[Info  - 2:48:39 PM] (2124774) Pylance language server 2023.5.30 (pyright e1b6074b) starting
[Info  - 2:48:39 PM] (2124774) Server root directory: /home/webappdevcasino/.vscode-server/extensions/ms-python.vscode-pylance-2023.5.30/dist
[Info  - 2:48:39 PM] (2124774) Starting service instance "casino_group_project"
[Info  - 2:48:39 PM] (2124774) Setting pythonPath for service "casino_group_project": "/bin/python3.10"
[Warn  - 2:48:39 PM] (2124774) stubPath /home/webappdevcasino/casino_group_project/typings is not a valid directory.
[Info  - 2:48:39 PM] (2124774) Assuming Python version 3.10
[Info  - 2:48:40 PM] (2124774) Found 30 source files
[Info  - 2:48:40 PM] (2124774) Background analysis(1) root directory: /home/webappdevcasino/.vscode-server/extensions/ms-python.vscode-pylance-2023.5.30/dist
[Info  - 2:48:40 PM] (2124774) Background analysis(1) started

/home/webappdevcasino/.vscode-server/extensions/ms-python.vscode-pylance-2023.5.30/dist/pyright.bundle.js:1
"use strict";exports.id=885,exports.ids=[885],exports.modules={46398:function(e,t,n){var i=this&&this.__createBinding||(Object.create?function(e,t,n,i){void 0===i&&(i=n),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,i){void 0===i&&(i=n),e[i]=t[n]}),s=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&i(t,e,n);return s(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.analyzeProgram=t.nullCallback=void 0;const a=n(88711),o=r(n(30795)),l=n(59273);t.nullCallback=()=>{},t.analyzeProgram=function(e,n,i,s,r,c){let p=!1;s=null!=s?s:t.nullCallback;try{(0,a.throwIfCancellationRequested)(c);const t=new l.Duration;p=e.analyze(n,c);const r=e.getFilesToAnalyzeCount(),o=e.getDiagnostics(i),d=o.length,u=t.getDurationInSeconds();(d>0||!p)&&s({diagnostics:o,filesInProgram:e.getFileCount(),filesRequiringAnalysis:r,checkingOnlyOpenFiles:e.isCheckingOnlyOpenFiles(),fatalErrorOccurred:!1,configParseErrorOccurred:!1,elapsedTime:u})}catch(e){if(a.OperationCanceledException.is(e))return!1;const t=o.getErrorString(e);r.error("Error performing analysis: "+t),s({diagnostics:[],filesInProgram:0,filesRequiringAnalysis:0,checkingOnlyOpenFiles:!0,fatalErrorOccurred:!0,configParseErrorOccurred:!1,elapsedTime:0,error:o.getSerializableError(e)})}return p}},21403:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.isAnnotationEvaluationPostponed=void 0;const i=n(86513);t.isAnnotationEvaluationPostponed=function(e){return!!e.isStubFile||(!!e.futureImports.has("annotations")||e.executionEnvironment.pythonVersion>=i.PythonVersion.V3_12)}},21:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.isCodeUnreachable=t.setTypeParameterSymbol=t.getTypeParameterSymbol=t.setDunderAllInfo=t.getDunderAllInfo=t.setCodeFlowComplexity=t.getCodeFlowComplexity=t.setCodeFlowExpressions=t.getCodeFlowExpressions=t.setFileInfo=t.getFileInfo=t.setAfterFlowNode=t.getAfterFlowNode=t.setFlowNode=t.getFlowNode=t.setDeclaration=t.getDeclaration=t.setScope=t.getScope=t.setImportInfo=t.getImportInfo=t.cleanNodeAnalysisInfo=void 0;const i=n(80563);function s(e){return e.flowNode}t.cleanNodeAnalysisInfo=function(e){const t=e;delete t.scope,delete t.declaration,delete t.flowNode,delete t.afterFlowNode,delete t.fileInfo,delete t.codeFlowExpressions,delete t.codeFlowComplexity,delete t.dunderAllInfo,delete t.typeParameterSymbol},t.getImportInfo=function(e){return e.importInfo},t.setImportInfo=function(e,t){e.importInfo=t},t.getScope=function(e){return e.scope},t.setScope=function(e,t){e.scope=t},t.getDeclaration=function(e){return e.declaration},t.setDeclaration=function(e,t){e.declaration=t},t.getFlowNode=s,t.setFlowNode=function(e,t){e.flowNode=t},t.getAfterFlowNode=function(e){return e.afterFlowNode},t.setAfterFlowNode=function(e,t){e.afterFlowNode=t},t.getFileInfo=function(e){for(;36!==e.nodeType;)e=e.parent;return e.fileInfo},t.setFileInfo=function(e,t){e.fileInfo=t},t.getCodeFlowExpressions=function(e){return e.codeFlowExpressions},t.setCodeFlowExpressions=function(e,t){e.codeFlowExpressions=t},t.getCodeFlowComplexity=function(e){var t;return null!==(t=e.codeFlowComplexity)&&void 0!==t?t:0},t.setCodeFlowComplexity=function(e,t){e.codeFlowComplexity=t},t.getDunderAllInfo=function(e){return e.dunderAllInfo},t.setDunderAllInfo=function(e,t){e.dunderAllInfo=t},t.getTypeParameterSymbol=function(e){return e.typeParameterSymbol},t.setTypeParameterSymbol=function(e,t){e.typeParameterSymbol=t},t.isCodeUnreachable=function(e){let t=e;for(;t;){const e=s(t);if(e)return!!(e.flags&i.FlowFlags.Unreachable);t=t.parent}return!1}},24618:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.BackgroundAnalysisProgram=void 0;const i=n(46398),s=n(12394);t.BackgroundAnalysisProgram=class{constructor(e,t,n,i,r,a,o){this._console=e,this._configOptions=t,this._importResolver=n,this._backgroundAnalysis=i,this._maxAnalysisTime=r,this._disableChecker=a,this._disposed=!1,this._program=new s.Program(this._importResolver,this._configOptions,this._console,void 0,this._disableChecker,o)}get configOptions(){return this._configOptions}get importResolver(){return this._importResolver}get program(){return this._program}get host(){return this._importResolver.host}get backgroundAnalysis(){return this._backgroundAnalysis}set backgroundAnalysis(e){this._backgroundAnalysis=e}hasSourceFile(e){return!!this._program.getSourceFile(e)}setConfigOptions(e){var t;this._configOptions=e,null===(t=this._backgroundAnalysis)||void 0===t||t.setConfigOptions(e),this._program.setConfigOptions(e)}setImportResolver(e){var t;this._importResolver=e,null===(t=this._backgroundAnalysis)||void 0===t||t.setImportResolver(e),this._program.setImportResolver(e),this._configOptions.getExecutionEnvironments().forEach((e=>this._ensurePartialStubPackages(e)))}setTrackedFiles(e){var t;null===(t=this._backgroundAnalysis)||void 0===t||t.setTrackedFiles(e);const n=this._program.setTrackedFiles(e);this._reportDiagnosticsForRemovedFiles(n)}setAllowedThirdPartyImports(e){var t;null===(t=this._backgroundAnalysis)||void 0===t||t.setAllowedThirdPartyImports(e),this._program.setAllowedThirdPartyImports(e)}setFileOpened(e,t,n,i){var s;null===(s=this._backgroundAnalysis)||void 0===s||s.setFileOpened(e,t,n,i),this._program.setFileOpened(e,t,n,i)}getChainedFilePath(e){return this._program.getChainedFilePath(e)}updateChainedFilePath(e,t){var n;null===(n=this._backgroundAnalysis)||void 0===n||n.updateChainedFilePath(e,t),this._program.updateChainedFilePath(e,t)}updateOpenFileContents(e,t,n,i){var s;null===(s=this._backgroundAnalysis)||void 0===s||s.setFileOpened(e,t,n,i),this._program.setFileOpened(e,t,n,i),this.markFilesDirty([e],!0)}setFileClosed(e,t){var n;null===(n=this._backgroundAnalysis)||void 0===n||n.setFileClosed(e,t);const i=this._program.setFileClosed(e,t);this._reportDiagnosticsForRemovedFiles(i)}addInterimFile(e){var t;null===(t=this._backgroundAnalysis)||void 0===t||t.addInterimFile(e),this._program.addInterimFile(e)}markAllFilesDirty(e,t=!0){var n;null===(n=this._backgroundAnalysis)||void 0===n||n.markAllFilesDirty(e,t),this._program.markAllFilesDirty(e,t)}markFilesDirty(e,t,n=!0){var i;null===(i=this._backgroundAnalysis)||void 0===i||i.markFilesDirty(e,t,n),this._program.markFilesDirty(e,t,n)}setCompletionCallback(e){var t;this._onAnalysisCompletion=e,null===(t=this._backgroundAnalysis)||void 0===t||t.setCompletionCallback(e)}startAnalysis(e){return this._backgroundAnalysis?(this._backgroundAnalysis.startAnalysis(this.getIndices(),e),!1):(0,i.analyzeProgram)(this._program,this._maxAnalysisTime,this._configOptions,this._onAnalysisCompletion,this._console,e)}analyzeFile(e,t){return this._program.analyzeFile(e,t)}startIndexing(e){var t;null===(t=this._backgroundAnalysis)||void 0===t||t.startIndexing(e,this._configOptions,this.importResolver,this.host.kind)}refreshIndexing(e){var t;null===(t=this._backgroundAnalysis)||void 0===t||t.refreshIndexing(this._configOptions,this.importResolver,this.host.kind,e)}cancelIndexing(){var e;null===(e=this._backgroundAnalysis)||void 0===e||e.cancelIndexing()}getIndexing(e){var t;return null===(t=this.getIndices())||void 0===t?void 0:t.getIndex(this._configOptions.findExecEnvironment(e).root)}async getDiagnosticsForRange(e,t,n){return this._backgroundAnalysis?this._backgroundAnalysis.getDiagnosticsForRange(e,t,n):this._program.getDiagnosticsForRange(e,t)}async writeTypeStub(e,t,n,s){return this._backgroundAnalysis?this._backgroundAnalysis.writeTypeStub(e,t,n,s):((0,i.analyzeProgram)(this._program,void 0,this._configOptions,this._onAnalysisCompletion,this._console,s),this._program.writeTypeStub(e,t,n,s))}invalidateAndForceReanalysis(e,t,n){var i;t&&this.refreshIndexing(n),null===(i=this._backgroundAnalysis)||void 0===i||i.invalidateAndForceReanalysis(e),this._importResolver.invalidateCache(),this._program.markAllFilesDirty(!0,e)}restart(){var e;null===(e=this._backgroundAnalysis)||void 0===e||e.restart()}dispose(){var e;this._disposed=!0,this._program.dispose(),null===(e=this._backgroundAnalysis)||void 0===e||e.shutdown()}enterEditMode(){this._preEditAnalysis=this._backgroundAnalysis,this._backgroundAnalysis=void 0,this._program.enterEditMode()}exitEditMode(){return this._backgroundAnalysis=this._preEditAnalysis,this._preEditAnalysis=void 0,this._program.exitEditMode()}getIndices(){}_ensurePartialStubPackages(e){var t;return null===(t=this._backgroundAnalysis)||void 0===t||t.ensurePartialStubPackages(e.root),this._importResolver.ensurePartialStubPackages(e)}_reportDiagnosticsForRemovedFiles(e){e.length>0&&!this._backgroundAnalysis&&this._onAnalysisCompletion&&this._onAnalysisCompletion({diagnostics:e,filesInProgram:this._program.getFileCount(),filesRequiringAnalysis:this._program.getFilesToAnalyzeCount(),checkingOnlyOpenFiles:this._program.isCheckingOnlyOpenFiles(),fatalErrorOccurred:!1,configParseErrorOccurred:!1,elapsedTime:0})}}},43324:function(e,t,n){var i=this&&this.__createBinding||(Object.create?function(e,t,n,i){void 0===i&&(i=n),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,i){void 0===i&&(i=n),e[i]=t[n]}),s=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&i(t,e,n);return s(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.DummyScopeGenerator=t.ReturnFinder=t.YieldFinder=t.Binder=void 0;const a=n(5284),o=n(30795),l=n(28513),c=n(81844),p=n(96541),d=n(6698),u=n(99661),y=r(n(21)),m=n(80563),h=n(44660),g=n(91128),f=r(n(66455)),T=n(59438),v=n(89126),_=r(n(93890)),b=n(16682),I=n(48466);class C extends T.ParseTreeWalker{constructor(e,t=!1){super(),this._moduleSymbolOnly=t,this._deferredBindingTasks=[],this._activeTypeParams=new Map,this._currentExceptTargets=[],this._finallyTargets=[],this._typingImportAliases=[],this._sysImportAliases=[],this._dataclassesImportAliases=[],this._typingSymbolAliases=new Map,this._dataclassesSymbolAliases=new Map,this._dunderAllStringNodes=[],this._usesUnsupportedDunderAllForm=!1,this._isInExceptSuite=!1,this._potentialHiddenSymbols=new Map,this._potentialPrivateSymbols=new Map,this._codeFlowComplexity=0,this._fileInfo=e}bindModule(e){var t;const n=void 0===this._fileInfo.builtinsScope;this._createNewScope(n?4:3,this._fileInfo.builtinsScope,(()=>{y.setScope(e,this._currentScope),y.setFlowNode(e,this._currentFlowNode),this._addImplicitSymbolToCurrentScope("__name__",e,"str"),this._addImplicitSymbolToCurrentScope("__qualname__",e,"str"),this._addImplicitSymbolToCurrentScope("__loader__",e,"Any"),this._addImplicitSymbolToCurrentScope("__package__",e,"str"),this._addImplicitSymbolToCurrentScope("__spec__",e,"Any"),this._addImplicitSymbolToCurrentScope("__path__",e,"Iterable[str]"),this._addImplicitSymbolToCurrentScope("__file__",e,"str"),this._addImplicitSymbolToCurrentScope("__cached__",e,"str"),this._addImplicitSymbolToCurrentScope("__dict__",e,"Dict[str, Any]"),this._addImplicitSymbolToCurrentScope("__annotations__",e,"Dict[str, Any]"),this._addImplicitSymbolToCurrentScope("__builtins__",e,"Any");const t=f.getDocString(e.statements);this._addImplicitSymbolToCurrentScope("__doc__",e,t?"str":"str | None"),this._currentFlowNode=this._createStartFlowNode(),this._walkStatementsAndReportUnreachable(e.statements),y.setAfterFlowNode(e,this._currentFlowNode),y.setCodeFlowExpressions(e,this._currentScopeCodeFlowExpressions),y.setCodeFlowComplexity(e,this._codeFlowComplexity)})),this._bindDeferred(),this._potentialHiddenSymbols.forEach(((e,t)=>{var n;(null===(n=this._dunderAllNames)||void 0===n?void 0:n.some((e=>e===t)))||(this._fileInfo.isStubFile?e.setIsExternallyHidden():e.setPrivatePyTypedImport())})),this._potentialPrivateSymbols.forEach(((e,t)=>{var n;(null===(n=this._dunderAllNames)||void 0===n?void 0:n.some((e=>e===t)))||e.setIsPrivateMember()})),this._dunderAllNames?y.setDunderAllInfo(e,{names:this._dunderAllNames,stringNodes:this._dunderAllStringNodes,usesUnsupportedDunderAllForm:this._usesUnsupportedDunderAllForm}):y.setDunderAllInfo(e,void 0);const i=y.getScope(e);if(i&&this._dunderAllNames)for(const e of this._dunderAllNames)null===(t=i.symbolTable.get(e))||void 0===t||t.setIsInDunderAll()}visitModule(e){return(0,o.fail)("We should never get here"),!1}visitSuite(e){return this._walkStatementsAndReportUnreachable(e.statements),!1}visitModuleName(e){const t=y.getImportInfo(e);if((0,o.assert)(void 0!==t),t.isNativeLib)return!0;if(!t.isImportFound)return this._addDiagnostic(this._fileInfo.diagnosticRuleSet.reportMissingImports,l.DiagnosticRule.reportMissingImports,u.Localizer.Diagnostic.importResolveFailure().format({importName:t.importName}),e),!0;if(!t.isStubFile&&1===t.importType&&!t.pyTypedInfo){const n=this._addDiagnostic(this._fileInfo.diagnosticRuleSet.reportMissingTypeStubs,l.DiagnosticRule.reportMissingTypeStubs,u.Localizer.Diagnostic.stubFileMissing().format({importName:t.importName}),e);if(n){const e={action:"pyright.createtypestub",moduleName:t.importName};n.addAction(e)}}return!0}visitClass(e){this.walkMultiple(e.decorators);const t={type:6,node:e,path:this._fileInfo.filePath,range:(0,p.convertTextRangeToRange)(e.name,this._fileInfo.lines),moduleName:this._fileInfo.moduleName,isInExceptSuite:this._isInExceptSuite},n=this._bindNameToScope(this._currentScope,e.name);return n&&n.addDeclaration(t),y.setDeclaration(e,t),e.typeParameters&&this.walk(e.typeParameters),this.walkMultiple(e.arguments),this._createNewScope(2,this._getNonClassParentScope(),(()=>{y.setScope(e,this._currentScope),this._addImplicitSymbolToCurrentScope("__doc__",e,"str | None"),this._addImplicitSymbolToCurrentScope("__module__",e,"str"),this._dunderSlotsEntries=void 0,this._moduleSymbolOnly||this.walk(e.suite),this._dunderSlotsEntries&&this._addSlotsToCurrentScope(this._dunderSlotsEntries),this._dunderSlotsEntries=void 0})),this._createAssignmentTargetFlowNodes(e.name,!1,!1),e.typeParameters&&this._removeActiveTypeParameters(e.typeParameters),!1}visitFunction(e){this._createVariableAnnotationFlowNode(),y.setFlowNode(e,this._currentFlowNode);const t=this._bindNameToScope(this._currentScope,e.name),n=f.getEnclosingClass(e,!0),i={type:5,node:e,isMethod:!!n,isGenerator:!1,path:this._fileInfo.filePath,range:(0,p.convertTextRangeToRange)(e.name,this._fileInfo.lines),moduleName:this._fileInfo.moduleName,isInExceptSuite:this._isInExceptSuite};return t&&t.addDeclaration(i),y.setDeclaration(e,i),e.parameters.forEach((e=>{e.defaultValue&&this.walk(e.defaultValue)})),e.typeParameters&&this.walk(e.typeParameters),this.walkMultiple(e.decorators),e.parameters.forEach((e=>{e.typeAnnotation&&this.walk(e.typeAnnotation),e.typeAnnotationComment&&this.walk(e.typeAnnotationComment)})),e.returnTypeAnnotation&&this.walk(e.returnTypeAnnotation),e.functionAnnotationComment&&this.walk(e.functionAnnotationComment),this._createNewScope(1,this._getNonClassParentScope(),(()=>{y.setScope(e,this._currentScope);f.getEnclosingClass(e)&&this._addImplicitSymbolToCurrentScope("__class__",e,"class"),this._deferBinding((()=>{this._currentFlowNode=this._createStartFlowNode(),this._codeFlowComplexity=0,e.parameters.forEach((t=>{var n,i;if(t.name){const s=this._bindNameToScope(this._currentScope,t.name);let r=f.getDocString(null!==(i=null===(n=null==e?void 0:e.suite)||void 0===n?void 0:n.statements)&&void 0!==i?i:[]);if(void 0!==r&&(r=(0,g.extractParameterDocumentation)(r,t.name.value)),s){const e={type:2,node:t,path:this._fileInfo.filePath,range:(0,p.convertTextRangeToRange)(t,this._fileInfo.lines),moduleName:this._fileInfo.moduleName,isInExceptSuite:this._isInExceptSuite,docString:r};s.addDeclaration(e),y.setDeclaration(t.name,e)}this._createFlowAssignment(t.name)}})),this._targetFunctionDeclaration=i,this._currentReturnTarget=this._createBranchLabel(),this.walk(e.suite),y.setAfterFlowNode(e.suite,this._currentFlowNode),this._addAntecedent(this._currentReturnTarget,this._currentFlowNode);const t=this._finishFlowLabel(this._currentReturnTarget);y.setAfterFlowNode(e,t),y.setCodeFlowExpressions(e,this._currentScopeCodeFlowExpressions),y.setCodeFlowComplexity(e,this._codeFlowComplexity)}))})),this._createAssignmentTargetFlowNodes(e.name,!1,!1),e.typeParameters&&this._removeActiveTypeParameters(e.typeParameters),!1}visitLambda(e){return this._createVariableAnnotationFlowNode(),y.setFlowNode(e,this._currentFlowNode),e.parameters.forEach((e=>{e.defaultValue&&this.walk(e.defaultValue)})),this._createNewScope(1,this._getNonClassParentScope(),(()=>{y.setScope(e,this._currentScope),this._deferBinding((()=>{this._currentFlowNode=this._createStartFlowNode(),e.parameters.forEach((e=>{if(e.name){const t=this._bindNameToScope(this._currentScope,e.name);if(t){const n={type:2,node:e,path:this._fileInfo.filePath,range:(0,p.convertTextRangeToRange)(e,this._fileInfo.lines),moduleName:this._fileInfo.moduleName,isInExceptSuite:this._isInExceptSuite};t.addDeclaration(n),y.setDeclaration(e.name,n)}this._createFlowAssignment(e.name),this.walk(e.name),y.setFlowNode(e,this._currentFlowNode)}})),this.walk(e.expression),y.setCodeFlowExpressions(e,this._currentScopeCodeFlowExpressions)}))})),!1}visitCall(e){var t,n;if(this._disableTrueFalseTargets((()=>{this.walk(e.leftExpression),e.arguments.forEach((e=>{this._currentFlowNode&&y.setFlowNode(e,this._currentFlowNode),this.walk(e)}))})),f.isNodeContainedWithinNodeType(e,13)||this._createCallFlowNode(e),3===this._currentScope.type&&35===e.leftExpression.nodeType&&38===e.leftExpression.leftExpression.nodeType&&"__all__"===e.leftExpression.leftExpression.value){let i=!0;if("extend"===e.leftExpression.memberName.value&&1===e.arguments.length){const t=e.arguments[0].valueExpression;if(31===t.nodeType)t.entries.forEach((e=>{var t,n;48===e.nodeType&&1===e.strings.length&&49===e.strings[0].nodeType&&(null===(t=this._dunderAllNames)||void 0===t||t.push(e.strings[0].value),null===(n=this._dunderAllStringNodes)||void 0===n||n.push(e.strings[0]),i=!1)}));else if(35===t.nodeType&&38===t.leftExpression.nodeType&&"__all__"===t.memberName.value){const e=this._getDunderAllNamesFromImport(t.leftExpression.value);e&&e.length>0&&(e.forEach((e=>{var t;null===(t=this._dunderAllNames)||void 0===t||t.push(e)})),i=!1)}}else if("remove"===e.leftExpression.memberName.value&&1===e.arguments.length){const t=e.arguments[0].valueExpression;48===t.nodeType&&1===t.strings.length&&49===t.strings[0].nodeType&&this._dunderAllNames&&(this._dunderAllNames=this._dunderAllNames.filter((e=>e!==t.strings[0].value)),this._dunderAllStringNodes=this._dunderAllStringNodes.filter((e=>e.value!==t.strings[0].value)),i=!1)}else if("append"===e.leftExpression.memberName.value&&1===e.arguments.length){const s=e.arguments[0].valueExpression;48===s.nodeType&&1===s.strings.length&&49===s.strings[0].nodeType&&(null===(t=this._dunderAllNames)||void 0===t||t.push(s.strings[0].value),null===(n=this._dunderAllStringNodes)||void 0===n||n.push(s.strings[0]),i=!1)}i&&(this._usesUnsupportedDunderAllForm=!0,this._addDiagnostic(this._fileInfo.diagnosticRuleSet.reportUnsupportedDunderAll,l.DiagnosticRule.reportUnsupportedDunderAll,u.Localizer.Diagnostic.unsupportedDunderAllOperation(),e))}return!1}visitTypeParameterList(e){return e.parameters.forEach((e=>{e.boundExpression&&this.walk(e.boundExpression)})),e.parameters.forEach((t=>{const n=t.name,i=new b.Symbol(0),s={type:3,node:t,path:this._fileInfo.filePath,range:(0,p.convertTextRangeToRange)(e,this._fileInfo.lines),moduleName:this._fileInfo.moduleName,isInExceptSuite:this._isInExceptSuite};i.addDeclaration(s),y.setDeclaration(n,s),y.setTypeParameterSymbol(n,i),this._activeTypeParams.has(n.value)?this._addError(u.Localizer.Diagnostic.typeParameterExistingTypeParameter().format({name:n.value}),n):this._activeTypeParams.set(n.value,i)})),e.parameters.forEach((e=>{e.defaultExpression&&this.walk(e.defaultExpression)})),!1}visitTypeAlias(e){this._bindNameToScope(this._currentScope,e.name),this.walk(e.name),e.typeParameters&&this.walk(e.typeParameters);const t={type:4,node:e,path:this._fileInfo.filePath,range:(0,p.convertTextRangeToRange)(e.name,this._fileInfo.lines),moduleName:this._fileInfo.moduleName,isInExceptSuite:this._isInExceptSuite},n=this._bindNameToScope(this._currentScope,e.name);return n&&n.addDeclaration(t),y.setDeclaration(e,t),this._createAssignmentTargetFlowNodes(e.name,!0,!1),this.walk(e.expression),e.typeParameters&&this._removeActiveTypeParameters(e.typeParameters),!1}visitAssignment(e){if(this._handleTypingStubAssignmentOrAnnotation(e))return!1;if(this._bindPossibleTupleNamedTarget(e.leftExpression),e.typeAnnotationComment&&(this.walk(e.typeAnnotationComment),this._addTypeDeclarationForVariable(e.leftExpression,e.typeAnnotationComment)),e.chainedTypeAnnotationComment&&this._addDiagnostic(this._fileInfo.diagnosticRuleSet.reportGeneralTypeIssues,l.DiagnosticRule.reportGeneralTypeIssues,u.Localizer.Diagnostic.annotationNotSupported(),e.chainedTypeAnnotationComment),24===e.leftExpression.nodeType){const t=e.leftExpression;if(1===t.items.length&&!t.trailingComma&&48===t.items[0].valueExpression.nodeType&&(0,m.isCodeFlowSupportedForReference)(t.baseExpression)){const e=(0,m.createKeyForReference)(t.baseExpression);this._currentScopeCodeFlowExpressions.add(e)}}this.walk(e.rightExpression);let t=!0;if((f.getEnclosingFunction(e)||9===e.rightExpression.nodeType&&this._fileInfo.isTypingStubFile||f.isWithinLoop(e))&&(t=!1),this._addInferredTypeAssignmentForVariable(e.leftExpression,e.rightExpression,t),this._createAssignmentTargetFlowNodes(e.leftExpression,!0,!1),3===this._currentScope.type&&(38===e.leftExpression.nodeType&&"__all__"===e.leftExpression.value||54===e.leftExpression.nodeType&&38===e.leftExpression.valueExpression.nodeType&&"__all__"===e.leftExpression.valueExpression.value)){const t=e.rightExpression;this._dunderAllNames=[];let n=!1;31===t.nodeType?t.entries.forEach((e=>{48===e.nodeType&&1===e.strings.length&&49===e.strings[0].nodeType?(this._dunderAllNames.push(e.strings[0].value),this._dunderAllStringNodes.push(e.strings[0])):n=!0})):52===t.nodeType?t.expressions.forEach((e=>{48===e.nodeType&&1===e.strings.length&&49===e.strings[0].nodeType?(this._dunderAllNames.push(e.strings[0].value),this._dunderAllStringNodes.push(e.strings[0])):n=!0})):n=!0,n&&(this._usesUnsupportedDunderAllForm=!0,this._addDiagnostic(this._fileInfo.diagnosticRuleSet.reportUnsupportedDunderAll,l.DiagnosticRule.reportUnsupportedDunderAll,u.Localizer.Diagnostic.unsupportedDunderAllOperation(),e))}if(2===this._currentScope.type&&(38===e.leftExpression.nodeType&&"__slots__"===e.leftExpression.value||54===e.leftExpression.nodeType&&38===e.leftExpression.valueExpression.nodeType&&"__slots__"===e.leftExpression.valueExpression.value)){const t=e.rightExpression;this._dunderSlotsEntries=[];let n=!0;48===t.nodeType?this._dunderSlotsEntries.push(t):31===t.nodeType?t.entries.forEach((e=>{48===e.nodeType&&1===e.strings.length&&49===e.strings[0].nodeType?this._dunderSlotsEntries.push(e):n=!1})):52===t.nodeType?t.expressions.forEach((e=>{48===e.nodeType&&1===e.strings.length&&49===e.strings[0].nodeType?this._dunderSlotsEntries.push(e):n=!1})):n=!1,n||(this._dunderSlotsEntries=void 0)}return!1}visitAssignmentExpression(e){this._disableTrueFalseTargets((()=>{this.walk(e.rightExpression)}));const t=f.getEvaluationNodeForAssignmentExpression(e);if(t){const n=y.getScope(t);let i=this._currentScope;for(;i&&i!==n;){if(i.lookUpSymbol(e.name.value)){this._addError(u.Localizer.Diagnostic.assignmentExprComprehension().format({name:e.name.value}),e.name);break}i=i.parent}this._bindNameToScope(n,e.name),this._addInferredTypeAssignmentForVariable(e.name,e.rightExpression),this._createAssignmentTargetFlowNodes(e.name,!0,!1)}else this._addError(u.Localizer.Diagnostic.assignmentExprContext(),e),this.walk(e.name);return!1}visitAugmentedAssignment(e){if(this.walk(e.leftExpression),this.walk(e.rightExpression),this._bindPossibleTupleNamedTarget(e.destExpression),this._createAssignmentTargetFlowNodes(e.destExpression,!1,!1),1===e.operator&&3===this._currentScope.type&&38===e.leftExpression.nodeType&&"__all__"===e.leftExpression.value){const t=e.rightExpression;let n=!0;if(31===t.nodeType)t.entries.forEach((e=>{var t;48===e.nodeType&&1===e.strings.length&&49===e.strings[0].nodeType&&(null===(t=this._dunderAllNames)||void 0===t||t.push(e.strings[0].value),this._dunderAllStringNodes.push(e.strings[0]))})),n=!1;else if(35===t.nodeType&&38===t.leftExpression.nodeType&&"__all__"===t.memberName.value){const e=this._getDunderAllNamesFromImport(t.leftExpression.value);e&&(e.forEach((e=>{var t;null===(t=this._dunderAllNames)||void 0===t||t.push(e)})),n=!1)}n&&(this._usesUnsupportedDunderAllForm=!0,this._addDiagnostic(this._fileInfo.diagnosticRuleSet.reportUnsupportedDunderAll,l.DiagnosticRule.reportUnsupportedDunderAll,u.Localizer.Diagnostic.unsupportedDunderAllOperation(),e))}return!1}visitDel(e){return e.expressions.forEach((e=>{this._bindPossibleTupleNamedTarget(e),this.walk(e),this._createAssignmentTargetFlowNodes(e,!1,!0)})),!1}visitTypeAnnotation(e){var t;if(this._handleTypingStubAssignmentOrAnnotation(e))return!1;const n=3===(null===(t=e.parent)||void 0===t?void 0:t.nodeType)&&void 0!==f.getEnclosingClass(e,!0);n||this.walk(e.typeAnnotation),this._createVariableAnnotationFlowNode(),this._bindPossibleTupleNamedTarget(e.valueExpression),this._addTypeDeclarationForVariable(e.valueExpression,e.typeAnnotation),n&&this.walk(e.typeAnnotation);const i=[];return this._isNarrowingExpression(e.valueExpression,i)&&i.forEach((e=>{const t=(0,m.createKeyForReference)(e);this._currentScopeCodeFlowExpressions.add(t)})),this.walk(e.valueExpression),!1}visitFor(e){this._bindPossibleTupleNamedTarget(e.targetExpression),this._addInferredTypeAssignmentForVariable(e.targetExpression,e),this.walk(e.iterableExpression);const t=this._createLoopLabel(),n=this._createBranchLabel(),i=this._createBranchLabel();this._addAntecedent(t,this._currentFlowNode),this._currentFlowNode=t,this._addAntecedent(n,this._currentFlowNode);const s=this._trackCodeFlowExpressions((()=>{this._createAssignmentTargetFlowNodes(e.targetExpression,!0,!1)}));if(this._bindLoopStatement(t,i,(()=>{this.walk(e.forSuite),this._addAntecedent(t,this._currentFlowNode),s.forEach((e=>{var t;null===(t=this._currentScopeCodeFlowExpressions)||void 0===t||t.add(e)}))})),this._currentFlowNode=this._finishFlowLabel(n),e.elseSuite&&this.walk(e.elseSuite),this._addAntecedent(i,this._currentFlowNode),this._currentFlowNode=this._finishFlowLabel(i),e.asyncToken&&!this._fileInfo.ipythonMode){const t=f.getEnclosingFunction(e);t&&t.isAsync||this._addError(u.Localizer.Diagnostic.asyncNotInAsyncFunction(),e.asyncToken)}return!1}visitContinue(e){return this._currentContinueTarget&&this._addAntecedent(this._currentContinueTarget,this._currentFlowNode),this._currentFlowNode=C._unreachableFlowNode,!1}visitBreak(e){return this._currentBreakTarget&&this._addAntecedent(this._currentBreakTarget,this._currentFlowNode),this._currentFlowNode=C._unreachableFlowNode,!1}visitReturn(e){return this._targetFunctionDeclaration&&(this._targetFunctionDeclaration.returnStatements||(this._targetFunctionDeclaration.returnStatements=[]),this._targetFunctionDeclaration.returnStatements.push(e)),e.returnExpression&&this.walk(e.returnExpression),y.setFlowNode(e,this._currentFlowNode),this._currentReturnTarget&&this._addAntecedent(this._currentReturnTarget,this._currentFlowNode),this._finallyTargets.forEach((e=>{this._addAntecedent(e,this._currentFlowNode)})),this._currentFlowNode=C._unreachableFlowNode,!1}visitYield(e){return this._isInListComprehension(e,!0)&&this._addError(u.Localizer.Diagnostic.yieldWithinListCompr(),e),this._bindYield(e),!1}visitYieldFrom(e){return this._isInListComprehension(e,!0)&&this._addError(u.Localizer.Diagnostic.yieldWithinListCompr(),e),this._bindYield(e),!1}visitMemberAccess(e){return this.walk(e.leftExpression),y.setFlowNode(e,this._currentFlowNode),!1}visitName(e){y.setFlowNode(e,this._currentFlowNode);const t=this._activeTypeParams.get(e.value);return t&&y.setTypeParameterSymbol(e,t),!1}visitIndex(e){return y.setFlowNode(e,this._currentFlowNode),!0}visitIf(e){const t=this._currentFlowNode,n=this._createBranchLabel(),i=this._createBranchLabel(),s=this._createBranchLabel(t);return s.affectedExpressions=this._trackCodeFlowExpressions((()=>{const t=_.evaluateStaticBoolLikeExpression(e.testExpression,this._fileInfo.executionEnvironment,this._fileInfo.definedConstants,this._typingImportAliases,this._sysImportAliases);this._bindConditional(e.testExpression,n,i),this._currentFlowNode=!1===t?C._unreachableFlowNode:this._finishFlowLabel(n),this.walk(e.ifSuite),this._addAntecedent(s,this._currentFlowNode),this._currentFlowNode=!0===t?C._unreachableFlowNode:this._finishFlowLabel(i),e.elseSuite?this.walk(e.elseSuite):this._bindNeverCondition(e.testExpression,s,!1),this._addAntecedent(s,this._currentFlowNode),this._currentFlowNode=this._finishFlowLabel(s)})),!1}visitWhile(e){const t=this._createBranchLabel(),n=this._createBranchLabel(),i=this._createBranchLabel(),s=_.evaluateStaticBoolLikeExpression(e.testExpression,this._fileInfo.executionEnvironment,this._fileInfo.definedConstants,this._typingImportAliases,this._sysImportAliases),r=this._createLoopLabel();return this._addAntecedent(r,this._currentFlowNode),this._currentFlowNode=r,this._bindConditional(e.testExpression,t,n),this._currentFlowNode=!1===s?C._unreachableFlowNode:this._finishFlowLabel(t),this._bindLoopStatement(r,i,(()=>{this.walk(e.whileSuite)})),this._addAntecedent(r,this._currentFlowNode),this._currentFlowNode=!0===s?C._unreachableFlowNode:this._finishFlowLabel(n),e.elseSuite&&this.walk(e.elseSuite),this._addAntecedent(i,this._currentFlowNode),this._currentFlowNode=this._finishFlowLabel(i),!1}visitAssert(e){const t=this._createBranchLabel(),n=this._createBranchLabel();return this._bindConditional(e.testExpression,t,n),e.exceptionExpression&&(this._currentFlowNode=this._finishFlowLabel(n),this.walk(e.exceptionExpression)),this._currentFlowNode=this._finishFlowLabel(t),!1}visitExcept(e){if(e.typeExpression&&this.walk(e.typeExpression),e.name){this.walk(e.name);const t=this._bindNameToScope(this._currentScope,e.name);if(this._createAssignmentTargetFlowNodes(e.name,!0,!1),t){const n={type:1,node:e.name,isConstant:(0,I.isConstantName)(e.name.value),inferredTypeSource:e,path:this._fileInfo.filePath,range:(0,p.convertTextRangeToRange)(e.name,this._fileInfo.lines),moduleName:this._fileInfo.moduleName,isInExceptSuite:this._isInExceptSuite};t.addDeclaration(n)}}const t=this._isInExceptSuite;return this._isInExceptSuite=!0,this.walk(e.exceptSuite),this._isInExceptSuite=t,e.name&&this._createFlowAssignment(e.name,!0),!1}visitRaise(e){return this._targetFunctionDeclaration&&(this._targetFunctionDeclaration.raiseStatements||(this._targetFunctionDeclaration.raiseStatements=[]),this._targetFunctionDeclaration.raiseStatements.push(e)),e.typeExpression&&this.walk(e.typeExpression),e.valueExpression&&this.walk(e.valueExpression),e.tracebackExpression&&this.walk(e.tracebackExpression),this._finallyTargets.forEach((e=>{this._addAntecedent(e,this._currentFlowNode)})),this._currentFlowNode=C._unreachableFlowNode,!1}visitTry(e){const t=this._currentFlowNode,n=e.exceptClauses.map((()=>this._createBranchLabel())),i=this._createBranchLabel(t);let s=!1;const r=this._createBranchLabel(t),a={flags:m.FlowFlags.PreFinallyGate,id:this._getUniqueFlowNodeId(),antecedent:r,isGateClosed:!1};if(i.affectedExpressions=this._trackCodeFlowExpressions((()=>{e.finallySuite&&this._addAntecedent(i,a);e.exceptClauses.some((e=>!e.typeExpression))||n.push(r),n.forEach((e=>{this._addAntecedent(e,this._currentFlowNode)})),e.finallySuite&&this._finallyTargets.push(r),this._useExceptTargets(n,(()=>{this.walk(e.trySuite)})),e.elseSuite&&this.walk(e.elseSuite),this._addAntecedent(i,this._currentFlowNode),this._isCodeUnreachable()||(s=!0),e.exceptClauses.forEach(((e,t)=>{this._currentFlowNode=this._finishFlowLabel(n[t]),this.walk(e),this._addAntecedent(i,this._currentFlowNode),this._isCodeUnreachable()||(s=!0)})),e.finallySuite&&this._finallyTargets.pop(),this._currentFlowNode=this._finishFlowLabel(i)})),e.finallySuite){this.walk(e.finallySuite);const t={flags:m.FlowFlags.PostFinally,id:this._getUniqueFlowNodeId(),finallyNode:e.finallySuite,antecedent:this._currentFlowNode,preFinallyGate:a};this._currentFlowNode=s?t:C._unreachableFlowNode}return!1}visitAwait(e){var t;const n=f.getEnclosingFunction(e);if(void 0===n||!n.isAsync){if(this._fileInfo.ipythonMode&&void 0===n)return!0;32!==(null===(t=e.parent)||void 0===t?void 0:t.nodeType)&&this._addError(u.Localizer.Diagnostic.awaitNotInAsync(),e)}return!0}visitGlobal(e){const t=this._currentScope.getGlobalScope().scope;return e.nameList.forEach((e=>{const n=e.value;0===this._currentScope.getBindingType(n)&&this._addError(u.Localizer.Diagnostic.nonLocalRedefinition().format({name:n}),e);const i=this._currentScope.lookUpSymbolRecursive(n);i&&i.scope===this._currentScope&&this._addError(u.Localizer.Diagnostic.globalReassignment().format({name:n}),e),this._bindNameToScope(t,e),this._currentScope!==t&&this._currentScope.setBindingType(n,1)})),!0}visitNonlocal(e){const t=this._currentScope.getGlobalScope().scope;return this._currentScope===t?this._addError(u.Localizer.Diagnostic.nonLocalInModule(),e):e.nameList.forEach((e=>{const n=e.value;1===this._currentScope.getBindingType(n)&&this._addError(u.Localizer.Diagnostic.globalRedefinition().format({name:n}),e);const i=this._currentScope.lookUpSymbolRecursive(n);i&&i.scope===this._currentScope?this._addError(u.Localizer.Diagnostic.nonLocalReassignment().format({name:n}),e):i&&i.scope!==t||this._addError(u.Localizer.Diagnostic.nonLocalNoBinding().format({name:n}),e),i&&this._currentScope.setBindingType(n,0)})),!0}visitImportAs(e){var t,n,i,s,r,a;if(e.module.nameParts.length>0){const l=e.module.nameParts[0].value;let c,p;e.alias?(c=e.alias.value,p=e.alias):(c=l,p=e.module.nameParts[0]);const d=this._bindNameToScope(this._currentScope,p);!d||3!==this._currentScope.type&&4!==this._currentScope.type||e.alias&&1===e.module.nameParts.length&&e.module.nameParts[0].value===e.alias.value||(this._fileInfo.isStubFile||this._fileInfo.isInPyTypedPackage)&&this._potentialHiddenSymbols.set(c,d);const u=y.getImportInfo(e.module);(0,o.assert)(void 0!==u),d&&this._createAliasDeclarationForMultipartImportName(e,e.alias,u,d),this._createFlowAssignment(e.alias?e.alias:e.module.nameParts[0]),1===e.module.nameParts.length&&("typing"===l||"typing_extensions"===l?this._typingImportAliases.push(null!==(n=null===(t=e.alias)||void 0===t?void 0:t.value)&&void 0!==n?n:l):"sys"===l?this._sysImportAliases.push(null!==(s=null===(i=e.alias)||void 0===i?void 0:i.value)&&void 0!==s?s:l):"dataclasses"===l&&this._dataclassesImportAliases.push(null!==(a=null===(r=e.alias)||void 0===r?void 0:r.value)&&void 0!==a?a:l))}return!0}visitImportFrom(e){var t;const n=["Final","ClassVar","Annotated"],i=["InitVar"],s=y.getImportInfo(e.module);let r="";s&&s.isImportFound&&!s.isNativeLib&&(r=s.resolvedPaths[s.resolvedPaths.length-1]);const a=(0,c.stripFileExtension)((0,c.getFileName)(this._fileInfo.filePath)),o="__init__"===a&&1===e.module.leadingDots&&1===e.module.nameParts.length;let l=!1,h=!1;if(1===e.module.nameParts.length){const t=e.module.nameParts[0].value;"typing"!==t&&"typing_extensions"!==t||(l=!0),"dataclasses"===t&&(h=!0)}if(e.isWildcardImport){if((f.getEnclosingClass(e)||f.getEnclosingFunction(e))&&this._addError(u.Localizer.Diagnostic.wildcardInFunction(),e),s){const a=[];null===(t=this._currentScopeCodeFlowExpressions)||void 0===t||t.add(m.wildcardImportReferenceKey);const c=this._fileInfo.importLookup(r);if(c){const t=this._getWildcardImportNames(c);if(o){t.some((t=>t===e.module.nameParts[0].value))||this._addImplicitFromImport(e,s)}t.forEach((t=>{const n=this._bindNameValueToScope(this._currentScope,t);if(n){if(c.symbolTable.get(t)){const i={type:8,node:e,path:r,loadSymbolsFromPath:!0,range:(0,d.getEmptyRange)(),usesLocalName:!1,symbolName:t,moduleName:this._fileInfo.moduleName,isInExceptSuite:this._isInExceptSuite};n.addDeclaration(i),a.push(t)}else if(s&&s.filteredImplicitImports){const i=s.filteredImplicitImports.find((e=>e.name===t));if(i){const s={type:8,node:e,path:i.path,loadSymbolsFromPath:!0,range:(0,d.getEmptyRange)(),usesLocalName:!1,moduleName:this._fileInfo.moduleName,isInExceptSuite:this._isInExceptSuite},o={type:8,node:e,path:r,loadSymbolsFromPath:!0,usesLocalName:!1,symbolName:t,submoduleFallback:s,range:(0,d.getEmptyRange)(),moduleName:this._fileInfo.moduleName,isInExceptSuite:this._isInExceptSuite};n.addDeclaration(o),a.push(t)}}}}))}this._createFlowWildcardImport(e,a),l&&n.forEach((e=>{this._typingSymbolAliases.set(e,e)})),h&&i.forEach((e=>{this._dataclassesSymbolAliases.set(e,e)}))}}else o&&this._addImplicitFromImport(e,s),e.imports.forEach((t=>{const o=t.name.value,c=t.alias||t.name,u=this._bindNameToScope(this._currentScope,c);if(u){let y,m;e.module.nameParts.length>0&&(3!==this._currentScope.type&&4!==this._currentScope.type||t.alias&&t.alias.value===t.name.value||(this._fileInfo.isStubFile||this._fileInfo.isInPyTypedPackage)&&this._potentialHiddenSymbols.set(c.value,u)),s&&s.filteredImplicitImports&&(y=s.filteredImplicitImports.find((e=>e.name===o)));let g=!0;y&&(m={type:8,node:t,path:y.path,loadSymbolsFromPath:!0,range:(0,d.getEmptyRange)(),usesLocalName:!1,moduleName:this._fileInfo.moduleName,isInExceptSuite:this._isInExceptSuite},"__init__"===a&&(1===e.module.leadingDots&&0===e.module.nameParts.length||r===this._fileInfo.filePath)&&(g=!1));const f={type:8,node:t,path:r,loadSymbolsFromPath:g,usesLocalName:!!t.alias,symbolName:o,submoduleFallback:m,range:(0,p.convertTextRangeToRange)(c,this._fileInfo.lines),moduleName:this._fileInfo.moduleName,isInExceptSuite:this._isInExceptSuite,isNativeLib:null==s?void 0:s.isNativeLib};u.addDeclaration(f),this._createFlowAssignment(t.alias||t.name),l&&n.some((e=>e===t.name.value))&&this._typingSymbolAliases.set(c.value,t.name.value),h&&i.some((e=>e===t.name.value))&&this._dataclassesSymbolAliases.set(c.value,t.name.value)}}));return!0}visitWith(e){e.withItems.forEach((e=>{this.walk(e.expression),e.target&&(this._bindPossibleTupleNamedTarget(e.target),this._addInferredTypeAssignmentForVariable(e.target,e),this._createAssignmentTargetFlowNodes(e.target,!0,!1))}));const t=this._createContextManagerLabel(e.withItems.map((e=>e.expression)),!!e.isAsync,!1);this._addAntecedent(t,this._currentFlowNode);const n=this._createContextManagerLabel(e.withItems.map((e=>e.expression)),!!e.isAsync,!0);this._currentExceptTargets.forEach((e=>{this._addAntecedent(e,n)}));const i=this._currentFlowNode,s=this._createBranchLabel(i);return this._addAntecedent(s,t),s.affectedExpressions=this._trackCodeFlowExpressions((()=>{if(this._useExceptTargets([t,n],(()=>{this.walk(e.suite)})),this._addAntecedent(s,this._currentFlowNode),this._currentFlowNode=s,this._isCodeUnreachable()||this._addExceptTargets(this._currentFlowNode),e.asyncToken&&!this._fileInfo.ipythonMode){const t=f.getEnclosingFunction(e);t&&t.isAsync||this._addError(u.Localizer.Diagnostic.asyncNotInAsyncFunction(),e.asyncToken)}})),!1}visitTernary(e){const t=this._currentFlowNode,n=this._createBranchLabel(),i=this._createBranchLabel(),s=this._createBranchLabel(t);return s.affectedExpressions=this._trackCodeFlowExpressions((()=>{this._bindConditional(e.testExpression,n,i),this._currentFlowNode=this._finishFlowLabel(n),this.walk(e.ifExpression),this._addAntecedent(s,this._currentFlowNode),this._currentFlowNode=this._finishFlowLabel(i),this.walk(e.elseExpression),this._addAntecedent(s,this._currentFlowNode),this._currentFlowNode=this._finishFlowLabel(s)})),!1}visitUnaryOperation(e){return 38===e.operator&&this._currentFalseTarget&&this._currentTrueTarget?this._bindConditional(e.expression,this._currentFalseTarget,this._currentTrueTarget):this._disableTrueFalseTargets((()=>{this.walk(e.expression)})),!1}visitBinaryOperation(e){if(36===e.operator||37===e.operator){let t,n=this._currentTrueTarget,i=this._currentFalseTarget;n&&i||(t=this._createBranchLabel(),n=i=t);const s=this._createBranchLabel();36===e.operator?this._bindConditional(e.leftExpression,s,i):this._bindConditional(e.leftExpression,n,s),this._currentFlowNode=this._finishFlowLabel(s),this._bindConditional(e.rightExpression,n,i),t&&(this._currentFlowNode=this._finishFlowLabel(t))}else this._disableTrueFalseTargets((()=>{this.walk(e.leftExpression),this.walk(e.rightExpression)}));return!1}visitListComprehension(e){const t=f.getEnclosingFunction(e);return this._createNewScope(0,this._getNonClassParentScope(),(()=>{var n;y.setScope(e,this._currentScope);const i=this._createBranchLabel();for(let i=0;i<e.forIfNodes.length;i++){const s=e.forIfNodes[i],r=new Map;33===s.nodeType&&(this._bindPossibleTupleNamedTarget(s.targetExpression,r),this._addInferredTypeAssignmentForVariable(s.targetExpression,s),s.asyncToken&&!this._fileInfo.ipythonMode&&(t&&t.isAsync||31===(null===(n=e.parent)||void 0===n?void 0:n.nodeType)&&this._addError(u.Localizer.Diagnostic.asyncNotInAsyncFunction(),s.asyncToken)))}for(let t=0;t<e.forIfNodes.length;t++){const n=e.forIfNodes[t];if(33===n.nodeType)this.walk(n.iterableExpression),this._createAssignmentTargetFlowNodes(n.targetExpression,!0,!1);else{const e=this._createBranchLabel();this._bindConditional(n.testExpression,e,i),this._currentFlowNode=this._finishFlowLabel(e)}}this.walk(e.expression),this._addAntecedent(i,this._currentFlowNode),this._currentFlowNode=this._finishFlowLabel(i)})),!1}visitMatch(e){this.walk(e.subjectExpression);const t=[],n=this._isNarrowingExpression(e.subjectExpression,t);n&&t.forEach((e=>{const t=(0,m.createKeyForReference)(e);this._currentScopeCodeFlowExpressions.add(t)}));const i=this._createBranchLabel();let s=!1;return e.cases.forEach((t=>{const n=this._createBranchLabel(),r=this._createBranchLabel(),a=this._createBranchLabel();this._addAntecedent(r,this._currentFlowNode),t.isIrrefutable?t.guardExpression||(s=!0):this._addAntecedent(n,this._currentFlowNode),this._currentFlowNode=this._finishFlowLabel(r),this.walk(t.pattern),this._createFlowNarrowForPattern(e.subjectExpression,t),t.guardExpression?this._bindConditional(t.guardExpression,a,n):this._addAntecedent(a,this._currentFlowNode),this._currentFlowNode=this._finishFlowLabel(a),this.walk(t.suite),this._addAntecedent(i,this._currentFlowNode),this._currentFlowNode=this._finishFlowLabel(n)})),n&&this._createFlowNarrowForPattern(e.subjectExpression,e),s||this._createFlowExhaustedMatch(e),this._addAntecedent(i,this._currentFlowNode),this._currentFlowNode=this._finishFlowLabel(i),!1}visitPatternAs(e){const t=this._createBranchLabel();if(e.orPatterns.forEach((e=>{this.walk(e),this._addAntecedent(t,this._currentFlowNode)})),this._currentFlowNode=this._finishFlowLabel(t),e.target){this.walk(e.target);const t=this._bindNameToScope(this._currentScope,e.target);if(this._createAssignmentTargetFlowNodes(e.target,!1,!1),t){const n={type:1,node:e.target,isConstant:(0,I.isConstantName)(e.target.value),inferredTypeSource:e,path:this._fileInfo.filePath,range:(0,p.convertTextRangeToRange)(e.target,this._fileInfo.lines),moduleName:this._fileInfo.moduleName,isInExceptSuite:this._isInExceptSuite};t.addDeclaration(n)}}return!1}visitPatternCapture(e){return e.isWildcard||this._addPatternCaptureTarget(e.target),!0}visitPatternMappingExpandEntry(e){return"_"!==e.target.value&&this._addPatternCaptureTarget(e.target),!0}_removeActiveTypeParameters(e){e.parameters.forEach((e=>{const t=this._activeTypeParams.get(e.name.value);if(t){const n=t.getDeclarations();(0,o.assert)(n&&1===n.length&&3===n[0].type),n[0].node===e&&this._activeTypeParams.delete(e.name.value)}}))}_getNonClassParentScope(){let e=this._currentScope;for(;2===e.type;)e=e.parent;return e}_addSlotsToCurrentScope(e){(0,o.assert)(2===this._currentScope.type);let t=!1;for(const n of e){const e=n.strings[0].value;if("__dict__"===e){t=!0;continue}let i=this._currentScope.lookUpSymbol(e);if(!i){i=this._currentScope.addSymbol(e,5);const t="none"!==this._fileInfo.diagnosticRuleSet.reportPrivateUsage;(0,I.isPrivateOrProtectedName)(e)&&t&&i.setIsPrivateMember()}const s={type:1,node:n,isConstant:(0,I.isConstantName)(e),isDefinedBySlots:!0,path:this._fileInfo.filePath,range:(0,p.convertTextRangeToRange)(n,this._fileInfo.lines),moduleName:this._fileInfo.moduleName,isInExceptSuite:this._isInExceptSuite};i.addDeclaration(s)}t||this._currentScope.setSlotsNames(e.map((e=>e.strings[0].value)))}_isInListComprehension(e,t=!1){let n,i,s=e;for(;s;){if(32===s.nodeType){if(t&&s.forIfNodes.length>0){const e=s.forIfNodes[0];if(n===e&&33===e.nodeType&&i===e.iterableExpression)return!1}return!0}i=n,n=s,s=s.parent}return!1}_addPatternCaptureTarget(e){const t=this._bindNameToScope(this._currentScope,e);if(this._createAssignmentTargetFlowNodes(e,!1,!1),t){const n={type:1,node:e,isConstant:(0,I.isConstantName)(e.value),inferredTypeSource:e.parent,path:this._fileInfo.filePath,range:(0,p.convertTextRangeToRange)(e,this._fileInfo.lines),moduleName:this._fileInfo.moduleName,isInExceptSuite:this._isInExceptSuite};t.addDeclaration(n)}}_useExceptTargets(e,t){const n=this._currentExceptTargets;this._currentExceptTargets=e,t(),this._currentExceptTargets=n}_getDunderAllNamesFromImport(e){var t,n;const i=this._currentScope.lookUpSymbol(e);if(!i)return;const s=i.getDeclarations().find((e=>8===e.type)),r=(null==s?void 0:s.path)&&s.loadSymbolsFromPath?s.path:(null===(t=null==s?void 0:s.submoduleFallback)||void 0===t?void 0:t.path)&&s.submoduleFallback.loadSymbolsFromPath?s.submoduleFallback.path:void 0;if(!r)return;let a=this._fileInfo.importLookup(r);return(null==a?void 0:a.dunderAllNames)?a.dunderAllNames:(null===(n=null==s?void 0:s.submoduleFallback)||void 0===n?void 0:n.path)?(a=this._fileInfo.importLookup(s.submoduleFallback.path),null==a?void 0:a.dunderAllNames):void 0}_addImplicitFromImport(e,t){const n=e.module.nameParts[0].value,i=this._bindNameValueToScope(this._currentScope,n);i&&this._createAliasDeclarationForMultipartImportName(e,void 0,t,i),this._createFlowAssignment(e.module.nameParts[0])}_createAliasDeclarationForMultipartImportName(e,t,n,i){var s;const r=e.module.nameParts[0].value,a=i.getDeclarations().find((e=>8===e.type&&e.firstNamePart===r));let o,l;l=n&&n.isImportFound&&!n.isNativeLib&&n.resolvedPaths.length>0?n.resolvedPaths[n.resolvedPaths.length-1]:h.UnresolvedModuleMarker;const c=n&&n.isImportFound&&!n.isNativeLib&&n.resolvedPaths.length>0;o=a||(c?{type:8,node:e,path:l,loadSymbolsFromPath:!1,range:(0,d.getEmptyRange)(),usesLocalName:!!t,moduleName:r,firstNamePart:r,isInExceptSuite:this._isInExceptSuite}:{type:8,node:e,path:l,loadSymbolsFromPath:!0,range:(0,d.getEmptyRange)(),usesLocalName:!!t,moduleName:null!==(s=null==n?void 0:n.importName)&&void 0!==s?s:"",firstNamePart:r,isUnresolved:!0,isInExceptSuite:this._isInExceptSuite});const p=y.getImportInfo(e.module.nameParts[0]);if(p&&p.resolvedPaths.length&&(o.path=p.resolvedPaths[0],o.loadSymbolsFromPath=!0,this._addImplicitImportsToLoaderActions(p,o)),t||1===e.module.nameParts.length)o.path=l,o.loadSymbolsFromPath=!0,o.isUnresolved=!1,n&&this._addImplicitImportsToLoaderActions(n,o);else{let t=o;for(let i=1;i<e.module.nameParts.length;i++){const s=e.module.nameParts[i].value;let r=t.implicitImports?t.implicitImports.get(s):void 0;if(!r){r={path:n&&i<n.resolvedPaths.length?n.resolvedPaths[i]:h.UnresolvedModuleMarker,loadSymbolsFromPath:!1,implicitImports:new Map,isUnresolved:!c},t.implicitImports||(t.implicitImports=new Map),t.implicitImports.set(s,r)}if(i===e.module.nameParts.length-1)n&&i<n.resolvedPaths.length&&(r.path=n.resolvedPaths[i],r.loadSymbolsFromPath=!0,this._addImplicitImportsToLoaderActions(n,r));else{const t=y.getImportInfo(e.module.nameParts[i]);t&&t.resolvedPaths.length&&(r.path=t.resolvedPaths[i],r.loadSymbolsFromPath=!0,this._addImplicitImportsToLoaderActions(t,r))}t=r}}a||i.addDeclaration(o)}_getWildcardImportNames(e){const t=[];if(e.dunderAllNames){if(!e.usesUnsupportedDunderAllForm)return e.dunderAllNames;(0,a.appendArray)(t,e.dunderAllNames)}return e.symbolTable.forEach(((e,n)=>{e.isExternallyHidden()||(0,I.isPrivateOrProtectedName)(n)||t.push(n)})),t}_walkStatementsAndReportUnreachable(e){let t=!1;for(const n of e)if(y.setFlowNode(n,this._currentFlowNode),t||(t=this._isCodeUnreachable()),t){if(this._targetFunctionDeclaration&&!this._targetFunctionDeclaration.isGenerator){(new S).checkContainsYield(n)&&(this._targetFunctionDeclaration.isGenerator=!0)}if(!this._moduleSymbolOnly){new F(this._currentScope).walk(n)}}else this.walk(n);return!1}_createStartFlowNode(){return{flags:m.FlowFlags.Start,id:this._getUniqueFlowNodeId()}}_createBranchLabel(e){return{flags:m.FlowFlags.BranchLabel,id:this._getUniqueFlowNodeId(),antecedents:[],preBranchAntecedent:e,affectedExpressions:void 0}}_createFlowNarrowForPattern(e,t){const n={flags:m.FlowFlags.NarrowForPattern,id:this._getUniqueFlowNodeId(),subjectExpression:e,statement:t,antecedent:this._currentFlowNode};this._currentFlowNode=n}_createContextManagerLabel(e,t,n){return{flags:m.FlowFlags.PostContextManager|m.FlowFlags.BranchLabel,id:this._getUniqueFlowNodeId(),antecedents:[],expressions:e,affectedExpressions:void 0,isAsync:t,blockIfSwallowsExceptions:n}}_createLoopLabel(){return{flags:m.FlowFlags.LoopLabel,id:this._getUniqueFlowNodeId(),antecedents:[],affectedExpressions:void 0}}_finishFlowLabel(e){return 0===e.antecedents.length?C._unreachableFlowNode:1===e.antecedents.length&&e.flags===m.FlowFlags.BranchLabel?e.antecedents[0]:(this._codeFlowComplexity+=e.antecedents.length-1,e)}_bindNeverCondition(e,t,n){const i=[];if(55===e.nodeType&&38===e.operator)this._bindNeverCondition(e.expression,t,!n);else if(7!==e.nodeType||36!==e.operator&&37!==e.operator){if(this._isNarrowingExpression(e,i,!0)){i.filter((e=>38===e.nodeType)).length>0&&(this._currentFlowNode=this._createFlowConditional(n?m.FlowFlags.TrueNeverCondition:m.FlowFlags.FalseNeverCondition,this._currentFlowNode,e))}this._addAntecedent(t,this._currentFlowNode)}else{let i=36===e.operator;if(n&&(i=!i),i){const i=this._currentFlowNode;this._bindNeverCondition(e.leftExpression,t,n),this._currentFlowNode=i,this._bindNeverCondition(e.rightExpression,t,n)}else{const i=this._currentFlowNode,s=this._createBranchLabel();if(this._bindNeverCondition(e.leftExpression,s,n),i!==this._currentFlowNode){this._currentFlowNode=this._finishFlowLabel(s);const r=this._currentFlowNode;this._bindNeverCondition(e.rightExpression,t,n),r===this._currentFlowNode&&(this._currentFlowNode=i)}}}}_bindConditional(e,t,n){this._setTrueFalseTargets(t,n,(()=>{this.walk(e)})),this._isLogicalExpression(e)||(this._addAntecedent(t,this._createFlowConditional(m.FlowFlags.TrueCondition,this._currentFlowNode,e)),this._addAntecedent(n,this._createFlowConditional(m.FlowFlags.FalseCondition,this._currentFlowNode,e)))}_disableTrueFalseTargets(e){this._setTrueFalseTargets(void 0,void 0,e)}_setTrueFalseTargets(e,t,n){const i=this._currentTrueTarget,s=this._currentFalseTarget;this._currentTrueTarget=e,this._currentFalseTarget=t,n(),this._currentTrueTarget=i,this._currentFalseTarget=s}_createFlowConditional(e,t,n){if(t.flags&m.FlowFlags.Unreachable)return t;const i=_.evaluateStaticBoolLikeExpression(n,this._fileInfo.executionEnvironment,this._fileInfo.definedConstants,this._typingImportAliases,this._sysImportAliases);if(!0===i&&e&m.FlowFlags.FalseCondition||!1===i&&e&m.FlowFlags.TrueCondition)return C._unreachableFlowNode;const s=[];if(!this._isNarrowingExpression(n,s,0!=(e&(m.FlowFlags.TrueNeverCondition|m.FlowFlags.FalseNeverCondition))))return t;s.forEach((e=>{const t=(0,m.createKeyForReference)(e);this._currentScopeCodeFlowExpressions.add(t)}));const r=s.filter((e=>38===e.nodeType)),a={flags:e,id:this._getUniqueFlowNodeId(),reference:r.length>0?r[0]:void 0,expression:n,antecedent:t};return this._addExceptTargets(a),a}_isLogicalExpression(e){switch(e.nodeType){case 55:return 38===e.operator;case 7:return 36===e.operator||37===e.operator}return!1}_isNarrowingExpression(e,t,n=!1,i=!1){switch(e.nodeType){case 38:case 35:case 24:if(n){if(38!==e.nodeType)return!1;if(!i)return!1}return!!(0,m.isCodeFlowSupportedForReference)(e)&&(t.push(e),n||(35===e.nodeType&&(0,m.isCodeFlowSupportedForReference)(e.leftExpression)&&t.push(e.leftExpression),24!==e.nodeType||1!==e.items.length||e.trailingComma||0!==e.items[0].argumentCategory||(0,m.isCodeFlowSupportedForReference)(e.baseExpression)&&t.push(e.baseExpression)),!0);case 4:return t.push(e.name),this._isNarrowingExpression(e.rightExpression,t,n,!0),!0;case 7:{const i=39===e.operator||40===e.operator,s=12===e.operator||28===e.operator;if(i||s){if(11===e.rightExpression.nodeType&&26===e.rightExpression.constType)return this._isNarrowingExpression(e.leftExpression,t,n,!0);if(i&&9===e.leftExpression.nodeType&&38===e.leftExpression.leftExpression.nodeType&&"type"===e.leftExpression.leftExpression.value&&1===e.leftExpression.arguments.length&&0===e.leftExpression.arguments[0].argumentCategory)return this._isNarrowingExpression(e.leftExpression.arguments[0].valueExpression,t,n,!0);return this._isNarrowingExpression(e.leftExpression,t,n,!0)}return!(41!==e.operator&&42!==e.operator||48!==e.leftExpression.nodeType||!this._isNarrowingExpression(e.rightExpression,t,n,!0))||(41===e.operator||42===e.operator)&&this._isNarrowingExpression(e.leftExpression,t,n,!0)}case 55:return 38===e.operator&&this._isNarrowingExpression(e.expression,t,n,!1);case 5:return this._isNarrowingExpression(e.rightExpression,t,n,!0);case 9:if(38===e.leftExpression.nodeType&&("isinstance"===e.leftExpression.value||"issubclass"===e.leftExpression.value)&&2===e.arguments.length)return this._isNarrowingExpression(e.arguments[0].valueExpression,t,n,!0);if(38===e.leftExpression.nodeType&&"callable"===e.leftExpression.value&&1===e.arguments.length)return this._isNarrowingExpression(e.arguments[0].valueExpression,t,n,!0);if(e.arguments.length>=1)return!n&&this._isNarrowingExpression(e.arguments[0].valueExpression,t,n,!0)}return!1}_createAssignmentTargetFlowNodes(e,t,n){switch(e.nodeType){case 38:case 35:case 24:this._createFlowAssignment(e,n),t&&this.walk(e);break;case 52:e.expressions.forEach((e=>{this._createAssignmentTargetFlowNodes(e,t,n)}));break;case 54:this._createAssignmentTargetFlowNodes(e.valueExpression,!1,n),t&&this.walk(e);break;case 56:this._createAssignmentTargetFlowNodes(e.expression,!1,n),t&&this.walk(e);break;case 31:e.entries.forEach((e=>{this._createAssignmentTargetFlowNodes(e,t,n)}));break;default:t&&this.walk(e)}}_createCallFlowNode(e){if(!this._isCodeUnreachable()){const t={flags:m.FlowFlags.Call,id:this._getUniqueFlowNodeId(),node:e,antecedent:this._currentFlowNode};this._currentFlowNode=t}this._isCodeUnreachable()||this._addExceptTargets(this._currentFlowNode)}_createVariableAnnotationFlowNode(){if(!this._isCodeUnreachable()){const e={flags:m.FlowFlags.VariableAnnotation,id:this._getUniqueFlowNodeId(),antecedent:this._currentFlowNode};this._currentFlowNode=e}}_createFlowAssignment(e,t=!1){let n=b.indeterminateSymbolId;if(38===e.nodeType){const t=this._currentScope.lookUpSymbolRecursive(e.value);(0,o.assert)(void 0!==t),n=t.symbol.id}const i=this._currentFlowNode;if(!this._isCodeUnreachable()&&(0,m.isCodeFlowSupportedForReference)(e)){const i={flags:m.FlowFlags.Assignment,id:this._getUniqueFlowNodeId(),node:e,antecedent:this._currentFlowNode,targetSymbolId:n},s=(0,m.createKeyForReference)(e);this._currentScopeCodeFlowExpressions.add(s),t&&(i.flags|=m.FlowFlags.Unbind),35===e.nodeType&&this._addExceptTargets(i),this._currentFlowNode=i}t&&void 0!==y.getFlowNode(e)||y.setFlowNode(e,t?i:this._currentFlowNode)}_createFlowWildcardImport(e,t){if(!this._isCodeUnreachable()){const n={flags:m.FlowFlags.WildcardImport,id:this._getUniqueFlowNodeId(),node:e,names:t,antecedent:this._currentFlowNode};this._addExceptTargets(n),this._currentFlowNode=n}y.setFlowNode(e,this._currentFlowNode)}_createFlowExhaustedMatch(e){if(!this._isCodeUnreachable()){const t={flags:m.FlowFlags.ExhaustedMatch,id:this._getUniqueFlowNodeId(),node:e,antecedent:this._currentFlowNode};this._currentFlowNode=t}y.setAfterFlowNode(e,this._currentFlowNode)}_isCodeUnreachable(){return!!(this._currentFlowNode.flags&m.FlowFlags.Unreachable)}_addExceptTargets(e){this._currentExceptTargets&&this._currentExceptTargets.forEach((t=>{this._addAntecedent(t,e)}))}_trackCodeFlowExpressions(e){const t=this._currentScopeCodeFlowExpressions;this._currentScopeCodeFlowExpressions=new Set,e();const n=this._currentScopeCodeFlowExpressions;return t&&this._currentScopeCodeFlowExpressions.forEach((e=>{t.add(e)})),this._currentScopeCodeFlowExpressions=t,n}_bindLoopStatement(e,t,n){const i=this._currentContinueTarget,s=this._currentBreakTarget;this._currentContinueTarget=e,this._currentBreakTarget=t,e.affectedExpressions=this._trackCodeFlowExpressions(n),this._currentContinueTarget=i,this._currentBreakTarget=s}_addAntecedent(e,t){this._currentFlowNode.flags&m.FlowFlags.Unreachable||e.antecedents.some((e=>e.id===t.id))||e.antecedents.push(t)}_bindNameToScope(e,t,n){return this._bindNameValueToScope(e,t.value,n)}_bindNameValueToScope(e,t,n){const i=this._currentScope.getBindingType(t);if(void 0===i){let i=e.lookUpSymbol(t);return i||(i=e.addSymbol(t,5),3!==this._currentScope.type&&4!==this._currentScope.type||(0,I.isPrivateOrProtectedName)(t)&&((0,I.isPrivateName)(t)?i.setIsExternallyHidden():this._fileInfo.isStubFile||this._fileInfo.isInPyTypedPackage?4===this._currentScope.type?i.setIsExternallyHidden():this._potentialPrivateSymbols.set(t,i):i.setIsPrivateMember()),n&&n.set(t,i)),i}{const e=(0===i?this._currentScope.parent:this._currentScope.getGlobalScope().scope).lookUpSymbolRecursive(t);if(e)return e.symbol}}_bindPossibleTupleNamedTarget(e,t){switch(e.nodeType){case 38:this._bindNameToScope(this._currentScope,e,t);break;case 52:e.expressions.forEach((e=>{this._bindPossibleTupleNamedTarget(e,t)}));break;case 31:e.entries.forEach((e=>{this._bindPossibleTupleNamedTarget(e,t)}));break;case 54:this._bindPossibleTupleNamedTarget(e.valueExpression,t);break;case 56:this._bindPossibleTupleNamedTarget(e.expression,t)}}_addImplicitSymbolToCurrentScope(e,t,n){const i=this._addSymbolToCurrentScope(e,!1);i&&(i.addDeclaration({type:0,node:t,intrinsicType:n,path:this._fileInfo.filePath,range:(0,d.getEmptyRange)(),moduleName:this._fileInfo.moduleName,isInExceptSuite:this._isInExceptSuite}),i.setIsIgnoredForProtocolMatch())}_addSymbolToCurrentScope(e,t){let n=this._currentScope.lookUpSymbol(e);if(!n){let i=0;t&&(i|=1),2===this._currentScope.type&&(i|=4),this._fileInfo.isStubFile&&(0,I.isPrivateOrProtectedName)(e)&&(i|=2),n=this._currentScope.addSymbol(e,i)}return n}_createNewScope(e,t,n){const i=this._currentScope,s=new v.Scope(e,t);this._currentScope=s;const r=4===e||3===e||1===e,a=this._currentScopeCodeFlowExpressions;return r&&(this._currentScopeCodeFlowExpressions=new Set),n(),this._currentScopeCodeFlowExpressions=a,this._currentScope=i,s}_addInferredTypeAssignmentForVariable(e,t,n=!1){switch(e.nodeType){case 38:{const i=e,s=this._currentScope.lookUpSymbolRecursive(i.value);if(s&&s.symbol){const r={type:1,node:e,isConstant:(0,I.isConstantName)(e.value),inferredTypeSource:t,isInferenceAllowedInPyTyped:this._isInferenceAllowedInPyTyped(i.value),typeAliasName:n?e:void 0,path:this._fileInfo.filePath,range:(0,p.convertTextRangeToRange)(i,this._fileInfo.lines),moduleName:this._fileInfo.moduleName,isInExceptSuite:this._isInExceptSuite,docString:this._getVariableDocString(e)};s.symbol.addDeclaration(r)}break}case 35:{const n=this._getMemberAccessInfo(e);if(n){const i=e.memberName;let s=n.classScope.lookUpSymbol(i.value);if(!s){s=n.classScope.addSymbol(i.value,1);const e="none"!==this._fileInfo.diagnosticRuleSet.reportPrivateUsage;(0,I.isPrivateOrProtectedName)(i.value)&&e&&s.setIsPrivateMember()}n.isInstanceMember?s.isClassMember()&&s.getDeclarations().some((e=>5===e.type&&e.isMethod))||s.setIsInstanceMember():s.setIsClassMember();const r={type:1,node:e.memberName,isConstant:(0,I.isConstantName)(i.value),inferredTypeSource:t,isDefinedByMemberAccess:!0,path:this._fileInfo.filePath,range:(0,p.convertTextRangeToRange)(e.memberName,this._fileInfo.lines),moduleName:this._fileInfo.moduleName,isInExceptSuite:this._isInExceptSuite,docString:this._getVariableDocString(e)};s.addDeclaration(r)}break}case 52:e.expressions.forEach((e=>{this._addInferredTypeAssignmentForVariable(e,t)}));break;case 54:this._addInferredTypeAssignmentForVariable(e.valueExpression,t);break;case 56:this._addInferredTypeAssignmentForVariable(e.expression,t);break;case 31:e.entries.forEach((e=>{this._addInferredTypeAssignmentForVariable(e,t)}))}}_isInferenceAllowedInPyTyped(e){return["__match_args__","__slots__","__all__"].some((t=>t===e))}_addTypeDeclarationForVariable(e,t){var n,i,s;let r=!1;switch(e.nodeType){case 38:{const a=e,o=this._currentScope.lookUpSymbolRecursive(a.value);if(o&&o.symbol){const r=this._isAnnotationFinal(t);let l=t;r.isFinal&&(r.finalTypeNode||(l=void 0));let c=this._isAnnotationClassVar(t);if(c.isClassVar&&(c.classVarTypeNode||(l=void 0)),r.isFinal){const t=f.getEnclosingClassOrFunction(e);t&&10===t.nodeType&&(3!==(null===(n=e.parent)||void 0===n?void 0:n.nodeType)&&3!==(null===(s=null===(i=e.parent)||void 0===i?void 0:i.parent)||void 0===s?void 0:s.nodeType)||(c={isClassVar:!0,classVarTypeNode:void 0}))}const d={type:1,node:e,isConstant:(0,I.isConstantName)(a.value),isFinal:r.isFinal,typeAliasName:e,path:this._fileInfo.filePath,typeAnnotationNode:l,range:(0,p.convertTextRangeToRange)(a,this._fileInfo.lines),moduleName:this._fileInfo.moduleName,isInExceptSuite:this._isInExceptSuite,docString:this._getVariableDocString(e)};if(o.symbol.addDeclaration(d),c.isClassVar?o.symbol.setIsClassVar():o.symbol.setIsInstanceMember(),24===t.nodeType)if(this._isDataclassesAnnotation(t.baseExpression,"InitVar"))o.symbol.setIsInitVar();else if(this._isTypingAnnotation(t.baseExpression,"Annotated")&&t.items.length>0){const e=t.items[0].valueExpression;24===e.nodeType&&this._isDataclassesAnnotation(e.baseExpression,"InitVar")&&o.symbol.setIsInitVar()}}r=!0;break}case 35:{const n=this._getMemberAccessInfo(e);if(n){const i=e.memberName;let s=n.classScope.lookUpSymbol(i.value);if(!s){s=n.classScope.addSymbol(i.value,1);const e="none"!==this._fileInfo.diagnosticRuleSet.reportPrivateUsage;(0,I.isPrivateOrProtectedName)(i.value)&&e&&s.setIsPrivateMember()}n.isInstanceMember?s.setIsInstanceMember():s.setIsClassMember();const a=this._isAnnotationFinal(t),o={type:1,node:e.memberName,isConstant:(0,I.isConstantName)(i.value),isDefinedByMemberAccess:!0,isFinal:a.isFinal,path:this._fileInfo.filePath,typeAnnotationNode:a.isFinal&&!a.finalTypeNode?void 0:t,range:(0,p.convertTextRangeToRange)(e.memberName,this._fileInfo.lines),moduleName:this._fileInfo.moduleName,isInExceptSuite:this._isInExceptSuite,docString:this._getVariableDocString(e)};s.addDeclaration(o),r=!0}break}}r||this._addDiagnostic(this._fileInfo.diagnosticRuleSet.reportGeneralTypeIssues,l.DiagnosticRule.reportGeneralTypeIssues,u.Localizer.Diagnostic.annotationNotSupported(),t)}_isTypingAnnotation(e,t){return this._isKnownAnnotation(e,t,this._typingImportAliases,this._typingSymbolAliases)}_isDataclassesAnnotation(e,t){return this._isKnownAnnotation(e,t,this._dataclassesImportAliases,this._dataclassesSymbolAliases)}_isKnownAnnotation(e,t,n,i){let s=e;if(48===s.nodeType&&s.typeAnnotation&&(s=s.typeAnnotation),38===s.nodeType){if(i.get(s.value)===t)return!0}else if(35===s.nodeType&&38===s.leftExpression.nodeType&&s.memberName.value===t){const e=s.leftExpression.value;return n.some((t=>t===e))}return!1}_getVariableDocString(e){const t=f.getVariableDocStringNode(e);if(!t)return;const n=t.strings;return 1===n.length?n[0].value:n.map((e=>e.value)).join("")}_isAnnotationFinal(e){let t,n=!1;if(e)if(this._isTypingAnnotation(e,"Final"))n=!0;else if(24===e.nodeType&&1===e.items.length){!this._isAnnotationFinal(e.baseExpression).isFinal||0!==e.items[0].argumentCategory||e.items[0].name||e.trailingComma||(n=!0,t=e.items[0].valueExpression)}return{isFinal:n,finalTypeNode:t}}_isAnnotationClassVar(e){let t,n=!1;for(;e;){if(48===e.nodeType&&e.typeAnnotation&&(e=e.typeAnnotation),!(24===e.nodeType&&e.items.length>0&&this._isTypingAnnotation(e.baseExpression,"Annotated"))){if(this._isTypingAnnotation(e,"ClassVar")){n=!0;break}if(24===e.nodeType&&1===e.items.length){!this._isAnnotationClassVar(e.baseExpression).isClassVar||0!==e.items[0].argumentCategory||e.items[0].name||e.trailingComma||(n=!0,t=e.items[0].valueExpression);break}break}e=e.items[0].valueExpression}return{isClassVar:n,classVarTypeNode:t}}_isRequiredAnnotation(e){return!(!e||24!==e.nodeType||1!==e.items.length||!this._isTypingAnnotation(e.baseExpression,"Required"))}_isNotRequiredAnnotation(e){return!(!e||24!==e.nodeType||1!==e.items.length||!this._isTypingAnnotation(e.baseExpression,"NotRequired"))}_getMemberAccessInfo(e){if(38!==e.leftExpression.nodeType)return;const t=e.leftExpression.value,n=f.getEnclosingFunction(e);if(!n)return;const i=f.getEnclosingClass(n,!0);if(!i)return;let s=!1;if(n.parameters.length<1||!n.parameters[0].name)return;const r=i.name.value,a=n.parameters[0].name.value;if(t===r)s=!1;else{if(t!==a)return;if("__new__"===n.name.value)s=!1;else{s=!0;for(const e of n.decorators)if(38===e.expression.nodeType){const t=e.expression.value;if("staticmethod"===t)return;if("classmethod"===t){s=!1;break}}}}const l=y.getScope(i);return(0,o.assert)(void 0!==l),{classNode:i,methodNode:n,classScope:l,isInstanceMember:s}}_addImplicitImportsToLoaderActions(e,t){e.filteredImplicitImports.forEach((e=>{const n=t.implicitImports?t.implicitImports.get(e.name):void 0;n?(n.path=e.path,n.loadSymbolsFromPath=!0):(t.implicitImports||(t.implicitImports=new Map),t.implicitImports.set(e.name,{path:e.path,loadSymbolsFromPath:!0,implicitImports:new Map}))}))}_handleTypingStubAssignmentOrAnnotation(e){if(!this._fileInfo.isTypingStubFile)return!1;let t;if(54===e.nodeType)t=e;else{if(54!==e.leftExpression.nodeType)return!1;t=e.leftExpression}if(38!==t.valueExpression.nodeType)return!1;const n=t.valueExpression,i=new Set(["Tuple","Generic","Protocol","Callable","Type","ClassVar","Final","Literal","TypedDict","Union","Optional","Annotated","TypeAlias","OrderedDict","Concatenate","TypeGuard","StrictTypeGuard","Unpack","Self","NoReturn","Never","LiteralString"]),s=n.value;if(!i.has(s))return!1;const r=this._bindNameToScope(this._currentScope,t.valueExpression);return r&&r.addDeclaration({type:7,node:t,path:this._fileInfo.filePath,range:(0,p.convertTextRangeToRange)(t,this._fileInfo.lines),moduleName:this._fileInfo.moduleName,isInExceptSuite:this._isInExceptSuite}),!0}_deferBinding(e){this._moduleSymbolOnly||this._deferredBindingTasks.push({scope:this._currentScope,codeFlowExpressions:this._currentScopeCodeFlowExpressions,activeTypeParams:new Map(this._activeTypeParams),callback:e})}_bindDeferred(){for(;this._deferredBindingTasks.length>0;){const e=this._deferredBindingTasks.shift();this._currentScope=e.scope,this._currentScopeCodeFlowExpressions=e.codeFlowExpressions,this._activeTypeParams=e.activeTypeParams,e.callback()}}_bindYield(e){const t=f.getEnclosingFunction(e);t?t.isAsync&&61===e.nodeType&&this._addError(u.Localizer.Diagnostic.yieldFromOutsideAsync(),e):f.getEnclosingLambda(e)||this._addError(u.Localizer.Diagnostic.yieldOutsideFunction(),e),this._targetFunctionDeclaration&&(this._targetFunctionDeclaration.yieldStatements||(this._targetFunctionDeclaration.yieldStatements=[]),this._targetFunctionDeclaration.yieldStatements.push(e),this._targetFunctionDeclaration.isGenerator=!0),e.expression&&this.walk(e.expression),y.setFlowNode(e,this._currentFlowNode)}_getUniqueFlowNodeId(){return this._codeFlowComplexity+=.05,(0,m.getUniqueFlowNodeId)()}_addDiagnostic(e,t,n,i){let s;switch(e){case"error":s=this._addError(n,i);break;case"warning":s=this._addWarning(n,i);break;case"information":s=this._addInformation(n,i);break;case"none":break;default:return(0,o.assertNever)(e,`${e} is not expected`)}return s&&s.setRule(t),s}_addError(e,t){return this._fileInfo.diagnosticSink.addDiagnosticWithTextRange("error",e,t)}_addWarning(e,t){return this._fileInfo.diagnosticSink.addDiagnosticWithTextRange("warning",e,t)}_addInformation(e,t){return this._fileInfo.diagnosticSink.addDiagnosticWithTextRange("information",e,t)}}t.Binder=C,C._unreachableFlowNode={flags:m.FlowFlags.Unreachable,id:(0,m.getUniqueFlowNodeId)()};class S extends T.ParseTreeWalker{constructor(){super(...arguments),this._containsYield=!1}checkContainsYield(e){return this.walk(e),this._containsYield}visitYield(e){return this._containsYield=!0,!1}visitYieldFrom(e){return this._containsYield=!0,!1}}t.YieldFinder=S;class x extends T.ParseTreeWalker{constructor(){super(...arguments),this._containsReturn=!1}checkContainsReturn(e){return this.walk(e),this._containsReturn}visitReturn(e){return this._containsReturn=!0,!1}}t.ReturnFinder=x;class F extends T.ParseTreeWalker{constructor(e){super(),this._currentScope=e}visitClass(e){const t=this._createNewScope(2,(()=>{this.walk(e.suite)}));return y.getScope(e)||y.setScope(e,t),!1}visitFunction(e){const t=this._createNewScope(1,(()=>{this.walk(e.suite)}));return y.getScope(e)||y.setScope(e,t),!1}_createNewScope(e,t){const n=this._currentScope,i=new v.Scope(e,this._currentScope);return this._currentScope=i,t(),this._currentScope=n,i}}t.DummyScopeGenerator=F},5084:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.CacheManager=void 0;const i=n(30795),s=n(52957);t.CacheManager=class{constructor(){this._pausedCount=0,this._cacheOwners=[]}registerCacheOwner(e){this._cacheOwners.push(e)}unregisterCacheOwner(e){const t=this._cacheOwners.findIndex((t=>t===e));t<0?(0,i.fail)("Specified cache provider not found"):this._cacheOwners.splice(t,1)}pauseTracking(){const e=this;return e._pausedCount++,{dispose(){e._pausedCount--}}}getCacheUsage(){if(this._pausedCount>0)return-1;let e=0;return this._cacheOwners.forEach((t=>{e+=t.getCacheUsage()})),e}emptyCache(e){if(e){const t=(0,s.getHeapStatistics)();e.info(`Emptying type cache to avoid heap overflow. Used ${this._convertToMB(t.used_heap_size)} out of ${this._convertToMB(t.heap_size_limit)}.`)}this._cacheOwners.forEach((e=>{e.emptyCache()}))}getUsedHeapRatio(e){const t=(0,s.getHeapStatistics)();return e&&e.info(`Heap stats: total_heap_size=${this._convertToMB(t.total_heap_size)}, used_heap_size=${this._convertToMB(t.used_heap_size)}, total_physical_size=${this._convertToMB(t.total_physical_size)}, total_available_size=${this._convertToMB(t.total_available_size)}, heap_size_limit=${this._convertToMB(t.heap_size_limit)}`),t.used_heap_size/t.heap_size_limit}_convertToMB(e){return`${Math.round(e/1048576)}MB`}}},46892:function(e,t,n){var i=this&&this.__createBinding||(Object.create?function(e,t,n,i){void 0===i&&(i=n),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,i){void 0===i&&(i=n),e[i]=t[n]}),s=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&i(t,e,n);return s(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.Checker=void 0;const a=n(29335),o=n(30795),l=n(83501),c=n(28513),p=n(81844),d=n(86513),u=n(6698),y=n(55843),m=n(99661),h=n(29597),g=n(1240),f=r(n(21)),T=n(44660),v=n(24161),_=n(87710),b=n(32966),I=r(n(66455)),C=n(59438),S=n(78140),x=n(59083),F=n(60177),D=n(17741),P=n(9584),E=n(93890),A=r(n(48466)),k=n(60721),w=n(11528),N=n(36906),R=n(51458),O=n(33029),M=n(43024);new Map([["Tuple",{version:d.PythonVersion.V3_9,fullName:"builtins.tuple",replacementText:"tuple"}],["List",{version:d.PythonVersion.V3_9,fullName:"builtins.list",replacementText:"list"}],["Dict",{version:d.PythonVersion.V3_9,fullName:"builtins.dict",replacementText:"dict"}],["Set",{version:d.PythonVersion.V3_9,fullName:"builtins.set",replacementText:"set"}],["FrozenSet",{version:d.PythonVersion.V3_9,fullName:"builtins.frozenset",replacementText:"frozenset"}],["Type",{version:d.PythonVersion.V3_9,fullName:"builtins.type",replacementText:"type"}],["Deque",{version:d.PythonVersion.V3_9,fullName:"collections.deque",replacementText:"collections.deque"}],["DefaultDict",{version:d.PythonVersion.V3_9,fullName:"collections.defaultdict",replacementText:"collections.defaultdict"}],["OrderedDict",{version:d.PythonVersion.V3_9,fullName:"collections.OrderedDict",replacementText:"collections.OrderedDict"}],["Counter",{version:d.PythonVersion.V3_9,fullName:"collections.Counter",replacementText:"collections.Counter"}],["ChainMap",{version:d.PythonVersion.V3_9,fullName:"collections.ChainMap",replacementText:"collections.ChainMap"}]]),new Map([["Optional",{version:d.PythonVersion.V3_10,fullName:"typing.Optional",replacementText:"| None"}],["Union",{version:d.PythonVersion.V3_10,fullName:"typing.Union",replacementText:"|"}]]);class L extends C.ParseTreeWalker{constructor(e,t,n,i,s){super(),this._importResolver=e,this._evaluator=t,this._parseResults=n,this._sourceMapper=i,this._dependentFiles=s,this._isUnboundCheckSuppressed=!1,this._scopedNodes=[],this._typeParameterLists=[],this._moduleNode=n.parseTree,this._fileInfo=f.getFileInfo(this._moduleNode)}check(){this._scopedNodes.push(this._moduleNode),this._conditionallyReportShadowedModule();const e=f.getCodeFlowComplexity(this._moduleNode);e>w.maxCodeComplexity&&this._evaluator.addDiagnosticForTextRange(this._fileInfo,this._fileInfo.diagnosticRuleSet.reportGeneralTypeIssues,c.DiagnosticRule.reportGeneralTypeIssues,m.Localizer.Diagnostic.codeTooComplexToAnalyze(),{start:0,length:0}),this._walkStatementsAndReportUnreachable(this._moduleNode.statements);const t=f.getDunderAllInfo(this._moduleNode);t&&(this._evaluator.markNamesAccessed(this._moduleNode,t.names),this._reportUnusedDunderAllSymbols(t.stringNodes)),this._validateSymbolTables(),this._reportDuplicateImports(),this._checkRegions()}walk(e){f.isCodeUnreachable(e)?this._evaluator.suppressDiagnostics(e,(()=>{super.walk(e)})):super.walk(e)}visitSuite(e){return this._walkStatementsAndReportUnreachable(e.statements),!1}visitStatementList(e){return e.statements.forEach((e=>{(0,h.isExpressionNode)(e)&&(this._evaluator.getType(e),this._reportUnusedExpression(e))})),!0}visitClass(e){const t=this._evaluator.getTypeOfClass(e);return e.typeParameters&&this.walk(e.typeParameters),this.walk(e.suite),this.walkMultiple(e.decorators),this.walkMultiple(e.arguments),t&&(R.ClassType.isProtocolClass(t.classType)&&(e.arguments.forEach((e=>{if(!e.name){const n=this._evaluator.getType(e.valueExpression);n&&(0,R.isInstantiableClass)(n)&&!R.ClassType.isBuiltIn(n,"Protocol")&&!R.ClassType.isBuiltIn(n,"Generic")&&(R.ClassType.isProtocolClass(n)||this._evaluator.addError(m.Localizer.Diagnostic.protocolBaseClass().format({classType:this._evaluator.printType(t.classType),baseType:this._evaluator.printType(n)}),e.valueExpression))}})),this._validateProtocolTypeParamVariance(e,t.classType)),this._fileInfo.isStubFile||(this._validateBaseClassOverrides(t.classType),this._validateSlotsClassVarConflict(t.classType)),this._validateMultipleInheritanceCompatibility(t.classType,e.name),this._validateConstructorConsistency(t.classType),this._validateFinalMemberOverrides(t.classType),this._validateInstanceVariableInitialization(t.classType),this._validateFinalClassNotAbstract(t.classType,e),this._validateDataClassPostInit(t.classType,e),this._validateProtocolCompatibility(t.classType,e),this._reportDuplicateEnumMembers(t.classType),R.ClassType.isTypedDictClass(t.classType)&&this._validateTypedDictClassSuite(e.suite),R.ClassType.isEnumClass(t.classType)&&this._validateEnumClassOverride(e,t.classType)),this._scopedNodes.push(e),!1}visitFunction(e){var t;e.typeParameters&&this.walk(e.typeParameters),this._fileInfo.diagnosticRuleSet.analyzeUnannotatedFunctions||this._fileInfo.isStubFile||I.isUnannotatedFunction(e)&&this._evaluator.addInformation(m.Localizer.Diagnostic.unannotatedFunctionSkipped().format({name:e.name.value}),e.name);const n=this._evaluator.getTypeOfFunction(e),i=I.getEnclosingClass(e,!0);if(n){let s=!1;e.parameters.forEach(((e,t)=>{if(e.name)if(1===e.category){const t=e.typeAnnotation||e.typeAnnotationComment;if(t&&35===t.nodeType&&"args"===t.memberName.value){const e=this._evaluator.getType(t.leftExpression);e&&(0,R.isTypeVar)(e)&&e.details.isParamSpec&&(s=!0)}}else 2===e.category&&(s=!1);if(e.name&&0===e.category&&s&&this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportGeneralTypeIssues,c.DiagnosticRule.reportGeneralTypeIssues,m.Localizer.Diagnostic.namedParamAfterParamSpecArgs().format({name:e.name.value}),e.name),e.name&&"_"!==e.name.value){const t=n.functionType.details.parameters.find((t=>{var n;return t.name===(null===(n=e.name)||void 0===n?void 0:n.value)}));if(t){const n=t.type;if("none"!==this._fileInfo.diagnosticRuleSet.reportUnknownParameterType)if((0,R.isUnknown)(n)||(0,R.isTypeVar)(n)&&n.details.isSynthesized&&!n.details.isSynthesizedSelf)this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportUnknownParameterType,c.DiagnosticRule.reportUnknownParameterType,m.Localizer.Diagnostic.paramTypeUnknown().format({paramName:e.name.value}),e.name);else if((0,O.isPartlyUnknown)(n)){const t=new l.DiagnosticAddendum;t.addMessage(m.Localizer.DiagnosticAddendum.paramType().format({paramType:this._evaluator.printType(n,{expandTypeAlias:!0})})),this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportUnknownParameterType,c.DiagnosticRule.reportUnknownParameterType,m.Localizer.Diagnostic.paramTypePartiallyUnknown().format({paramName:e.name.value})+t.getString(),e.name)}let i=!1;(t.typeAnnotation||(0,R.isTypeVar)(n)&&n.details.isSynthesizedSelf)&&(i=!0),i||"none"===this._fileInfo.diagnosticRuleSet.reportMissingParameterType||this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportMissingParameterType,c.DiagnosticRule.reportMissingParameterType,m.Localizer.Diagnostic.paramAnnotationMissing().format({name:e.name.value}),e.name)}}}));const r=n.functionType.details.parameters.filter((e=>!!(e.typeAnnotation&&(0,R.isTypeVar)(e.type)&&(0,R.isParamSpec)(e.type)&&0!==e.category&&e.name&&e.type.paramSpecAccess)));if(1===r.length&&r[0].typeAnnotation&&this._evaluator.addError(m.Localizer.Diagnostic.paramSpecArgsKwargsUsage(),r[0].typeAnnotation),this._fileInfo.isStubFile){e.returnTypeAnnotation||(null===(t=e.functionAnnotationComment)||void 0===t?void 0:t.returnTypeAnnotation)||this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportUnknownParameterType,c.DiagnosticRule.reportUnknownParameterType,m.Localizer.Diagnostic.returnTypeUnknown(),e.name)}i&&this._validateMethod(e,n.functionType,i)}e.parameters.forEach(((e,t)=>{if(e.defaultValue&&this.walk(e.defaultValue),e.typeAnnotation&&this.walk(e.typeAnnotation),e.typeAnnotationComment&&this.walk(e.typeAnnotationComment),n){const i=e.typeAnnotation||e.typeAnnotationComment;if(i&&t<n.functionType.details.parameters.length){const e=n.functionType.details.parameters[t].type,s=["__init__","__new__"];!(0,R.isTypeVar)(e)||3!==e.details.declaredVariance||e.details.isSynthesized||s.some((e=>e===n.functionType.details.name))||this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportGeneralTypeIssues,c.DiagnosticRule.reportGeneralTypeIssues,m.Localizer.Diagnostic.paramTypeCovariant(),i)}}})),e.returnTypeAnnotation&&this.walk(e.returnTypeAnnotation),e.functionAnnotationComment&&(this.walk(e.functionAnnotationComment),"none"!==this._fileInfo.diagnosticRuleSet.reportTypeCommentUsage&&this._fileInfo.executionEnvironment.pythonVersion>=d.PythonVersion.V3_5&&this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportTypeCommentUsage,c.DiagnosticRule.reportTypeCommentUsage,m.Localizer.Diagnostic.typeCommentDeprecated(),e.functionAnnotationComment)),this.walkMultiple(e.decorators),e.parameters.forEach((e=>{e.name&&this.walk(e.name)}));const s=f.getCodeFlowComplexity(e),r=s>w.maxCodeComplexity;if(r?this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportGeneralTypeIssues,c.DiagnosticRule.reportGeneralTypeIssues,m.Localizer.Diagnostic.codeTooComplexToAnalyze(),e.name):this.walk(e.suite),n&&(r||this._validateFunctionReturn(e,n.functionType),this._validateDunderSignatures(e,n.functionType,void 0!==i),this._validateTypeGuardFunction(e,n.functionType,void 0!==i),this._validateFunctionTypeVarUsage(e,n)),this._fileInfo.isStubFile&&"__getattr__"===e.name.value){const t=(0,F.getScopeForNode)(e);3===(null==t?void 0:t.type)&&this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportIncompleteStub,c.DiagnosticRule.reportIncompleteStub,m.Localizer.Diagnostic.stubUsesGetAttr(),e.name)}if(this._scopedNodes.push(e),n&&(0,R.isOverloadedFunction)(n.decoratedType)&&R.OverloadedFunctionType.getImplementation(n.decoratedType)!==n.functionType){const t=R.OverloadedFunctionType.getOverloads(n.decoratedType);if(t.length>1){const n=100;t.length<n&&this._validateOverloadConsistency(e,t[t.length-1],t.slice(0,t.length-1))}}return!1}visitLambda(e){this._evaluator.getType(e),this.walkMultiple([...e.parameters,e.expression]),e.parameters.forEach((e=>{if(e.name){const t=this._evaluator.getType(e.name);t&&((0,R.isUnknown)(t)?this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportUnknownLambdaType,c.DiagnosticRule.reportUnknownLambdaType,m.Localizer.Diagnostic.paramTypeUnknown().format({paramName:e.name.value}),e.name):(0,O.isPartlyUnknown)(t)&&this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportUnknownLambdaType,c.DiagnosticRule.reportUnknownLambdaType,m.Localizer.Diagnostic.paramTypePartiallyUnknown().format({paramName:e.name.value}),e.name))}}));const t=this._evaluator.getType(e.expression);return t&&((0,R.isUnknown)(t)?this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportUnknownLambdaType,c.DiagnosticRule.reportUnknownLambdaType,m.Localizer.Diagnostic.lambdaReturnTypeUnknown(),e.expression):(0,O.isPartlyUnknown)(t)&&this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportUnknownLambdaType,c.DiagnosticRule.reportUnknownLambdaType,m.Localizer.Diagnostic.lambdaReturnTypePartiallyUnknown().format({returnType:this._evaluator.printType(t,{expandTypeAlias:!0})}),e.expression)),this._scopedNodes.push(e),!1}visitCall(e){var t;if(this._validateIsInstanceCall(e),this._validateIllegalDefaultParamInitializer(e),this._validateStandardCollectionInstantiation(e),("none"!==this._fileInfo.diagnosticRuleSet.reportUnusedCallResult||"none"!==this._fileInfo.diagnosticRuleSet.reportUnusedCoroutine)&&47===(null===(t=e.parent)||void 0===t?void 0:t.nodeType)){const t=38===e.leftExpression.nodeType&&"reveal_type"===e.leftExpression.value,n=this._evaluator.getType(e);!t&&n&&this._isTypeValidForUnusedValueTest(n)&&(this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportUnusedCallResult,c.DiagnosticRule.reportUnusedCallResult,m.Localizer.Diagnostic.unusedCallResult().format({type:this._evaluator.printType(n)}),e),(0,R.isClassInstance)(n)&&R.ClassType.isBuiltIn(n,"Coroutine")&&this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportUnusedCoroutine,c.DiagnosticRule.reportUnusedCoroutine,m.Localizer.Diagnostic.unusedCoroutine(),e))}return!0}visitAwait(e){var t;if("none"!==this._fileInfo.diagnosticRuleSet.reportUnusedCallResult&&47===(null===(t=e.parent)||void 0===t?void 0:t.nodeType)&&9===e.expression.nodeType){const t=this._evaluator.getType(e);t&&this._isTypeValidForUnusedValueTest(t)&&this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportUnusedCallResult,c.DiagnosticRule.reportUnusedCallResult,m.Localizer.Diagnostic.unusedCallResult().format({type:this._evaluator.printType(t)}),e)}return!0}visitFor(e){return this._evaluator.evaluateTypesForStatement(e),e.typeComment&&this._evaluator.addDiagnosticForTextRange(this._fileInfo,this._fileInfo.diagnosticRuleSet.reportGeneralTypeIssues,c.DiagnosticRule.reportGeneralTypeIssues,m.Localizer.Diagnostic.annotationNotSupported(),e.typeComment),!0}visitList(e){return this._validateIllegalDefaultParamInitializer(e),!0}visitSet(e){return this._validateIllegalDefaultParamInitializer(e),!0}visitDictionary(e){return this._validateIllegalDefaultParamInitializer(e),!0}visitListComprehension(e){return this._scopedNodes.push(e),!0}visitListComprehensionIf(e){return this._validateConditionalIsBool(e.testExpression),this._reportUnnecessaryConditionExpression(e.testExpression),!0}visitIf(e){return this._validateConditionalIsBool(e.testExpression),this._reportUnnecessaryConditionExpression(e.testExpression),!0}visitWhile(e){return this._validateConditionalIsBool(e.testExpression),this._reportUnnecessaryConditionExpression(e.testExpression),!0}visitWith(e){return e.withItems.forEach((e=>{this._evaluator.evaluateTypesForStatement(e)})),e.typeComment&&this._evaluator.addDiagnosticForTextRange(this._fileInfo,this._fileInfo.diagnosticRuleSet.reportGeneralTypeIssues,c.DiagnosticRule.reportGeneralTypeIssues,m.Localizer.Diagnostic.annotationNotSupported(),e.typeComment),!0}visitReturn(e){var t,n;let i;const s=I.getEnclosingFunction(e),r=s?this._evaluator.getFunctionDeclaredReturnType(s):void 0;if(i=e.returnExpression?null!==(t=this._evaluator.getTypeResult(e.returnExpression))&&void 0!==t?t:{type:R.UnknownType.create()}:{type:R.NoneType.createInstance()},(null==s?void 0:s.isAsync)&&e.returnExpression){const t=f.getDeclaration(s);5===(null==t?void 0:t.type)&&t.isGenerator&&this._evaluator.addError(m.Localizer.Diagnostic.returnInAsyncGenerator(),e.returnExpression)}if(this._evaluator.isNodeReachable(e,void 0)&&s){if(r)if((0,R.isNever)(r))this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportGeneralTypeIssues,c.DiagnosticRule.reportGeneralTypeIssues,m.Localizer.Diagnostic.noReturnContainsReturn(),e);else{let t=new l.DiagnosticAddendum,s=!1;if(this._evaluator.assignType(r,i.type,t,new M.TypeVarContext,void 0,64))s=!0;else{const n=(0,O.getTypeVarArgumentsRecursive)(r);if(n&&n.some((e=>e.details.constraints.length>0))){const a=new M.TypeVarContext;for(const t of n)if(t.details.constraints.length>0){const n=this._evaluator.narrowConstrainedTypeVar(e,t);n&&(a.setTypeVarType(t,n),a.addSolveForScope((0,O.getTypeVarScopeId)(t)))}if(!a.isEmpty()){const e=(0,O.applySolvedTypeVars)(r,a);this._evaluator.assignType(e,i.type,t,void 0,void 0,64)&&(s=!0)}}}s||(i.expectedTypeDiagAddendum&&(t=i.expectedTypeDiagAddendum),this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportGeneralTypeIssues,c.DiagnosticRule.reportGeneralTypeIssues,m.Localizer.Diagnostic.returnTypeMismatch().format({exprType:this._evaluator.printType(i.type),returnType:this._evaluator.printType(r)})+t.getString(),e.returnExpression?e.returnExpression:e,null===(n=i.expectedTypeDiagAddendum)||void 0===n?void 0:n.getEffectiveTextRange()))}(0,R.isUnknown)(i.type)?this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportUnknownVariableType,c.DiagnosticRule.reportUnknownVariableType,m.Localizer.Diagnostic.returnTypeUnknown(),e.returnExpression):(0,O.isPartlyUnknown)(i.type)&&this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportUnknownVariableType,c.DiagnosticRule.reportUnknownVariableType,m.Localizer.Diagnostic.returnTypePartiallyUnknown().format({returnType:this._evaluator.printType(i.type,{expandTypeAlias:!0})}),e.returnExpression)}return!0}visitYield(e){const t=e.expression?this._evaluator.getType(e.expression):R.NoneType.createInstance();return this._validateYieldType(e,t||R.UnknownType.create()),!0}visitYieldFrom(e){var t,n,i,s;const r=this._evaluator.getType(e.expression)||R.UnknownType.create();let a;if((0,R.isClassInstance)(r)&&R.ClassType.isBuiltIn(r,"Coroutine"))a=R.UnknownType.create();else{a=null!==(n=null===(t=this._evaluator.getTypeOfIterable({type:r},!1,e))||void 0===t?void 0:t.type)&&void 0!==n?n:R.UnknownType.create();const o=(0,O.getGeneratorTypeArgs)(a);a=o?o.length>=1?o[0]:R.UnknownType.create():null!==(s=null===(i=this._evaluator.getTypeOfIterator({type:r},!1,e))||void 0===i?void 0:i.type)&&void 0!==s?s:R.UnknownType.create()}return this._validateYieldType(e,a),!0}visitRaise(e){if(this._evaluator.verifyRaiseExceptionType(e),e.valueExpression){const t=this._evaluator.getBuiltInType(e,"BaseException"),n=this._evaluator.getType(e.valueExpression);if(n&&t&&(0,R.isInstantiableClass)(t)){const i=new l.DiagnosticAddendum;(0,O.doForEachSubtype)(n,(e=>{e=this._evaluator.makeTopLevelTypeVarsConcrete(e),(0,R.isAnyOrUnknown)(e)||(0,R.isNoneInstance)(e)||(0,R.isClass)(e)&&(0,O.derivesFromClassRecursive)(e,t,!1)||i.addMessage(m.Localizer.Diagnostic.exceptionTypeIncorrect().format({type:this._evaluator.printType(e)}))})),i.isEmpty()||this._evaluator.addError(m.Localizer.Diagnostic.expectedExceptionObj()+i.getString(),e.valueExpression)}}return!0}visitExcept(e){if(e.typeExpression){this._evaluator.evaluateTypesForStatement(e);const t=this._evaluator.getType(e.typeExpression);t&&this._validateExceptionType(t,e.typeExpression)}return!0}visitAssert(e){e.exceptionExpression&&this._evaluator.getType(e.exceptionExpression),this._validateConditionalIsBool(e.testExpression);const t=this._evaluator.getType(e.testExpression);return t&&(0,R.isClassInstance)(t)&&(0,O.isTupleClass)(t)&&t.tupleTypeArguments&&t.tupleTypeArguments.length>0&&((0,O.isUnboundedTupleClass)(t)||this._evaluator.addDiagnosticForTextRange(this._fileInfo,this._fileInfo.diagnosticRuleSet.reportAssertAlwaysTrue,c.DiagnosticRule.reportAssertAlwaysTrue,m.Localizer.Diagnostic.assertAlwaysTrue(),e.testExpression)),!0}visitAssignment(e){if(this._evaluator.evaluateTypesForStatement(e),e.typeAnnotationComment&&(this._evaluator.getType(e.typeAnnotationComment),"none"!==this._fileInfo.diagnosticRuleSet.reportTypeCommentUsage&&this._fileInfo.executionEnvironment.pythonVersion>=d.PythonVersion.V3_6&&this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportTypeCommentUsage,c.DiagnosticRule.reportTypeCommentUsage,m.Localizer.Diagnostic.typeCommentDeprecated(),e.typeAnnotationComment)),54===e.leftExpression.nodeType){const t=this._evaluator.getTypeOfAnnotation(e.leftExpression.typeAnnotation);if((0,R.isClassInstance)(t)&&R.ClassType.isBuiltIn(t,"TypeAlias")){const t=(0,F.getScopeForNode)(e);t&&2!==t.type&&3!==t.type&&4!==t.type&&this._evaluator.addError(m.Localizer.Diagnostic.typeAliasNotInModuleOrClass(),e.leftExpression.typeAnnotation)}}return!0}visitAssignmentExpression(e){return this._evaluator.getType(e),!0}visitAugmentedAssignment(e){return this._evaluator.evaluateTypesForStatement(e),!0}visitIndex(e){this._evaluator.getType(e);const t=this._evaluator.getType(e.baseExpression);return t&&(0,O.doForEachSubtype)(t,(t=>{if((0,R.isClassInstance)(t)&&t.tupleTypeArguments&&!(0,O.isUnboundedTupleClass)(t)){const n=t.tupleTypeArguments.length;if(1===e.items.length&&!e.trailingComma&&0===e.items[0].argumentCategory&&!e.items[0].name){const i=this._evaluator.getType(e.items[0].valueExpression);i&&(0,R.isClassInstance)(i)&&R.ClassType.isBuiltIn(i,"int")&&(0,O.isLiteralType)(i)&&"number"==typeof i.literalValue&&(i.literalValue>=0&&i.literalValue>=n||i.literalValue<0&&i.literalValue+n<0)&&this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportGeneralTypeIssues,c.DiagnosticRule.reportGeneralTypeIssues,m.Localizer.Diagnostic.tupleIndexOutOfRange().format({index:i.literalValue,type:this._evaluator.printType(t)}),e)}}})),!0}visitBinaryOperation(e){return 36!==e.operator&&37!==e.operator||(this._validateConditionalIsBool(e.leftExpression),this._validateConditionalIsBool(e.rightExpression)),12===e.operator||28===e.operator?I.isWithinAssertExpression(e)||this._validateComparisonTypes(e):39===e.operator||40===e.operator?I.isWithinAssertExpression(e)||this._validateComparisonTypesForIsOperator(e):41!==e.operator&&42!==e.operator||I.isWithinAssertExpression(e)||this._validateContainmentTypes(e),this._evaluator.getType(e),!0}visitSlice(e){return this._evaluator.getType(e),!0}visitUnpack(e){return this._evaluator.getType(e),!0}visitTuple(e){return this._evaluator.getType(e),!0}visitUnaryOperation(e){return 38===e.operator&&this._validateConditionalIsBool(e.expression),this._evaluator.getType(e),!0}visitTernary(e){return this._evaluator.getType(e),this._validateConditionalIsBool(e.testExpression),this._reportUnnecessaryConditionExpression(e.testExpression),!0}visitStringList(e){for(const t of e.strings)if(t.hasUnescapeErrors){(0,g.getUnescapedString)(t.token).unescapeErrors.forEach((e=>{const n={start:t.token.start+t.token.prefixLength+t.token.quoteMarkLength+e.offset,length:e.length};0===e.errorType?this._evaluator.addDiagnosticForTextRange(this._fileInfo,this._fileInfo.diagnosticRuleSet.reportInvalidStringEscapeSequence,c.DiagnosticRule.reportInvalidStringEscapeSequence,m.Localizer.Diagnostic.stringUnsupportedEscape(),n):1===e.errorType?this._evaluator.addDiagnosticForTextRange(this._fileInfo,"error","",m.Localizer.Diagnostic.formatStringEscape(),n):2===e.errorType?this._evaluator.addDiagnosticForTextRange(this._fileInfo,"error","",m.Localizer.Diagnostic.formatStringBrace(),n):3===e.errorType&&this._evaluator.addDiagnosticForTextRange(this._fileInfo,"error","",m.Localizer.Diagnostic.formatStringUnterminated(),n)}))}return e.typeAnnotation&&this._evaluator.getType(e),e.strings.length>1&&!e.isParenthesized&&this._evaluator.addDiagnosticForTextRange(this._fileInfo,this._fileInfo.diagnosticRuleSet.reportImplicitStringConcatenation,c.DiagnosticRule.reportImplicitStringConcatenation,m.Localizer.Diagnostic.implicitStringConcat(),e),!0}visitFormatString(e){return e.expressions.forEach((e=>{this._evaluator.getType(e)})),!0}visitGlobal(e){return this._suppressUnboundCheck((()=>{e.nameList.forEach((e=>{this._evaluator.getType(e),this.walk(e)}))})),!1}visitNonlocal(e){return this._suppressUnboundCheck((()=>{e.nameList.forEach((e=>{this._evaluator.getType(e),this.walk(e)}))})),!1}visitName(e){this._conditionallyReportPrivateUsage(e),this._isUnboundCheckSuppressed||this._reportUnboundName(e);const t=this._evaluator.getType(e);return this._reportDeprecatedUse(e,t),!0}visitDel(e){return e.expressions.forEach((e=>{this._evaluator.verifyDeleteExpression(e),this.walk(e)})),!1}visitMemberAccess(e){const t=this._evaluator.getType(e);return this._reportDeprecatedUse(e.memberName,t),this._conditionallyReportPrivateUsage(e.memberName),this.walk(e.leftExpression),!1}visitImportAs(e){return this._conditionallyReportShadowedImport(e),this._evaluator.evaluateTypesForStatement(e),!0}visitImportFrom(e){if(0===e.module.leadingDots&&1===e.module.nameParts.length&&"__future__"===e.module.nameParts[0].value&&(I.isValidLocationForFutureImport(e)||this._evaluator.addError(m.Localizer.Diagnostic.futureImportLocationNotAllowed(),e)),this._conditionallyReportShadowedImport(e),e.isWildcardImport){const t=f.getImportInfo(e.module);t&&t.isImportFound&&2!==t.importType&&!this._fileInfo.isStubFile&&this._evaluator.addDiagnosticForTextRange(this._fileInfo,this._fileInfo.diagnosticRuleSet.reportWildcardImportFromLibrary,c.DiagnosticRule.reportWildcardImportFromLibrary,m.Localizer.Diagnostic.wildcardLibraryImport(),e.wildcardToken||e)}else e.imports.forEach((e=>{this._evaluator.evaluateTypesForStatement(e)}));return!0}visitImportFromAs(e){var t;if(this._fileInfo.isStubFile)return!1;const n=this._evaluator.getDeclarationsForNameNode(e.name);if(!n)return!1;for(const t of n){if(!(0,T.isAliasDeclaration)(t)||!t.submoduleFallback||t.node!==e)continue;const n=this._evaluator.resolveAliasDeclaration(t,!0);if(!(null==n?void 0:n.path)||!(0,P.isStubFile)(n.path))continue;const i=this._getImportResult(e,n.path);if(i){this._addMissingModuleSourceDiagnosticIfNeeded(i,e.name);break}}const i=this._evaluator.getType(null!==(t=e.alias)&&void 0!==t?t:e.name);return this._reportDeprecatedUse(e.name,i),!1}visitModuleName(e){if(this._fileInfo.isStubFile)return!1;const t=f.getImportInfo(e);return(0,o.assert)(void 0!==t),this._addMissingModuleSourceDiagnosticIfNeeded(t,e),!1}visitTypeParameterList(e){return this._typeParameterLists.push(e),!0}visitTypeParameter(e){return!1}visitTypeAnnotation(e){return this._evaluator.getType(e.typeAnnotation),!0}visitMatch(e){return this._evaluator.getType(e.subjectExpression),this._validateExhaustiveMatch(e),!0}visitCase(e){return e.guardExpression&&this._validateConditionalIsBool(e.guardExpression),this._evaluator.evaluateTypesForStatement(e.pattern),!0}visitPatternClass(e){return(0,S.validateClassPattern)(this._evaluator,e),!0}visitTry(e){return this._reportUnusedExceptStatements(e),!0}visitError(e){return e.child&&this._evaluator.getType(e.child),!1}_getImportResult(e,t){const n=this._importResolver.getConfigOptions().findExecEnvironment(t),i=0===e.parent.module.leadingDots?this._importResolver.getModuleNameForImport(t,n).moduleName:(0,_.getRelativeModuleName)(this._importResolver.fileSystem,this._fileInfo.filePath,t);if(i)return this._importResolver.resolveImport(this._fileInfo.filePath,n,(0,v.createImportedModuleDescriptor)(i))}_addMissingModuleSourceDiagnosticIfNeeded(e,t){!e.isNativeLib&&e.isStubFile&&0!==e.importType&&e.nonStubImportResult&&!e.nonStubImportResult.isImportFound&&this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportMissingModuleSource,c.DiagnosticRule.reportMissingModuleSource,m.Localizer.Diagnostic.importSourceResolveFailure().format({importName:e.importName}),t)}_validateConditionalIsBool(e){const t=this._evaluator.getType(e);if(!t)return;let n=!0;const i=new l.DiagnosticAddendum;this._evaluator.mapSubtypesExpandTypeVars(t,void 0,(t=>{if((0,R.isAnyOrUnknown)(t))return;if((0,R.isClassInstance)(t)&&R.ClassType.isBuiltIn(t,"bool"))return;const s=this._evaluator.getTypeOfMagicMethodReturn(t,[],"__bool__",e,void 0);s&&!(0,R.isAnyOrUnknown)(s)&&((0,R.isClassInstance)(s)&&R.ClassType.isBuiltIn(s,"bool")||(n=!1,i.addMessage(m.Localizer.DiagnosticAddendum.conditionalRequiresBool().format({operandType:this._evaluator.printType(t),boolReturnType:this._evaluator.printType(s)}))))})),n||this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportGeneralTypeIssues,c.DiagnosticRule.reportGeneralTypeIssues,m.Localizer.Diagnostic.conditionalOperandInvalid().format({type:this._evaluator.printType(t)})+i.getString(),e)}_reportUnnecessaryConditionExpression(e){if(7===e.nodeType)return void(36!==e.operator&&37!==e.operator||(this._reportUnnecessaryConditionExpression(e.leftExpression),this._reportUnnecessaryConditionExpression(e.rightExpression)));if(55===e.nodeType)return void(38===e.operator&&this._reportUnnecessaryConditionExpression(e.expression));const t=this._evaluator.getTypeOfExpression(e);let n=!0;(0,O.doForEachSubtype)(t.type,(e=>{e=this._evaluator.makeTopLevelTypeVarsConcrete(e),(0,R.isFunction)(e)||(0,R.isOverloadedFunction)(e)||(n=!1)})),n&&this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportUnnecessaryComparison,c.DiagnosticRule.reportUnnecessaryComparison,m.Localizer.Diagnostic.functionInConditionalExpression(),e)}_reportUnusedExpression(e){var t,n;if("none"===this._fileInfo.diagnosticRuleSet.reportUnusedExpression)return;let i=!1;[55,7,40,11,38,52].some((t=>t===e.nodeType))?i=!0:31!==e.nodeType&&45!==e.nodeType&&15!==e.nodeType||e.entries.some((e=>32===e.nodeType))||(i=!0),i&&this._fileInfo.ipythonMode===D.IPythonMode.CellDocs&&47===(null===(t=e.parent)||void 0===t?void 0:t.nodeType)&&e.parent.statements[e.parent.statements.length-1]===e&&36===(null===(n=e.parent.parent)||void 0===n?void 0:n.nodeType)&&e.parent.parent.statements[e.parent.parent.statements.length-1]===e.parent&&(i=!1),i&&this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportUnusedExpression,c.DiagnosticRule.reportUnusedExpression,m.Localizer.Diagnostic.unusedExpression(),e)}_validateExhaustiveMatch(e){if("none"===this._fileInfo.diagnosticRuleSet.reportMatchNotExhaustive)return;const t=this._evaluator.evaluateTypeForSubnode(e,(()=>{this._evaluator.evaluateTypesForMatchStatement(e)}));if(t&&!(0,R.isNever)(t.type)){const n=new l.DiagnosticAddendum;n.addMessage(m.Localizer.DiagnosticAddendum.matchIsNotExhaustiveType().format({type:this._evaluator.printType(t.type)})),n.addMessage(m.Localizer.DiagnosticAddendum.matchIsNotExhaustiveHint()),this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportMatchNotExhaustive,c.DiagnosticRule.reportMatchNotExhaustive,m.Localizer.Diagnostic.matchIsNotExhaustive()+n.getString(),e.subjectExpression)}}_suppressUnboundCheck(e){const t=this._isUnboundCheckSuppressed;this._isUnboundCheckSuppressed=!0;try{e()}finally{this._isUnboundCheckSuppressed=t}}_validateIllegalDefaultParamInitializer(e){"none"!==this._fileInfo.diagnosticRuleSet.reportCallInDefaultInitializer&&I.isWithinDefaultParamInitializer(e)&&!this._fileInfo.isStubFile&&this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportCallInDefaultInitializer,c.DiagnosticRule.reportCallInDefaultInitializer,m.Localizer.Diagnostic.defaultValueContainsCall(),e)}_validateStandardCollectionInstantiation(e){const t=this._evaluator.getType(e.leftExpression);if(t&&(0,R.isInstantiableClass)(t)&&R.ClassType.isBuiltIn(t)&&!t.includeSubclasses&&t.aliasName){["List","Set","Dict","Tuple"].some((e=>e===t.aliasName))&&this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportGeneralTypeIssues,c.DiagnosticRule.reportGeneralTypeIssues,m.Localizer.Diagnostic.collectionAliasInstantiation().format({type:t.aliasName,alias:t.details.name}),e.leftExpression)}}_validateContainmentTypes(e){const t=this._evaluator.getType(e.leftExpression),n=this._evaluator.getType(e.rightExpression);if(!t||!n)return;if((0,R.isNever)(t)||(0,R.isNever)(n))return;const i=(0,N.getElementTypeForContainerNarrowing)(n);if(!i)return;const s=(0,N.narrowTypeForContainerElementType)(this._evaluator,t,this._evaluator.makeTopLevelTypeVarsConcrete(i));if((0,R.isNever)(s)){const n=()=>41===e.operator?m.Localizer.Diagnostic.containmentAlwaysFalse():m.Localizer.Diagnostic.containmentAlwaysTrue();this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportUnnecessaryContains,c.DiagnosticRule.reportUnnecessaryContains,n().format({leftType:this._evaluator.printType(t,{expandTypeAlias:!0}),rightType:this._evaluator.printType(i,{expandTypeAlias:!0})}),e)}}_validateComparisonTypesForIsOperator(e){const t=this._evaluator.getType(e.rightExpression);if(!t||!(0,R.isNoneInstance)(t))return;const n=this._evaluator.getType(e.leftExpression);if(!n)return;let i=!1;(0,O.doForEachSubtype)(n,(e=>{e=this._evaluator.makeTopLevelTypeVarsConcrete(e),this._evaluator.assignType(e,R.NoneType.createInstance())&&(i=!0)}));i||this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportUnnecessaryComparison,c.DiagnosticRule.reportUnnecessaryComparison,(39===e.operator?m.Localizer.Diagnostic.comparisonAlwaysFalse():m.Localizer.Diagnostic.comparisonAlwaysTrue()).format({leftType:this._evaluator.printType(n,{expandTypeAlias:!0}),rightType:this._evaluator.printType(t)}),e)}_validateComparisonTypes(e){let t=e.rightExpression;7===t.nodeType&&!t.parenthesized&&I.operatorSupportsChaining(t.operator)&&(t=t.leftExpression);const n=this._evaluator.getType(e.leftExpression),i=this._evaluator.getType(t);if(!n||!i)return;if((0,R.isNever)(n)||(0,R.isNever)(i))return;const s=()=>12===e.operator?m.Localizer.Diagnostic.comparisonAlwaysFalse():m.Localizer.Diagnostic.comparisonAlwaysTrue();if((0,O.isLiteralTypeOrUnion)(i)&&(0,O.isLiteralTypeOrUnion)(n)){if(void 0===(0,E.evaluateStaticBoolExpression)(e,this._fileInfo.executionEnvironment,this._fileInfo.definedConstants)){let t=!1;(0,O.doForEachSubtype)(n,(e=>{this._evaluator.assignType(i,e)&&(t=!0)})),t||this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportUnnecessaryComparison,c.DiagnosticRule.reportUnnecessaryComparison,s().format({leftType:this._evaluator.printType(n,{expandTypeAlias:!0}),rightType:this._evaluator.printType(i,{expandTypeAlias:!0})}),e)}}else{let t=!1;if((0,O.doForEachSubtype)(n,(e=>{t||(e=this._evaluator.makeTopLevelTypeVarsConcrete(e),(0,O.doForEachSubtype)(i,(n=>{t||(n=this._evaluator.makeTopLevelTypeVarsConcrete(n),this._isTypeComparable(e,n)&&(t=!0))})))})),!t){const t=this._evaluator.printType(n,{expandTypeAlias:!0}),r=this._evaluator.printType(i,{expandTypeAlias:!0});this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportUnnecessaryComparison,c.DiagnosticRule.reportUnnecessaryComparison,s().format({leftType:t,rightType:r}),e)}}}_isTypeComparable(e,t){if((0,R.isAnyOrUnknown)(e)||(0,R.isAnyOrUnknown)(t))return!0;if((0,R.isNever)(e)||(0,R.isNever)(t))return!1;if((0,R.isModule)(e)||(0,R.isModule)(t))return(0,R.isTypeSame)(e,t);if((0,R.isNoneInstance)(e)||(0,R.isNoneInstance)(t))return(0,R.isTypeSame)(e,t);if(((0,R.isFunction)(e)||(0,R.isOverloadedFunction)(e))!==((0,R.isFunction)(t)||(0,R.isOverloadedFunction)(t)))return!1;if((0,R.isInstantiableClass)(e)||(0,R.isClassInstance)(e)&&R.ClassType.isBuiltIn(e,"type")){if((0,R.isInstantiableClass)(t)||(0,R.isClassInstance)(t)&&R.ClassType.isBuiltIn(t,"type")){const n=R.ClassType.cloneForSpecialization(e,void 0,!1),i=R.ClassType.cloneForSpecialization(t,void 0,!1);if(this._evaluator.assignType(n,i)||this._evaluator.assignType(i,n))return!0}const n=e.details.effectiveMetaclass;return!!(n&&(0,R.isClass)(n)&&(0,O.lookUpClassMember)(n,"__eq__",4))}if((0,R.isClassInstance)(e)){if((0,R.isClassInstance)(t)){const n=R.ClassType.cloneForSpecialization(e,void 0,!1),i=R.ClassType.cloneForSpecialization(t,void 0,!1);if(this._evaluator.assignType(n,i)||this._evaluator.assignType(i,n))return!0;if(R.ClassType.isBuiltIn(e)&&R.ClassType.isBuiltIn(t))return!1}const n=(0,O.lookUpClassMember)(R.ClassType.cloneAsInstantiable(e),"__eq__",4);return!!n&&(!R.ClassType.isDataClass(e)||!n.symbol.getSynthesizedType())}return!0}_isTypeValidForUnusedValueTest(e){return!(0,R.isNoneInstance)(e)&&!(0,R.isNever)(e)&&!(0,R.isAnyOrUnknown)(e)}_validateFunctionTypeVarUsage(e,t){if("none"===this._fileInfo.diagnosticRuleSet.reportInvalidTypeVarUse)return;const n=t.functionType,i=new Map,s=new Map;let r,a,o=!0;if(R.FunctionType.isInstanceMethod(n)&&"__init__"===e.name.value){const t=I.getEnclosingClassOrFunction(e);if(t&&10===t.nodeType){const e=this._evaluator.getTypeOfClass(t);e&&(0,R.isClass)(e.classType)&&(a=e.classType)}}const p=new I.NameNodeWalker(((t,n,l)=>{var c,p,d,u,y,m;const h=this._evaluator.getType(t);if(h&&(0,R.isTypeVar)(h)&&!h.details.isSynthesizedSelf){if(h.scopeId===I.getScopeIdForNode(e)){let e=h.details.constraints.length>0||!!h.details.defaultType||o&&void 0!==h.details.boundType&&void 0!==n||(0,R.isParamSpec)(h);if(!e&&l&&void 0!==n){const t=this._evaluator.getType(l);(null==t?void 0:t.typeAliasInfo)&&t.typeAliasInfo.typeParameters&&n<t.typeAliasInfo.typeParameters.length&&(e=!0)}const s=i.get(h.details.name),a=18===(null===(c=null==r?void 0:r.defaultValue)||void 0===c?void 0:c.nodeType);s?(s.nodes.push(t),void 0!==r?(s.paramTypeUsageCount+=1,a&&(s.paramTypeWithEllipsisUsageCount+=1,s.paramWithEllipsis||(s.paramWithEllipsis=null===(d=null==r?void 0:r.name)||void 0===d?void 0:d.value))):s.returnTypeUsageCount+=1):i.set(h.details.name,{nodes:[t],paramTypeUsageCount:void 0!==r?1:0,paramTypeWithEllipsisUsageCount:a?1:0,returnTypeUsageCount:void 0===r?1:0,paramWithEllipsis:a?null===(p=null==r?void 0:r.name)||void 0===p?void 0:p.value:void 0,isExempt:e})}if(a&&h.scopeId===a.details.typeVarScopeId){const e=s.get(h.details.name),n=18===(null===(u=null==r?void 0:r.defaultValue)||void 0===u?void 0:u.nodeType),i=!!h.details.defaultType;e?(e.nodes.push(t),void 0!==r&&(e.paramTypeUsageCount+=1,n&&(e.paramTypeWithEllipsisUsageCount+=1,e.paramWithEllipsis||(e.paramWithEllipsis=null===(m=null==r?void 0:r.name)||void 0===m?void 0:m.value)))):s.set(h.details.name,{nodes:[t],paramTypeUsageCount:void 0!==r?1:0,paramTypeWithEllipsisUsageCount:n?1:0,returnTypeUsageCount:0,paramWithEllipsis:n?null===(y=null==r?void 0:r.name)||void 0===y?void 0:y.value:void 0,isExempt:i})}}}));e.parameters.forEach((e=>{const t=e.typeAnnotation||e.typeAnnotationComment;t&&(r=e,p.walk(t))})),r=void 0,e.returnTypeAnnotation&&(o=!1,p.walk(e.returnTypeAnnotation)),i.forEach((e=>{var i;1!==e.nodes.length||e.isExempt||this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportInvalidTypeVarUse,c.DiagnosticRule.reportInvalidTypeVarUse,m.Localizer.Diagnostic.typeVarUsedOnlyOnce().format({name:e.nodes[0].value}),e.nodes[0]);let s=e.returnTypeUsageCount>0;if(1===e.returnTypeUsageCount&&n.details.declaredReturnType){const t=n.details.declaredReturnType;(0,R.isUnion)(t)&&t.subtypes.some((t=>(0,R.isTypeVar)(t)&&t.details.name===e.nodes[0].value))&&(s=!1)}const r=(0,R.isOverloadedFunction)(t.decoratedType)&&!R.FunctionType.isOverloaded(t.functionType);if(s&&e.paramTypeWithEllipsisUsageCount>0&&e.paramTypeUsageCount===e.paramTypeWithEllipsisUsageCount&&!r){const t=new l.DiagnosticAddendum;t.addMessage(m.Localizer.DiagnosticAddendum.typeVarUnsolvableRemedy()),this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportInvalidTypeVarUse,c.DiagnosticRule.reportInvalidTypeVarUse,m.Localizer.Diagnostic.typeVarPossiblyUnsolvable().format({name:e.nodes[0].value,param:null!==(i=e.paramWithEllipsis)&&void 0!==i?i:""})+t.getString(),e.nodes[0])}})),s.forEach((e=>{var t;if(e.paramTypeWithEllipsisUsageCount>0&&e.paramTypeUsageCount===e.paramTypeWithEllipsisUsageCount&&!e.isExempt){const n=new l.DiagnosticAddendum;n.addMessage(m.Localizer.DiagnosticAddendum.typeVarUnsolvableRemedy()),this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportInvalidTypeVarUse,c.DiagnosticRule.reportInvalidTypeVarUse,m.Localizer.Diagnostic.typeVarPossiblyUnsolvable().format({name:e.nodes[0].value,param:null!==(t=e.paramWithEllipsis)&&void 0!==t?t:""})+n.getString(),e.nodes[0])}}))}_validateOverloadConsistency(e,t,n){for(let i=0;i<n.length;i++){const s=n[i];if(this._isOverlappingOverload(t,s)){this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportOverlappingOverload,c.DiagnosticRule.reportOverlappingOverload,m.Localizer.Diagnostic.overlappingOverload().format({name:e.name.value,obscured:n.length+1,obscuredBy:i+1}),e.name);break}}for(let i=0;i<n.length;i++){const s=n[i];if(this._isOverlappingOverload(s,t)){const r=R.FunctionType.getSpecializedReturnType(s),a=R.FunctionType.getSpecializedReturnType(t);if(r&&a&&!this._evaluator.assignType(a,r,void 0,new M.TypeVarContext,void 0,520)){const t=this._findNodeForOverload(e,s);this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportOverlappingOverload,c.DiagnosticRule.reportOverlappingOverload,m.Localizer.Diagnostic.overloadReturnTypeMismatch().format({name:e.name.value,newIndex:n.length+1,prevIndex:i+1}),(t||e).name);break}}}}_findNodeForOverload(e,t){const n=this._evaluator.getDeclarationsForNameNode(e.name);if(n)for(const e of n)if(5===e.type){const n=this._evaluator.getTypeOfFunction(e.node);if((null==n?void 0:n.functionType)===t)return e.node}}_isOverlappingOverload(e,t){return(!R.FunctionType.isInstanceMethod(e)||"__get__"!==e.details.name)&&this._evaluator.assignType(e,t,void 0,new M.TypeVarContext((0,O.getTypeVarScopeId)(e)),void 0,56)}_isLegalOverloadImplementation(e,t,n){var i;const s=new M.TypeVarContext((0,O.getTypeVarScopeId)(t)),r=new M.TypeVarContext((0,O.getTypeVarScopeId)(e));let a=this._evaluator.assignType(e,t,n,r,s,290);const o=null!==(i=e.details.declaredReturnType)&&void 0!==i?i:this._evaluator.getFunctionInferredReturnType(e),c=(0,O.applySolvedTypeVars)(t.details.declaredReturnType||this._evaluator.getFunctionInferredReturnType(t),s),p=new l.DiagnosticAddendum;return(0,R.isNever)(o)||this._evaluator.assignType(c,o,p.createAddendum(),s,r,8)||(p.addMessage(m.Localizer.DiagnosticAddendum.functionReturnTypeMismatch().format({sourceType:this._evaluator.printType(o),destType:this._evaluator.printType(c)})),null==n||n.addAddendum(p),a=!1),a}_walkStatementsAndReportUnreachable(e){let t,n=!1;for(const i of e){if(!n&&!this._evaluator.isNodeReachable(i,t)){const t=i.start,s=e[e.length-1],r=u.TextRange.getEnd(s);this._evaluator.addUnreachableCode(i,{start:t,length:r-t}),n=!0}!n&&this._fileInfo.isStubFile&&this._validateStubStatement(i),this.walk(i),t=i}}_validateStubStatement(e){switch(e.nodeType){case 19:case 28:case 10:case 0:break;case 57:case 26:case 53:case 58:this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportInvalidStubStatement,c.DiagnosticRule.reportInvalidStubStatement,m.Localizer.Diagnostic.invalidStubStatement(),e);break;case 47:for(const t of e.statements){let e=!0;switch(t.nodeType){case 2:case 4:case 6:case 7:case 11:case 14:case 15:case 24:case 26:case 27:case 29:case 30:case 31:case 35:case 38:case 39:case 40:case 43:case 44:case 45:case 46:case 51:case 52:case 53:case 55:case 56:case 57:case 58:case 59:case 60:case 61:e=!1;break;case 5:e=1===t.operator&&38===t.leftExpression.nodeType&&"__all__"===t.leftExpression.value;break;case 9:e=35===t.leftExpression.nodeType&&38===t.leftExpression.leftExpression.nodeType&&"__all__"===t.leftExpression.leftExpression.value}e||this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportInvalidStubStatement,c.DiagnosticRule.reportInvalidStubStatement,m.Localizer.Diagnostic.invalidStubStatement(),t)}}}_validateExceptionType(e,t){var n,i;const s=this._evaluator.getBuiltInType(t,"BaseException"),r=e=>!s||!(0,R.isInstantiableClass)(s)||(0,O.derivesFromClassRecursive)(e,s,!1),a=new l.DiagnosticAddendum;let o;if((0,R.isAnyOrUnknown)(e))o=e;else if((0,R.isInstantiableClass)(e))r(e)||a.addMessage(m.Localizer.Diagnostic.exceptionTypeIncorrect().format({type:this._evaluator.printType(e)})),o=R.ClassType.cloneAsInstance(e);else if((0,R.isClassInstance)(e)){const s=null!==(i=null===(n=this._evaluator.getTypeOfIterator({type:e},!1,t))||void 0===n?void 0:n.type)&&void 0!==i?i:R.UnknownType.create();o=(0,O.mapSubtypes)(s,(t=>(0,R.isAnyOrUnknown)(t)?t:(0,R.isInstantiableClass)(t)?(r(t)||a.addMessage(m.Localizer.Diagnostic.exceptionTypeIncorrect().format({type:this._evaluator.printType(e)})),R.ClassType.cloneAsInstance(t)):(a.addMessage(m.Localizer.Diagnostic.exceptionTypeIncorrect().format({type:this._evaluator.printType(e)})),R.UnknownType.create())))}return a.isEmpty()||this._evaluator.addError(m.Localizer.Diagnostic.exceptionTypeNotClass().format({type:this._evaluator.printType(e)}),t),o||R.UnknownType.create()}_reportUnusedDunderAllSymbols(e){if("none"===this._fileInfo.diagnosticRuleSet.reportUnsupportedDunderAll)return;const t=f.getScope(this._moduleNode);t&&e.forEach((e=>{t.symbolTable.has(e.value)||this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportUnsupportedDunderAll,c.DiagnosticRule.reportUnsupportedDunderAll,m.Localizer.Diagnostic.dunderAllSymbolNotPresent().format({name:e.value}),e)}))}_validateSymbolTables(){var e;const t=null===(e=this._dependentFiles)||void 0===e?void 0:e.map((e=>f.getFileInfo(e.parseTree)));for(const e of this._scopedNodes){const n=f.getScope(e);n&&n.symbolTable.forEach(((e,i)=>{this._conditionallyReportUnusedSymbol(i,e,n.type,t),this._reportIncompatibleDeclarations(i,e),this._reportMultipleFinalDeclarations(i,e,n.type),this._reportMultipleTypeAliasDeclarations(i,e),this._reportInvalidOverload(i,e)}))}const n=this._fileInfo.accessedSymbolSet;for(const e of this._typeParameterLists)for(const t of e.parameters){const e=f.getTypeParameterSymbol(t.name);if((0,o.assert)(e),!n.has(e.id)){e.getDeclarations().forEach((e=>{this._conditionallyReportUnusedDeclaration(e,!1)}))}}}_reportInvalidOverload(e,t){const n=t.getTypedDeclarations();if(n.length>=1){const i=n[0];if(5===i.type){const n=this._evaluator.getEffectiveTypeOfSymbol(t),s=(0,R.isOverloadedFunction)(n)?R.OverloadedFunctionType.getOverloads(n):(0,R.isFunction)(n)&&R.FunctionType.isOverloaded(n)?[n]:[];if(1===s.length&&this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportGeneralTypeIssues,c.DiagnosticRule.reportGeneralTypeIssues,m.Localizer.Diagnostic.singleOverload().format({name:e}),i.node.name),s.forEach((t=>{if(t.details.declaration&&!I.isFunctionSuiteEmpty(t.details.declaration.node)){const n=new l.DiagnosticAddendum;n.addMessage(m.Localizer.DiagnosticAddendum.overloadWithImplementation()),this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportGeneralTypeIssues,c.DiagnosticRule.reportGeneralTypeIssues,m.Localizer.Diagnostic.overloadWithImplementation().format({name:e})+n.getString(),t.details.declaration.node.name)}})),!this._fileInfo.isStubFile&&s.length>0){let t;if((0,R.isOverloadedFunction)(n)&&R.OverloadedFunctionType.getImplementation(n)?t=R.OverloadedFunctionType.getImplementation(n):(0,R.isFunction)(n)&&!R.FunctionType.isOverloaded(n)&&(t=n),t)(0,R.isOverloadedFunction)(n)&&R.OverloadedFunctionType.getOverloads(n).forEach(((n,s)=>{var r,a,o,p;const d=new l.DiagnosticAddendum;if(!this._isLegalOverloadImplementation(n,t,d)&&t.details.declaration){const l=this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportGeneralTypeIssues,c.DiagnosticRule.reportGeneralTypeIssues,m.Localizer.Diagnostic.overloadImplementationMismatch().format({name:e,index:s+1})+d.getString(),t.details.declaration.node.name);l&&n.details.declaration&&l.addRelatedInfo(m.Localizer.DiagnosticAddendum.overloadSignature(),null!==(a=null===(r=n.details.declaration)||void 0===r?void 0:r.path)&&void 0!==a?a:i.path,null!==(p=null===(o=n.details.declaration)||void 0===o?void 0:o.range)&&void 0!==p?p:i.range)}}));else{let e=!1;const t=I.getEnclosingClassOrFunction(i.node);if(t&&10===t.nodeType){const n=this._evaluator.getTypeOfClass(t);n&&R.ClassType.isProtocolClass(n.classType)&&(e=!0)}e||this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportGeneralTypeIssues,c.DiagnosticRule.reportGeneralTypeIssues,m.Localizer.Diagnostic.overloadWithoutImplementation().format({name:i.node.name.value}),i.node.name)}}}}}_reportMultipleFinalDeclarations(e,t,n){if(!this._evaluator.isFinalVariable(t))return;const i=t.getDeclarations();let s=!1,r=!1;if(i.forEach((t=>{this._evaluator.isFinalVariableDeclaration(t)&&(s&&this._evaluator.addError(m.Localizer.Diagnostic.finalRedeclaration().format({name:e}),t.node),s=!0),1===t.type&&t.inferredTypeSource&&(r&&2!==n&&this._evaluator.addError(m.Localizer.Diagnostic.finalReassigned().format({name:e}),t.node),r=!0)})),!r&&!this._fileInfo.isStubFile){const n=i.find((e=>1===e.type&&e.isFinal));if(n){let i=!1;if(t.isClassMember()&&!t.isClassVar()){const e=I.getEnclosingClass(n.node,!0);if(e){const t=this._evaluator.getTypeOfClass(e);t&&(0,R.isClass)(t.decoratedType)&&R.ClassType.isDataClass(t.decoratedType)&&(i=!0)}}i||this._evaluator.addError(m.Localizer.Diagnostic.finalUnassigned().format({name:e}),n.node)}}}_reportMultipleTypeAliasDeclarations(e,t){const n=t.getDeclarations(),i=n.find((e=>this._evaluator.isExplicitTypeAliasDeclaration(e)));i&&n.length>1&&n.forEach((t=>{t!==i&&this._evaluator.addError(m.Localizer.Diagnostic.typeAliasRedeclared().format({name:e}),t.node)}))}_reportIncompatibleDeclarations(e,t){var n,i,s,r;const a=(0,k.getLastTypedDeclaredForSymbol)(t);if(!a)return;if("_"===e)return;let o,l=t.getDeclarations().filter((e=>e!==a));if(5===a.type){const e=this._evaluator.getTypeOfFunction(a.node);l=l.filter((t=>{if(5!==t.type)return!0;const n=this._evaluator.getTypeOfFunction(t.node);if(!n)return!0;const i=e?this._evaluator.makeTopLevelTypeVarsConcrete(e.decoratedType):void 0;return i&&(0,R.isClassInstance)(i)&&R.ClassType.isPropertyClass(i)&&(0,R.isClassInstance)(n.decoratedType)&&R.ClassType.isPropertyClass(n.decoratedType)?n.decoratedType.details.typeSourceId!==i.details.typeSourceId:!R.FunctionType.isOverloaded(n.functionType)}))}if(0===l.length)return;o=5===a.type?a.isMethod?m.Localizer.DiagnosticAddendum.seeMethodDeclaration():m.Localizer.DiagnosticAddendum.seeFunctionDeclaration():6===a.type?m.Localizer.DiagnosticAddendum.seeClassDeclaration():2===a.type?m.Localizer.DiagnosticAddendum.seeParameterDeclaration():1===a.type?m.Localizer.DiagnosticAddendum.seeVariableDeclaration():4===a.type?m.Localizer.DiagnosticAddendum.seeTypeAliasDeclaration():m.Localizer.DiagnosticAddendum.seeDeclaration();const p=e=>{if(e){let t;5===a.type||6===a.type?t=a.node.name:1===a.type?38===a.node.nodeType&&(t=a.node):2!==a.type&&3!==a.type||a.node.name&&(t=a.node.name),t&&e.addRelatedInfo(o,a.path,a.range)}};for(const t of l)if(6===t.type){let n=!1;if(3===a.type&&(n=!0),!n){p(this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportGeneralTypeIssues,c.DiagnosticRule.reportGeneralTypeIssues,m.Localizer.Diagnostic.obscuredClassDeclaration().format({name:e}),t.node.name))}}else if(5===t.type){const s=null===(n=this._evaluator.getTypeForDeclaration(a))||void 0===n?void 0:n.type;let r=!1;s&&(0,R.isFunction)(s)&&this._evaluator.getFunctionInferredReturnType(s);const o=null===(i=this._evaluator.getTypeForDeclaration(t))||void 0===i?void 0:i.type,l=I.getEnclosingSuite(a.node)===I.getEnclosingSuite(t.node);if(o&&(0,R.isFunction)(o)&&this._evaluator.getFunctionInferredReturnType(o),!l&&s&&o&&(0,R.isTypeSame)(s,o)&&(r=!0),3===a.type&&(r=!0),!r){p(this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportGeneralTypeIssues,c.DiagnosticRule.reportGeneralTypeIssues,t.isMethod?m.Localizer.Diagnostic.obscuredMethodDeclaration().format({name:e}):m.Localizer.Diagnostic.obscuredFunctionDeclaration().format({name:e}),t.node.name))}}else if(2===t.type){if(t.node.name){let n=!1;if(3===a.type&&(n=!0),!n){const n=m.Localizer.Diagnostic.obscuredParameterDeclaration();p(this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportGeneralTypeIssues,c.DiagnosticRule.reportGeneralTypeIssues,n.format({name:e}),t.node.name))}}}else if(1===t.type){const n=null===(s=this._evaluator.getTypeForDeclaration(a))||void 0===s?void 0:s.type;if(t.typeAnnotationNode&&38===t.node.nodeType){let i=!1;const s=null===(r=this._evaluator.getTypeForDeclaration(t))||void 0===r?void 0:r.type;if(n&&s&&(0,R.isTypeSame)(n,s)&&(i=!0),3===a.type&&(i=!0),!i){p(this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportGeneralTypeIssues,c.DiagnosticRule.reportGeneralTypeIssues,m.Localizer.Diagnostic.obscuredVariableDeclaration().format({name:e}),t.node))}}}else if(4===t.type){p(this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportGeneralTypeIssues,c.DiagnosticRule.reportGeneralTypeIssues,m.Localizer.Diagnostic.obscuredTypeAliasDeclaration().format({name:e}),t.node.name))}}_conditionallyReportUnusedSymbol(e,t,n,i){const s=this._fileInfo.accessedSymbolSet;if(t.isIgnoredForProtocolMatch()||s.has(t.id))return;if(i&&i.some((e=>e.accessedSymbolSet.has(t.id))))return;if("_"===e)return;if(A.isDunderName(e))return;t.getDeclarations().forEach((t=>{this._conditionallyReportUnusedDeclaration(t,this._isSymbolPrivate(e,n))}))}_conditionallyReportUnusedDeclaration(e,t){var n;let i,s,r,a;switch(e.type){case 8:if(i=this._fileInfo.diagnosticRuleSet.reportUnusedImport,a=c.DiagnosticRule.reportUnusedImport,21===e.node.nodeType)if(e.node.alias)e.node.alias.value!==e.moduleName&&(s=e.node.alias);else{const t=e.node.module.nameParts;if(t.length>0){const e=t.map((e=>e.value)).join("."),n={start:t[0].start,length:t[0].length};return u.TextRange.extend(n,t[t.length-1]),this._fileInfo.diagnosticSink.addUnusedCodeWithTextRange(m.Localizer.Diagnostic.unaccessedSymbol().format({name:e}),n,{action:"pyright.unusedImport"}),void this._evaluator.addDiagnosticForTextRange(this._fileInfo,this._fileInfo.diagnosticRuleSet.reportUnusedImport,c.DiagnosticRule.reportUnusedImport,m.Localizer.Diagnostic.unaccessedImport().format({name:e}),n)}}else if(23===e.node.nodeType){const t=e.node.parent,i=(null===(n=e.node.alias)||void 0===n?void 0:n.value)===e.node.name.value,r=1===t.module.nameParts.length&&"__future__"===t.module.nameParts[0].value;i||r||(s=e.node.alias||e.node.name)}s&&(r=m.Localizer.Diagnostic.unaccessedImport().format({name:s.value}));break;case 4:case 1:case 2:if(!t)return;if(this._fileInfo.isStubFile)return;i=this._fileInfo.diagnosticRuleSet.reportUnusedVariable,38===e.node.nodeType?(s=e.node,s.value.startsWith("_")&&(i="none")):41===e.node.nodeType&&(s=e.node.name,i="none"),s&&(a=c.DiagnosticRule.reportUnusedVariable,r=m.Localizer.Diagnostic.unaccessedVariable().format({name:s.value}));break;case 6:if(!t)return;if(this._fileInfo.isStubFile)return;i=this._fileInfo.diagnosticRuleSet.reportUnusedClass,s=e.node.name,a=c.DiagnosticRule.reportUnusedClass,r=m.Localizer.Diagnostic.unaccessedClass().format({name:s.value});break;case 5:if(!t)return;if(this._fileInfo.isStubFile)return;i=this._fileInfo.diagnosticRuleSet.reportUnusedFunction,s=e.node.name,a=c.DiagnosticRule.reportUnusedFunction,r=m.Localizer.Diagnostic.unaccessedFunction().format({name:s.value});break;case 3:i="none",s=e.node.name;break;case 0:case 7:return;default:(0,o.assertNever)(e)}const l=a===c.DiagnosticRule.reportUnusedImport?{action:"pyright.unusedImport"}:void 0;s&&(this._fileInfo.diagnosticSink.addUnusedCodeWithTextRange(m.Localizer.Diagnostic.unaccessedSymbol().format({name:s.value}),s,l),void 0!==a&&r&&this._evaluator.addDiagnostic(i,a,r,s))}_validateIsInstanceCall(e){if(38!==e.leftExpression.nodeType||"isinstance"!==e.leftExpression.value&&"issubclass"!==e.leftExpression.value||2!==e.arguments.length)return;const t=e.leftExpression.value,n="isinstance"===t;let i=this._evaluator.getType(e.arguments[0].valueExpression);if(!i)return;i=(0,O.mapSubtypes)(i,(e=>(0,O.transformPossibleRecursiveTypeAlias)(e)));const s=this._evaluator.getType(e.arguments[1].valueExpression);if(!s)return;let r=!0;if((0,O.doForEachSubtype)(s,(e=>{(0,R.isClassInstance)(e)&&R.ClassType.isTupleClass(e)&&e.tupleTypeArguments?e.tupleTypeArguments.some((e=>!this._isTypeSupportedTypeForIsInstance(e.type,n)))&&(r=!1):this._isTypeSupportedTypeForIsInstance(e,n)||(r=!1)})),!r){const t=new l.DiagnosticAddendum;t.addMessage(m.Localizer.DiagnosticAddendum.typeVarNotAllowed()),this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportGeneralTypeIssues,c.DiagnosticRule.reportGeneralTypeIssues,n?m.Localizer.Diagnostic.isInstanceInvalidType().format({type:this._evaluator.printType(s)})+t.getString():m.Localizer.Diagnostic.isSubclassInvalidType().format({type:this._evaluator.printType(s)})+t.getString(),e.arguments[1])}let a=e;for(;a;){if(2===a.nodeType)return;a=a.parent}const o=["FunctionType","LambdaType","BuiltinFunctionType","BuiltinMethodType","type","Type"],p=[];let d=!1;if((0,O.doForEachSubtype)(s,(e=>{(0,R.isClass)(e)?R.TypeBase.isInstantiable(e)?void 0===e.literalValue&&(p.push(e),R.ClassType.isBuiltIn(e)&&o.some((t=>t===e.details.name))&&(r=!1),e.includeSubclasses&&(d=!0)):((0,O.isTupleClass)(e)?e.tupleTypeArguments&&e.tupleTypeArguments.forEach((e=>{(0,R.isInstantiableClass)(e.type)?(p.push(e.type),e.type.includeSubclasses&&(d=!0)):r=!1})):e.includeSubclasses&&(d=!0),R.ClassType.isBuiltIn(e)&&o.some((t=>t===e.details.name))&&(r=!1)):r=!1})),!r)return;if(p.some((e=>R.ClassType.isProtocolClass(e)&&!R.ClassType.isRuntimeCheckable(e)))&&this._evaluator.addError(m.Localizer.Diagnostic.protocolUsedInCall().format({name:t}),e.arguments[1].valueExpression),(0,O.derivesFromAnyOrUnknown)(i))return;const u=e=>(0,R.combineTypes)(e),y=e=>{const t=[];for(const i of p){const s=(0,N.isIsinstanceFilterSuperclass)(this._evaluator,e,i,i,n),r=(0,N.isIsinstanceFilterSubclass)(this._evaluator,e,i,i,n);r&&r&&!R.ClassType.isSameGenericClass(e,i)?t.push(R.UnknownType.create()):s?t.push(e):r&&t.push(i)}return n?t.map((e=>(0,R.isInstantiableClass)(e)?R.ClassType.cloneAsInstance(e):e)):t};let h;if(n&&(0,R.isClassInstance)(i)){h=u(y(R.ClassType.cloneAsInstantiable(i)))}else if(!n&&(0,R.isInstantiableClass)(i)){h=u(y(i))}else{if(!(0,R.isUnion)(i))return;{let e=[],t=!1;if((0,O.doForEachSubtype)(i,(i=>{(0,R.isAnyOrUnknown)(i)&&(t=!0),n&&(0,R.isClassInstance)(i)?e=e.concat(y(R.ClassType.cloneAsInstantiable(i))):!n&&(0,R.isInstantiableClass)(i)&&(e=e.concat(y(i)))})),h=u(e),t)return}}const g=()=>{const e=p.map((e=>R.ClassType.cloneAsInstance(e)));return(0,R.combineTypes)(e)};!d&&(0,R.isTypeSame)(h,i,{ignorePseudoGeneric:!0})&&this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportUnnecessaryIsInstance,c.DiagnosticRule.reportUnnecessaryIsInstance,n?m.Localizer.Diagnostic.unnecessaryIsInstanceAlways().format({testType:this._evaluator.printType(i),classType:this._evaluator.printType(g())}):m.Localizer.Diagnostic.unnecessaryIsSubclassAlways().format({testType:this._evaluator.printType(i),classType:this._evaluator.printType(g())}),e)}_isTypeSupportedTypeForIsInstance(e,t){let n=!0;return(0,O.doForEachSubtype)(e,(e=>{switch(e=this._evaluator.makeTopLevelTypeVarsConcrete(e),(e=(0,O.transformPossibleRecursiveTypeAlias)(e)).category){case 2:case 1:case 0:break;case 7:e.isTypeArgumentExplicit&&!e.includeSubclasses&&(n=!1);break;case 3:n=!!t&&R.TypeBase.isInstantiable(e);break;case 5:n=R.TypeBase.isInstantiable(e);break;case 9:n=this._isTypeSupportedTypeForIsInstance(e,t);break;default:n=!1}})),n}_isSymbolPrivate(e,t){if(1===t||0===t)return!0;if(A.isPrivateName(e))return!0;if(A.isProtectedName(e)){return!(2===t)}return!1}_reportDeprecatedUse(e,t){if(!t)return;let n,i;function s(t,s){const r=I.getCallForName(e);if(r){const a=t.getTypeResult(r);a&&a.overloadsUsedForCall&&a.overloadsUsedForCall.length>0&&a.overloadsUsedForCall.forEach((t=>{void 0!==t.details.deprecatedMessage&&(e.value===t.details.name?(i=t.details.deprecatedMessage,n=m.Localizer.Diagnostic.deprecatedFunction().format({name:t.details.name})):(0,R.isInstantiableClass)(s)&&"__init__"===t.details.name&&(i=t.details.deprecatedMessage,n=m.Localizer.Diagnostic.deprecatedConstructor().format({name:s.details.name})))}))}}if((0,O.doForEachSubtype)(t,(t=>{(0,R.isClass)(t)?t.includeSubclasses||void 0===t.details.deprecatedMessage||e.value!==t.details.name?s(this._evaluator,t):(i=t.details.deprecatedMessage,n=m.Localizer.Diagnostic.deprecatedClass().format({name:t.details.name})):(0,R.isFunction)(t)?void 0!==t.details.deprecatedMessage&&e.value===t.details.name&&(i=t.details.deprecatedMessage,n=m.Localizer.Diagnostic.deprecatedFunction().format({name:t.details.name||"<anonymous>"})):(0,R.isOverloadedFunction)(t)&&s(this._evaluator,t)})),n){const t=new l.DiagnosticAddendum;i&&t.addMessage(i),"none"===this._fileInfo.diagnosticRuleSet.reportDeprecated?this._evaluator.addDeprecated(n+t.getString(),e):this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportDeprecated,c.DiagnosticRule.reportDeprecated,n+t.getString(),e)}}_reportUnboundName(e){if("none"!==this._fileInfo.diagnosticRuleSet.reportUnboundVariable&&!f.isCodeUnreachable(e)){const t=this._evaluator.getType(e);t&&((0,R.isUnbound)(t)?this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportUnboundVariable,c.DiagnosticRule.reportUnboundVariable,m.Localizer.Diagnostic.symbolIsUnbound().format({name:e.value}),e):(0,R.isPossiblyUnbound)(t)&&this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportUnboundVariable,c.DiagnosticRule.reportUnboundVariable,m.Localizer.Diagnostic.symbolIsPossiblyUnbound().format({name:e.value}),e))}}_conditionallyReportShadowedModule(){if("none"===this._fileInfo.diagnosticRuleSet.reportShadowedImports)return;const e=this._fileInfo.moduleName,t={nameParts:e.split("."),leadingDots:0,importedSymbols:[]};if(this._importResolver.getTypeshedStdLibPath(this._fileInfo.executionEnvironment)&&this._importResolver.isStdlibModule(t,this._fileInfo.executionEnvironment)&&this._sourceMapper.isUserCode(this._fileInfo.filePath)){const t=this._evaluator.addDiagnosticForTextRange(this._fileInfo,this._fileInfo.diagnosticRuleSet.reportShadowedImports,c.DiagnosticRule.reportShadowedImports,m.Localizer.Diagnostic.stdlibModuleOverridden().format({name:e,path:this._fileInfo.filePath}),this._moduleNode);if(t){const e={action:"renameShadowedFile",oldFile:this._fileInfo.filePath,newFile:this._sourceMapper.getNextFileName(this._fileInfo.filePath)};t.addAction(e)}}}_conditionallyReportShadowedImport(e){var t,n;if("none"===this._fileInfo.diagnosticRuleSet.reportShadowedImports)return;const i=23===e.nodeType?22===(null===(t=e.parent)||void 0===t?void 0:t.nodeType)?null===(n=e.parent)||void 0===n?void 0:n.module:void 0:e.module;if(null==i?void 0:i.leadingDots)return;const s=21===e.nodeType?e.module.nameParts:23===e.nodeType?[e.name]:e.module.nameParts,r=s.map((e=>e.value)),o={nameParts:r,leadingDots:0,importedSymbols:[]},l=this._importResolver.getTypeshedStdLibPath(this._fileInfo.executionEnvironment);if(l&&this._importResolver.isStdlibModule(o,this._fileInfo.executionEnvironment)){const t=y.DefinitionProvider.getDefinitionsForNode(this._sourceMapper,this._evaluator,s[s.length-1],s[s.length-1].start,a.CancellationToken.None);(t?t.map((e=>e.path)):[]).forEach((t=>{if(!t.startsWith(l)&&!(0,P.isStubFile)(t)&&this._sourceMapper.isUserCode(t)){const n=this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportShadowedImports,c.DiagnosticRule.reportShadowedImports,m.Localizer.Diagnostic.stdlibModuleOverridden().format({name:r.join("."),path:t}),e);if(n){const e={action:"renameShadowedFile",oldFile:t,newFile:this._sourceMapper.getNextFileName(t)};n.addAction(e)}}}))}}_conditionallyReportPrivateUsage(e){var t;if("none"===this._fileInfo.diagnosticRuleSet.reportPrivateUsage)return;if(this._fileInfo.isStubFile)return;if(1===(null===(t=e.parent)||void 0===t?void 0:t.nodeType)&&e.parent.name===e)return;const n=e.value,i=A.isPrivateName(n),s=A.isProtectedName(n);if(!i&&!s)return;const r=this._evaluator.getDeclarationsForNameNode(e);let a,o=r&&r.length>0?r[r.length-1]:void 0;if(!o||o.node===e)return;if(8===o.type){if(o.usesLocalName)return;const e=this._evaluator.resolveAliasDeclarationWithInfo(o,!0);if(!e)return;if(o=e.declaration,!e.isPrivate)return}if(!o||o.node===e)return;o.node&&(a=I.getEnclosingClass(o.node)),o.node&&o.node.parent&&o.node.parent===a&&(a=I.getEnclosingClass(a));let l=!1;if(a&&s){const t=this._evaluator.getTypeOfClass(a);if(t&&(0,R.isInstantiableClass)(t.decoratedType)){if(R.ClassType.isDefinedInStub(t.decoratedType))return;l=!0;const n=I.getEnclosingClass(e);if(n){const e=this._evaluator.getTypeOfClass(n);if(e&&(0,R.isInstantiableClass)(e.decoratedType)&&(0,O.derivesFromClassRecursive)(e.decoratedType,t.decoratedType,!0))return}}}a&&!I.isNodeContainedWithin(e,a)&&(l?this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportPrivateUsage,c.DiagnosticRule.reportPrivateUsage,m.Localizer.Diagnostic.protectedUsedOutsideOfClass().format({name:n}),e):this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportPrivateUsage,c.DiagnosticRule.reportPrivateUsage,m.Localizer.Diagnostic.privateUsedOutsideOfClass().format({name:n}),e))}_validateEnumClassOverride(e,t){t.details.baseClasses.forEach(((t,n)=>{if((0,R.isClass)(t)&&R.ClassType.isEnumClass(t)){let i=!1;t.details.fields.forEach((e=>{const n=this._evaluator.getEffectiveTypeOfSymbol(e);(0,R.isClassInstance)(n)&&R.ClassType.isSameGenericClass(n,t)&&(i=!0)})),i&&this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportGeneralTypeIssues,c.DiagnosticRule.reportGeneralTypeIssues,m.Localizer.Diagnostic.enumClassOverride().format({name:t.details.name}),e.arguments[n])}}))}_validateTypedDictClassSuite(e){const t=e=>{this._evaluator.addError(m.Localizer.Diagnostic.typedDictBadVar(),e)};e.statements.forEach((e=>{if(!f.isCodeUnreachable(e))if(47===e.nodeType)for(const n of e.statements)54!==n.nodeType&&18!==n.nodeType&&48!==n.nodeType&&42!==n.nodeType&&t(n);else t(e)}))}_validateTypeGuardFunction(e,t,n){var i;const s=t.details.declaredReturnType;if(!s)return;if(!(0,R.isClassInstance)(s)||!s.typeArguments||s.typeArguments.length<1)return;const r=R.ClassType.isBuiltIn(s,"TypeGuard"),a=R.ClassType.isBuiltIn(s,"StrictTypeGuard");if(!r&&!a)return;let o=t.details.parameters.length;if(n&&(R.FunctionType.isInstanceMethod(t)||R.FunctionType.isConstructorMethod(t)||R.FunctionType.isClassMethod(t))&&o--,o<1&&this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportGeneralTypeIssues,c.DiagnosticRule.reportGeneralTypeIssues,m.Localizer.Diagnostic.typeGuardParamCount(),e.name),a){const r=s.typeArguments[0],a=n&&!R.FunctionType.isStaticMethod(t)?1:0;if(a>=t.details.parameters.length)return;const o=R.FunctionType.getEffectiveParameterType(t,a);if(!this._evaluator.assignType(o,r)){const t=e.returnTypeAnnotation||(null===(i=e.functionAnnotationComment)||void 0===i?void 0:i.returnTypeAnnotation);t&&this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportGeneralTypeIssues,c.DiagnosticRule.reportGeneralTypeIssues,m.Localizer.Diagnostic.strictTypeGuardReturnType().format({type:this._evaluator.printType(o),returnType:this._evaluator.printType(r)}),t)}}}_validateDunderSignatures(e,t,n){var i;const s=t.details.name;if(n&&"__init__"===s){const n=e.returnTypeAnnotation||(null===(i=e.functionAnnotationComment)||void 0===i?void 0:i.returnTypeAnnotation),s=t.details.declaredReturnType;if(n&&s)(0,R.isNoneInstance)(s)||(0,R.isNever)(s)||this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportGeneralTypeIssues,c.DiagnosticRule.reportGeneralTypeIssues,m.Localizer.Diagnostic.initMustReturnNone(),n);else{const n=this._evaluator.getFunctionInferredReturnType(t);(0,R.isNever)(n)||(0,R.isNoneInstance)(n)||(0,R.isAnyOrUnknown)(n)||this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportGeneralTypeIssues,c.DiagnosticRule.reportGeneralTypeIssues,m.Localizer.Diagnostic.initMustReturnNone(),e.name)}}}_validateFunctionReturn(e,t){var n;if(this._fileInfo.isStubFile)return;const i=e.returnTypeAnnotation||(null===(n=e.functionAnnotationComment)||void 0===n?void 0:n.returnTypeAnnotation);if(i){const n=!this._evaluator.isAfterNodeReachable(e),s=this._evaluator.isAfterNodeReachable(e.suite);let r=t.details.declaredReturnType;if(r){(0,R.isUnknown)(r)?this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportUnknownVariableType,c.DiagnosticRule.reportUnknownVariableType,m.Localizer.Diagnostic.declaredReturnTypeUnknown(),i):(0,O.isPartlyUnknown)(r)&&this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportUnknownVariableType,c.DiagnosticRule.reportUnknownVariableType,m.Localizer.Diagnostic.declaredReturnTypePartiallyUnknown().format({returnType:this._evaluator.printType(r,{expandTypeAlias:!0})}),i);const e=new l.DiagnosticAddendum;(0,R.isTypeVar)(r)&&4===r.details.declaredVariance&&(e.addMessage(m.Localizer.DiagnosticAddendum.typeVarIsContravariant().format({name:R.TypeVarType.getReadableName(r)})),this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportGeneralTypeIssues,c.DiagnosticRule.reportGeneralTypeIssues,m.Localizer.Diagnostic.returnTypeContravariant()+e.getString(),i))}if(R.FunctionType.isGenerator(t)&&(r=(0,O.getDeclaredGeneratorReturnType)(t)),r&&!n&&s)if((0,R.isNever)(r))I.isSuiteEmpty(e.suite)||R.FunctionType.isOverloaded(t)||this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportGeneralTypeIssues,c.DiagnosticRule.reportGeneralTypeIssues,m.Localizer.Diagnostic.noReturnReturnsNone(),i);else if(!R.FunctionType.isAbstractMethod(t)){const n=new l.DiagnosticAddendum;this._evaluator.assignType(r,R.NoneType.createInstance(),n)||I.isSuiteEmpty(e.suite)||R.FunctionType.isOverloaded(t)||this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportGeneralTypeIssues,c.DiagnosticRule.reportGeneralTypeIssues,m.Localizer.Diagnostic.returnMissing().format({returnType:this._evaluator.printType(r)})+n.getString(),i)}}else{const n=this._evaluator.getFunctionInferredReturnType(t);(0,R.isUnknown)(n)?this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportUnknownParameterType,c.DiagnosticRule.reportUnknownParameterType,m.Localizer.Diagnostic.returnTypeUnknown(),e.name):(0,O.isPartlyUnknown)(n)&&this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportUnknownParameterType,c.DiagnosticRule.reportUnknownParameterType,m.Localizer.Diagnostic.returnTypePartiallyUnknown().format({returnType:this._evaluator.printType(n,{expandTypeAlias:!0})}),e.name)}}_validateFinalMemberOverrides(e){e.details.fields.forEach(((t,n)=>{const i=(0,O.lookUpClassMember)(e,n,1);if(i&&(0,R.isInstantiableClass)(i.classType)&&this._evaluator.isFinalVariable(i.symbol)&&!A.isPrivateName(n)){const e=t.getDeclarations()[0];this._evaluator.addError(m.Localizer.Diagnostic.finalRedeclarationBySubclass().format({name:n,className:i.classType.details.name}),e.node)}}))}_reportDuplicateEnumMembers(e){R.ClassType.isEnumClass(e)&&!R.ClassType.isBuiltIn(e)&&e.details.fields.forEach(((t,n)=>{if(t.getTypedDeclarations().length>0)return;const i=t.getDeclarations();if(i.length>=2&&1===i[0].type){const s=this._evaluator.getEffectiveTypeOfSymbol(t);(0,R.isClassInstance)(s)&&R.ClassType.isSameGenericClass(s,e)&&void 0!==s.literalValue&&this._evaluator.addError(m.Localizer.Diagnostic.duplicateEnumMember().format({name:n}),i[1].node)}}))}_validateProtocolCompatibility(e,t){if(R.ClassType.isProtocolClass(e))return;const n=new l.DiagnosticAddendum,i=t=>e.details.mro.some((e=>(0,R.isClass)(e)&&!R.ClassType.isProtocolClass(e)&&e.details.fields.has(t)));e.details.baseClasses.forEach((e=>{if(!(0,R.isClass)(e)||!R.ClassType.isProtocolClass(e))return;(0,O.getProtocolSymbols)(e).forEach(((e,t)=>{const s=e.symbol.getDeclarations();0!==s.length&&(0,R.isClass)(e.classType)&&(1===s[0].type?s.some((e=>1===e.type&&!!e.inferredTypeSource))||i(t)||n.addMessage(m.Localizer.DiagnosticAddendum.missingProtocolMember().format({name:t,classType:e.classType.details.name})):5===s[0].type&&s.every((e=>5!==e.type||I.isSuiteEmpty(e.node.suite)))&&".pyi"!==(0,p.getFileExtension)(s[0].path).toLowerCase()&&(i(t)||n.addMessage(m.Localizer.DiagnosticAddendum.missingProtocolMember().format({name:t,classType:e.classType.details.name}))))}))})),n.isEmpty()||this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportGeneralTypeIssues,c.DiagnosticRule.reportGeneralTypeIssues,m.Localizer.Diagnostic.missingProtocolMembers()+n.getString(),t.name)}_validateDataClassPostInit(e,t){if(!R.ClassType.isDataClass(e))return;const n=(0,O.lookUpClassMember)(e,"__post_init__",18);if(!n)return;if(R.ClassType.derivesFromAnyOrUnknown(e))return;const i=new Map;R.ClassType.getReverseMro(e).forEach((e=>{(0,R.isClass)(e)&&R.ClassType.isDataClass(e)&&e.details.fields.forEach(((e,t)=>{e.isInitVar()&&i.set(t,e)}))}));const s=this._evaluator.getTypeOfMember(n);if(!(0,R.isFunction)(s)||!R.FunctionType.isInstanceMethod(s)||!s.details.declaration)return;const r=(0,b.getParameterListDetails)(s);if(void 0!==r.argsIndex||void 0!==r.kwargsIndex||void 0!==r.firstKeywordOnlyIndex)return;const a=r.params.filter((e=>!e.param.hasDefault)),o=i.size+1;(o<a.length||o>r.params.length)&&this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportGeneralTypeIssues,c.DiagnosticRule.reportGeneralTypeIssues,m.Localizer.Diagnostic.dataClassPostInitParamCount().format({expected:i.size}),s.details.declaration.node.name);let p=1;i.forEach(((e,t)=>{var n;if(p>=r.params.length)return;const i=r.params[p].param;if(i.hasDeclaredType&&i.typeAnnotation){const a=null===(n=this._evaluator.getDeclaredTypeOfSymbol(e))||void 0===n?void 0:n.type,o=R.FunctionType.getEffectiveParameterType(s,r.params[p].index),d=new l.DiagnosticAddendum;if(a&&!this._evaluator.assignType(o,a,d)){const n=this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportGeneralTypeIssues,c.DiagnosticRule.reportGeneralTypeIssues,m.Localizer.Diagnostic.dataClassPostInitType().format({fieldName:t})+d.getString(),i.typeAnnotation);if(n){const t=e.getTypedDeclarations();t.length>0&&n.addRelatedInfo(m.Localizer.DiagnosticAddendum.dataClassFieldLocation(),t[0].path,t[0].range)}}}p++}))}_validateFinalClassNotAbstract(e,t){if(!R.ClassType.isFinal(e))return;if(!R.ClassType.supportsAbstractMethods(e))return;const n=this._evaluator.getAbstractMethods(e);if(0===n.length)return;const i=new l.DiagnosticAddendum;n.forEach(((e,t)=>{if(2===t)i.addMessage(m.Localizer.DiagnosticAddendum.memberIsAbstractMore().format({count:n.length-2}));else if(t<2&&(0,R.isInstantiableClass)(e.classType)){const t=e.classType.details.name;i.addMessage(m.Localizer.DiagnosticAddendum.memberIsAbstract().format({type:t,name:e.symbolName}))}})),this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportGeneralTypeIssues,c.DiagnosticRule.reportGeneralTypeIssues,m.Localizer.Diagnostic.finalClassIsAbstract().format({type:e.details.name})+i.getString(),t.name)}_validateInstanceVariableInitialization(e){this._fileInfo.isStubFile||"none"!==this._fileInfo.diagnosticRuleSet.reportUninitializedInstanceVariable&&(R.ClassType.isProtocolClass(e)||R.ClassType.supportsAbstractMethods(e)&&!R.ClassType.isFinal(e)||e.details.fields.forEach(((t,n)=>{if(!t.isInstanceMember())return;const i=t.getDeclarations();if(i.find((t=>{var n,i,s;const r=I.getEnclosingClassOrFunction(t.node);if(!r)return!0;if(10===r.nodeType){if(3===(null===(n=t.node.parent)||void 0===n?void 0:n.nodeType))return!0;if(54===(null===(i=t.node.parent)||void 0===i?void 0:i.nodeType)&&3===(null===(s=t.node.parent.parent)||void 0===s?void 0:s.nodeType))return!0;if(R.ClassType.isDataClass(e))return!0;if(R.ClassType.isTypedDictClass(e))return!0}return"__init__"===r.name.value})))return;(0,O.lookUpClassMember)(e,n,1)||this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportUninitializedInstanceVariable,c.DiagnosticRule.reportUninitializedInstanceVariable,m.Localizer.Diagnostic.uninitializedInstanceVariable().format({name:n}),i[0].node)})))}_validateProtocolTypeParamVariance(e,t){if(0===t.details.typeParameters.length)return;const n=this._evaluator.getBuiltInType(e,"object");if(!(0,R.isInstantiableClass)(n))return;const i=t.details.typeParameters.map((e=>R.TypeVarType.cloneAsInvariant(e))),s=R.ClassType.cloneWithNewTypeParameters(t,i),r=R.ClassType.cloneAsInstance(n),a=R.ClassType.createInstantiable("__varianceDummy","","","",0,0,void 0,void 0);i.forEach(((n,o)=>{if(n.details.isVariadic||n.details.isParamSpec)return;if(0===n.details.declaredVariance)return;const l=i.map(((e,t)=>e.details.isVariadic?e:t===o?r:a)),p=i.map(((e,t)=>t===o||e.details.isVariadic?e:a)),d=R.ClassType.cloneForSpecialization(s,l,!0),u=R.ClassType.cloneForSpecialization(s,p,!0);let y;if(this._evaluator.assignClassToSelf(d,u))y=3;else{y=this._evaluator.assignClassToSelf(u,d)?4:2}if(y!==t.details.typeParameters[o].details.declaredVariance){let i;i=3===y?m.Localizer.Diagnostic.protocolVarianceCovariant().format({variable:n.details.name,class:t.details.name}):4===y?m.Localizer.Diagnostic.protocolVarianceContravariant().format({variable:n.details.name,class:t.details.name}):m.Localizer.Diagnostic.protocolVarianceInvariant().format({variable:n.details.name,class:t.details.name}),this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportInvalidTypeVarUse,c.DiagnosticRule.reportInvalidTypeVarUse,i,e.name)}}))}_validateSlotsClassVarConflict(e){e.details.localSlotsNames&&(R.ClassType.isDataClass(e)||e.details.fields.forEach(((e,t)=>{const n=e.getDeclarations();n.some((e=>1===e.type&&e.isDefinedBySlots))&&n.forEach((e=>{1!==e.type||e.isDefinedBySlots||e.isDefinedByMemberAccess||38===e.node.nodeType&&I.isWriteAccess(e.node)&&this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportGeneralTypeIssues,c.DiagnosticRule.reportGeneralTypeIssues,m.Localizer.Diagnostic.slotsClassVarConflict().format({name:t}),e.node)}))})))}_validateConstructorConsistency(e){const t=(0,O.lookUpClassMember)(e,"__init__",12),n=(0,O.lookUpClassMember)(e,"__new__",12);if(!(t&&n&&(0,R.isClass)(t.classType)&&(0,R.isClass)(n.classType)))return;if(!R.ClassType.isSameGenericClass(n.classType,e)&&!R.ClassType.isSameGenericClass(t.classType,e))return;const i=n.classType.details.effectiveMetaclass;if(i&&(0,R.isClass)(i)&&!R.ClassType.isBuiltIn(i,"type")){if((0,O.lookUpClassMember)(i,"__call__",40))return}let s=this._evaluator.getTypeOfMember(n);if(!(0,R.isFunction)(s)&&!(0,R.isOverloadedFunction)(s))return;if(s=this._evaluator.bindFunctionToClassOrObject(e,s,void 0,void 0,void 0,!0),!s)return;if((0,R.isOverloadedFunction)(s)&&(s=R.OverloadedFunctionType.getImplementation(s),!s))return;let r=this._evaluator.getTypeOfMember(t);if(((0,R.isFunction)(r)||(0,R.isOverloadedFunction)(r))&&(r=this._evaluator.bindFunctionToClassOrObject(R.ClassType.cloneAsInstance(e),r),r&&(!(0,R.isOverloadedFunction)(r)||(r=R.OverloadedFunctionType.getImplementation(r),r))&&(0,R.isFunction)(r)&&(0,R.isFunction)(s)&&!(R.FunctionType.hasDefaultParameters(r)||R.FunctionType.hasDefaultParameters(s)||(r=R.FunctionType.cloneWithNewFlags(r,98304|r.details.flags),s=R.FunctionType.cloneWithNewFlags(s,98304|r.details.flags),this._evaluator.assignType(s,r,void 0,void 0,void 0,32)&&this._evaluator.assignType(r,s,void 0,void 0,void 0,32))))){const i=R.ClassType.isSameGenericClass(t.classType,e),a=(0,k.getLastTypedDeclaredForSymbol)(t.symbol),o=(0,k.getLastTypedDeclaredForSymbol)(n.symbol);if(a&&o){const e=i?a:o,p=28===e.node.nodeType?e.node.name:e.node,d=new l.DiagnosticAddendum,u=this._evaluator.printType(r),y=this._evaluator.printType(s);d.addMessage(m.Localizer.DiagnosticAddendum.initMethodSignature().format({type:u})),d.addMessage(m.Localizer.DiagnosticAddendum.newMethodSignature().format({type:y}));const h=this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportInconsistentConstructor,c.DiagnosticRule.reportInconsistentConstructor,m.Localizer.Diagnostic.constructorParametersMismatch().format({classType:this._evaluator.printType(R.ClassType.cloneAsInstance(i?t.classType:n.classType))})+d.getString(),p);if(h){const e=i?o:a;h.addRelatedInfo((i?m.Localizer.DiagnosticAddendum.newMethodLocation():m.Localizer.DiagnosticAddendum.initMethodLocation()).format({type:this._evaluator.printType(R.ClassType.cloneAsInstance(i?n.classType:t.classType))}),e.path,e.range)}}}}_validateMultipleInheritanceCompatibility(e,t){if("none"===this._fileInfo.diagnosticRuleSet.reportIncompatibleMethodOverride&&"none"===this._fileInfo.diagnosticRuleSet.reportIncompatibleVariableOverride)return;const n=[];if(e.details.baseClasses.forEach((e=>{!(0,R.isClass)(e)||R.ClassType.isBuiltIn(e,"Generic")||R.ClassType.isBuiltIn(e,"Protocol")||n.push(e)})),n.length<2)return;const i=n.map((t=>{const n=e.details.mro.find((e=>(0,R.isClass)(e)&&R.ClassType.isSameGenericClass(e,t)));return n&&(0,R.isClass)(n)?(0,O.getClassFieldsRecursive)(n):new Map})),s=(0,O.getClassFieldsRecursive)(e);for(let n=1;n<i.length;n++){const r=i[n];for(const[n,i]of r){if(A.isDunderName(n)||A.isPrivateName(n))continue;const r=i.classType;if(!(0,R.isClass)(r))continue;const a=s.get(n);if(a){const s=a.classType;if(!(0,R.isClass)(s)||R.ClassType.isSameGenericClass(s,r)||R.ClassType.isSameGenericClass(s,e))continue;this._validateMultipleInheritanceOverride(i,a,e,n,t)}}}}_validateMultipleInheritanceOverride(e,t,n,i,s){if(!(0,R.isClass)(e.classType)||!(0,R.isClass)(t.classType))return;if("_"===i)return;let r=this._evaluator.getEffectiveTypeOfSymbol(e.symbol);r=(0,O.partiallySpecializeType)(r,e.classType);const a=t.symbol;let o=this._evaluator.getEffectiveTypeOfSymbol(a);o=(0,O.partiallySpecializeType)(o,t.classType);const p=n.details.fields.get(i),d=p?this._evaluator.getEffectiveTypeOfSymbol(p):void 0;let u;const y=(0,k.getLastTypedDeclaredForSymbol)(t.symbol),h=(0,k.getLastTypedDeclaredForSymbol)(e.symbol);if((0,R.isFunction)(r)||(0,R.isOverloadedFunction)(r)){const e=new l.DiagnosticAddendum;let t;if((0,R.isFunction)(o))t=o;else if((0,R.isOverloadedFunction)(o)&&(t=R.OverloadedFunctionType.getImplementation(o),!t))return;if(t&&!this._evaluator.validateOverrideMethod(r,t,e,!0)){const r=t.details.declaration;r&&5===r.type&&(u=this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportIncompatibleMethodOverride,c.DiagnosticRule.reportIncompatibleMethodOverride,m.Localizer.Diagnostic.baseClassMethodTypeIncompatible().format({classType:n.details.name,name:i})+e.getString(),s))}}else if((0,O.isProperty)(r)){if(!(0,O.isProperty)(o)&&!(0,R.isAnyOrUnknown)(o)){a.getDeclarations().length>0&&(u=this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportIncompatibleVariableOverride,c.DiagnosticRule.reportIncompatibleVariableOverride,m.Localizer.Diagnostic.baseClassVariableTypeIncompatible().format({classType:n.details.name,name:i}),s))}}else"none"!==this._fileInfo.diagnosticRuleSet.reportIncompatibleVariableOverride&&((0,R.isAnyOrUnknown)(r)||(0,R.isAnyOrUnknown)(o)||this._evaluator.assignType(r,null!=d?d:o)||(u=this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportIncompatibleVariableOverride,c.DiagnosticRule.reportIncompatibleVariableOverride,m.Localizer.Diagnostic.baseClassVariableTypeIncompatible().format({classType:n.details.name,name:i}),s)));u&&y&&h&&(u.addRelatedInfo(m.Localizer.DiagnosticAddendum.baseClassOverriddenType().format({baseClass:this._evaluator.printType((0,O.convertToInstance)(e.classType)),type:this._evaluator.printType(r)}),h.path,h.range),u.addRelatedInfo(m.Localizer.DiagnosticAddendum.baseClassOverridesType().format({baseClass:this._evaluator.printType((0,O.convertToInstance)(t.classType)),type:this._evaluator.printType(o)}),y.path,y.range))}_validateBaseClassOverrides(e){e.details.fields.forEach(((t,n)=>{if(A.isPrivateName(n))return;if(!t.hasTypedDeclarations()&&!this._evaluator.isFinalVariable(t))return;const i=this._evaluator.getEffectiveTypeOfSymbol(t);if((0,R.isAnyOrUnknown)(i))return;let s;for(const r of e.details.baseClasses){if(!(0,R.isClass)(r))continue;const a=e.details.mro.find((e=>(0,R.isClass)(e)&&R.ClassType.isSameGenericClass(e,r)));if(!a)continue;const o=(0,O.lookUpClassMember)(a,n,0);o&&(s=null!=s?s:o,this._validateBaseClassOverride(o,t,i,e,n))}s?this._validateOverrideDecoratorPresent(i,s):this._validateOverrideDecoratorNotPresent(i)}))}_validateOverrideDecoratorPresent(e,t){var n;if("none"===this._fileInfo.diagnosticRuleSet.reportImplicitOverride)return;let i;if((0,R.isFunction)(e))i=e;else if((0,R.isOverloadedFunction)(e))i=R.OverloadedFunctionType.getImplementation(e);else if((0,R.isClassInstance)(e)&&R.ClassType.isPropertyClass(e)){const t=e.details.fields.get("fget");if(t){const e=null===(n=this._evaluator.getDeclaredTypeOfSymbol(t))||void 0===n?void 0:n.type;e&&(0,R.isFunction)(e)&&(i=e)}}if(!(null==i?void 0:i.details.declaration)||R.FunctionType.isOverridden(i))return;if("__init__"===i.details.name||"__new__"===i.details.name)return;const s=i.details.declaration.node;this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportImplicitOverride,c.DiagnosticRule.reportImplicitOverride,m.Localizer.Diagnostic.overrideDecoratorMissing().format({name:s.name.value,className:this._evaluator.printType((0,O.convertToInstance)(t.classType))}),s.name)}_validateOverrideDecoratorNotPresent(e){var t;let n;if((0,R.isFunction)(e))n=e;else if((0,R.isOverloadedFunction)(e))n=R.OverloadedFunctionType.getImplementation(e);else if((0,R.isClassInstance)(e)&&R.ClassType.isPropertyClass(e)){const i=e.details.fields.get("fget");if(i){const e=null===(t=this._evaluator.getDeclaredTypeOfSymbol(i))||void 0===t?void 0:t.type;e&&(0,R.isFunction)(e)&&(n=e)}}if(!(null==n?void 0:n.details.declaration)||!R.FunctionType.isOverridden(n))return;const i=n.details.declaration.node;this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportGeneralTypeIssues,c.DiagnosticRule.reportGeneralTypeIssues,m.Localizer.Diagnostic.overriddenMethodNotFound().format({name:i.name.value}),i.name)}_validateBaseClassOverride(e,t,n,i,s){if(!(0,R.isInstantiableClass)(e.classType))return;if(!e.symbol.hasTypedDeclarations())return;if("_"===s)return;const r=(0,O.partiallySpecializeType)(this._evaluator.getEffectiveTypeOfSymbol(e.symbol),e.classType);if((0,R.isFunction)(r)||(0,R.isOverloadedFunction)(r)){const i=new l.DiagnosticAddendum;if((0,R.isFunction)(n)||(0,R.isOverloadedFunction)(n)){const a=["__init__","__new__","__init_subclass__"],o=!A.isDunderName(s);if(!a.some((e=>e===s))&&!A.isPrivateName(s)&&!this._evaluator.validateOverrideMethod(r,n,i,o)){const r=(0,R.isFunction)(n)&&n.details.declaration?n.details.declaration:(0,k.getLastTypedDeclaredForSymbol)(t);if(r){const t=this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportIncompatibleMethodOverride,c.DiagnosticRule.reportIncompatibleMethodOverride,m.Localizer.Diagnostic.incompatibleMethodOverride().format({name:s,className:e.classType.details.name})+i.getString(),5===r.type?r.node.name:r.node),n=(0,k.getLastTypedDeclaredForSymbol)(e.symbol);t&&n&&t.addRelatedInfo(m.Localizer.DiagnosticAddendum.overriddenMethod(),n.path,n.range)}}if((0,R.isFunction)(r)&&!A.isPrivateName(s)&&R.FunctionType.isFinal(r)){const n=(0,k.getLastTypedDeclaredForSymbol)(t);if(n&&5===n.type){const t=this._evaluator.addError(m.Localizer.Diagnostic.finalMethodOverride().format({name:s,className:e.classType.details.name}),n.node.name),i=(0,k.getLastTypedDeclaredForSymbol)(e.symbol);t&&i&&t.addRelatedInfo(m.Localizer.DiagnosticAddendum.finalMethod(),i.path,i.range)}}}else if(!(0,R.isAnyOrUnknown)(n)&&!R.ClassType.isBuiltIn(e.classType,"_TypedDict")){const i=t.getDeclarations();if(i.length>0){const t=i[i.length-1],r=this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportIncompatibleMethodOverride,c.DiagnosticRule.reportIncompatibleMethodOverride,m.Localizer.Diagnostic.methodOverridden().format({name:s,className:e.classType.details.name,type:this._evaluator.printType(n)}),t.node),a=(0,k.getLastTypedDeclaredForSymbol)(e.symbol);r&&a&&r.addRelatedInfo(m.Localizer.DiagnosticAddendum.overriddenMethod(),a.path,a.range)}}}else if((0,O.isProperty)(r))if((0,O.isProperty)(n)){const a=r.details.fields,o=n.details.fields,p=e.classType;["fget","fset","fdel"].forEach((e=>{const n=new l.DiagnosticAddendum,r=a.get(e),d=o.get(e);if(r){const a=(0,O.partiallySpecializeType)(this._evaluator.getEffectiveTypeOfSymbol(r),p);if((0,R.isFunction)(a))if(d){const t=(0,O.partiallySpecializeType)(this._evaluator.getEffectiveTypeOfSymbol(d),i);if((0,R.isFunction)(t)&&!this._evaluator.validateOverrideMethod(a,t,n.createAddendum())){n.addMessage(m.Localizer.DiagnosticAddendum.propertyMethodIncompatible().format({name:e}));const i=t.details.declaration;if(i&&5===i.type){const e=this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportIncompatibleMethodOverride,c.DiagnosticRule.reportIncompatibleMethodOverride,m.Localizer.Diagnostic.propertyOverridden().format({name:s,className:p.details.name})+n.getString(),i.node.name),t=a.details.declaration;e&&t&&e.addRelatedInfo(m.Localizer.DiagnosticAddendum.overriddenMethod(),t.path,t.range)}}}else{n.addMessage(m.Localizer.DiagnosticAddendum.propertyMethodMissing().format({name:e}));const i=t.getDeclarations();if(i.length>0){const e=this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportIncompatibleMethodOverride,c.DiagnosticRule.reportIncompatibleMethodOverride,m.Localizer.Diagnostic.propertyOverridden().format({name:s,className:p.details.name})+n.getString(),i[i.length-1].node),t=a.details.declaration;e&&t&&e.addRelatedInfo(m.Localizer.DiagnosticAddendum.overriddenMethod(),t.path,t.range)}}}}))}else{const n=t.getDeclarations();n.length>0&&this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportIncompatibleMethodOverride,c.DiagnosticRule.reportIncompatibleMethodOverride,m.Localizer.Diagnostic.propertyOverridden().format({name:s,className:e.classType.details.name}),n[n.length-1].node)}else if("none"!==this._fileInfo.diagnosticRuleSet.reportIncompatibleVariableOverride){const i=t.getDeclarations();if(i.length>0){const a=i[i.length-1],o=new l.DiagnosticAddendum;if(!this._evaluator.assignType(r,n,o)){const t=this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportIncompatibleVariableOverride,c.DiagnosticRule.reportIncompatibleVariableOverride,m.Localizer.Diagnostic.symbolOverridden().format({name:s,className:e.classType.details.name})+o.getString(),a.node),n=(0,k.getLastTypedDeclaredForSymbol)(e.symbol);t&&n&&t.addRelatedInfo(m.Localizer.DiagnosticAddendum.overriddenSymbol(),n.path,n.range)}const p=this._evaluator.isFinalVariable(e.symbol),d=i.find((e=>this._evaluator.isFinalVariableDeclaration(e)));if(!p&&d){const t=this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportIncompatibleVariableOverride,c.DiagnosticRule.reportIncompatibleVariableOverride,m.Localizer.Diagnostic.variableFinalOverride().format({name:s,className:e.classType.details.name}),a.node);t&&t.addRelatedInfo(m.Localizer.DiagnosticAddendum.overriddenSymbol(),d.path,d.range)}const u=e.symbol.isClassVar();let y=t.isClassVar();if(u&&!y&&(t.hasTypedDeclarations()||(y=!0),t.getTypedDeclarations().every((e=>6===e.type))&&(y=!0)),u!==y){const n=t.isClassVar()?m.Localizer.Diagnostic.classVarOverridesInstanceVar():m.Localizer.Diagnostic.instanceVarOverridesClassVar(),i=this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportIncompatibleVariableOverride,c.DiagnosticRule.reportIncompatibleVariableOverride,n.format({name:s,className:e.classType.details.name}),a.node),r=(0,k.getLastTypedDeclaredForSymbol)(e.symbol);i&&r&&i.addRelatedInfo(m.Localizer.DiagnosticAddendum.overriddenSymbol(),r.path,r.range)}}}}_validateMethod(e,t,n){var i,s,r,a;const o=this._evaluator.getTypeOfClass(n),l=null==o?void 0:o.classType;if(e.name&&l){["__init__","__init_subclass__","__enter__","__exit__"].some((t=>t===e.name.value))&&(R.FunctionType.isAbstractMethod(t)||R.FunctionType.isOverloaded(t)||this._fileInfo.isStubFile||this._validateSuperCallForMethod(e,t,l))}if("__new__"===(null===(i=e.name)||void 0===i?void 0:i.value))0!==e.parameters.length&&e.parameters[0].name&&["cls","_cls","__cls","__mcls","mcls","mcs"].some((t=>e.parameters[0].name.value===t))||this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportSelfClsParameterName,c.DiagnosticRule.reportSelfClsParameterName,m.Localizer.Diagnostic.newClsParam(),e.parameters.length>0?e.parameters[0]:e.name),l&&this._validateClsSelfParameterType(t,l,!0);else if("__init_subclass__"===(null===(s=e.name)||void 0===s?void 0:s.value))0!==e.parameters.length&&e.parameters[0].name&&"cls"===e.parameters[0].name.value||this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportSelfClsParameterName,c.DiagnosticRule.reportSelfClsParameterName,m.Localizer.Diagnostic.initSubclassClsParam(),e.parameters.length>0?e.parameters[0]:e.name),l&&this._validateClsSelfParameterType(t,l,!0);else if("__class_getitem__"===(null===(r=e.name)||void 0===r?void 0:r.value))0!==e.parameters.length&&e.parameters[0].name&&"cls"===e.parameters[0].name.value||this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportSelfClsParameterName,c.DiagnosticRule.reportSelfClsParameterName,m.Localizer.Diagnostic.classGetItemClsParam(),e.parameters.length>0?e.parameters[0]:e.name),l&&this._validateClsSelfParameterType(t,l,!0);else if("_generate_next_value_"===(null===(a=e.name)||void 0===a?void 0:a.value));else if(R.FunctionType.isStaticMethod(t)){if(e.parameters.length>0&&e.parameters[0].name){const t=e.parameters[0].name.value;"self"!==t&&"cls"!==t||this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportSelfClsParameterName,c.DiagnosticRule.reportSelfClsParameterName,m.Localizer.Diagnostic.staticClsSelfParam(),e.parameters[0].name)}}else if(R.FunctionType.isClassMethod(t)){let n="";e.parameters.length>0&&e.parameters[0].name&&(n=e.parameters[0].name.value),"cls"!==n&&(this._fileInfo.isStubFile&&(n.startsWith("_")||"metacls"===n)||this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportSelfClsParameterName,c.DiagnosticRule.reportSelfClsParameterName,m.Localizer.Diagnostic.classMethodClsParam(),e.parameters.length>0?e.parameters[0]:e.name)),l&&this._validateClsSelfParameterType(t,l,!0)}else{const i=e.decorators.length>0;if(R.FunctionType.isOverloaded(t)||!i){let t="",i=!0;if(e.parameters.length>0&&(e.parameters[0].name&&(t=e.parameters[0].name.value),0!==e.parameters[0].category&&(i=!1)),i&&"self"!==t){let i=!1;if(["cls","mcls","mcs"].some((e=>e===t))){const e=this._evaluator.getTypeOfClass(n),t=this._evaluator.getBuiltInType(n,"type");t&&(0,R.isInstantiableClass)(t)&&e&&(0,R.isInstantiableClass)(e.classType)&&(0,O.derivesFromClassRecursive)(e.classType,t,!0)&&(i=!0)}const s=A.isPrivateOrProtectedName(t);i||s||this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportSelfClsParameterName,c.DiagnosticRule.reportSelfClsParameterName,m.Localizer.Diagnostic.instanceMethodSelfParam(),e.parameters.length>0?e.parameters[0]:e.name)}}l&&this._validateClsSelfParameterType(t,l,!1)}}_validateSuperCallForMethod(e,t,n){if("none"===this._fileInfo.diagnosticRuleSet.reportMissingSuperCall)return;let i=9;R.ClassType.isFinal(n)&&(i|=4);if(!(0,O.lookUpClassMember)(n,t.details.name,i))return;let s=!1;const r=new I.CallNodeWalker((e=>{if(35===e.leftExpression.nodeType&&e.leftExpression.memberName.value===t.details.name){const t=e.leftExpression.leftExpression;if(9===t.nodeType&&38===t.leftExpression.nodeType&&"super"===t.leftExpression.value)s=!0;else{const e=this._evaluator.getType(t);e&&(0,R.isInstantiableClass)(e)&&(s=!0)}}}));r.walk(e.suite),s||this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportMissingSuperCall,c.DiagnosticRule.reportMissingSuperCall,m.Localizer.Diagnostic.missingSuperCall().format({methodName:t.details.name}),e.name)}_validateClsSelfParameterType(e,t,n){if(e.details.parameters.length<1)return;const i=e.details.parameters[0];if(!i.typeAnnotation||!i.name)return;if(R.ClassType.isProtocolClass(t))return;const s=this._evaluator.makeTopLevelTypeVarsConcrete(i.type),r=n?t:(0,O.convertToInstance)(t);if((0,R.isInstantiableClass)(s)&&R.ClassType.isProtocolClass(s))return;if((0,R.isClassInstance)(s)&&R.ClassType.isProtocolClass(s))return;if(R.FunctionType.isOverloaded(e))return;if((0,R.isClassInstance)(s)&&R.ClassType.isBuiltIn(s,"LiteralString")&&R.ClassType.isBuiltIn(t,"str"))return;const a=new M.TypeVarContext((0,O.getTypeVarScopeId)(e));this._evaluator.assignType(s,r,void 0,a)||(0,R.isNever)(s)||this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportGeneralTypeIssues,c.DiagnosticRule.reportGeneralTypeIssues,m.Localizer.Diagnostic.clsSelfParamTypeMismatch().format({name:i.name,classType:this._evaluator.printType(r)}),i.typeAnnotation)}_validateYieldType(e,t){let n,i;const s=I.getEnclosingFunction(e);if(s){const e=this._evaluator.getTypeOfFunction(s);e&&((0,o.assert)((0,R.isFunction)(e.functionType)),n=R.FunctionType.getSpecializedReturnType(e.functionType),n&&(i=(0,O.getGeneratorYieldType)(n,!!s.isAsync)),n&&!i&&s.returnTypeAnnotation&&this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportGeneralTypeIssues,c.DiagnosticRule.reportGeneralTypeIssues,s.isAsync?m.Localizer.Diagnostic.generatorAsyncReturnType():m.Localizer.Diagnostic.generatorSyncReturnType(),s.returnTypeAnnotation))}if(this._evaluator.isNodeReachable(e,void 0))if(n&&(0,R.isNever)(n))this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportGeneralTypeIssues,c.DiagnosticRule.reportGeneralTypeIssues,m.Localizer.Diagnostic.noReturnContainsYield(),e);else if(i){const n=new l.DiagnosticAddendum;this._evaluator.assignType(i,t,n)||this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportGeneralTypeIssues,c.DiagnosticRule.reportGeneralTypeIssues,m.Localizer.Diagnostic.yieldTypeMismatch().format({exprType:this._evaluator.printType(t),yieldType:this._evaluator.printType(i)})+n.getString(),e.expression||e)}}_reportUnusedExceptStatements(e){let t=!1;const n=[];e.exceptClauses.forEach((e=>{var i,s;if(t||e.isExceptGroup||!e.typeExpression)return;const r=this._evaluator.getType(e.typeExpression);if(!r||(0,R.isAnyOrUnknown)(r))return void(t=!0);const a=[];if((0,R.isInstantiableClass)(r))r.includeSubclasses&&(t=!0),a.push(r);else if((0,R.isClassInstance)(r)){const e=null!==(s=null===(i=this._evaluator.getTypeOfIterator({type:r},!1,void 0))||void 0===i?void 0:i.type)&&void 0!==s?s:R.UnknownType.create();(0,O.doForEachSubtype)(e,(e=>{(0,R.isAnyOrUnknown)(e)&&(t=!0),(0,R.isInstantiableClass)(e)&&(e.includeSubclasses&&(t=!0),a.push(e))}))}else t=!0;if(n.length>0&&!t){const t=new l.DiagnosticAddendum;let i=0;a.forEach((e=>{const s=n.find((t=>(0,O.derivesFromClassRecursive)(e,t,!0)));s&&(t.addMessage(m.Localizer.DiagnosticAddendum.unreachableExcept().format({exceptionType:this._evaluator.printType((0,O.convertToInstance)(e)),parentType:this._evaluator.printType((0,O.convertToInstance)(s))})),i++)})),a.length===i&&(this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportGeneralTypeIssues,c.DiagnosticRule.reportGeneralTypeIssues,m.Localizer.Diagnostic.unreachableExcept()+t.getString(),e.typeExpression),this._evaluator.addUnreachableCode(e,e.exceptSuite))}n.push(...a)}))}_reportDuplicateImports(){const e=(0,_.getTopLevelImports)(this._moduleNode),t=new Map;e.orderedImports.forEach((e=>{if(22===e.node.nodeType){const t=new Map;e.node.imports.forEach((e=>{if(!e.alias){t.get(e.name.value)?this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportDuplicateImport,c.DiagnosticRule.reportDuplicateImport,m.Localizer.Diagnostic.duplicateImport().format({importName:e.name.value}),e.name):t.set(e.name.value,e)}}))}else if(e.subnode&&!e.subnode.alias){t.get(e.moduleName)?this._evaluator.addDiagnostic(this._fileInfo.diagnosticRuleSet.reportDuplicateImport,c.DiagnosticRule.reportDuplicateImport,m.Localizer.Diagnostic.duplicateImport().format({importName:e.moduleName}),e.subnode):t.set(e.moduleName,e.subnode)}}))}_checkRegions(){const e=(0,x.getRegionComments)(this._parseResults),t=[];e.forEach((e=>{0===e.type?t.push(e):t.length>0?t.pop():this._addDiagnosticForRegionComment(e,m.Localizer.Diagnostic.unmatchedEndregionComment())})),t.forEach((e=>{this._addDiagnosticForRegionComment(e,m.Localizer.Diagnostic.unmatchedRegionComment())}))}_addDiagnosticForRegionComment(e,t){return this._evaluator.addDiagnosticForTextRange(this._fileInfo,"error","",t,{start:e.comment.start-1,length:e.comment.length+1})}}t.Checker=L},33866:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.CircularDependency=void 0;t.CircularDependency=class{constructor(){this._paths=[]}appendPath(e){this._paths.push(e)}getPaths(){return this._paths}normalizeOrder(){let e=0;this._paths.forEach(((t,n)=>{t<this._paths[e]&&(e=n)})),0!==e&&(this._paths=this._paths.slice(e).concat(this._paths.slice(0,e)))}isEqual(e){if(e._paths.length!==this._paths.length)return!1;for(let t=0;t<this._paths.length;t++)if(this._paths[t]!==e._paths[t])return!1;return!0}}},54318:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getCodeFlowEngine=t.isIncompleteType=void 0;const i=n(30795),s=n(96541),r=n(21),a=n(80563),o=n(27548),l=n(66455),c=n(78140),p=n(2026),d=n(36906),u=n(51458),y=n(33029);function m(e){return!!e.isIncompleteType}t.isIncompleteType=m;t.getCodeFlowEngine=function(e,t){const n=new Map,h=new Map,g=new Map;let f=1,T=0,v=0;function _(t,s,r=!1){const o=new Set;if(n.has(t.id))return!0;n.set(t.id,!0);try{return function t(n,s,l=0){if(l>64)return!0;l++;let c=n;for(;;){if(o.has(c.id))return!1;if(o.add(c.id),c.flags&a.FlowFlags.Unreachable)return!1;if(c===s)return!0;if(c.flags&(a.FlowFlags.VariableAnnotation|a.FlowFlags.Assignment|a.FlowFlags.TrueCondition|a.FlowFlags.FalseCondition|a.FlowFlags.WildcardImport|a.FlowFlags.TrueNeverCondition|a.FlowFlags.FalseNeverCondition|a.FlowFlags.NarrowForPattern|a.FlowFlags.ExhaustedMatch))c=c.antecedent;else if(c.flags&a.FlowFlags.Call){const t=c;if(!r&&I(e,t))return!1;c=t.antecedent}else{if(c.flags&(a.FlowFlags.BranchLabel|a.FlowFlags.LoopLabel)){if(c.flags&a.FlowFlags.PostContextManager){const t=c;if(!t.expressions.some((n=>S(e,n,t.isAsync))))return!1}const n=c;for(const e of n.antecedents)if(t(e,s,l))return!0;return!1}if(c.flags&a.FlowFlags.Start)return!s;if(!(c.flags&a.FlowFlags.PreFinallyGate)){if(c.flags&a.FlowFlags.PostFinally){const e=c,n=e.preFinallyGate.isGateClosed;try{return e.preFinallyGate.isGateClosed=!0,t(e.antecedent,s,l)}finally{e.preFinallyGate.isGateClosed=n}}return(0,i.fail)("Unexpected flow node flags"),!1}{const e=c;if(e.isGateClosed)return!1;c=e.antecedent}}}}(t,s)}finally{n.delete(t.id)}}function b(e,t){let n=!0;return(0,y.doForEachSubtype)(e,(e=>{(0,u.isTypeVar)(e)?(0,u.isTypeSame)(e,t)||(n=!1):e.condition&&e.condition.some((e=>e.isConstrainedTypeVar&&e.typeVarName===t.nameWithScope))||(n=!1)})),n}function I(e,t){const n=t.node;if(h.has(n.id)){const e=h.get(n.id);return e}if(T>u.maxTypeRecursionCount)return!1;if(30===n.leftExpression.nodeType)return!1;h.set(n.id,!1),T++;try{let t=0,i=0;const s=e.getTypeOfExpression(n.leftExpression,2),r=s.type;(0,y.doForEachSubtype)(r,(r=>{var a;if(i++,(0,u.isInstantiableClass)(r)){if(r.details.effectiveMetaclass&&(0,u.isClass)(r.details.effectiveMetaclass)&&!u.ClassType.isBuiltIn(r.details.effectiveMetaclass,"type")){if((0,y.lookUpClassMember)(r.details.effectiveMetaclass,"__call__",12))return}let t=(0,y.lookUpClassMember)(r,"__init__",12);if(void 0===t&&(t=(0,y.lookUpClassMember)(r,"__new__",12)),t){const n=e.getTypeOfMember(t);if(n&&((0,u.isFunction)(n)||(0,u.isOverloadedFunction)(n))){const t=e.bindFunctionToClassOrObject(void 0,n);t&&(r=t)}}}else if((0,u.isClassInstance)(r)){const t=(0,y.lookUpClassMember)(r,"__call__",8);if(t){const n=e.getTypeOfMember(t);if(n&&((0,u.isFunction)(n)||(0,u.isOverloadedFunction)(n))){const t=e.bindFunctionToClassOrObject(void 0,n);t&&(r=t)}}}const o=6===(null===(a=n.parent)||void 0===a?void 0:a.nodeType);if((0,u.isFunction)(r))C(r,o)&&t++;else if((0,u.isOverloadedFunction)(r)){let i=0,a=0;if(u.OverloadedFunctionType.getOverloads(r).forEach((e=>{i++,C(e,o)&&a++})),a>0)if(a===i)t++;else{const i=e.validateOverloadedFunctionArguments(n,n.arguments,{type:r,isIncomplete:s.isIncomplete},void 0,!1,void 0);i.returnType&&(0,u.isNever)(i.returnType)&&t++}}}));const a=i>0&&t===i;return h.set(n.id,a),a}finally{T--}}function C(e,t){const n=e.details.declaredReturnType;return!!n&&(!!(u.FunctionType.isAsync(e)&&(0,u.isClassInstance)(n)&&u.ClassType.isBuiltIn(n,"Coroutine")&&n.typeArguments&&n.typeArguments.length>=3&&(0,u.isNever)(n.typeArguments[2])&&t)||(0,u.isNever)(n))}function S(e,t,n){var i;if(g.has(t.id))return g.get(t.id);if(g.set(t.id,!1),v>u.maxTypeRecursionCount)return!1;v++;let s=!1;try{const r=e.getTypeOfExpression(t).type;if(r&&(0,u.isClassInstance)(r)){const a=n?"__aexit__":"__exit__",o=null===(i=e.getTypeOfObjectMember(t,r,a))||void 0===i?void 0:i.type;if(o&&(0,u.isFunction)(o)&&o.details.declaredReturnType){const e=o.details.declaredReturnType;s=!1,(0,u.isClassInstance)(e)&&u.ClassType.isBuiltIn(e,"bool")&&(void 0!==e.literalValue&&!0!==e.literalValue||(s=!0))}}}finally{v--}return g.set(t.id,s),s}function x(t,n){const s=(0,r.getImportInfo)(t.node.module);(0,i.assert)(void 0!==s&&s.isImportFound),(0,i.assert)(t.node.isWildcardImport);const a=e.lookUpSymbolRecursive(t.node,n,!1);(0,i.assert)(void 0!==a);const o=a.symbol.getDeclarations().find((e=>e.node===t.node));return o&&e.getInferredTypeOfDeclaration(a.symbol,o)||u.UnknownType.create()}function F(e,t,n,i=console){let a="";if(t){const e=(0,r.getFileInfo)(t),n=(0,s.convertOffsetToPosition)(t.start,e.lines);a=`${(0,l.printExpression)(t)}[${n.line+1}:${n.character+1}]`}i.log(`${n}@${e.id}: ${a||"(none)"}`),i.log((0,o.formatControlFlowGraph)(e))}return{createCodeFlowAnalyzer:function(){const n=new Map;return{getTypeFromCodeFlow:function(s,r,o,h,g){const T=void 0!==r?(0,a.createKeyForReference)(r):void 0;let v;const b=function(e){let t=n.get(e);return t||(t={cache:new Map,pendingNodes:new Set},n.set(e,t)),t}(void 0!==T&&void 0!==o?T+`.${o.toString()}`:".");function C(e,n,i){if(i){if(n){const t=b.cache.get(e.id);if(t){const e=t;e.isIncompleteType&&e.type&&!(0,u.isTypeSame)(e.type,n)&&f++}}}else f++;const s=i?{isIncompleteType:!0,type:n,incompleteSubtypes:[],generationCount:f}:n;return b.cache.set(e.id,s),t.trackEntry(b.cache,e.id),{type:n,isIncomplete:i,generationCount:f,incompleteSubtypes:i?[]:void 0}}function F(e,t,n,s,r,a){const o=b.cache.get(e.id);void 0!==o&&m(o)||(0,i.fail)("setIncompleteSubtype can be called only on a valid incomplete cache entry");const l=o.incompleteSubtypes;if(t<l.length){const e=l[t];e.isIncomplete===s&&(0,u.isTypeSame)(e.type,n)?e.isPending!==r&&(l[t]={type:n,isIncomplete:s,isPending:r,evaluationCount:a}):(l[t]={type:n,isIncomplete:s,isPending:r,evaluationCount:a},f++)}else(0,i.assert)(l.length===t),l.push({type:n,isIncomplete:s,isPending:r,evaluationCount:a}),f++;let c;if(o.incompleteSubtypes.length>0){const e=[];o.incompleteSubtypes.forEach((t=>{t.type&&e.push(t.type)})),c=e.length>0?(0,u.combineTypes)(e):void 0}return o.type=c,o.generationCount=f,D(e)}function D(e){if(!b.cache.has(e.id))return;const t=b.cache.get(e.id);return void 0===t?{type:void 0,isIncomplete:!1}:m(t)?{type:t.type,isIncomplete:!0,incompleteSubtypes:t.incompleteSubtypes,generationCount:t.generationCount}:{type:t,isIncomplete:!1}}function P(t){let n=t.node;const i=t.node.parent;return i&&(28!==i.nodeType&&10!==i.nodeType||(n=i)),e.evaluateTypeForSubnode(n,(()=>{e.evaluateTypesForStatement(t.node)}))}function E(e,t){b.pendingNodes.add(e.id);try{const n=t();return b.pendingNodes.delete(e.id),n}catch(t){throw b.pendingNodes.delete(e.id),t}}function A(t){var n,s;let m=t;for(e.checkForCancellation();;){const t=D(m);if(t){if(!t.isIncomplete)return t;if(t.generationCount===f)return{type:t.type?(0,u.cleanIncompleteUnknown)(t.type):void 0,isIncomplete:!0}}if(b.pendingNodes.has(m.id))return{type:null!==(n=null==t?void 0:t.type)&&void 0!==n?n:u.UnknownType.create(!0),isIncomplete:!0};if(m.flags&a.FlowFlags.Unreachable)return C(m,u.NeverType.createNever(),!1);if(m.flags&a.FlowFlags.VariableAnnotation){m=m.antecedent}else if(m.flags&a.FlowFlags.Call){const t=m;if(!(null==g?void 0:g.skipNoReturnCallAnalysis)&&I(e,t))return C(m,void 0,!1);m=t.antecedent}else if(m.flags&a.FlowFlags.Assignment){const t=m,n=t.node;if(r){if(o===t.targetSymbolId&&(0,l.isMatchingExpression)(r,n)){if(m.flags&a.FlowFlags.Unbind)return C(m,u.UnboundType.create(),!1);let i=E(m,(()=>P(t)));return i&&((0,y.isTypeAliasPlaceholder)(i.type)||35===r.nodeType&&e.isAsymmetricDescriptorAssignment(n))&&(i=void 0),C(m,null==i?void 0:i.type,!!(null==i?void 0:i.isIncomplete))}if(24===n.nodeType&&(0,l.isMatchingExpression)(r,n.baseExpression)&&3===(null===(s=n.parent)||void 0===s?void 0:s.nodeType)&&1===n.items.length&&!n.trailingComma&&!n.items[0].name&&0===n.items[0].argumentCategory&&48===n.items[0].valueExpression.nodeType&&1===n.items[0].valueExpression.strings.length&&49===n.items[0].valueExpression.strings[0].nodeType){const e=n.items[0].valueExpression.strings[0].value,i=E(t,(()=>{const n=A(t.antecedent);return n.type&&(n.type=(0,y.mapSubtypes)(n.type,(t=>(0,u.isClass)(t)&&u.ClassType.isTypedDictClass(t)?(0,p.narrowForKeyAssignment)(t,e):t))),n}));return C(m,null==i?void 0:i.type,!!(null==i?void 0:i.isIncomplete))}if((0,l.isPartialMatchingExpression)(r,n))return{type:h,isIncomplete:!!(null==g?void 0:g.isTypeAtStartIncomplete)}}m=t.antecedent}else{if(m.flags&a.FlowFlags.BranchLabel){const t=m;if(m.flags&a.FlowFlags.PostContextManager){const t=m;if(t.expressions.some((n=>S(e,n,t.isAsync)))===t.blockIfSwallowsExceptions)return C(m,void 0,!1)}if(r&&t.preBranchAntecedent&&t.affectedExpressions&&(v||(v=(0,a.createKeysForReferenceSubexpressions)(r)),!v.some((e=>t.affectedExpressions.has(e)))&&_(m,t.preBranchAntecedent))){m=t.preBranchAntecedent;continue}return k(m)}if(m.flags&a.FlowFlags.LoopLabel){const e=m;if(r&&(v||(v=(0,a.createKeysForReferenceSubexpressions)(r)),!v.some((t=>e.affectedExpressions.has(t))))){m=e.antecedents[0];continue}return w(e,t)}if(m.flags&(a.FlowFlags.TrueCondition|a.FlowFlags.FalseCondition)){const t=m;if(!(null==g?void 0:g.skipConditionalNarrowing)&&r){const n=E(m,(()=>{const n=(0,d.getTypeNarrowingCallback)(e,r,t.expression,!!(t.flags&(a.FlowFlags.TrueCondition|a.FlowFlags.TrueNeverCondition)));if(n){const e=A(t.antecedent);let i=e.type,s=e.isIncomplete;if(i){const e=n(i);e&&(i=e.type,e.isIncomplete&&(s=!0))}return C(m,i,s)}}));if(n)return n}m=t.antecedent}else if(m.flags&(a.FlowFlags.TrueNeverCondition|a.FlowFlags.FalseNeverCondition)){const t=m;if(!(null==g?void 0:g.skipConditionalNarrowing)&&t.reference&&(0,a.createKeyForReference)(t.reference)!==T){const n=e.lookUpSymbolRecursive(t.reference,t.reference.value,!1);if(n&&n.symbol.getTypedDeclarations().length>0){const n=E(m,(()=>{const n=(0,d.getTypeNarrowingCallback)(e,t.reference,t.expression,!!(t.flags&(a.FlowFlags.TrueCondition|a.FlowFlags.TrueNeverCondition)));if(n){const i=e.getTypeOfExpression(t.reference);let s=i.type,r=!!i.isIncomplete;const a=n(i.type);if(a&&(s=a.type,a.isIncomplete&&(r=!0)),(0,u.isNever)(s))return C(m,void 0,r)}}));if(n)return n}}m=t.antecedent}else if(m.flags&a.FlowFlags.ExhaustedMatch){const t=m,n=e.evaluateTypeForSubnode(t.node,(()=>{e.evaluateTypesForMatchStatement(t.node)}));if(n&&(0,u.isNever)(n.type))return C(m,n.type,!!n.isIncomplete);m=t.antecedent}else if(m.flags&a.FlowFlags.NarrowForPattern){const t=m;if(!r||(0,l.isMatchingExpression)(r,t.subjectExpression)){const n=e.evaluateTypeForSubnode(t.statement,(()=>{64===t.statement.nodeType?e.evaluateTypesForCaseStatement(t.statement):e.evaluateTypesForMatchStatement(t.statement)}));if(n){if(r)return C(m,n.type,!!n.isIncomplete);if((0,u.isNever)(n.type))return C(m,void 0,!!n.isIncomplete)}}else if(64===t.statement.nodeType){const n=t.statement,i=(0,c.getPatternSubtypeNarrowingCallback)(e,r,t.subjectExpression);if(i){const t=e.evaluateTypeForSubnode(n,(()=>{e.evaluateTypesForCaseStatement(n)}));if(t){const e=i(t.type);if(e)return C(m,e.type,!!t.isIncomplete||!!e.isIncomplete)}}}m=t.antecedent}else{if(m.flags&a.FlowFlags.PreFinallyGate)return N(m);if(m.flags&a.FlowFlags.PostFinally)return R(m);if(m.flags&a.FlowFlags.Start)return C(m,h,!!(null==g?void 0:g.isTypeAtStartIncomplete));if(m.flags&a.FlowFlags.WildcardImport){const e=m;if(r&&38===r.nodeType){const t=r.value;if(e.names.some((e=>e===t)))return E(m,(()=>{const n=x(e,t);return C(m,n,!1)}))}m=e.antecedent}else(0,i.fail)("Unexpected flow node flags")}}}}function k(e){const t=[];let n=!1;return E(e,(()=>{for(const i of e.antecedents){const s=A(i);if(void 0===r&&s.type&&!(0,u.isNever)(s.type))return C(e,h,!1);s.isIncomplete&&(n=!0),s.type&&t.push(s.type)}const i=t.length>0?(0,u.combineTypes)(t):void 0;return C(e,i,n)}))}function w(e,t){var n;const i=e.antecedents.length;if(void 0===t)t=C(e,r?void 0:h,!0);else if(t.incompleteSubtypes&&t.incompleteSubtypes.length===e.antecedents.length&&t.incompleteSubtypes.some((e=>e.isPending)))return{type:t.type,isIncomplete:!0};let s=0;for(;;){let a=!1,o=!1,l=void 0===r&&(null===(n=t.incompleteSubtypes)||void 0===n?void 0:n.some((e=>void 0!==e.type))),c=!1;if(e.antecedents.forEach(((n,i)=>{var s,p;if(void 0===r&&l)return;if((t=D(e)).incompleteSubtypes&&i<t.incompleteSubtypes.length&&t.incompleteSubtypes[i].isPending)return a=!0,void(o=!0);const d=void 0!==t.incompleteSubtypes&&i<t.incompleteSubtypes.length?t.incompleteSubtypes[i]:void 0;if(void 0===d||!(null==d?void 0:d.isPending)&&(null==d?void 0:d.isIncomplete)){const r=void 0===d?0:d.evaluationCount;t=F(e,i,null!==(s=null==d?void 0:d.type)&&void 0!==s?s:u.UnknownType.create(!0),!0,!0,r);try{const s=A(n);s.isIncomplete&&(a=!0,0===i&&(c=!0)),t=F(e,i,null!==(p=s.type)&&void 0!==p?p:s.isIncomplete?u.UnknownType.create(!0):u.NeverType.createNever(),s.isIncomplete,!1,r+1)}catch(t){throw F(e,i,u.UnknownType.create(!0),!0,!1,r+1),t}}void 0===r&&void 0!==(null==t?void 0:t.type)&&(l=!0)})),l)return o?{type:h,isIncomplete:!1}:C(e,h,!1);let p=t.type;if(a&&p&&(p=(0,u.cleanIncompleteUnknown)(p)),!a||s>=i){let t=a;return o||!p||(0,y.isIncompleteUnknown)(p)||c||(f++,t=!1),o||a?{type:p,isIncomplete:t}:C(e,p,!1)}s++}}function N(e){return e.isGateClosed?{type:void 0,isIncomplete:!1}:E(e,(()=>{const t=A(e.antecedent);return function(e){b.cache.delete(e.id)}(e),{type:t.type,isIncomplete:t.isIncomplete}}))}function R(t){const n=t.preFinallyGate.isGateClosed;try{let n;return t.preFinallyGate.isGateClosed=!0,e.useSpeculativeMode(t.finallyNode,(()=>{n=A(t.antecedent)})),n.isIncomplete?n:C(t,n.type,!1)}finally{t.preFinallyGate.isGateClosed=n}}return s?A(s):{type:h,isIncomplete:!!(null==g?void 0:g.isTypeAtStartIncomplete)}}}},isFlowNodeReachable:_,narrowConstrainedTypeVar:function(t,n){(0,i.assert)(!n.details.isParamSpec),(0,i.assert)(!n.details.isVariadic),(0,i.assert)(!n.details.boundType),(0,i.assert)(n.details.constraints.length>0);const s=new Set,r=[];for(const e of n.details.constraints){if(!(0,u.isClassInstance)(e))return;r.push(e)}const o=function t(n,o){let l=n;for(;;){if(s.has(l.id))return r;if(l.flags&(a.FlowFlags.Unreachable|a.FlowFlags.Start))return r;if(l.flags&(a.FlowFlags.VariableAnnotation|a.FlowFlags.Assignment|a.FlowFlags.WildcardImport|a.FlowFlags.TrueNeverCondition|a.FlowFlags.FalseNeverCondition|a.FlowFlags.NarrowForPattern|a.FlowFlags.ExhaustedMatch|a.FlowFlags.PostFinally|a.FlowFlags.PreFinallyGate|a.FlowFlags.Call)){l=l.antecedent}else{if(!(l.flags&(a.FlowFlags.TrueCondition|a.FlowFlags.FalseCondition))){if(l.flags&(a.FlowFlags.BranchLabel|a.FlowFlags.LoopLabel)){const e=l,n=[];s.add(l.id);for(const i of e.antecedents){const e=t(i,o);for(const t of e)n.some((e=>(0,u.isTypeSame)(e,t)))||n.push(t)}return s.delete(l.id),n}return(0,i.fail)("Unexpected flow node flags"),r}{const n=l,i=n.expression,r=0!=(l.flags&a.FlowFlags.TrueCondition);if(9===i.nodeType&&38===i.leftExpression.nodeType&&"isinstance"===i.leftExpression.value&&2===i.arguments.length){const a=i.arguments[0].valueExpression;if(b(e.getTypeOfExpression(a).type,o)){s.add(l.id);const a=t(n.antecedent,o);s.delete(l.id);const c=i.arguments[1].valueExpression,p=e.getTypeOfExpression(c,104).type;if((0,u.isInstantiableClass)(p))return a.filter((e=>u.ClassType.isSameGenericClass(e,p)?r:!r))}}l=n.antecedent}}}}(t,n);return 1===o.length?o[0]:void 0},printControlFlowGraph:F}}},80563:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.wildcardImportReferenceKey=t.createKeysForReferenceSubexpressions=t.createKeyForReference=t.isCodeFlowSupportedForReference=t.getUniqueFlowNodeId=t.FlowFlags=void 0;const i=n(30795);!function(e){e[e.Unreachable=1]="Unreachable",e[e.Start=2]="Start",e[e.BranchLabel=4]="BranchLabel",e[e.LoopLabel=8]="LoopLabel",e[e.Assignment=16]="Assignment",e[e.Unbind=32]="Unbind",e[e.WildcardImport=64]="WildcardImport",e[e.TrueCondition=128]="TrueCondition",e[e.FalseCondition=512]="FalseCondition",e[e.Call=1024]="Call",e[e.PreFinallyGate=2048]="PreFinallyGate",e[e.PostFinally=4096]="PostFinally",e[e.VariableAnnotation=16384]="VariableAnnotation",e[e.PostContextManager=32768]="PostContextManager",e[e.TrueNeverCondition=65536]="TrueNeverCondition",e[e.FalseNeverCondition=131072]="FalseNeverCondition",e[e.NarrowForPattern=262144]="NarrowForPattern",e[e.ExhaustedMatch=524288]="ExhaustedMatch"}(t.FlowFlags||(t.FlowFlags={}));let s=1;function r(e){let t;if(38===e.nodeType)t=e.value;else if(35===e.nodeType){t=`${r(e.leftExpression)}.${e.memberName.value}`}else if(24===e.nodeType){const n=r(e.baseExpression);(0,i.assert)(1===e.items.length);const s=e.items[0].valueExpression;if(40===s.nodeType)t=`${n}[${s.value.toString()}]`;else if(48===s.nodeType){const e=s;(0,i.assert)(1===e.strings.length&&49===e.strings[0].nodeType),t=`${n}["${e.strings[0].value}"]`}else 55===s.nodeType&&33===s.operator&&40===s.expression.nodeType?t=`${n}[-${s.expression.value.toString()}]`:(0,i.fail)("createKeyForReference received unexpected index type")}else(0,i.fail)("createKeyForReference received unexpected expression type");return t}t.getUniqueFlowNodeId=function(){return s++},t.isCodeFlowSupportedForReference=function e(t){if(38===t.nodeType)return!0;if(35===t.nodeType)return e(t.leftExpression);if(24===t.nodeType){if(1!==t.items.length||t.trailingComma||void 0!==t.items[0].name||0!==t.items[0].argumentCategory)return!1;const n=t.items[0].valueExpression,i=40===n.nodeType&&!n.isImaginary&&n.isInteger,s=55===n.nodeType&&33===n.operator&&40===n.expression.nodeType&&!n.expression.isImaginary&&n.expression.isInteger,r=48===n.nodeType&&1===n.strings.length&&49===n.strings[0].nodeType;return!!(i||s||r)&&e(t.baseExpression)}return!1},t.createKeyForReference=r,t.createKeysForReferenceSubexpressions=function e(t){return 38===t.nodeType?[r(t)]:35===t.nodeType?[...e(t.leftExpression),r(t)]:24===t.nodeType?[...e(t.baseExpression),r(t)]:void(0,i.fail)("createKeyForReference received unexpected expression type")},t.wildcardImportReferenceKey="*"},27548:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.formatControlFlowGraph=void 0;const i=n(96541),s=n(21),r=n(80563);t.formatControlFlowGraph=function(e){const t=Object.create(null),n=[],a=[],o=d(e,new Set);for(const e of n)e.text=h(e.flowNode,e.circular),y(e);const l=function(e){const t=f(Array(e),0);for(const e of n)t[e.level]=Math.max(t[e.level],e.text.length);return t}(function e(t){let n=0;for(const i of c(t))n=Math.max(n,e(i));return n+1}(o));return function e(t,n){if(-1===t.lane){t.lane=n,t.endLane=n;const i=c(t);for(let s=0;s<i.length;s++){s>0&&n++;const r=i[s];e(r,n),r.endLane>t.endLane&&(n=r.endLane)}t.endLane=n}}(o,0),function(){const e=l.length,t=n.reduce(((e,t)=>Math.max(e,t.lane)),0)+1,i=f(Array(t),""),s=l.map((()=>Array(t))),r=l.map((()=>f(Array(t),0)));for(const e of n){s[e.level][e.lane]=e;const t=c(e);for(let n=0;n<t.length;n++){const i=t[n];let s=8;i.lane===e.lane&&(s|=4),n>0&&(s|=1),n<t.length-1&&(s|=2),r[e.level][i.lane]|=s}0===t.length&&(r[e.level][e.lane]|=16);const n=p(e);for(let t=0;t<n.length;t++){const i=n[t];let s=4;t>0&&(s|=1),t<n.length-1&&(s|=2),r[e.level-1][i.lane]|=s}}for(let n=0;n<e;n++)for(let e=0;e<t;e++){const t=n>0?r[n-1][e]:0,i=e>0?r[n][e-1]:0;let s=r[n][e];s||(8&t&&(s|=12),2&i&&(s|=3),r[n][e]=s)}for(let t=0;t<e;t++)for(let n=0;n<i.length;n++){const i=r[t][n],o=4&i?"─":" ",c=s[t][n];c?(a(n,c.text),t<e-1&&(a(n," "),a(n,T(o,l[t]-c.text.length)))):t<e-1&&a(n,T(o,l[t]+1)),a(n,g(i)),a(n,8&i&&t<e-1&&!s[t+1][n]?"─":" ")}return`${i.join("\n")}\n`;function a(e,t){i[e]+=t}}();function c(e){const t=[];for(const n of e.edges)n.source===e&&t.push(n.target);return t}function p(e){const t=[];for(const n of e.edges)n.target===e&&t.push(n.source);return t}function d(e,i){const s=e.id;let a=t[s];if(a&&i.has(e))return a={id:-1,flowNode:e,edges:[],text:"",lane:-1,endLane:-1,level:-1,circular:!0},n.push(a),a;if(i.add(e),!a){t[s]=a={id:s,flowNode:e,edges:[],text:"",lane:-1,endLane:-1,level:-1,circular:!1},n.push(a);const o=function(e){if(e.flags&(r.FlowFlags.LoopLabel|r.FlowFlags.BranchLabel))return e.antecedents;if(e.flags&(r.FlowFlags.Assignment|r.FlowFlags.VariableAnnotation|r.FlowFlags.WildcardImport|r.FlowFlags.TrueCondition|r.FlowFlags.FalseCondition|r.FlowFlags.NarrowForPattern|r.FlowFlags.ExhaustedMatch|r.FlowFlags.Call|r.FlowFlags.PreFinallyGate|r.FlowFlags.PostFinally))return[e.antecedent];return[]}(e);for(const e of o)u(a,e,i)}return i.delete(e),a}function u(e,t,n){const i=d(t,n),s={source:e,target:i};a.push(s),e.edges.push(s),i.edges.push(s)}function y(e){if(-1!==e.level)return e.level;let t=0;for(const n of p(e))t=Math.max(t,y(n)+1);return e.level=t}function m(e){const t=function(e){return e.flags&r.FlowFlags.Assignment||e.flags&r.FlowFlags.WildcardImport?e.node:e.flags&(r.FlowFlags.TrueCondition|r.FlowFlags.FalseCondition)?e.expression:e.flags&r.FlowFlags.NarrowForPattern?e.statement:e.flags&r.FlowFlags.Call?e.node:void 0}(e);if(!t)return;const n=(0,s.getFileInfo)(t),a=(0,i.convertOffsetToPosition)(t.start,n.lines);return`[${a.line+1}:${a.character+1}]`}function h(e,t){const n=`${function(e){if(e&r.FlowFlags.Start)return"Start";if(e&r.FlowFlags.BranchLabel)return"Branch";if(e&r.FlowFlags.LoopLabel)return"Loop";if(e&r.FlowFlags.Unbind)return"Unbind";if(e&r.FlowFlags.Assignment)return"Assign";if(e&r.FlowFlags.TrueCondition)return"True";if(e&r.FlowFlags.FalseCondition)return"False";if(e&r.FlowFlags.Call)return"Call";if(e&r.FlowFlags.Unreachable)return"Unreachable";if(e&r.FlowFlags.WildcardImport)return"Wildcard";if(e&r.FlowFlags.PreFinallyGate)return"PreFinal";if(e&r.FlowFlags.PostFinally)return"PostFinal";if(e&r.FlowFlags.VariableAnnotation)return"Annotate";if(e&r.FlowFlags.TrueNeverCondition)return"TrueNever";if(e&r.FlowFlags.FalseNeverCondition)return"FalseNever";if(e&r.FlowFlags.NarrowForPattern)return"Pattern";if(e&r.FlowFlags.ExhaustedMatch)return"Exhaust";throw new Error}(e.flags)}@${e.id}${m(e)||""}`;return t?`Circular(${n})`:n}function g(e){switch(e){case 3:return"│";case 12:return"─";case 5:return"╯";case 9:return"╰";case 6:return"╮";case 10:return"╭";case 7:return"┤";case 11:return"├";case 13:return"┴";case 14:return"┬";case 15:return"╫"}return" "}function f(e,t){if(e.fill)e.fill(t);else for(let n=0;n<e.length;n++)e[n]=t;return e}function T(e,t){if(e.repeat)return t>0?e.repeat(t):"";let n="";for(;n.length<t;)n+=e;return n}}},67030:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getFileLevelDirectives=void 0;const i=n(59750),s=n(30795),r=n(83501),a=n(96541),o=n(99661),l="strict",c="basic";function p(e){!function(e,t,n){const s=(0,i.getBooleanDiagnosticRules)(),r=(0,i.getDiagLevelDiagnosticRules)();for(const i of s)n.find((e=>e===i))||t[i]&&(e[i]=!0);for(const i of r){if(n.find((e=>e===i)))continue;const s=t[i],r=e[i];("error"===s||"warning"===s&&"error"!==r||"information"===s&&"error"!==r&&"warning"!==r)&&(e[i]=s)}}(e,(0,i.getStrictDiagnosticRuleSet)(),(0,i.getStrictModeNotOverriddenRules)())}function d(e){!function(e,t){const n=(0,i.getBooleanDiagnosticRules)(),s=(0,i.getDiagLevelDiagnosticRules)();for(const i of n)e[i]=t[i];for(const n of s)e[n]=t[n]}(e,(0,i.getBasicDiagnosticRuleSet)())}function u(e,t,n,i,s){const a="pyright:";if(e.startsWith(a)){const a=e.substring(8);if(a.trim().startsWith("ignore"))return i;if(!n()){const e=new r.DiagnosticAddendum;e.addMessage(o.Localizer.DiagnosticAddendum.pyrightCommentIgnoreTip());const n={message:o.Localizer.Diagnostic.pyrightCommentNotOnOwnLine()+e.getString(),range:t};s.push(n)}const u=a.split(",");u.some((e=>e.trim()===l))?p(i):u.some((e=>e.trim()===c))&&d(i);let h=0;for(const e of u){const n={start:t.start+8+h,length:e.length};i=y(m(e,n),n,i,s),h+=e.length+1}}return i}function y(e,t,n,s){const r=e.split("="),a={start:t.start,length:r[0].length},p=m(r[0],a);if(1===r.length&&p&&[l,c].some((e=>p===e)))return n;const d=(0,i.getDiagLevelDiagnosticRules)(),u=(0,i.getBooleanDiagnosticRules)(),y=r.length>0?r.slice(1).join("="):"",h={start:t.start+r[0].length+1,length:y.length},g=m(y,h);if(d.find((e=>e===p))){const e=function(e){switch(e){case"false":case"none":return"none";case"true":case"error":return"error";case"warning":return"warning";case"information":return"information";default:return}}(g);if(void 0!==e)n[p]=e;else{const e={message:o.Localizer.Diagnostic.pyrightCommentInvalidDiagnosticSeverityValue(),range:g?h:a};s.push(e)}}else if(u.find((e=>e===p))){const e=function(e){if("false"===e)return!1;if("true"===e)return!0;return}(g);if(void 0!==e)n[p]=e;else{const e={message:o.Localizer.Diagnostic.pyrightCommentInvalidDiagnosticBoolValue(),range:g?h:a};s.push(e)}}else if(p){const e={message:g?o.Localizer.Diagnostic.pyrightCommentUnknownDiagnosticRule().format({rule:p}):o.Localizer.Diagnostic.pyrightCommentUnknownDirective().format({directive:p}),range:a};s.push(e)}else{const e={message:o.Localizer.Diagnostic.pyrightCommentMissingDirective(),range:a};s.push(e)}return n}function m(e,t){(0,s.assert)(e.length===t.length);const n=e.trimStart();if(n!==e){const i=e.length-n.length;t.start+=i,t.length-=i}const i=n.trimEnd();return i!==n&&(t.length-=n.length-i.length),(0,s.assert)(i.length===t.length),i}t.getFileLevelDirectives=function(e,t,n,s,r){let o=(0,i.cloneDiagnosticRuleSet)(n);s&&p(o);for(let n=0;n<e.count;n++){const i=e.getItemAt(n);if(i.comments)for(const e of i.comments){const n={start:e.start,length:e.length};o=u(m(e.value,n),n,(()=>(0,a.convertOffsetToPosition)(e.start,t).character<=1),o,r)}}return o}},54750:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.populateTypeVarContextBasedOnExpectedType=t.assignTypeToTypeVar=void 0;const i=n(83501),s=n(99661),r=n(7461),a=n(51458),o=n(33029),l=n(43024);t.assignTypeToTypeVar=function(e,t,n,c,p,d=0,u=0){let y=!0;const m=0!=(2&d);if(!t.scopeId)return!0;if(!p.hasSolveForScope(t.scopeId)){if((0,a.isAnyOrUnknown)(n)||(0,a.isClass)(n)&&a.ClassType.derivesFromAnyOrUnknown(n))return!0;if(t.details.isParamSpec&&(0,a.isFunction)(n)&&a.FunctionType.isParamSpecValue(n)&&a.FunctionType.shouldSkipArgsKwargsCompatibilityCheck(n))return!0;if((0,a.isNever)(n)&&0==(1&d))return!0;if(0!=(512&d))return!0;if(y=!1,!t.details.isSynthesized)return null==c||c.addMessage(s.Localizer.DiagnosticAddendum.typeAssignmentMismatch().format({sourceType:e.printType(n),destType:e.printType(t)})),!1}if(0!=(8&d))return e.assignType(e.makeTopLevelTypeVarsConcrete(t),e.makeTopLevelTypeVarsConcrete(n),c,void 0,void 0,d,u);if(t.details.isParamSpec)return function(e,t,n,i,r,l=0){let c=!0;return r.doForEachSignature((p=>{if((0,a.isTypeVar)(n)&&n.details.isParamSpec){const e=p.getParamSpecType(t);if(!e)return void(!r.isLocked()&&r.hasSolveForScope(t.scopeId)&&r.setTypeVarType(t,(0,o.convertTypeToParamSpecValue)(n)));if(0===e.details.parameters.length&&e.details.paramSpec&&(0,a.isTypeSame)(e.details.paramSpec,n,{},l))return}else if((0,a.isFunction)(n)){const i=n,s=n.details.parameters.map(((e,t)=>({category:e.category,name:e.name,isNameSynthesized:e.isNameSynthesized,hasDefault:!!e.hasDefault,defaultValueExpression:e.defaultValueExpression,type:a.FunctionType.getEffectiveParameterType(i,t)}))),c=p.getParamSpecType(t);if(!c){if(!r.isLocked()&&r.hasSolveForScope(t.scopeId)){const e=a.FunctionType.createInstance("","","",n.details.flags);s.forEach((t=>{a.FunctionType.addParameter(e,t)})),e.details.typeVarScopeId=n.details.typeVarScopeId,e.details.docString=n.details.docString,e.details.paramSpec=n.details.paramSpec,r.setTypeVarType(t,e)}return}if(c.details.paramSpec===n.details.paramSpec){const t=(0,o.convertParamSpecValueToType)(c,!0),i=a.FunctionType.createInstance("","","",n.details.flags);if(s.forEach((e=>{a.FunctionType.addParameter(i,e)})),i.details.typeVarScopeId=n.details.typeVarScopeId,e.assignType(t,i,void 0,void 0,void 0,32,l))return}}else if((0,a.isAnyOrUnknown)(n))return;null==i||i.addMessage(s.Localizer.DiagnosticAddendum.typeParamSpec().format({type:e.printType(n),name:t.details.name})),c=!1})),c}(e,t,n,c,p,u);if(t.details.isVariadic&&!t.isVariadicInUnion&&!(0,a.isUnpacked)(n)){const t=e.getTupleClassType();n=t&&(0,a.isInstantiableClass)(t)?(0,o.convertToInstance)((0,o.specializeTupleClass)(t,[{type:n,isUnbounded:!1}],!0,!0)):a.UnknownType.create()}(0,a.isTypeVar)(n)&&n.details.isVariadic&&n.isVariadicUnpacked&&!n.isVariadicInUnion&&!t.details.isVariadic&&(n=a.TypeVarType.cloneForUnpacked(n,!0)),a.TypeBase.isInstantiable(t)&&(0,a.isClassInstance)(n)&&a.ClassType.isBuiltIn(n,"type")&&!n.typeArguments&&(n=a.AnyType.create());const h=p.getPrimarySignature().getTypeVar(t),g=null==h?void 0:h.narrowBound;let f=null==h?void 0:h.wideBound;if(f||t.details.isSynthesizedSelf||(f=t.details.boundType),t.details.constraints.length>0){let i;const r=e.makeTopLevelTypeVarsConcrete(n);if((0,a.isTypeVar)(n))e.assignType(t,r,void 0,new l.TypeVarContext(t.scopeId),void 0,0,u)&&(i=n,a.TypeBase.isInstantiable(n)&&(i=(0,o.convertToInstance)(n,!1)));else{let n,s=!0;i=(0,o.mapSubtypes)(r,(i=>{let r,l;return(0,a.isAnyOrUnknown)(i)?i:(t.details.constraints.forEach(((n,s)=>{const c=a.TypeBase.isInstantiable(t)?(0,o.convertToInstantiable)(n):n;e.assignType(c,i,void 0,void 0,void 0,0,u)&&(r&&!e.assignType(a.TypeBase.isInstantiable(t)?(0,o.convertToInstantiable)(r):r,c,void 0,void 0,void 0,0,u)||(r=(0,o.addConditionToType)(n,(0,o.getTypeCondition)(i)),l=s))})),r||m||(s=!1),void 0===l||(0,o.getTypeCondition)(i)||(void 0!==n&&n!==l&&(s=!1),n=l),r)})),!(0,a.isNever)(i)&&s||(i=void 0),!i&&(0,a.isUnion)(r)&&(i=t.details.constraints.find((n=>{const i=a.TypeBase.isInstantiable(t)?(0,o.convertToInstantiable)(n):n;return e.assignType(i,r,void 0,void 0,void 0,0,u)})))}if(!i)return null==c||c.addMessage(s.Localizer.DiagnosticAddendum.typeConstrainedTypeVar().format({type:e.printType(n),name:t.details.name})),!1;if(g&&!(0,a.isAnyOrUnknown)(g)){if(!e.assignType(g,i,void 0,void 0,void 0,0,u)){if(!e.assignType(i,g,void 0,void 0,void 0,0,u))return null==c||c.addMessage(s.Localizer.DiagnosticAddendum.typeConstrainedTypeVar().format({type:e.printType(i),name:e.printType(g)})),!1;!p.isLocked()&&y&&p.setTypeVarType(t,i)}}else!p.isLocked()&&y&&p.setTypeVarType(t,i);return!0}let T=g,v=f;const _=c?new i.DiagnosticAddendum:void 0;let b=n;if(a.TypeBase.isInstantiable(t)){if(!(0,o.isEffectivelyInstantiable)(b))return null==c||c.addMessage(s.Localizer.DiagnosticAddendum.typeAssignmentMismatch().format({sourceType:e.printType(b),destType:e.printType(t)})),!1;b=(0,o.convertToInstance)(b,!1)}else if((0,a.isTypeVar)(n)&&a.TypeBase.isInstantiable(n)&&(0,a.isTypeSame)((0,o.convertToInstance)(n),t))return null==c||c.addMessage(s.Localizer.DiagnosticAddendum.typeAssignmentMismatch().format({sourceType:e.printType(b),destType:e.printType(t)})),!1;if(0!=(1024&d))0!=(1&d)?(T=b,v=b):m?T=b:v=b;else if(m){if(f){if(!(0,a.isTypeSame)(f,b,{},u))if(e.assignType(f,e.makeTopLevelTypeVarsConcrete(b),_,void 0,void 0,512&d,u))v=b;else if(!e.assignType(b,f,_,void 0,void 0,512&d,u))return c&&_&&(c.addMessage(s.Localizer.DiagnosticAddendum.typeAssignmentMismatch().format({sourceType:e.printType(b),destType:e.printType(f)})),c.addAddendum(_)),!1}else v=b;if(g&&!e.assignType(v,g,void 0,void 0,void 0,512&d,u))return c&&_&&(c.addMessage(s.Localizer.DiagnosticAddendum.typeAssignmentMismatch().format({sourceType:e.printType(b),destType:e.printType(g)})),c.addAddendum(_)),!1}else{if(g){if(!(0,a.isTypeSame)(g,b,{},u))if(e.assignType(g,b,_,new l.TypeVarContext(t.scopeId),void 0,d,u))T=(0,o.isPartlyUnknown)(g)&&!(0,a.isUnknown)(b)&&e.assignType(b,g,void 0,new l.TypeVarContext(t.scopeId),void 0,512&d,u)?b:(0,o.applySolvedTypeVars)(g,p);else{if(p.isLocked())return null==c||c.addMessage(s.Localizer.DiagnosticAddendum.typeAssignmentMismatch().format({sourceType:e.printType(g),destType:e.printType(b)})),!1;if(e.assignType(b,g,void 0,new l.TypeVarContext(t.scopeId),void 0,512&d,u))T=b;else if((0,a.isVariadicTypeVar)(t)){const t=function(e,t){if(!(0,a.isUnpackedClass)(e)||!(0,a.isUnpackedClass)(t))return;if(!e.tupleTypeArguments||!t.tupleTypeArguments||e.tupleTypeArguments.length!==t.tupleTypeArguments.length)return;let n=!0;const i=e.tupleTypeArguments.map(((e,i)=>{const s=t.tupleTypeArguments[i];return e.isUnbounded!==s.isUnbounded&&(n=!1),{isUnbounded:e.isUnbounded,type:(0,a.combineTypes)([e.type,s.type])}}));if(!n)return;return(0,o.specializeTupleClass)(e,i,!0,!0)}(g,b);if(!t)return null==c||c.addMessage(s.Localizer.DiagnosticAddendum.typeAssignmentMismatch().format({sourceType:e.printType(g),destType:e.printType(b)})),!1;T=t}else{const n=e.getObjectType(),i=(0,o.applySolvedTypeVars)(g,p);T=(0,a.isUnion)(i)&&i.subtypes.length>r.maxSubtypesForInferredType&&void 0!==t.details.boundType&&n&&(0,a.isClassInstance)(n)?(0,a.combineTypes)([i,n]):(0,a.combineTypes)([i,b])}}}else T=b;if(f&&T&&!(0,a.isTypeSame)(f,T,{},u)){let t=!0;(0,a.isTypeVar)(f)&&((0,a.isTypeSame)(T,f)||(0,a.isUnion)(T)&&T.subtypes.some((e=>(0,a.isTypeSame)(e,f))))&&(t=!1);const n=t?e.makeTopLevelTypeVarsConcrete(f,!0):f;if(!e.assignType(n,T,null==c?void 0:c.createAddendum(),void 0,void 0,512,u))return c&&_&&c.addMessage(s.Localizer.DiagnosticAddendum.typeAssignmentMismatch().format({sourceType:e.printType(b),destType:e.printType(f)})),!1}}if(t.details.boundType){const i=T||v;if(a.TypeBase.isInstantiable(t)&&!a.TypeBase.isInstantiable(n))return!1;const r=t.details.isSynthesizedSelf?p:new l.TypeVarContext(t.scopeId);if(!e.assignType(t.details.boundType,e.makeTopLevelTypeVarsConcrete(i),null==c?void 0:c.createAddendum(),r,void 0,512&d,u))return t.details.isSynthesized||null==c||c.addMessage(s.Localizer.DiagnosticAddendum.typeBound().format({sourceType:e.printType(i),destType:e.printType(t.details.boundType),name:a.TypeVarType.getReadableName(t)})),!1}if(!p.isLocked()&&y){let n;if(T&&0==(1152&d)){const i=(0,a.isVariadicTypeVar)(t)?function(e,t){if(!(0,a.isUnpackedClass)(t)||!t.tupleTypeArguments)return t;let n=!1;const i=t.tupleTypeArguments.map((t=>{const i=e.stripLiteralValue(t.type);return i!==t.type&&(n=!0),{isUnbounded:t.isUnbounded,type:i}}));if(!n)return t;return(0,o.specializeTupleClass)(t,i,!0,!0)}(e,T):e.stripLiteralValue(T);i!==T&&(v&&!e.assignType(v,i)||(n=i))}p.setTypeVarType(t,T,n,v)}return!0},t.populateTypeVarContextBasedOnExpectedType=function(e,t,n,i,s){if((0,a.isAny)(n))return t.details.typeParameters.forEach((e=>{i.setTypeVarType(e,n)})),!0;if((0,a.isTypeVar)(n)&&n.details.isSynthesizedSelf&&n.details.boundType&&(n=n.details.boundType),!(0,a.isClass)(n))return!1;const r=n.typeArguments;if(!r)return e.assignType(t,n,void 0,i,void 0,1024);if(e.inferTypeParameterVarianceForClass(t),a.ClassType.isSameGenericClass(n,t)){const e=(0,o.buildTypeVarContextFromSpecializedClass)(n);return e.getPrimarySignature().getTypeVars().forEach((n=>{const s=e.getPrimarySignature().getTypeVarType(n.typeVar);if(s&&(!(0,a.isTypeVar)(s)||s.scopeId!==t.details.typeVarScopeId)){const e=a.TypeVarType.getVariance(n.typeVar);i.setTypeVarType(n.typeVar,3===e?void 0:s,void 0,4===e?void 0:s)}})),!0}const c=(0,o.getTypeVarScopeId)(n),p=a.ClassType.getTypeParameters(n).map(((e,t)=>{const n=a.TypeVarType.createInstance(`__dest${t}`);return n.details.isSynthesized=!0,n.details.declaredVariance=2,n.scopeId=c,n})),d=a.ClassType.cloneForSpecialization(n,p,!0),u=a.ClassType.getTypeParameters(t).map(((e,t)=>{const n=a.TypeVarType.createInstance(`__source${t}`);return n.details.isSynthesized=!0,n.details.synthesizedIndex=t,n.details.isExemptFromBoundCheck=!0,n})),y=a.ClassType.cloneForSpecialization(t,u,!0),m=new l.TypeVarContext(c);if(e.assignType(d,y,void 0,m,void 0,1024)){let e=!0;return p.forEach(((t,n)=>{const l=m.getPrimarySignature().getTypeVarType(t);if(l&&(0,a.isTypeVar)(l)&&l.details.isSynthesized&&void 0!==l.details.synthesizedIndex){const c=a.ClassType.getTypeParameters(y)[l.details.synthesizedIndex];if(n<r.length){let l=(0,o.transformPossibleRecursiveTypeAlias)(r[n]);if(s&&(l=(0,o.transformExpectedType)(l,s)),l){const e=a.TypeVarType.getVariance(t);i.setTypeVarType(c,3===e?void 0:l,void 0,4===e?void 0:l)}else e=!1}}})),e}return!1}},90281:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.applyConstructorTransform=t.hasConstructorTransform=void 0;const i=n(83501),s=n(28513),r=n(99661),a=n(21),o=n(32966),l=n(16682),c=n(51458),p=n(33029),d=n(43024);function u(e,t,n,l,u){const y=new Map,m=(0,o.getParameterListDetails)(u);let h=!1,g=!1;const f=new d.TypeVarContext((0,p.getTypeVarScopeId)(u));n.slice(1).forEach(((n,l)=>{var d,T,v,_,b,I,C,S;if(n.valueExpression)if(n.name){const l=m.params.find((e=>{var t;return e.param.name===(null===(t=n.name)||void 0===t?void 0:t.value)&&e.source!==o.ParameterSource.PositionOnly}));if(l){const o=l.param.name,d=c.FunctionType.getEffectiveParameterType(u,l.index);if(y.has(o))t&&e.addDiagnostic((0,a.getFileInfo)(t).diagnosticRuleSet.reportGeneralTypeIssues,s.DiagnosticRule.reportGeneralTypeIssues,r.Localizer.Diagnostic.paramAlreadyAssigned().format({name:n.name.value}),n.name),h=!0;else{const l=new i.DiagnosticAddendum,c=e.getTypeOfExpression(n.valueExpression,void 0,(0,p.makeInferenceContext)(d));e.assignType(d,c.type,l,f)||(t&&e.addDiagnostic((0,a.getFileInfo)(t).diagnosticRuleSet.reportGeneralTypeIssues,s.DiagnosticRule.reportGeneralTypeIssues,r.Localizer.Diagnostic.argAssignmentParamFunction().format({argType:e.printType(c.type),paramType:e.printType(d),functionName:u.details.name,paramName:o}),null!==(S=n.valueExpression)&&void 0!==S?S:t),h=!0),y.set(o,!0)}}else if(void 0===m.kwargsIndex)t&&e.addDiagnostic((0,a.getFileInfo)(t).diagnosticRuleSet.reportGeneralTypeIssues,s.DiagnosticRule.reportGeneralTypeIssues,r.Localizer.Diagnostic.paramNameMissing().format({name:n.name.value}),n.name),h=!0;else{const o=c.FunctionType.getEffectiveParameterType(u,m.params[m.kwargsIndex].index),l=new i.DiagnosticAddendum,d=e.getTypeOfExpression(n.valueExpression,void 0,(0,p.makeInferenceContext)(o));e.assignType(o,d.type,l,f)||(t&&e.addDiagnostic((0,a.getFileInfo)(t).diagnosticRuleSet.reportGeneralTypeIssues,s.DiagnosticRule.reportGeneralTypeIssues,r.Localizer.Diagnostic.argAssignmentParamFunction().format({argType:e.printType(d.type),paramType:e.printType(o),functionName:u.details.name,paramName:null!==(I=m.params[m.kwargsIndex].param.name)&&void 0!==I?I:""}),null!==(C=n.valueExpression)&&void 0!==C?C:t),h=!0)}}else if(l>=m.params.length||m.params[l].source===o.ParameterSource.KeywordOnly)if(void 0!==m.argsIndex){const o=c.FunctionType.getEffectiveParameterType(u,m.params[m.argsIndex].index),l=new i.DiagnosticAddendum,y=e.getTypeOfExpression(n.valueExpression,void 0,(0,p.makeInferenceContext)(o));e.assignType(o,y.type,l,f)||(t&&e.addDiagnostic((0,a.getFileInfo)(t).diagnosticRuleSet.reportGeneralTypeIssues,s.DiagnosticRule.reportGeneralTypeIssues,r.Localizer.Diagnostic.argAssignmentParamFunction().format({argType:e.printType(y.type),paramType:e.printType(o),functionName:u.details.name,paramName:null!==(d=m.params[m.argsIndex].param.name)&&void 0!==d?d:""}),null!==(T=n.valueExpression)&&void 0!==T?T:t),h=!0)}else g||t&&e.addDiagnostic((0,a.getFileInfo)(t).diagnosticRuleSet.reportGeneralTypeIssues,s.DiagnosticRule.reportGeneralTypeIssues,1===m.positionParamCount?r.Localizer.Diagnostic.argPositionalExpectedOne():r.Localizer.Diagnostic.argPositionalExpectedCount().format({expected:m.positionParamCount}),null!==(v=n.valueExpression)&&void 0!==v?v:t),g=!0,h=!0;else{const o=c.FunctionType.getEffectiveParameterType(u,l),d=new i.DiagnosticAddendum,g=null!==(_=m.params[l].param.name)&&void 0!==_?_:"",T=e.getTypeOfExpression(n.valueExpression,void 0,(0,p.makeInferenceContext)(o));e.assignType(o,T.type,d,f)||(t&&e.addDiagnostic((0,a.getFileInfo)(t).diagnosticRuleSet.reportGeneralTypeIssues,s.DiagnosticRule.reportGeneralTypeIssues,r.Localizer.Diagnostic.argAssignmentParamFunction().format({argType:e.printType(T.type),paramType:e.printType(o),functionName:u.details.name,paramName:g}),null!==(b=n.valueExpression)&&void 0!==b?b:t),h=!0),y.set(g,!1)}}));const T=(0,p.applySolvedTypeVars)(u,f);if(!(0,c.isFunction)(T))return;const v=T.details.parameters.map(((e,t)=>{const n={...e};return n.type=c.FunctionType.getEffectiveParameterType(T,t),e.name&&y.get(e.name)&&(n.hasDefault=!0),n})),_=[...v.filter((e=>2!==e.category&&(1===e.category||(!e.name||!y.has(e.name))))),...v.filter((e=>e.name&&y.get(e.name))),...v.filter((e=>2===e.category))],b=c.FunctionType.createInstance(l.details.name,l.details.fullName,l.details.moduleName,l.details.flags,T.details.docString);return l.details.parameters.length>0&&c.FunctionType.addParameter(b,l.details.parameters[0]),_.forEach((e=>{c.FunctionType.addParameter(b,e)})),b.details.declaredReturnType=T.details.declaredReturnType?c.FunctionType.getSpecializedReturnType(T):T.inferredReturnType,b.details.declaration=l.details.declaration,b.details.typeVarScopeId=T.details.typeVarScopeId,{returnType:b,isTypeIncomplete:!1,argumentErrors:h}}t.hasConstructorTransform=function(e){return"functools.partial"===e.details.fullName},t.applyConstructorTransform=function(e,t,n,i,o){return"functools.partial"===i.details.fullName?function(e,t,n,i){if(!(0,c.isClassInstance)(i.returnType)||"functools.partial"!==i.returnType.details.fullName)return i;const o=(0,p.lookUpObjectMember)(i.returnType,"__call__");if(!o||!(0,c.isTypeSame)((0,p.convertToInstance)(o.classType),i.returnType))return i;const d=e.getTypeOfMember(o);if(!(0,c.isFunction)(d)||d.details.parameters.length<1)return i;if(n.length<1)return i;const y=e.getTypeOfArgument(n[0]),m=y.type;if(e.inferReturnTypeIfNecessary(m),n.some((e=>0!==e.argumentCategory)))return i;if((0,c.isFunction)(m)){const s=u(e,t,n,d,m);if(!s)return i;const r=c.ClassType.cloneForSymbolTableUpdate(i.returnType);return r.details.fields.set("__call__",l.Symbol.createWithType(4,s.returnType)),{returnType:r,isTypeIncomplete:i.isTypeIncomplete,argumentErrors:s.argumentErrors}}if((0,c.isOverloadedFunction)(m)){const o=[];let p=!1;if(c.OverloadedFunctionType.getOverloads(m).forEach((t=>{const i=u(e,void 0,n,d,t);i&&(i.argumentErrors?p=!0:(0,c.isFunction)(i.returnType)&&o.push(i.returnType))})),0===o.length)return p&&e.addDiagnostic((0,a.getFileInfo)(t).diagnosticRuleSet.reportGeneralTypeIssues,s.DiagnosticRule.reportGeneralTypeIssues,r.Localizer.Diagnostic.noOverload().format({name:m.overloads[0].details.name}),t),i;const y=c.ClassType.cloneForSymbolTableUpdate(i.returnType);let h;return h=1===o.length?o[0]:c.OverloadedFunctionType.create(o.map((e=>c.FunctionType.cloneWithNewFlags(e,256|e.details.flags)))),y.details.fields.set("__call__",l.Symbol.createWithType(4,h)),{returnType:y,isTypeIncomplete:i.isTypeIncomplete,argumentErrors:!1}}return i}(e,t,n,o):o}},45341:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createFunctionFromConstructor=t.validateConstructorArguments=void 0;const i=n(28513),s=n(99661),r=n(21),a=n(54750),o=n(90281),l=n(66455),c=n(33029),p=n(43024),d=n(51458);function u(e,t,n,i,s,r,o){let u=!1,m=!1;const h=[],g=(0,c.mapSubtypes)(r.expectedType,(g=>{g=(0,c.transformPossibleRecursiveTypeAlias)(g);const f=new p.TypeVarContext((0,c.getTypeVarScopeId)(i));if(f.addSolveForScope((0,c.getTypeVarScopeId)(o)),(0,a.populateTypeVarContextBasedOnExpectedType)(e,d.ClassType.cloneAsInstance(i),g,f,(0,l.getTypeVarScopesForNode)(t))){const a=(0,c.applySolvedTypeVars)(o,f);let l;if(e.useSpeculativeMode(t,(()=>{l=e.validateCallArguments(t,n,{type:a},f.clone(),s)})),!l.argumentErrors)return l=e.validateCallArguments(t,n,{type:a},f,s),l.isTypeIncomplete&&(u=!0),l.argumentErrors&&(m=!0),h.push(...l.overloadsUsedForCall),y(e,i,g,r,f)}}));if(!(0,d.isNever)(g))return{returnType:g,isTypeIncomplete:u,argumentErrors:m,overloadsUsedForCall:h}}function y(e,t,n,i,s){var r;const a=(0,c.applySolvedTypeVars)(d.ClassType.cloneAsInstance(t),s);if(e.assignType(n,a,void 0,null===(r=null==i?void 0:i.typeVarContext)||void 0===r?void 0:r.clone(),void 0))return(0,d.isAny)(n)?n:a}function m(e,t,n,i){let s=!0;if(n){const r=(0,c.mapSubtypes)(n.expectedType,(s=>y(e,t,s,n,i)));if(!(0,d.isNever)(r))return r;t.typeArguments&&(s=!1)}const r=(0,c.applySolvedTypeVars)(t,i,{unknownIfNotFound:s});return d.ClassType.cloneAsInstance(r)}function h(e){return(0,d.isFunction)(e)&&d.FunctionType.isSkipConstructorCheck(e)}t.validateConstructorArguments=function(e,t,n,y,g,f){var T;const v=function(e,t,n,i,s,r){const a=i.details.effectiveMetaclass;if(a&&(0,d.isInstantiableClass)(a)&&!d.ClassType.isSameGenericClass(a,i)){const o=e.getTypeOfClassMemberName(t,a,!0,"__call__",{method:"get"},void 0,352,i);if(o){const a=e.validateCallArguments(t,n,o,void 0,s,r);if(!a.returnType||(0,d.isUnknown)(a.returnType)){const t=new p.TypeVarContext((0,c.getTypeVarScopeId)(i));a.returnType=m(e,i,r,t)}return a}}return}(e,t,n,y,g,f);if(v)return v;const _=e.getTypeOfClassMemberName(t,y,!1,"__new__",{method:"get"},void 0,21,y),b=e.getTypeOfObjectMember(t,d.ClassType.cloneAsInstance(y),"__init__",{method:"get"},void 0,68);let I,C=!1,S=!1,x=!1;const F=[];if(_||b){const i=null==b?void 0:b.type;if(i&&!h(i)){if(f){const s=u(e,t,n,y,g,f,i);s&&!s.argumentErrors&&(I=s.returnType,s.isTypeIncomplete&&(x=!0))}if(!I){const s=y.typeArguments?(0,c.buildTypeVarContextFromSpecializedClass)(y,!1):new p.TypeVarContext((0,c.getTypeVarScopeId)(y));s.addSolveForScope((0,c.getTypeVarScopeId)(i));const r=e.validateCallArguments(t,n,{type:i},s,g);let a=y;r.specializedInitSelfType&&(0,d.isClassInstance)(r.specializedInitSelfType)&&d.ClassType.isSameGenericClass(r.specializedInitSelfType,y)&&(a=d.ClassType.cloneAsInstantiable(r.specializedInitSelfType)),I=m(e,a,void 0,s),r.isTypeIncomplete&&(x=!0),r.argumentErrors?S=!0:F.push(...r.overloadsUsedForCall)}C=!0,g=!0}if(!S&&_&&!h(_.type)){const i=_.type;let s;if(f&&!I){const r=u(e,t,n,y,g,f,i);r&&!r.argumentErrors&&(s=r.returnType,I=s,r.isTypeIncomplete&&(x=!0))}const r=new p.TypeVarContext((0,c.getTypeVarScopeId)(y));y.typeAliasInfo&&r.addSolveForScope(y.typeAliasInfo.typeVarScopeId),r.addSolveForScope((0,c.getTypeVarScopeId)(i));const a=e.useSpeculativeMode((0,o.hasConstructorTransform)(y)?t:void 0,(()=>e.validateCallArguments(t,n,_,r,g)));a.isTypeIncomplete&&(x=!0),a.argumentErrors?S=!0:s||(s=a.returnType,0===F.length&&F.push(...a.overloadsUsedForCall),s&&((0,d.isClassInstance)(s)&&d.ClassType.isSameGenericClass(s,y)?((0,c.isPartlyUnknown)(s)||(0,c.requiresSpecialization)(s))&&void 0!==I||((0,d.isClassInstance)(s)&&d.ClassType.isTupleClass(s)&&!s.tupleTypeArguments&&s.typeArguments&&1===s.typeArguments.length&&(s=(0,c.specializeTupleClass)(s,[{type:s.typeArguments[0],isUnbounded:!0}])),I=s):I||(0,d.isUnknown)(s)||(I=s))),I?(0,d.isClassInstance)(I)&&(0,c.isTupleClass)(I)&&!I.tupleTypeArguments&&(I=function(e,t){let n=e;t&&(0,d.isClassInstance)(t.expectedType)&&(0,c.isTupleClass)(t.expectedType)&&t.expectedType.tupleTypeArguments&&(n=(0,c.specializeTupleClass)(e,t.expectedType.tupleTypeArguments));return n}(I,f)):I=m(e,y,f,r),C=!0}}else{const o=function(e,t,n,o,u){let y=!1;if(n.length>0){const n=(0,r.getFileInfo)(t);e.addDiagnostic(n.diagnosticRuleSet.reportGeneralTypeIssues,i.DiagnosticRule.reportGeneralTypeIssues,s.Localizer.Diagnostic.constructorNoArgs().format({type:o.aliasName||o.details.name}),t),y=!0}if(!u&&o.typeArguments)return{argumentErrors:y,overloadsUsedForCall:[],returnType:(0,c.convertToInstance)(o)};const h=new p.TypeVarContext((0,c.getTypeVarScopeId)(o));u&&(0,a.populateTypeVarContextBasedOnExpectedType)(e,d.ClassType.cloneAsInstance(o),u.expectedType,h,(0,l.getTypeVarScopesForNode)(t));return{argumentErrors:y,overloadsUsedForCall:[],returnType:m(e,o,u,h)}}(e,t,n,y,f);o.argumentErrors?S=!0:F.push(...o.overloadsUsedForCall),I=null!==(T=o.returnType)&&void 0!==T?T:d.UnknownType.create()}if(C||n.forEach((t=>{t.valueExpression&&!e.isSpeculativeModeInUse(t.valueExpression)&&e.getTypeOfExpression(t.valueExpression)})),!S&&I){const i=(0,o.applyConstructorTransform)(e,t,n,y,{argumentErrors:S,returnType:I,isTypeIncomplete:x});I=i.returnType,i.isTypeIncomplete&&(x=!0),i.argumentErrors&&(S=!0)}return{argumentErrors:S,returnType:I,isTypeIncomplete:x,overloadsUsedForCall:F}},t.createFunctionFromConstructor=function(e,t,n=0){const i=(0,c.lookUpClassMember)(t,"__init__",12);if(i){const s=e.getTypeOfMember(i),r=d.ClassType.cloneAsInstance(t),a=i=>{let s=e.bindFunctionToClassOrObject(r,i,void 0,void 0,n);return s&&(s=d.FunctionType.clone(s),s.details.declaredReturnType=r,s.specializedTypes&&(s.specializedTypes.returnType=r),!s.details.docString&&t.details.docString&&(s.details.docString=t.details.docString),s.details.flags&=-5),s};if((0,d.isFunction)(s))return a(s);if((0,d.isOverloadedFunction)(s)){const e=[];if(s.overloads.forEach((t=>{const n=a(t);n&&e.push(n)})),0===e.length)return;return 1===e.length?e[0]:d.OverloadedFunctionType.create(e)}}const s=(0,c.lookUpClassMember)(t,"__new__",12);if(s){const i=e.getTypeOfMember(s),r=i=>{let s=e.bindFunctionToClassOrObject(t,i,void 0,void 0,n,!0);return s&&(s=d.FunctionType.clone(s),!s.details.docString&&t.details.docString&&(s.details.docString=t.details.docString),s.details.flags&=-6),s};if((0,d.isFunction)(i))return r(i);if((0,d.isOverloadedFunction)(i)){const e=[];if(i.overloads.forEach((t=>{const n=r(t);n&&e.push(n)})),0===e.length)return;return 1===e.length?e[0]:d.OverloadedFunctionType.create(e)}}const r=d.FunctionType.createSynthesizedInstance("__new__",0);return r.details.declaredReturnType=d.ClassType.cloneAsInstance(t),d.FunctionType.addDefaultParameters(r),!r.details.docString&&t.details.docString&&(r.details.docString=t.details.docString),r}},5838:function(e,t,n){var i=this&&this.__createBinding||(Object.create?function(e,t,n,i){void 0===i&&(i=n),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,i){void 0===i&&(i=n),e[i]=t[n]}),s=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&i(t,e,n);return s(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.applyDataClassDecorator=t.applyDataClassDefaultBehaviors=t.applyDataClassClassBehaviorOverrides=t.getDataclassDecoratorBehaviors=t.validateDataClassTransformDecorator=t.synthesizeDataClassMethods=void 0;const a=n(30795),o=n(83501),l=n(28513),c=n(99661),p=r(n(21)),d=n(45341),u=n(46288),y=n(66455),m=n(93890),h=n(16682),g=n(48466),f=n(51458),T=n(33029),v=n(43024);function _(e,t){let n;return(0,f.isFunction)(e)?n=e.details.fullName:(0,f.isOverloadedFunction)(e)?n=e.overloads[0].details.fullName:(0,f.isInstantiableClass)(e)&&(n=e.details.fullName),!!n&&t.some((e=>e===n))}function b(e,t,n,i,s){switch(i){case"order":!0===s?n.details.flags|=64:!1===s&&(n.details.flags&=-65);break;case"kw_only":!1===s?n.details.flags&=-2097153:!0===s&&(n.details.flags|=2097152);break;case"frozen":{let i=!1,r=!1;!1===s?n.details.flags&=-9:!0===s&&(n.details.flags|=8),n.details.baseClasses.forEach((e=>{(0,f.isInstantiableClass)(e)&&f.ClassType.isDataClass(e)&&(f.ClassType.isFrozenDataClass(e)?r=!0:e.details.classDataClassTransform||e.details.declaredMetaclass&&(0,f.isInstantiableClass)(e.details.declaredMetaclass)&&e.details.declaredMetaclass.details.classDataClassTransform||(i=!0))})),s?i&&e.addDiagnostic(p.getFileInfo(t).diagnosticRuleSet.reportGeneralTypeIssues,l.DiagnosticRule.reportGeneralTypeIssues,c.Localizer.Diagnostic.dataClassBaseClassNotFrozen(),t):r&&e.addDiagnostic(p.getFileInfo(t).diagnosticRuleSet.reportGeneralTypeIssues,l.DiagnosticRule.reportGeneralTypeIssues,c.Localizer.Diagnostic.dataClassBaseClassFrozen(),t);break}case"init":!1===s?n.details.flags|=16:!0===s&&(n.details.flags&=-17);break;case"eq":!1===s?n.details.flags|=32:!0===s&&(n.details.flags&=-33);break;case"slots":!0===s?(n.details.flags|=33554432,n.details.localSlotsNames&&e.addDiagnostic(p.getFileInfo(t).diagnosticRuleSet.reportGeneralTypeIssues,l.DiagnosticRule.reportGeneralTypeIssues,c.Localizer.Diagnostic.dataClassSlotsOverwrite(),t)):!1===s&&(n.details.flags&=-33554433);break;case"hash":case"unsafe_hash":!0===s&&(n.details.flags|=67108864)}}function I(e,t,n,i,s){let r=!1;i.forEach((t=>{t.valueExpression&&t.name&&(!function(e,t,n,i,s){const r=p.getFileInfo(t);b(e,t,n,i,(0,m.evaluateStaticBoolExpression)(s,r.executionEnvironment,r.definedConstants))}(e,t.name,n,t.name.value,t.valueExpression),"frozen"===t.name.value&&(r=!0))})),r||b(e,t,n,"frozen",s.frozen)}function C(e,t){e.details.dataClassBehaviors=t,e.details.flags|=4,t.keywordOnlyParams&&(e.details.flags|=2097152),t.generateEq||(e.details.flags|=32),t.generateOrder&&(e.details.flags|=64),t.frozen&&(e.details.flags|=8)}t.synthesizeDataClassMethods=function(e,t,n,i,s,r){var b;(0,a.assert)(f.ClassType.isDataClass(n));const I=(0,T.synthesizeTypeVarForSelfCls)(n,!0),C=f.FunctionType.createSynthesizedInstance("__new__",1),S=f.FunctionType.createSynthesizedInstance("__init__");f.FunctionType.addParameter(C,{category:0,name:"cls",type:I,hasDeclaredType:!0}),f.FunctionType.addDefaultParameters(C),C.details.declaredReturnType=(0,T.convertToInstance)(I);const x={category:0,name:"self",type:(0,T.synthesizeTypeVarForSelfCls)(n,!1),hasDeclaredType:!0};f.FunctionType.addParameter(S,x),S.details.declaredReturnType=f.NoneType.createInstance();const F=[],D=[],P=function(e,t){let n=!0;return f.ClassType.getReverseMro(e).forEach((e=>{if((0,f.isInstantiableClass)(e)){const n=(0,T.buildTypeVarContextFromSpecializedClass)(e,!1);f.ClassType.getDataClassEntries(e).forEach((e=>{const i=t.findIndex((t=>t.name===e.name)),s={...e};s.type=(0,T.applySolvedTypeVars)(s.type,n),e.isClassVar?i>=0&&t.splice(i,1):i>=0?t[i]=s:t.push(s)}))}else n=!1})),n}(n,D);P||f.FunctionType.addDefaultParameters(S);const E=[];let A=!1;n.details.fields.forEach((s=>{var r,a,o;if(!s.isIgnoredForProtocolMatch()){const d=s.getTypedDeclarations().find((e=>{if(1!==e.type)return!1;const t=(0,y.getEnclosingClassOrFunction)(e.node);return!(!t||10!==t.nodeType)}));if(d){let s,o,u,y=d.node;for(;y&&3!==y.nodeType;){if(54===y.nodeType){3===(null===(r=y.parent)||void 0===r?void 0:r.nodeType)&&(y=y.parent);break}y=y.parent}if(!y)return;let h,g,v=!1,b=f.ClassType.isDataClassKeywordOnlyParams(n)||A,I=!0;if(3===y.nodeType){if(54===y.leftExpression.nodeType&&38===y.leftExpression.valueExpression.nodeType){s=y.leftExpression.valueExpression;const t=y;u=()=>e.getTypeOfAnnotation(t.leftExpression.typeAnnotation,{isVariableAnnotation:!0,allowFinal:!0,allowClassVar:!0})}if(v=!0,h=y.rightExpression,9===y.rightExpression.nodeType){const i=e.getTypeOfExpression(y.rightExpression.leftExpression,2),s=i.type;if(_(s,(null===(a=n.details.dataClassBehaviors)||void 0===a?void 0:a.fieldDescriptorNames)||[])){const n=y.rightExpression.arguments.find((e=>{var t;return"init"===(null===(t=e.name)||void 0===t?void 0:t.value)}));if(n&&n.valueExpression){const e=p.getFileInfo(t);!1===(0,m.evaluateStaticBoolExpression)(n.valueExpression,e.executionEnvironment,e.definedConstants)&&(I=!1)}else{let t;if((0,f.isFunction)(s))t=s;else if((0,f.isOverloadedFunction)(s))t=e.getBestOverloadForArguments(y.rightExpression,{type:s,isIncomplete:i.isIncomplete},y.rightExpression.arguments);else if((0,f.isInstantiableClass)(s)){const n=e.getBoundMethod(s,"__init__");n&&((0,f.isFunction)(n)?t=n:(0,f.isOverloadedFunction)(n)&&(t=e.getBestOverloadForArguments(y.rightExpression,{type:n},y.rightExpression.arguments)))}if(t){const e=t.details.parameters.find((e=>"init"===e.name));e&&e.defaultValueExpression&&e.hasDeclaredType&&(0,f.isClass)(e.type)&&f.ClassType.isBuiltIn(e.type,"bool")&&(0,T.isLiteralType)(e.type)&&!1===e.type.literalValue&&(I=!1)}}const r=y.rightExpression.arguments.find((e=>{var t;return"kw_only"===(null===(t=e.name)||void 0===t?void 0:t.value)}));if(r&&r.valueExpression){const e=p.getFileInfo(t),n=(0,m.evaluateStaticBoolExpression)(r.valueExpression,e.executionEnvironment,e.definedConstants);!1===n?b=!1:!0===n&&(b=!0)}const a=y.rightExpression.arguments.find((e=>{var t,n,i;return"default"===(null===(t=e.name)||void 0===t?void 0:t.value)||"default_factory"===(null===(n=e.name)||void 0===n?void 0:n.value)||"factory"===(null===(i=e.name)||void 0===i?void 0:i.value)}));v=!!a,(null==a?void 0:a.valueExpression)&&(h=a.valueExpression);const l=y.rightExpression.arguments.find((e=>{var t;return"alias"===(null===(t=e.name)||void 0===t?void 0:t.value)}));if(l){const t=e.getTypeOfExpression(l.valueExpression).type;(0,f.isClassInstance)(t)&&f.ClassType.isBuiltIn(t,"str")&&(0,T.isLiteralType)(t)&&(o=t.literalValue)}const c=y.rightExpression.arguments.find((e=>{var t;return"converter"===(null===(t=e.name)||void 0===t?void 0:t.value)}));c&&c.valueExpression&&(g=c)}}}else if(54===y.nodeType&&38===y.valueExpression.nodeType){s=y.valueExpression;const t=y;if(u=()=>e.getTypeOfAnnotation(t.typeAnnotation,{isVariableAnnotation:!0,allowFinal:!0,allowClassVar:!0}),"_"===y.valueExpression.value){const e=u();(0,f.isClassInstance)(e)&&f.ClassType.isBuiltIn(e,"KW_ONLY")&&(A=!0,s=void 0,u=void 0)}}if(s&&u){const r=s.value,a=n.details.fields.get(r),d=null==a?void 0:a.getDeclarations().some((e=>1===e.type&&e.isFinal));if((null==a?void 0:a.isClassVar())&&!d){const e=D.findIndex((e=>e.name===r));e>=0&&D.splice(e,1);const t={name:r,classType:n,alias:o,isKeywordOnly:!1,hasDefault:v,defaultValueExpression:h,includeInInit:I,nameNode:s,type:f.UnknownType.create(),isClassVar:!0,converter:g};F.push(t)}else{const a={name:r,classType:n,alias:o,isKeywordOnly:b,hasDefault:v,defaultValueExpression:h,includeInInit:I,nameNode:s,type:f.UnknownType.create(),isClassVar:!1,converter:g};E.push({entry:a,evaluator:u});let d=F.findIndex((e=>e.name===r));if(d>=0?F[d]=a:F.push(a),d=D.findIndex((e=>e.name===r)),d>=0){const e=D[d];!a.hasDefault&&e.hasDefault&&e.includeInInit&&(a.hasDefault=!0,a.defaultValueExpression=e.defaultValueExpression,v=!0),D[d]=a}else D.push(a),d=D.length-1;if(!b&&I&&!i&&!v){const n=D.findIndex((e=>e.hasDefault&&e.includeInInit&&!e.isKeywordOnly));n>=0&&n<d&&e.addDiagnostic(p.getFileInfo(t).diagnosticRuleSet.reportGeneralTypeIssues,l.DiagnosticRule.reportGeneralTypeIssues,c.Localizer.Diagnostic.dataClassFieldWithDefault(),s)}}}}else{const i=s.getDeclarations();if(0===i.length)return;const r=i[i.length-1];if(1!==r.type)return;const a=r.node.parent;if(!a||3!==a.nodeType)return;if(9===a.rightExpression.nodeType){_(e.getTypeOfExpression(a.rightExpression.leftExpression,2).type,(null===(o=n.details.dataClassBehaviors)||void 0===o?void 0:o.fieldDescriptorNames)||[])&&e.addDiagnostic(p.getFileInfo(t).diagnosticRuleSet.reportGeneralTypeIssues,l.DiagnosticRule.reportGeneralTypeIssues,c.Localizer.Diagnostic.dataClassFieldWithoutAnnotation(),a.rightExpression)}}}})),n.details.dataClassEntries=F,E.forEach((e=>{e.entry.type=e.evaluator()}));const k=n.details.fields,w=[];i||s||(P&&(D.forEach((t=>{if(t.includeInInit){let i=t.type;if(t.classType!==n&&(0,T.requiresSpecialization)(i)){const e=new v.TypeVarContext((0,T.getTypeVarScopeId)(t.classType));(0,T.populateTypeVarContextForSelfType)(e,t.classType,n),i=(0,T.applySolvedTypeVars)(i,e)}i=function(e,t){if(!(0,f.isClassInstance)(t))return t;const n=(0,T.lookUpObjectMember)(t,"__set__");if(!n)return t;const i=e.getTypeOfMember(n);if(!(0,f.isFunction)(i))return t;const s=e.bindFunctionToClassOrObject(t,i);if(!s||!(0,f.isFunction)(s)||s.details.parameters.length<2)return t;return f.FunctionType.getEffectiveParameterType(s,1)}(e,i),t.converter&&(i=function(e,t,n,i){var s;const r=function(e,t){if((0,f.isFunction)(t)||(0,f.isOverloadedFunction)(t))return t;if((0,f.isClassInstance)(t))return e.getBoundMethod(t,"__call__");if((0,f.isInstantiableClass)(t))return(0,d.createFunctionFromConstructor)(e,t);return}(e,e.getTypeOfExpression(t.valueExpression).type);if(!r)return n;const a=f.TypeVarType.createInstance("__converterInput");a.scopeId=(0,y.getScopeIdForNode)(t);const u=f.FunctionType.createSynthesizedInstance("");if(u.details.typeVarScopeId=a.scopeId,u.details.declaredReturnType=n,f.FunctionType.addParameter(u,{category:0,name:"__input",type:a,hasDeclaredType:!0}),f.FunctionType.addParameter(u,{category:0,name:"",type:f.UnknownType.create()}),(0,f.isFunction)(r)){const d=new v.TypeVarContext(a.scopeId),y=new o.DiagnosticAddendum;if(e.assignType(u,r,y,d)){return(0,T.applySolvedTypeVars)(a,d,{unknownIfNotFound:!0})}e.addDiagnostic(p.getFileInfo(t).diagnosticRuleSet.reportGeneralTypeIssues,l.DiagnosticRule.reportGeneralTypeIssues,c.Localizer.Diagnostic.dataClassConverterFunction().format({argType:e.printType(r),fieldType:e.printType(n),fieldName:i})+y.getString(),t,null!==(s=y.getEffectiveTextRange())&&void 0!==s?s:t)}else{const s=[],d=new o.DiagnosticAddendum;if(f.OverloadedFunctionType.getOverloads(r).forEach((t=>{const n=new v.TypeVarContext(a.scopeId);if(e.assignType(u,t,d,n)){const e=(0,T.applySolvedTypeVars)(a,n,{unknownIfNotFound:!0});s.push(e)}})),s.length>0)return(0,f.combineTypes)(s);e.addDiagnostic(p.getFileInfo(t).diagnosticRuleSet.reportGeneralTypeIssues,l.DiagnosticRule.reportGeneralTypeIssues,c.Localizer.Diagnostic.dataClassConverterOverloads().format({funcName:r.overloads[0].details.name||"<anonymous function>",fieldType:e.printType(n),fieldName:i})+d.getString(),t)}return n}(e,t.converter,i,t.name));const s=t.alias||t.name;!t.alias&&t.nameNode&&(0,g.isPrivateName)(t.nameNode.value)&&e.addError(c.Localizer.Diagnostic.dataClassFieldWithPrivateName(),t.nameNode);const r={category:0,name:s,hasDefault:t.hasDefault,defaultValueExpression:t.defaultValueExpression,type:i,hasDeclaredType:!0};t.isKeywordOnly?w.push(r):f.FunctionType.addParameter(S,r)}})),w.length>0&&(f.FunctionType.addParameter(S,{category:1,type:f.AnyType.create()}),w.forEach((e=>{f.FunctionType.addParameter(S,e)})))),k.set("__init__",h.Symbol.createWithType(4,S)),k.set("__new__",h.Symbol.createWithType(4,C)));const N=e.getBuiltInType(t,"str"),R=e.getBuiltInType(t,"tuple");if(R&&(0,f.isInstantiableClass)(R)&&N&&(0,f.isInstantiableClass)(N)&&!k.has("__match_args__")){const e=[];D.forEach((t=>{t.includeInInit&&!t.isKeywordOnly&&e.push(t.name)}));const t=e.map((e=>({type:f.ClassType.cloneAsInstance(f.ClassType.cloneWithLiteral(N,e)),isUnbounded:!1}))),n=f.ClassType.cloneAsInstance((0,T.specializeTupleClass)(R,t));k.set("__match_args__",h.Symbol.createWithType(4,n))}const O=(n,i)=>{const s=f.FunctionType.createSynthesizedInstance(n);f.FunctionType.addParameter(s,x),f.FunctionType.addParameter(s,{category:0,name:"other",type:i,hasDeclaredType:!0}),s.details.declaredReturnType=e.getBuiltInObject(t,"bool"),k.get(n)||k.set(n,h.Symbol.createWithType(4,s))};if(f.ClassType.isSkipSynthesizedDataClassEq(n)||O("__eq__",e.getBuiltInObject(t,"object")),f.ClassType.isSynthesizedDataclassOrder(n)){const e=f.ClassType.cloneAsInstance(n);["__lt__","__le__","__gt__","__ge__"].forEach((t=>{O(t,e)}))}let M=!f.ClassType.isSkipSynthesizedDataClassEq(n)&&f.ClassType.isFrozenDataClass(n);const L=!f.ClassType.isSkipSynthesizedDataClassEq(n)&&!f.ClassType.isFrozenDataClass(n);if(r&&(M=!1),f.ClassType.isSynthesizeDataClassUnsafeHash(n)&&(M=!0),M){const n=f.FunctionType.createSynthesizedInstance("__hash__");f.FunctionType.addParameter(n,x),n.details.declaredReturnType=e.getBuiltInObject(t,"int"),k.set("__hash__",h.Symbol.createWithType(4,n))}else L&&!r&&k.set("__hash__",h.Symbol.createWithType(4,f.NoneType.createInstance()));let V=e.getBuiltInType(t,"dict");if((0,f.isInstantiableClass)(V)&&(V=f.ClassType.cloneAsInstance(f.ClassType.cloneForSpecialization(V,[e.getBuiltInObject(t,"str"),f.AnyType.create()],!0))),k.set("__dataclass_fields__",h.Symbol.createWithType(132,V)),f.ClassType.isGeneratedDataClassSlots(n)&&void 0===n.details.localSlotsNames&&(n.details.localSlotsNames=F.map((e=>e.name))),f.ClassType.isGeneratedDataClassSlots(n)){let n=null!==(b=e.getTypingType(t,"Iterable"))&&void 0!==b?b:f.UnknownType.create();(0,f.isInstantiableClass)(n)&&(n=f.ClassType.cloneAsInstance(f.ClassType.cloneForSpecialization(n,[e.getBuiltInObject(t,"str")],!0))),k.set("__slots__",h.Symbol.createWithType(132,n))}(0,u.updateNamedTupleBaseClass)(n,D.map((e=>e.type)),!0)&&(0,T.computeMroLinearization)(n)},t.validateDataClassTransformDecorator=function(e,t){const n={keywordOnlyParams:!1,generateEq:!0,generateOrder:!1,frozen:!1,fieldDescriptorNames:[]},i=p.getFileInfo(t);return t.arguments.forEach((t=>{if(t.name&&0===t.argumentCategory)switch(t.name.value){case"kw_only_default":{const s=(0,m.evaluateStaticBoolExpression)(t.valueExpression,i.executionEnvironment,i.definedConstants);if(void 0===s)return void e.addError(c.Localizer.Diagnostic.dataClassTransformExpectedBoolLiteral(),t.valueExpression);n.keywordOnlyParams=s;break}case"eq_default":{const s=(0,m.evaluateStaticBoolExpression)(t.valueExpression,i.executionEnvironment,i.definedConstants);if(void 0===s)return void e.addError(c.Localizer.Diagnostic.dataClassTransformExpectedBoolLiteral(),t.valueExpression);n.generateEq=s;break}case"order_default":{const s=(0,m.evaluateStaticBoolExpression)(t.valueExpression,i.executionEnvironment,i.definedConstants);if(void 0===s)return void e.addError(c.Localizer.Diagnostic.dataClassTransformExpectedBoolLiteral(),t.valueExpression);n.generateOrder=s;break}case"frozen_default":{const s=(0,m.evaluateStaticBoolExpression)(t.valueExpression,i.executionEnvironment,i.definedConstants);if(void 0===s)return void e.addError(c.Localizer.Diagnostic.dataClassTransformExpectedBoolLiteral(),t.valueExpression);n.frozen=s;break}case"field_descriptors":case"field_specifiers":{const i=e.getTypeOfExpression(t.valueExpression).type;if(!(0,f.isClassInstance)(i)||!f.ClassType.isBuiltIn(i,"tuple")||!i.tupleTypeArguments||i.tupleTypeArguments.some((e=>!(0,f.isInstantiableClass)(e.type)&&!(0,f.isFunction)(e.type)&&!(0,f.isOverloadedFunction)(e.type))))return void e.addError(c.Localizer.Diagnostic.dataClassTransformFieldSpecifier().format({type:e.printType(i)}),t.valueExpression);n.fieldDescriptorNames||(n.fieldDescriptorNames=[]),i.tupleTypeArguments.forEach((e=>{(0,f.isInstantiableClass)(e.type)||(0,f.isFunction)(e.type)?n.fieldDescriptorNames.push(e.type.details.fullName):(0,f.isOverloadedFunction)(e.type)&&n.fieldDescriptorNames.push(e.type.overloads[0].details.fullName)}));break}default:e.addError(c.Localizer.Diagnostic.dataClassTransformUnknownArgument().format({name:t.name.value}),t.valueExpression)}else e.addError(c.Localizer.Diagnostic.dataClassTransformPositionalParam(),t)})),n},t.getDataclassDecoratorBehaviors=function(e){var t;let n;if((0,f.isFunction)(e)?n=e:(0,f.isOverloadedFunction)(e)&&(n=null!==(t=e.overloads.find((e=>!!e.details.decoratorDataClassBehaviors)))&&void 0!==t?t:e.overloads[0]),n)return n.details.decoratorDataClassBehaviors?n.details.decoratorDataClassBehaviors:"dataclasses.dataclass"===n.details.fullName?{keywordOnlyParams:!1,generateEq:!0,generateOrder:!1,frozen:!1,fieldDescriptorNames:["dataclasses.field","dataclasses.Field"]}:void 0},t.applyDataClassClassBehaviorOverrides=I,t.applyDataClassDefaultBehaviors=C,t.applyDataClassDecorator=function(e,t,n,i,s){var r;C(n,i),I(e,t,n,null!==(r=null==s?void 0:s.arguments)&&void 0!==r?r:[],i)}},44660:(e,t)=>{function n(e){return 8===e.type}Object.defineProperty(t,"__esModule",{value:!0}),t.isUnresolvedAliasDeclaration=t.isIntrinsicDeclaration=t.isSpecialBuiltInClassDeclaration=t.isAliasDeclaration=t.isVariableDeclaration=t.isTypeAliasDeclaration=t.isTypeParameterDeclaration=t.isParameterDeclaration=t.isClassDeclaration=t.isFunctionDeclaration=t.UnresolvedModuleMarker=void 0,t.UnresolvedModuleMarker="*** unresolved ***",t.isFunctionDeclaration=function(e){return 5===e.type},t.isClassDeclaration=function(e){return 6===e.type},t.isParameterDeclaration=function(e){return 2===e.type},t.isTypeParameterDeclaration=function(e){return 3===e.type},t.isTypeAliasDeclaration=function(e){return 4===e.type},t.isVariableDeclaration=function(e){return 1===e.type},t.isAliasDeclaration=n,t.isSpecialBuiltInClassDeclaration=function(e){return 7===e.type},t.isIntrinsicDeclaration=function(e){return 0===e.type},t.isUnresolvedAliasDeclaration=function(e){return n(e)&&e.path===t.UnresolvedModuleMarker}},2848:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.resolveAliasDeclaration=t.createSynthesizedAliasDeclaration=t.getDeclarationsWithUsesLocalNameRemoved=t.isDefinedInFile=t.getNameNodeForDeclaration=t.getNameFromDeclaration=t.areDeclarationsSame=t.hasTypeForDeclaration=void 0;const i=n(6698),s=n(44660),r=n(66455);t.hasTypeForDeclaration=function(e){switch(e.type){case 0:case 6:case 7:case 5:case 3:case 4:return!0;case 2:{if(e.node.typeAnnotation||e.node.typeAnnotationComment)return!0;const t=e.node.parent;if(28===(null==t?void 0:t.nodeType)&&t.functionAnnotationComment&&!t.functionAnnotationComment.isParamListEllipsis){const n=t.functionAnnotationComment.paramTypeAnnotations;return!(t.parameters.length>n.length&&e.node===t.parameters[0])}return!1}case 1:return!!e.typeAnnotationNode;case 8:return!1}},t.areDeclarationsSame=function(e,t,n=!1,i=!1){if(e.type!==t.type)return!1;if(e.path!==t.path)return!1;if(!(i&&8===e.type||e.range.start.line===t.range.start.line&&e.range.start.character===t.range.start.character))return!1;if(8===e.type&&8===t.type){if(e.symbolName!==t.symbolName||e.usesLocalName!==t.usesLocalName)return!1;if(n)return!0;if(e.firstNamePart!==t.firstNamePart)return!1}return!0},t.getNameFromDeclaration=function(e){var t;switch(e.type){case 8:return e.symbolName;case 6:case 5:case 3:return e.node.name.value;case 2:return null===(t=e.node.name)||void 0===t?void 0:t.value;case 1:return 38===e.node.nodeType?e.node.value:void 0;case 0:case 7:return}throw new Error("Shouldn't reach here")},t.getNameNodeForDeclaration=function(e){var t,n;switch(e.type){case 8:return 21===e.node.nodeType?null!==(t=e.node.alias)&&void 0!==t?t:e.node.module.nameParts[0]:23===e.node.nodeType?null!==(n=e.node.alias)&&void 0!==n?n:e.node.name:e.node.module.nameParts[0];case 6:case 5:case 3:case 2:return e.node.name;case 1:return 38===e.node.nodeType?e.node:void 0;case 0:case 7:return}throw new Error("Shouldn't reach here")},t.isDefinedInFile=function(e,t){var n;return(0,s.isAliasDeclaration)(e)?(null===(n=(0,r.getFileInfoFromNode)(e.node))||void 0===n?void 0:n.filePath)===t:e.path===t},t.getDeclarationsWithUsesLocalNameRemoved=function(e){return e.map((e=>{if(8!==e.type)return e;const t={...e};return t.usesLocalName=!1,t}))},t.createSynthesizedAliasDeclaration=function(e){return{type:8,node:void 0,path:e,loadSymbolsFromPath:!1,range:(0,i.getEmptyRange)(),implicitImports:new Map,usesLocalName:!1,moduleName:"",isInExceptSuite:!1}},t.resolveAliasDeclaration=function e(t,n,i){let s=n;const r=[];let a,o,l=!1,c=!1;for(;;){if(8!==s.type||!s.symbolName)return{declaration:s,isPrivate:l,privatePyTypedImported:a,privatePyTypedImporter:o};if(!i.resolveLocalNames&&s.usesLocalName)return{declaration:s,isPrivate:l,privatePyTypedImported:a,privatePyTypedImporter:o};let p;s.path&&s.loadSymbolsFromPath&&(p=t(s.path,{skipFileNeededCheck:i.skipFileNeededCheck}));const d=p?p.symbolTable.get(s.symbolName):void 0;if(!d){if(s.submoduleFallback){if(s.symbolName&&s.path&&8===s.submoduleFallback.type&&s.submoduleFallback.path){if(!t(s.submoduleFallback.path,{skipFileNeededCheck:i.skipFileNeededCheck}))return}return e(t,s.submoduleFallback,i)}return s.isNativeLib?{declaration:void 0,isPrivate:l}:void 0}if(d.isPrivateMember()&&(l=!0),d.isExternallyHidden()&&!i.allowExternallyHiddenAccess)return;let u=d.getTypedDeclarations();if(u=u.filter((e=>!e.isInExceptSuite)),0===u.length&&(u=d.getDeclarations(),u=u.filter((e=>!e.isInExceptSuite))),0===u.length&&(u=d.getDeclarations()),0===u.length)return;const y=u.filter((e=>!r.includes(e)));if(s=y.length>0?y[y.length-1]:u[u.length-1],(null==p?void 0:p.isInPyTypedPackage)&&(c?d.isPrivatePyTypedImport()||(a=null!=a?a:null==s?void 0:s.moduleName):(d.isPrivatePyTypedImport()&&(o=null==s?void 0:s.moduleName),c=!0)),r.find((e=>e===s)))return s.path===n.path&&8===s.type&&s.submoduleFallback?e(t,s.submoduleFallback,i):{declaration:n,isPrivate:l,privatePyTypedImported:a,privatePyTypedImporter:o};r.push(s)}}},67673:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.convertDocStringToPlainText=t.convertDocStringToMarkdown=void 0;const i=n(91128);t.convertDocStringToMarkdown=function(e){return new N(e).convert()},t.convertDocStringToPlainText=function(e){const t=(0,i.cleanAndSplitDocString)(e),n=[];for(const e of t){const t=n.length>0?n[n.length-1]:void 0;O(e)&&O(t)||n.push(e)}return n.join("\n").trimEnd()};const s=/\S|$/,r=/\S/,a=/^\s*~~~+$/,o=/^\s*\+\+\++$/,l=/^\s*===+\s+===+$/,c=/^\s*---+\s+---+$/,p=/^(\s*)-\s/,d=/^(\s*)\*\s/,u=/^(\s*)\d+\.\s/,y=/^(\s+\* )(.*)$/,m=/^\s*\.\. /,h=/^\s*\.\.\s+(\w+)::\s*(.*)$/,g=/ *>>> /,f=/^\s*:(param|arg|type|return|rtype|raise|except|var|ivar|cvar|copyright|license)/,T=/^\.[\s\t]+(@\w)/gm,v=/^(\.\s{3})|^(\.)/,_=[{exp:/^\s*=+(\s+=+)+$/,replacement:"="},{exp:/^\s*-+(\s+-+)+$/,replacement:"-"},{exp:/^\s*~+(\s+-+)+$/,replacement:"~"},{exp:/^\s*\++(\s+\++)+$/,replacement:"+"}],b=/\s/g,I=/``/g,C=/~/g,S=/\+/g,x=/(?<!\\)([_*~[\]])/g,F=/(\[.*\]\(.*\))/g,D=/^\s*```(\w*)/,P=/^\s*```/,E=[{exp:/</g,replacement:"&lt;"},{exp:/>/g,replacement:"&gt;"}],A="  \n",k=/^\s*::$/,w=[{exp:/\s+::$/g,replacement:""},{exp:/(\S)\s*::$/g,replacement:"$1:"},{exp:/:[\w_\-+:.]+:`/g,replacement:"`"},{exp:/`:[\w_\-+:.]+:/g,replacement:"`"}];class N{constructor(e){this._builder="",this._skipAppendEmptyLine=!0,this._insideInlineCode=!1,this._appendDirectiveBlock=!1,this._stateStack=[],this._lineNum=0,this._blockIndent=0,this._state=this._parseText,this._input=e,this._lines=(0,i.cleanAndSplitDocString)(e)}convert(){for(T.test(this._input)&&(this._lines=this._lines.map((e=>e.replace(v,""))));void 0!==this._currentLineOrUndefined();){const e=this._state,t=this._lineNum;if(this._state(),this._state===e&&this._lineNum===t)break}return this._state===this._parseBacktickBlock||this._state===this._parseDocTest||this._state===this._parseLiteralBlock?this._trimOutputAndAppendLine("```"):this._insideInlineCode&&this._trimOutputAndAppendLine("`",!0),this._builder.trim()}_eatLine(){this._lineNum++}_currentLineOrUndefined(){return this._lineNum<this._lines.length?this._lines[this._lineNum]:void 0}_currentLine(){return this._currentLineOrUndefined()||""}_currentIndent(){return R(this._currentLine())}_prevIndent(){var e;return R(null!==(e=this._lineAt(this._lineNum-1))&&void 0!==e?e:"")}_lineAt(e){return e<this._lines.length?this._lines[e]:void 0}_nextBlockIndent(){return R(this._lines.slice(this._lineNum+1).find((e=>!O(e)))||"")}_currentLineIsOutsideBlock(){return this._currentIndent()<this._blockIndent}_currentLineWithinBlock(){return this._currentLine().substr(this._blockIndent)}_pushAndSetState(e){this._state===this._parseText&&(this._insideInlineCode=!1),this._stateStack.push(this._state),this._state=e}_popState(){this._state=this._stateStack.splice(0,1)[0],this._state===this._parseText&&(this._insideInlineCode=!1)}_parseText(){if(O(this._currentLineOrUndefined()))return void(this._state=this._parseEmpty);if(this._beginBacktickBlock())return;if(this._beginLiteralBlock())return;if(this._beginDocTest())return;if(this._beginDirective())return;if(this._beginList())return;if(this._beginFieldList())return;if(this._beginTableBlock())return;const e=this._formatPlainTextIndent(this._currentLine());this._appendTextLine(e),this._eatLine()}_formatPlainTextIndent(e){const t=this._lineAt(this._lineNum-1),n=this._prevIndent(),i=this._currentIndent();return!(i>n)||O(t)||this._builder.endsWith(A)||this._builder.endsWith("\n\n")||M(t)||(this._builder=this._builder.slice(0,-1)+A),n>i&&!O(t)&&!this._builder.endsWith(A)&&!this._builder.endsWith("\n\n")&&(this._builder=this._builder.slice(0,-1)+A),e=0===n||this._builder.endsWith(A)||this._builder.endsWith("\n\n")?this._convertIndent(e):e.trimStart()}_convertIndent(e){return e=e.replace(/^([ \t]+)(.+)$/g,((e,t,n)=>"&nbsp;".repeat(t.length)+n))}_escapeHtml(e){return E.forEach((t=>{e=e.replace(t.exp,t.replacement)})),e}_appendTextLine(e){const t=(e=this._preprocessTextLine(e)).split("`");for(let e=0;e<t.length;e++){let n=t[e];if(e>0&&(this._insideInlineCode=!this._insideInlineCode,this._append("`")),this._insideInlineCode){this._append(n);continue}if(n=this._escapeHtml(n),0===e){if(1===t.length){for(const e of _)if(e.exp.test(n)){n=n.replace(b,e.replacement);break}if(a.test(n)){this._append(n.replace(C,"-"));continue}if(o.test(n)){this._append(n.replace(S,"-"));continue}}const e=y.exec(n);null!==e&&3===e.length&&(this._append(e[1]),n=e[2])}n.split(F).forEach((e=>{F.test(e)?this._append(e):this._append(e.replace(x,"\\$1"))}))}this._builder+="\n"}_preprocessTextLine(e){return k.test(e)?"":(w.forEach((t=>e=e.replace(t.exp,t.replacement))),e=e.replace(I,"`"))}_parseEmpty(){if(O(this._currentLineOrUndefined()))return this._appendLine(),void this._eatLine();this._state=this._parseText}_beginMinIndentCodeBlock(e){this._appendLine("```"),this._pushAndSetState(e),this._blockIndent=this._currentIndent()}_beginBacktickBlock(){const e=this._currentLine().match(D);return null!==e&&(this._blockIndent=this._currentIndent(),this._appendLine("```"+e[1]),this._pushAndSetState(this._parseBacktickBlock),this._eatLine(),!0)}_parseBacktickBlock(){P.test(this._currentLine())&&this._currentIndent()===this._blockIndent?(this._appendLine("```"),this._appendLine(),this._popState()):this._appendLine(this._currentLine()),this._eatLine()}_beginDocTest(){return!!g.test(this._currentLine())&&(this._beginMinIndentCodeBlock(this._parseDocTest),this._appendLine(this._currentLineWithinBlock()),this._eatLine(),!0)}_parseDocTest(){if(this._currentLineIsOutsideBlock()||O(this._currentLine()))return this._trimOutputAndAppendLine("```"),this._appendLine(),void this._popState();this._appendLine(this._currentLineWithinBlock()),this._eatLine()}_beginLiteralBlock(){const e=this._lineAt(this._lineNum-1);if(void 0===e)return!1;if(!O(e))return!1;let t=this._lineNum-2;for(;t>=0;t--){const e=this._lineAt(t);if(!O(e)){if(e.endsWith("::"))break;return!1}}return!(t<0)&&(0===this._currentIndent()?(this._appendLine("```"),this._pushAndSetState(this._parseLiteralBlockSingleLine),!0):(this._beginMinIndentCodeBlock(this._parseLiteralBlock),!0))}_parseLiteralBlock(){if(O(this._currentLineOrUndefined()))return this._appendLine(),void this._eatLine();const e=this._lineAt(this._lineNum-1);if(this._currentLineIsOutsideBlock()&&O(e))return this._trimOutputAndAppendLine("```"),this._appendLine(),void this._popState();this._appendLine(this._currentLine()),this._eatLine()}_parseLiteralBlockSingleLine(){this._appendLine(this._currentLine()),this._appendLine("```"),this._appendLine(),this._popState(),this._eatLine()}_beginDirective(){return!!m.test(this._currentLine())&&(this._pushAndSetState(this._parseDirective),this._blockIndent=this._nextBlockIndent(),this._appendDirectiveBlock=!1,!0)}_beginFieldList(){if(this._insideInlineCode)return!1;let e=this._currentLine();if(e.startsWith("@"))return this._appendLine(),this._appendTextLine(e),this._eatLine(),!0;const t=!(null==e?void 0:e.endsWith(":"))&&!(null==e?void 0:e.endsWith("::"))&&!!e.match(/^\s*.*?\w+(\s*\(\w+\))*\s*:\s*\w+/g),n=f.test(e);if(t||n){const t=this._lineAt(this._lineNum-1);return this._builder.endsWith(A)||this._builder.endsWith("\n\n")||M(t)||(this._builder=this._builder.slice(0,-1)+A),e=this._convertIndent(e),this._appendTextLine(e),this._eatLine(),!0}return!1}_beginTableBlock(){if(this._insideInlineCode)return!1;const e=this._currentLine();return!!l.test(e)&&(this._tableState={header:e.trimStart(),inHeader:!0},this._eatLine(),this._pushAndSetState(this._parseTableBlock),!0)}_parseTableBlock(){if(O(this._currentLineOrUndefined())||!this._tableState)return this._tableState=void 0,void this._popState();let e=this._currentLine();if(l.test(e))return this._eatLine(),this._appendLine("\n<br/>\n"),this._popState(),void(this._tableState=void 0);{let t="|";const n=this._tableState.header.split(" "),i=[];if(this._tableState.inHeader){do{let t=0;for(let s=0;s<n.length;s++){const r=n[s].length+1,a=e.slice(t,t+r);void 0===i[s]?i[s]=`${a} `:i[s]=i[s].concat(`<br>${a} `),t+=r}this._eatLine(),e=this._currentLine()}while(!O(this._currentLineOrUndefined())&&!c.test(e)&&!l.test(e));this._tableState.inHeader=!1,i.forEach((e=>{t+=`${e}|`})),this._appendLine(t);const s=e.trimStart().replace(/=/g,"-").replace(" ","|");this._appendLine(`|${s}|`),this._eatLine()}else{let i=0;n.forEach((n=>{const s=n.length+1,r=e.slice(i,i+s);t+=`${r}|`,i+=s})),this._appendLine(t),this._eatLine()}}}_beginList(){if(this._insideInlineCode)return!1;let e=this._currentLine();const t=p.exec(e);if(2===(null==t?void 0:t.length))return t[1].length>=4&&(e=" ".repeat(t[1].length/2)+e.trimLeft()),this._appendTextLine(e),this._eatLine(),this._state!==this._parseList&&this._pushAndSetState(this._parseList),!0;const n=d.exec(e);if(2===(null==n?void 0:n.length))return 0===n[1].length?e=e=" "+e:n[1].length>=4&&(e=" ".repeat(n[1].length/2)+e.trimLeft()),this._appendTextLine(e),this._eatLine(),this._state!==this._parseList&&this._pushAndSetState(this._parseList),!0;const i=u.exec(e);return 2===(null==i?void 0:i.length)&&(this._appendTextLine(e),this._eatLine(),!0)}_parseList(){if(O(this._currentLineOrUndefined())||this._currentLineIsOutsideBlock())return void this._popState();if(!this._beginList()){const e=this._currentLine().trimStart();this._appendTextLine(e),this._eatLine()}}_parseDirective(){const e=h.exec(this._currentLine());if(null!==e&&3===e.length){const t=e[1],n=e[2];"class"===t&&(this._appendDirectiveBlock=!0,this._appendLine(),this._appendLine("```"),this._appendLine(n),this._appendLine("```"),this._appendLine())}0===this._blockIndent?this._popState():this._state=this._parseDirectiveBlock,this._eatLine()}_parseDirectiveBlock(){O(this._currentLineOrUndefined())||!this._currentLineIsOutsideBlock()?(this._appendDirectiveBlock&&this._appendTextLine(this._currentLine().trimLeft()),this._eatLine()):this._popState()}_appendLine(e){O(e)?this._skipAppendEmptyLine||(this._builder+="\n",this._skipAppendEmptyLine=!0):(this._builder+=e+"\n",this._skipAppendEmptyLine=!1)}_append(e){this._builder+=e,this._skipAppendEmptyLine=!1}_trimOutputAndAppendLine(e,t=!1){this._builder=this._builder.trimRight(),this._skipAppendEmptyLine=!1,t||this._appendLine(),this._appendLine(e)}}function R(e){return e.search(s)}function O(e){return void 0===e||!r.test(e)}function M(e){var t,n;return void 0!==e&&(null!==(n=null===(t=e.match(/^\s*[#`~=-]{3,}/))||void 0===t?void 0:t.length)&&void 0!==n?n:0)>0}},91128:(e,t)=>{function n(e){const t=e.replace(/\r/g,"").replace(/\t/g,"        ").split("\n");let n=Number.MAX_VALUE;t.forEach(((e,i)=>{if(t.length<=1||i>0){const t=e.trimLeft();t&&(n=Math.min(n,e.length-t.length))}})),n>=Number.MAX_VALUE&&(n=0);const i=[];for(t.forEach(((e,t)=>{0===t?i.push(e.trim()):i.push(e.substr(n).trimRight())}));i.length>0&&0===i[0].length;)i.shift();for(;i.length>0&&0===i[i.length-1].length;)i.pop();return i}Object.defineProperty(t,"__esModule",{value:!0}),t.extractParameterDocumentation=t.cleanAndSplitDocString=t.cleanDocString=void 0,t.cleanDocString=function(e){return n(e).join("\n")},t.cleanAndSplitDocString=n,t.extractParameterDocumentation=function(e,t){if(!e||!t)return;const i=n(e);for(const e of i){const n=e.trim();let i=n.indexOf("@param "+t);if(i>=0)return n.substr(i+7);if(i=n.indexOf(":param "+t),i>=0)return n.substr(i+7);if(i=n.indexOf(t+": "),i>=0)return n.substr(i);if(i=n.indexOf(t+" ("),i>=0)return n.substr(i)}}},92814:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getEnumAutoValueType=t.getTypeOfEnumMember=t.isDeclInEnumClass=t.transformTypeForPossibleEnumClass=t.createEnumType=t.isKnownEnumType=void 0;const i=n(30795),s=n(21),r=n(66455),a=n(16682),o=n(48466),l=n(36906),c=n(33029),p=n(51458);t.isKnownEnumType=function(e){return["Enum","IntEnum","StrEnum","Flag","IntFlag"].some((t=>t===e))},t.createEnumType=function(e,t,n,i){const o=(0,s.getFileInfo)(t);if(0===i.length)return;const l=i[0];if(0!==l.argumentCategory||!l.valueExpression||48!==l.valueExpression.nodeType||1!==l.valueExpression.strings.length||49!==l.valueExpression.strings[0].nodeType)return;const d=l.valueExpression.strings.map((e=>e.value)).join(""),u=p.ClassType.createInstantiable(d,(0,r.getClassFullName)(t,o.moduleName,d),o.moduleName,o.filePath,1048576,(0,r.getTypeSourceId)(t),void 0,n.details.effectiveMetaclass);u.details.baseClasses.push(n),(0,c.computeMroLinearization)(u);const y=u.details.fields;if(y.set("__class__",a.Symbol.createWithType(68,u)),i.length<2)return;const m=i[1];if(0!==m.argumentCategory||!m.valueExpression)return;const h=e.getBuiltInType(t,"int");if(!h||!(0,p.isInstantiableClass)(h))return;const g=p.ClassType.cloneAsInstance(u);if(48===m.valueExpression.nodeType){if(!m.valueExpression.strings.every((e=>49===e.nodeType)))return;const e=m.valueExpression.strings.map((e=>e.value)).join("").trim().split(/[\s,]+/);for(const[t,n]of e.entries()){if(!n)return;const e=p.ClassType.cloneWithLiteral(p.ClassType.cloneAsInstance(h),t+1),i=new p.EnumLiteral(u.details.fullName,u.details.name,n,e),s=a.Symbol.createWithType(4,p.ClassType.cloneWithLiteral(g,i));y.set(n,s)}return u}if(31===m.valueExpression.nodeType||52===m.valueExpression.nodeType){const t=31===m.valueExpression.nodeType?m.valueExpression.entries:m.valueExpression.expressions;if(0===t.length)return;let n=!1;for(const[i,s]of t.entries()){let t,r;if(0===i&&(n=48===s.nodeType),48===s.nodeType){if(!n)return;t=s,r=p.ClassType.cloneWithLiteral(p.ClassType.cloneAsInstance(h),i+1)}else{if(52!==s.nodeType)return;if(n)return;if(2!==s.expressions.length)return;t=s.expressions[0],r=e.getTypeOfExpression(s.expressions[1]).type}if(48!==t.nodeType||1!==t.strings.length||49!==t.strings[0].nodeType)return;const o=t.strings[0].value,l=new p.EnumLiteral(u.details.fullName,u.details.name,o,r),c=a.Symbol.createWithType(4,p.ClassType.cloneWithLiteral(g,l));y.set(o,c)}}if(15===m.valueExpression.nodeType){const t=m.valueExpression.entries;if(0===t.length)return;for(const n of t){if(17!==n.nodeType)return;const t=n.keyExpression,i=e.getTypeOfExpression(n.valueExpression).type;if(48!==t.nodeType||1!==t.strings.length||49!==t.strings[0].nodeType)return;const s=t.strings[0].value,r=new p.EnumLiteral(u.details.fullName,u.details.name,s,i),o=a.Symbol.createWithType(4,p.ClassType.cloneWithLiteral(g,r));y.set(s,o)}}return u},t.transformTypeForPossibleEnumClass=function(e,t,n){var i,a,l,d;const u=(0,r.getEnclosingClass)(t,!0);if(!u)return;const y=e.getTypeOfClass(u);if(!y||!p.ClassType.isEnumClass(y.classType))return;let m,h=3===(null===(i=t.parent)||void 0===i?void 0:i.nodeType)&&t.parent.leftExpression===t||54===(null===(a=t.parent)||void 0===a?void 0:a.nodeType)&&t.parent.valueExpression===t&&3===(null===(l=t.parent.parent)||void 0===l?void 0:l.nodeType)||(0,s.getFileInfo)(t).isStubFile&&54===(null===(d=t.parent)||void 0===d?void 0:d.nodeType)&&t.parent.valueExpression===t;if((0,o.isSingleDunderName)(t.value)&&(h=!1),"name"!==t.value&&"value"!==t.value||(h=!1),m=(0,c.lookUpClassMember)(y.classType,"__new__",2)?p.AnyType.create():n(),(0,p.isClassInstance)(m)&&m.details.fields.get("__get__")&&(h=!1),h){const e=new p.EnumLiteral(y.classType.details.fullName,y.classType.details.name,t.value,m);return p.ClassType.cloneAsInstance(p.ClassType.cloneWithLiteral(y.classType,e))}},t.isDeclInEnumClass=function(e,t){const n=(0,r.getEnclosingClass)(t.node,!0);if(!n)return!1;const i=e.getTypeOfClass(n);return!!i&&p.ClassType.isEnumClass(i.classType)},t.getTypeOfEnumMember=function(e,t,n,s,r){if(!p.ClassType.isEnumClass(n))return;const a=n.literalValue;if("name"===s||"_name_"===s){const s=e.getBuiltInType(t,"str");if(!(0,p.isInstantiableClass)(s))return;const o=e=>p.ClassType.cloneAsInstance(p.ClassType.cloneWithLiteral(s,e.itemName));if(a)return(0,i.assert)(a instanceof p.EnumLiteral),{type:o(a),isIncomplete:r};const c=(0,l.enumerateLiteralsForType)(e,n);if(c)return{type:(0,p.combineTypes)(c.map((e=>{const t=e.literalValue;return(0,i.assert)(t instanceof p.EnumLiteral),o(t)}))),isIncomplete:r}}if("value"===s||"_value_"===s){if(a)return(0,i.assert)(a instanceof p.EnumLiteral),{type:a.itemType,isIncomplete:r};const t=(0,l.enumerateLiteralsForType)(e,n);if(t)return{type:(0,p.combineTypes)(t.map((e=>{const t=e.literalValue;return(0,i.assert)(t instanceof p.EnumLiteral),t.itemType}))),isIncomplete:r}}},t.getEnumAutoValueType=function(e,t){const n=(0,r.getEnclosingClass)(t);if(n){const i=e.getTypeOfClass(n);if(i){const n=e.getTypeOfObjectMember(t,p.ClassType.cloneAsInstance(i.classType),"_generate_next_value_");if(n&&(0,p.isFunction)(n.type)&&n.classType&&(0,p.isClass)(n.classType)&&!p.ClassType.isBuiltIn(n.classType,"Enum")&&n.type.details.declaredReturnType)return n.type.details.declaredReturnType}}return e.getBuiltInObject(t,"int")}},19948:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.applyFunctionTransform=void 0;const i=n(28513),s=n(99661),r=n(21),a=n(16682),o=n(51458),l=n(33029);t.applyFunctionTransform=function(e,t,n,c,p){return(0,o.isFunction)(c)&&"functools.total_ordering"===c.details.fullName?function(e,t,n,c){var p;if(1!==n.length)return c;const d=null===(p=n[0].typeResult)||void 0===p?void 0:p.type;if(!d||!(0,o.isInstantiableClass)(d)||d.includeSubclasses)return c;const u=["__lt__","__le__","__gt__","__ge__"],y=o.ClassType.cloneAsInstance(d);let m;const h=u.filter((e=>{const t=(0,l.lookUpObjectMember)(y,e,8);return t&&!m&&(m=t),!t}));if(!m)return e.addDiagnostic((0,r.getFileInfo)(t).diagnosticRuleSet.reportGeneralTypeIssues,i.DiagnosticRule.reportGeneralTypeIssues,s.Localizer.Diagnostic.totalOrderingMissingMethod(),t),c;let g;const f=e.getTypeOfMember(m);(0,o.isFunction)(f)&&f.details.parameters.length>=2&&f.details.parameters[1].hasDeclaredType&&(g=f.details.parameters[1].type);if(!g){const n=e.getBuiltInObject(t,"object");if(!n||!(0,o.isClassInstance)(n))return c;g=n}const T=e.getBuiltInObject(t,"bool");if(!T||!(0,o.isClassInstance)(T))return c;const v={category:0,name:"self",type:(0,l.synthesizeTypeVarForSelfCls)(d,!1),hasDeclaredType:!0},_={category:0,name:"__value",type:g,hasDeclaredType:!0};return h.forEach((e=>{const t=o.FunctionType.createSynthesizedInstance(e);o.FunctionType.addParameter(t,v),o.FunctionType.addParameter(t,_),t.details.declaredReturnType=T,d.details.fields.set(e,a.Symbol.createWithType(4,t))})),c}(e,t,n,p):p}},24161:function(e,t,n){var i=this&&this.__createBinding||(Object.create?function(e,t,n,i){void 0===i&&(i=n),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,i){void 0===i&&(i=n),e[i]=t[n]}),s=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&i(t,e,n);return s(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.ImportResolver=t.supportedFileExtensions=t.supportedSourceFileExtensions=t.createImportedModuleDescriptor=void 0;const a=n(5284),o=n(59750),l=n(15813),c=n(81844),p=n(86513),d=r(n(92828)),u=n(92828),y=n(60628),m=n(74188),h=n(87710),g=n(20533),f=r(n(24873)),T=n(41097),v=n(48466);t.createImportedModuleDescriptor=function(e){if(0===e.length)return{leadingDots:0,nameParts:[],importedSymbols:[]};let t=0,n=0;for(;t<e.length&&"."===e[t];t++)n++;return{leadingDots:n,nameParts:e.slice(t).split("."),importedSymbols:[]}};const _=[".pyd",".so",".dylib"];t.supportedSourceFileExtensions=[".py",".pyi"],t.supportedFileExtensions=[...t.supportedSourceFileExtensions,..._];t.ImportResolver=class{constructor(e,t,n){this.fileSystem=e,this._configOptions=t,this.host=n,this._cachedImportResults=new Map,this._cachedModuleNameResults=new Map,this._cachedEntriesForPath=new Map,this.cachedParentImportResults=new g.ParentDirectoryCache((()=>this.getPythonSearchPaths([])))}invalidateCache(){this._cachedImportResults=new Map,this._cachedModuleNameResults=new Map,this.cachedParentImportResults.reset(),this._stdlibModules=void 0,this._invalidateFileSystemCache(),m.SupportPartialStubs.is(this.fileSystem)&&this.fileSystem.clearPartialStubs()}resolveImport(e,t,n){return this.resolveImportInternal(e,t,n)}getCompletionSuggestions(e,t,n){const i=this._getCompletionSuggestionsStrict(e,t,n);if(n.leadingDots>0)return i;const s=this.getParentImportResolutionRoot(e,t.root);let r=(0,c.ensureTrailingDirectorySeparator)((0,c.getDirectoryPath)((0,c.normalizePathCase)(this.fileSystem,(0,c.normalizePath)(e))));for(;this._shouldWalkUp(r,s,t);){let s;if(this._getCompletionSuggestionsAbsolute(e,t,r,n,i,!1),[s,r]=this._tryWalkUp(r),!s)break}return i}getConfigOptions(){return this._configOptions}setConfigOptions(e){this._configOptions=e,this.invalidateCache()}getSourceFilesFromStub(e,t,n){const i=[];if(this._cachedImportResults.forEach((t=>{t.forEach((t=>{if(t.isStubFile&&t.isImportFound&&t.nonStubImportResult&&t.resolvedPaths[t.resolvedPaths.length-1]===e&&t.nonStubImportResult.isImportFound){const e=t.nonStubImportResult.resolvedPaths[t.nonStubImportResult.resolvedPaths.length-1];(e.endsWith(".py")||e.endsWith(".pyi"))&&i.push(e)}}))})),0===i.length){const t=(0,c.changeAnyExtension)(e,".py");this.dirExistsCached(t)&&i.push(t)}if(0===i.length){const n=this.getImportRoots(t),s=[];for(const t of n)if((0,c.containsPath)(t,e,!0)){const n=(0,c.getRelativePathComponentsFromDirectory)(t,e,!0);if(n.length>1){n[1].endsWith(l.stubsSuffix)&&(n[1]=n[1].substr(0,n[1].length-l.stubsSuffix.length));const e=(0,c.combinePathComponents)(n);e&&s.push(e)}}for(const e of s)for(const t of n){const n=(0,c.resolvePaths)(t,e);let s=(0,c.changeAnyExtension)(n,".py");if(this.fileExistsCached(s))i.push(s);else{const e=(0,c.stripFileExtension)(s);e.endsWith("__init__")?(s=e.substr(0,e.length-9)+".py",this.fileExistsCached(s)&&i.push(s)):(s=(0,c.combinePaths)(e,"__init__.py"),this.fileExistsCached(s)&&i.push(s))}}}return i}getModuleNameForImport(e,t,n=!1){const i=(0,a.getOrAdd)(this._cachedModuleNameResults,t.root,(()=>new Map));return(0,a.getOrAdd)(i,e,(()=>this._getModuleNameForImport(e,t,n)))}getTypeshedStdLibPath(e){return this._getStdlibTypeshedPath(e,[])}getTypeshedThirdPartyPath(e){return this._getThirdPartyTypeshedPath(e,[])}isStdlibModule(e,t){return this._stdlibModules||(this._stdlibModules=this._buildStdlibCache(this.getTypeshedStdLibPath(t))),this._stdlibModules.has(e.nameParts.join("."))}getImportRoots(e,t=!1){const n=[],i=[],s=this._getStdlibTypeshedPath(e,n);if(s&&i.push(s),e.root&&i.push(e.root),(0,a.appendArray)(i,e.extraPaths),this._configOptions.stubPath&&i.push(this._configOptions.stubPath),t){const t=this._getThirdPartyTypeshedPath(e,n);t&&i.push((0,c.combinePaths)(t,"..."))}else{const t=this._getThirdPartyTypeshedPackageRoots(e,n);(0,a.appendArray)(i,t)}const r=this.getTypeshedPathEx(e,n);r&&i.push(r);const o=this.getPythonSearchPaths(n);return o.length>0&&(0,a.appendArray)(i,o),i}ensurePartialStubPackages(e){if(!m.SupportPartialStubs.is(this.fileSystem))return!1;if(this.fileSystem.isPartialStubPackagesScanned(e))return!1;const t=this.fileSystem,n=[],i=[],s=this.getTypeshedPathEx(e,n);return r(this._configOptions.stubPath),r(e.root),e.extraPaths.forEach((e=>r(e))),r(s),this.getPythonSearchPaths(n).forEach((e=>r(e))),this.fileSystem.processPartialStubPackages(i,this.getImportRoots(e),s),this._invalidateFileSystemCache(),!0;function r(e){e&&!t.isPathScanned(e)&&i.push(e)}}getPythonSearchPaths(e){if(!this._cachedPythonSearchPaths){const e=[],t=(f.findPythonSearchPaths(this.fileSystem,this._configOptions,this.host,e)||[]).map((e=>this.fileSystem.realCasePath(e)));this._cachedPythonSearchPaths={paths:[...new Set(t)],failureInfo:e}}return e.push(...this._cachedPythonSearchPaths.failureInfo),this._cachedPythonSearchPaths.paths}readdirEntriesCached(e){const t=this._cachedEntriesForPath.get(e);if(t)return t;let n;try{n=this.fileSystem.readdirEntriesSync(e)}catch{n=[]}return this._cachedEntriesForPath.set(e,n),n}resolveImportInternal(e,t,n){const i=this.formatImportName(n),s=this._resolveImportStrict(i,e,t,n,[]);if(s.isImportFound||n.leadingDots>0)return s;e=(0,c.normalizePathCase)(this.fileSystem,(0,c.normalizePath)(e));const r=(0,c.ensureTrailingDirectorySeparator)((0,c.getDirectoryPath)(e)),a=this.cachedParentImportResults.getImportResult(r,i,s);if(a)return this.filterImplicitImports(a,n.importedSymbols);const o=this.getParentImportResolutionRoot(e,t.root);if(!this.cachedParentImportResults.checkValidPath(this.fileSystem,e,o))return s;const l={importPath:void 0};let p=r;for(;this._shouldWalkUp(p,o,t);){const s=this.resolveAbsoluteImport(e,p,t,n,i,[],void 0,void 0,!1,!0);if(this.cachedParentImportResults.checked(p,i,l),s.isImportFound)return l.importPath=p,this.cachedParentImportResults.add({importResult:s,path:p,importName:i}),this.filterImplicitImports(s,n.importedSymbols);let r;if([r,p]=this._tryWalkUp(p),!r)break}return this.cachedParentImportResults.checked(p,i,l),s}fileExistsCached(e){var t,n;const i=this._splitPath(e);if(!i[0]||!i[1])return!!this.fileSystem.existsSync(e)&&(null!==(n=null===(t=(0,c.tryStat)(this.fileSystem,e))||void 0===t?void 0:t.isFile())&&void 0!==n&&n);const s=this.readdirEntriesCached(i[0]).find((e=>e.name===i[1]));if(null==s?void 0:s.isFile())return!0;if(null==s?void 0:s.isSymbolicLink()){const t=(0,c.tryRealpath)(this.fileSystem,e);if(t&&this.fileSystem.existsSync(t)&&(0,c.isFile)(this.fileSystem,t))return!0}return!1}dirExistsCached(e){var t,n;const i=this._splitPath(e);if(!i[0]||!i[1])return!!this.fileSystem.existsSync(e)&&(null!==(n=null===(t=(0,c.tryStat)(this.fileSystem,e))||void 0===t?void 0:t.isDirectory())&&void 0!==n&&n);const s=this.readdirEntriesCached(i[0]).find((e=>e.name===i[1]));if(null==s?void 0:s.isDirectory())return!0;if(null==s?void 0:s.isSymbolicLink()){const t=(0,c.tryRealpath)(this.fileSystem,e);if(t&&this.fileSystem.existsSync(t)&&(0,c.isDirectory)(this.fileSystem,t))return!0}return!1}addResultsToCache(e,t,n,i,s){return(0,a.getOrAdd)(this._cachedImportResults,e.root,(()=>new Map)).set(this._getCacheKey(t,s),n),this.filterImplicitImports(n,i)}resolveAbsoluteImport(e,t,n,i,s,r,a=!1,o=!1,l=!1,c=!0,p=!1){if(c&&l){const o=this._resolveAbsoluteImport(e,t,n,i,s,r,a,!1,!0,!0,!0);if(o.packageDirectory&&(!o.isNamespacePackage||o.isImportFound))return o}return this._resolveAbsoluteImport(e,t,n,i,s,r,a,o,!1,c,p)}getTypeshedPathEx(e,t){}resolveImportEx(e,t,n,i,s=[],r=!0){}resolveNativeImportEx(e,t,n=[]){}getNativeModuleName(e){const t=(0,c.getFileExtension)(e,!1).toLowerCase();if(this._isNativeModuleFileExtension(t))return(0,c.stripFileExtension)((0,c.stripFileExtension)(e))}getModuleNameFromPath(e,t,n=!1){const i=this.getModuleNameInfoFromPath(e,t,n);if(i&&!i.containsInvalidCharacters)return i.moduleName}getModuleNameInfoFromPath(e,t,n=!1){e=(0,c.ensureTrailingDirectorySeparator)(e);let i=(0,c.stripFileExtension)(t);if(this._isNativeModuleFileExtension((0,c.getFileExtension)(t))&&(i=(0,c.stripFileExtension)(i)),!i.startsWith(e))return;i.endsWith("__init__")&&(i=i.substr(0,i.length-9));const s=i.substr(e.length),r=(0,c.getPathComponents)(s);if(r.shift(),n){if(0===r.length)return;r.shift()}if(0===r.length)return;r[0].endsWith(l.stubsSuffix)&&(r[0]=r[0].substr(0,r[0].length-l.stubsSuffix.length));const a=r.some((e=>!this._isIdentifier(e)));return{moduleName:r.join("."),containsInvalidCharacters:a}}filterImplicitImports(e,t){if(void 0===t){const t=Object.assign({},e);return t.filteredImplicitImports=[],t}if(0===t.length)return e;if(0===e.implicitImports.length)return e;const n=e.implicitImports.filter((e=>t.some((t=>t===e.name))));if(n.length===e.implicitImports.length)return e;const i=Object.assign({},e);return i.filteredImplicitImports=n,i}formatImportName(e){return".".repeat(e.leadingDots)+e.nameParts.join(".")}getParentImportResolutionRoot(e,t){return t?(0,c.ensureTrailingDirectorySeparator)((0,c.normalizePathCase)(this.fileSystem,(0,c.normalizePath)(t))):(0,c.ensureTrailingDirectorySeparator)((0,c.getDirectoryPath)(e))}_resolveImportStrict(e,t,n,i,s){const r=(0,o.matchFileSpecs)(this._configOptions,t),a={importName:e,isRelative:!1,isImportFound:!1,isPartlyResolved:!1,isNamespacePackage:!1,isInitFilePresent:!1,isStubPackage:!1,importFailureInfo:s,resolvedPaths:[],importType:2,isStubFile:!1,isNativeLib:!1,implicitImports:[],filteredImplicitImports:[],nonStubImportResult:void 0};if(this.ensurePartialStubPackages(n),i.leadingDots>0){const r=this._resolveRelativeImport(t,n,i,e,s);if(r)return r.isRelative=!0,r}else{const s=this._lookUpResultsInCache(n,e,i.importedSymbols,r);if(s){if(!(s.isImportFound&&s.isNamespacePackage&&!this._isNamespacePackageResolved(i,s.implicitImports)))return s}const o=this._resolveBestAbsoluteImport(t,n,i,!0);if(o)return o.isStubFile&&(o.nonStubImportResult=this._resolveBestAbsoluteImport(t,n,i,!1)||a),this.addResultsToCache(n,e,o,i.importedSymbols,r)}return this.addResultsToCache(n,e,a,void 0,r)}_getCompletionSuggestionsStrict(e,t,n){const i=[],s=new Map;if(n.leadingDots>0)this._getCompletionSuggestionsRelative(e,t,n,s);else{n.nameParts.length>0&&this._getCompletionSuggestionsTypeshedPath(e,t,n,!0,s),t.root&&this._getCompletionSuggestionsAbsolute(e,t,t.root,n,s);for(const i of t.extraPaths)this._getCompletionSuggestionsAbsolute(e,t,i,n,s);this._configOptions.stubPath&&this._getCompletionSuggestionsAbsolute(e,t,this._configOptions.stubPath,n,s),this._getCompletionSuggestionsTypeshedPath(e,t,n,!1,s);const r=this.getPythonSearchPaths(i);for(const i of r)this._getCompletionSuggestionsAbsolute(e,t,i,n,s)}return s}_getModuleNameForImport(e,t,n){let i,s=0,r=!1;const a=[];let o;const l=this._getStdlibTypeshedPath(t,a);if(l&&(i=this.getModuleNameFromPath(l,e),i)){const e={leadingDots:0,nameParts:i.split("."),importedSymbols:void 0};if(this._isStdlibTypeshedStubValidForVersion(e,t,[]))return{moduleName:i,importType:s,isLocalTypingsFile:r}}if(t.root){const n=this.getModuleNameInfoFromPath(t.root,e);n&&(n.containsInvalidCharacters?o=n.moduleName:i=n.moduleName),s=2}for(const n of t.extraPaths){const t=this.getModuleNameInfoFromPath(n,e);if(t)if(t.containsInvalidCharacters)o=t.moduleName;else{const e=t.moduleName;(!i||e&&e.length<i.length)&&(i=e,s=2)}}if(this._configOptions.stubPath){const t=this.getModuleNameInfoFromPath(this._configOptions.stubPath,e);if(t)if(t.containsInvalidCharacters)o=t.moduleName;else{const e=t.moduleName;(!i||e&&e.length<i.length)&&(i=e,s=2,r=!0)}}const c=this._getThirdPartyTypeshedPath(t,a);if(c){const t=this.getModuleNameFromPath(c,e,!0);(!i||t&&t.length<i.length)&&(i=t,s=1)}const p=this.getTypeshedPathEx(t,a);if(p){const t=this.getModuleNameFromPath(p,e);(!i||t&&t.length<i.length)&&(i=t,s=1)}const d=this.getPythonSearchPaths(a);for(const t of d){const n=this.getModuleNameInfoFromPath(t,e);if(n)if(n.containsInvalidCharacters)o=n.moduleName;else{const e=n.moduleName;(!i||e&&e.length<i.length)&&(i=e,s=1)}}return i?{moduleName:i,importType:s,isLocalTypingsFile:r}:n&&o?{moduleName:o,importType:s,isLocalTypingsFile:r}:{moduleName:"",importType:2,isLocalTypingsFile:r}}_invalidateFileSystemCache(){this._cachedEntriesForPath.clear()}_splitPath(e){const t=(0,c.getPathComponents)(e);if(t.length<=1)return[e,""];return[(0,c.combinePathComponents)(t.slice(0,-1)),t[t.length-1]]}_resolveAbsoluteImport(e,t,n,i,s,r,a,o,p,d,u){p?r.push(`Attempting to resolve stub package using root path '${t}'`):r.push(`Attempting to resolve using root path '${t}'`);const y=[];let m,h,g,f=t,v=!1,_=!1,b=!1,I=!1,C=!1,S=[];if(0===i.nameParts.length){const e="__init__",t=(0,c.combinePaths)(f,e+".py"),n=(0,c.combinePaths)(f,e+".pyi");d&&this.fileExistsCached(n)?(r.push(`Resolved import with file '${n}'`),y.push(n),I=!0):this.fileExistsCached(t)?(r.push(`Resolved import with file '${t}'`),y.push(t)):(r.push(`Partially resolved import with directory '${f}'`),y.push(""),v=!0),S=this._findImplicitImports(s,f,[t,n])}else for(let e=0;e<i.nameParts.length;e++){const t=0===e,a=e===i.nameParts.length-1;f=(0,c.combinePaths)(f,i.nameParts[e]),p&&t&&(f+=l.stubsSuffix,b=!0);const g=this.dirExistsCached(f);if(g){t&&(m=f);const e="__init__",n=(0,c.combinePaths)(f,e+".py"),s=(0,c.combinePaths)(f,e+".pyi");if(_=!1,d&&this.fileExistsCached(s)?(r.push(`Resolved import with file '${s}'`),y.push(s),a&&(I=!0),_=!0):this.fileExistsCached(n)&&(r.push(`Resolved import with file '${n}'`),y.push(n),_=!0),!h&&u&&this.fileExistsCached((0,c.combinePaths)(f,"py.typed"))&&(h=(0,T.getPyTypedInfo)(this.fileSystem,f)),!a){_||(y.push(""),v=!0,h=void 0);continue}if(_){S=this._findImplicitImports(i.nameParts.join("."),f,[n,s]);break}}let x=(0,c.stripTrailingDirectorySeparator)(f);const F=(0,c.getFileName)(x);x=(0,c.getDirectoryPath)(x);const D=(0,c.combinePaths)(x,F+".py"),P=(0,c.combinePaths)(x,F+".pyi");if(d&&this.fileExistsCached(P))r.push(`Resolved import with file '${P}'`),y.push(P),a&&(I=!0);else if(this.fileExistsCached(D))r.push(`Resolved import with file '${D}'`),y.push(D);else{if(o&&this.dirExistsCached(x)){const e=this._getFilesInDirectory(x).find((e=>this._isNativeModuleFileName(F,e)));if(e){const t=(0,c.combinePaths)(x,e);C=this._resolveNativeModuleStub(t,n,s,i,r,y)}}!C&&g?(r.push(`Partially resolved import with directory '${f}'`),y.push(""),a&&(S=this._findImplicitImports(s,f,[D,P]),v=!0)):C&&r.push(`Did not find file '${P}' or '${D}'`)}break}const x=y.length>0&&y.length<i.nameParts.length;return g=a?y.length>0:y.length>=i.nameParts.length,{importName:s,isRelative:!1,isNamespacePackage:v,isInitFilePresent:_,isStubPackage:b,isImportFound:g,isPartlyResolved:x,importFailureInfo:r,importType:2,resolvedPaths:y,searchPath:t,isStubFile:I,isNativeLib:C,implicitImports:S,pyTypedInfo:h,filteredImplicitImports:S,packageDirectory:m}}_getCacheKey(e,t){return`${e}-${t}`}_lookUpResultsInCache(e,t,n,i){const s=this._cachedImportResults.get(e.root);if(!s)return;const r=s.get(this._getCacheKey(t,i));return r?this.filterImplicitImports(r,n):void 0}_isNamespacePackageResolved(e,t){if(e.importedSymbols){if(!e.importedSymbols.some((e=>t.some((t=>t.name===e)))))return!1}else if(0===t.length)return!1;return!0}_resolveBestAbsoluteImport(e,t,n,i){const s=this.formatImportName(n),r=[];if(i&&this._configOptions.stubPath){r.push(`Looking in stubPath '${this._configOptions.stubPath}'`);const a=this.resolveAbsoluteImport(e,this._configOptions.stubPath,t,n,s,r,void 0,!1,!0,i,!1);if(a.isImportFound){if(a.importType=2,a.isLocalTypingsFile=!0,!a.isNamespacePackage||a.resolvedPaths[a.resolvedPaths.length-1])return a;if(this._isNamespacePackageResolved(n,a.implicitImports))return a}}let a,o;t.root&&(r.push(`Looking in root directory of execution environment '${t.root}'`),o=this.resolveAbsoluteImport(e,t.root,t,n,s,r,void 0,!0,!0,i,!1),a=o);for(const l of t.extraPaths)r.push(`Looking in extraPath '${l}'`),o=this.resolveAbsoluteImport(e,l,t,n,s,r,void 0,!0,!0,i,!1),a=this._pickBestImport(a,o,n);const l=this.getPythonSearchPaths(r);if(l.length>0)for(const o of l){r.push(`Looking in python search path '${o}'`);const l=this.resolveAbsoluteImport(e,o,t,n,s,r,false,!0,!0,i,!0);l&&(l.importType=1,a=this._pickBestImport(a,l,n))}else r.push("No python interpreter search path");if(t.root!==this._getTypeshedRoot(t,r)&&(null==a?void 0:a.pyTypedInfo)&&!a.isPartlyResolved)return a;const c=this.resolveImportEx(e,t,n,s,r,i);if(c)return c;if(i&&n.nameParts.length>0){r.push("Looking for typeshed stdlib path");const e=this._findTypeshedPath(t,n,s,!0,r);if(e)return e.isStdlibTypeshedFile=!0,e;r.push("Looking for typeshed third-party path");const i=this._findTypeshedPath(t,n,s,!1,r);i&&(i.isThirdPartyTypeshedFile=!0,a=this._pickBestImport(a,i,n))}return a}_pickBestImport(e,t,n){if(!e)return t;if(!t)return e;if(t.isImportFound){if(!e.isImportFound)return t;if(e.isNamespacePackage&&!t.isNamespacePackage)return t;if(2===e.importType&&!e.isNamespacePackage)return e;if(2===t.importType&&!t.isNamespacePackage)return t;if(e.isNamespacePackage&&t.isNamespacePackage&&n.importedSymbols&&!this._isNamespacePackageResolved(n,e.implicitImports)){if(this._isNamespacePackageResolved(n,t.implicitImports))return t;if(e.isInitFilePresent&&!t.isInitFilePresent)return e;if(!e.isInitFilePresent&&t.isInitFilePresent)return t}if(e.pyTypedInfo&&!t.pyTypedInfo)return e;if(!e.pyTypedInfo&&t.pyTypedInfo)return t;if(e.isStubFile&&!t.isStubFile)return e;if(!e.isStubFile&&t.isStubFile)return t;if(e.resolvedPaths.length>t.resolvedPaths.length)return t}else if(t.isPartlyResolved&&e.isNamespacePackage&&!t.isNamespacePackage)return t;return e}_isIdentifier(e){for(let t=0;t<e.length;t++)if(0===t?!(0,y.isIdentifierStartChar)(e.charCodeAt(t)):!(0,y.isIdentifierChar)(e.charCodeAt(t)))return!1;return!0}_findTypeshedPath(e,t,n,i,s){let r;if(s.push(`Looking for typeshed ${i?f.stdLibFolderName:f.thirdPartyFolderName} path`),i){const n=this._getStdlibTypeshedPath(e,s,t);n&&(r=[n])}else r=this._getThirdPartyTypeshedPackagePaths(t,e,s);if(r)for(const a of r)if(this.dirExistsCached(a)){const r=this.resolveAbsoluteImport(void 0,a,e,t,n,s);if(r.isImportFound)return r.importType=i?0:1,r}s.push("Typeshed path not found")}_buildStdlibCache(e){const t=new Set;if(e){const n=(e,i)=>{this.readdirEntriesCached(e).forEach((s=>{if(s.isDirectory()){const t=(0,c.combinePaths)(e,s.name);n(t,i?`${i}.${s.name}`:s.name)}else if(s.name.includes(".py")){const e=(0,c.stripFileExtension)(s.name);e.startsWith("_")||t.add(i?`${i}.${e}`:e)}}))};n(e,void 0)}return t}_buildTypeshedThirdPartyPackageMap(e){this._cachedTypeshedThirdPartyPackagePaths=new Map,e&&this.readdirEntriesCached(e).forEach((t=>{if(t.isDirectory()){const n=(0,c.combinePaths)(e,t.name);this.readdirEntriesCached(n).forEach((e=>{if("@python2"!==e.name)if(e.isDirectory()){const t=this._cachedTypeshedThirdPartyPackagePaths.get(e.name);t?t.push(n):this._cachedTypeshedThirdPartyPackagePaths.set(e.name,[n])}else if(e.isFile()&&e.name.endsWith(".pyi")){const t=(0,c.stripFileExtension)(e.name),i=this._cachedTypeshedThirdPartyPackagePaths.get(t);i?i.push(n):this._cachedTypeshedThirdPartyPackagePaths.set(t,[n])}}))}}));const t=[...this._cachedTypeshedThirdPartyPackagePaths.values()].flatMap((e=>e));this._cachedTypeshedThirdPartyPackageRoots=[...new Set(t)].sort()}_getCompletionSuggestionsTypeshedPath(e,t,n,i,s){const r=[];let a;if(i){const e=this._getStdlibTypeshedPath(t,r,n);e&&(a=[e])}else{a=this._getThirdPartyTypeshedPackagePaths(n,t,r,!1);const e=this.getTypeshedPathEx(t,r);e&&(a=null!=a?a:[],a.push(e))}a&&a.forEach((i=>{this.dirExistsCached(i)&&this._getCompletionSuggestionsAbsolute(e,t,i,n,s)}))}_getStdlibTypeshedPath(e,t,n){const i=this._getTypeshedSubdirectory(!0,e,t);if(!i||!n||this._isStdlibTypeshedStubValidForVersion(n,e,t))return i}_getThirdPartyTypeshedPath(e,t){return this._getTypeshedSubdirectory(!1,e,t)}_isStdlibTypeshedStubValidForVersion(e,t,n){this._cachedTypeshedStdLibModuleVersions||(this._cachedTypeshedStdLibModuleVersions=this._readTypeshedStdLibVersions(t,n));for(let n=1;n<=e.nameParts.length;n++){const i=e.nameParts.slice(0,n),s=this._cachedTypeshedStdLibModuleVersions.get(i.join("."));if(s){if(t.pythonVersion<s.min)return!1;if(void 0!==s.max&&t.pythonVersion>s.max)return!1}}return!0}_readTypeshedStdLibVersions(e,t){const n=new Map,i=this._getTypeshedSubdirectory(!0,e,t);if(i){const e=(0,c.combinePaths)(i,"VERSIONS");try{const i=this.fileSystem.statSync(e);if(i.size>0&&i.size<262144){this.fileSystem.readFileSync(e,"utf8").split(/\r?\n/).forEach((e=>{const t=e.split("#")[0].split(":");if(2!==t.length)return;const i=t[1].split("-");if(i.length>2)return;const s=t[0].trim();if(!s)return;let r=i[0].trim();r.endsWith("+")&&(r=r.substr(0,r.length-1));let a,o=(0,p.versionFromString)(r);o||(o=p.PythonVersion.V3_0),i.length>1&&(a=(0,p.versionFromString)(i[1].trim())),n.set(s,{min:o,max:a})}))}else t.push("Typeshed stdlib VERSIONS file is unexpectedly large")}catch(e){t.push(`Could not read typeshed stdlib VERSIONS file: '${JSON.stringify(e)}'`)}}return n}_getThirdPartyTypeshedPackagePaths(e,t,n,i=!0){const s=this._getThirdPartyTypeshedPath(t,n);this._cachedTypeshedThirdPartyPackagePaths||this._buildTypeshedThirdPartyPackageMap(s);const r=e.nameParts.length>0?e.nameParts[0]:"";return i?this._cachedTypeshedThirdPartyPackagePaths.get(r):r?(0,a.flatten)((0,a.getMapValues)(this._cachedTypeshedThirdPartyPackagePaths,(e=>e.startsWith(r)))):[]}_getThirdPartyTypeshedPackageRoots(e,t){const n=this._getThirdPartyTypeshedPath(e,t);return this._cachedTypeshedThirdPartyPackagePaths||this._buildTypeshedThirdPartyPackageMap(n),this._cachedTypeshedThirdPartyPackageRoots}_getTypeshedRoot(e,t){if(void 0!==this._cachedTypeshedRoot)return this._cachedTypeshedRoot;let n="";if(this._configOptions.typeshedPath){const e=this._configOptions.typeshedPath;this.dirExistsCached(e)&&(n=e)}else{const e=this.getPythonSearchPaths(t);for(const t of e){const e=(0,c.combinePaths)(t,"typeshed");if(this.dirExistsCached(e)){n=e;break}}}return n||(n=f.getTypeShedFallbackPath(this.fileSystem)||""),this._cachedTypeshedRoot=n,n}_getTypeshedSubdirectory(e,t,n){if(e){if(void 0!==this._cachedTypeshedStdLibPath)return this._cachedTypeshedStdLibPath}else if(void 0!==this._cachedTypeshedThirdPartyPath)return this._cachedTypeshedThirdPartyPath;let i=this._getTypeshedRoot(t,n);if(i=f.getTypeshedSubdirectory(i,e),this.dirExistsCached(i))return e?this._cachedTypeshedStdLibPath=i:this._cachedTypeshedThirdPartyPath=i,i}_resolveRelativeImport(e,t,n,i,s){s.push("Attempting to resolve relative import");const r=(0,h.getDirectoryLeadingDotsPointsTo)((0,c.getDirectoryPath)(e),n.leadingDots);if(!r)return void s.push(`Invalid relative path '${i}'`);const a=this.resolveAbsoluteImport(e,r,t,n,i,s,!1,!0);return a&&a.isStubFile&&(a.nonStubImportResult=this.resolveAbsoluteImport(e,r,t,n,i,s,!1,!0,!1,!1)||{importName:i,isRelative:!0,isImportFound:!1,isPartlyResolved:!1,isNamespacePackage:!1,isStubPackage:!1,importFailureInfo:s,resolvedPaths:[],importType:2,isStubFile:!1,isNativeLib:!1,implicitImports:[],filteredImplicitImports:[],nonStubImportResult:void 0}),this.filterImplicitImports(a,n.importedSymbols)}_getCompletionSuggestionsRelative(e,t,n,i){const s=(0,h.getDirectoryLeadingDotsPointsTo)((0,c.getDirectoryPath)(e),n.leadingDots);s&&this._getCompletionSuggestionsAbsolute(e,t,s,n,i)}_getFilesInDirectory(e){const t=this.readdirEntriesCached(e),n=t.filter((e=>e.isFile())).map((e=>e.name));return t.forEach((t=>{var i;const s=(0,c.combinePaths)(e,t.name);t.isSymbolicLink()&&(null===(i=(0,c.tryStat)(this.fileSystem,s))||void 0===i?void 0:i.isFile())&&n.push(t.name)})),n}_getCompletionSuggestionsAbsolute(e,t,n,i,s,r=!0){let a=n;const o=i.nameParts.map((e=>e));i.hasTrailingDot&&o.push("");const l=i.leadingDots,p=o.slice(0,-1);if(0===o.length)this._addFilteredSuggestionsAbsolute(e,t,a,"",s,l,p,r);else for(let n=0;n<o.length&&(n===o.length-1&&this._addFilteredSuggestionsAbsolute(e,t,a,o[n],s,l,p,r),a=(0,c.combinePaths)(a,o[n]),this.dirExistsCached(a));n++);}_addFilteredSuggestionsAbsolute(e,n,i,s,r,a,o,l){const p=(0,c.getFileSystemEntriesFromDirEntries)(this.readdirEntriesCached(i),this.fileSystem,i);p.files.forEach((p=>{const u=(0,c.getFileExtension)(p,!1).toLowerCase(),y=(0,c.stripFileExtension)(p,!0);if(t.supportedFileExtensions.some((e=>e===u))){if("__init__"===y)return;if(s&&!d.isPatternInSymbol(s,y))return;if(!this._isUniqueValidSuggestion(y,r)||!this._isResolvableSuggestion(y,a,o,e,n,l))return;r.set(y,(0,c.combinePaths)(i,p))}})),p.directories.forEach((t=>{if(s&&!t.startsWith(s))return;if(!this._isUniqueValidSuggestion(t,r)||!this._isResolvableSuggestion(t,a,o,e,n,l))return;const p=(0,c.combinePaths)(i,t,"__init__.pyi");if(this.fileExistsCached(p))return void r.set(t,p);const d=(0,c.combinePaths)(i,t,"__init__.py");this.fileExistsCached(d)?r.set(t,d):r.set(t,"")}))}_isResolvableSuggestion(e,t,n,i,s,r){const a={leadingDots:t,nameParts:[...n,e],importedSymbols:[]};if(r){const e=this.formatImportName(a),t=[];return this._resolveImportStrict(e,i,s,a,t).isImportFound}return this.resolveImportInternal(i,s,a).isImportFound}_isUniqueValidSuggestion(e,t){return!t.has(e)&&(!/[.-]/.test(e)&&(!(0,v.isDunderName)(e)||"__future__"===e))}_findImplicitImports(e,t,n){const i=new Map,s=(0,c.getFileSystemEntriesFromDirEntries)(this.readdirEntriesCached(t),this.fileSystem,t);for(const r of s.files){const s=(0,c.getFileExtension)(r);let a,o=!1;if(".py"===s||".pyi"===s)a=(0,c.stripFileExtension)(r);else{if(!this._isNativeModuleFileExtension(s)||this.fileExistsCached(`${r}.py`)||this.fileExistsCached(`${r}.pyi`))continue;a=r.substr(0,r.indexOf(".")),o=!0}const l=(0,c.combinePaths)(t,r);if(!n.find((e=>e===l))){const n={isStubFile:r.endsWith(".pyi"),isNativeLib:o,name:a,path:l},s=i.get(n.name);if(!s||!s.isStubFile){if(o){const i=(0,c.combinePaths)(t,r),s=this.resolveNativeImportEx(i,`${e}.${a}`,[]);s&&(n.path=s,n.isNativeLib=!1)}i.set(n.name,n)}}}for(const e of s.directories){const s=(0,c.combinePaths)(t,e,"__init__.py"),r=s+"i";let a=!1,o="";if(this.fileExistsCached(r)?(a=!0,o=r):this.fileExistsCached(s)&&(o=s),o&&!n.find((e=>e===o))){const n={isStubFile:a,isNativeLib:!1,name:e,path:o,pyTypedInfo:(0,T.getPyTypedInfo)(this.fileSystem,(0,c.combinePaths)(t,e))};i.set(n.name,n)}}return[...i.values()]}_resolveNativeModuleStub(e,t,n,i,s,r){let a=n;if(i.leadingDots>0){const n=this.getModuleNameForImport(e,t);a=n.moduleName.length>0?n.moduleName:a}const o=this.resolveNativeImportEx(e,a,s);return o?(s.push(`Resolved native import ${n} with stub '${o}'`),r.push(o),!1):(s.push(`Resolved import with file '${e}'`),r.push(e),!0)}_isNativeModuleFileName(e,t){const n=(0,c.getFileExtension)(t,!1).toLowerCase(),i=(0,c.stripFileExtension)(t,!0);return this._isNativeModuleFileExtension(n)&&(0,u.equateStringsCaseInsensitive)(e,i)}_isNativeModuleFileExtension(e){return _.some((t=>t===e))}_tryWalkUp(e){return(0,c.isDiskPathRoot)(e)?[!1,""]:[!0,(0,c.ensureTrailingDirectorySeparator)((0,c.normalizePathCase)(this.fileSystem,(0,c.normalizePath)((0,c.combinePaths)(e,".."))))]}_shouldWalkUp(e,t,n){return e.length>t.length||e===t&&!n.root}}},87710:function(e,t,n){var i=this&&this.__createBinding||(Object.create?function(e,t,n,i){void 0===i&&(i=n),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,i){void 0===i&&(i=n),e[i]=t[n]}),s=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&i(t,e,n);return s(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.haveSameParentModule=t.getResolvedFilePath=t.getDirectoryLeadingDotsPointsTo=t.getRelativeModuleName=t.getTextRangeForImportNameDeletion=t.getImportGroupFromModuleNameAndType=t.getAllImportNames=t.getContainingImportStatement=t.getTextEditsForAutoImportInsertion=t.getTextEditsForAutoImportInsertions=t.getTextEditsForAutoImportSymbolAddition=t.getTopLevelImports=t.compareImportStatements=t.getImportGroup=void 0;const a=n(88711),o=n(5284),l=n(81844),c=n(96541),p=n(92828),d=n(6698),u=r(n(21)),y=r(n(48466));function m(e){return e.importResult?0===e.importResult.importType?0:1===e.importResult.importType||e.importResult.isLocalTypingsFile?1:e.importResult.isRelative?3:2:2}function h(e){return y.isConstantName(e)?0:y.isTypeAliasName(e)?1:2}function g(e,t){const n=h(e)-h(t);if(0!==n)return n;const i=e.replace(/_/g,"="),s=t.replace(/_/g,"=");return(0,p.compareStringsCaseSensitive)(i,s)}function f(e,t,n,i){let s;for(const t of n.imports){if(g(t.name.value,e)>0)break;s=t}let r=!1,a="";if(n.imports.length>0){const e=(0,c.convertOffsetToPosition)(n.start,i.tokenizerOutput.lines),t=(0,c.convertOffsetToPosition)(n.imports[0].start,i.tokenizerOutput.lines),s=n.imports.length>1?(0,c.convertOffsetToPosition)(n.imports[1].start,i.tokenizerOutput.lines):void 0;if(t.line>e.line&&(void 0===s||s.line>t.line)){const e=i.tokenizerOutput.lines.getItemAt(t.line);a=i.text.substr(e.start,t.character),/^\s*$/.test(a)&&(r=!0)}}const o=s?d.TextRange.getEnd(s):n.imports.length>0?n.imports[0].start:n.start+n.length,l=(0,c.convertOffsetToPosition)(o,i.tokenizerOutput.lines),p=t?`${e} as ${t}`:`${e}`;let u;if(r){const e=i.tokenizerOutput.predominantEndOfLineSequence;u=s?`,${e}${a}${p}`:`${p},${e}${a}`}else u=s?`, ${p}`:`${p}, `;return{range:{start:l,end:l},importName:e,replacementText:u}}function T(e,t){if(t.length<2)return t.map((e=>s(e)));const n=[...(0,o.createMapFromItems)(t,(e=>`${e.importGroup} ${d.Range.print(e.range)}`))].sort(((e,t)=>(0,p.compareStringsCaseSensitive)(e[0],t[0]))).map((e=>e[1])),i=[];for(const t of n)1===t.length?i.push(s(t[0])):i.push({range:t[0].range,replacementText:t[0].preChange+t.map((e=>e.importStatement)).sort(((e,t)=>r(e,t))).join(e.tokenizerOutput.predominantEndOfLineSequence)+t[0].postChange});return i;function s(e){return{range:e.range,replacementText:e.preChange+e.importStatement+e.postChange}}function r(e,t){const n=e.startsWith("import");return n===t.startsWith("import")?e<t?-1:1:n?-1:1}}function v(e,t,n,i,s,r){const a=[];0===(e=Array.isArray(e)?e:[e]).length&&e.push({});const l=(0,o.createMapFromItems)(e,(e=>e.name?"from":"import")),p=l.get("import");p&&h(p,(e=>`import ${e.join(", ")}`));const u=l.get("from");return u&&h(u,(e=>{var n;return`from ${null!==(n=t.nameForImportFrom)&&void 0!==n?n:t.name} import ${e.join(", ")}`})),a;function h(e,l){const p=e.map((e=>function(e,t){const n=e.name?e.name:t;return{sortText:n,text:e.alias?`${n} as ${e.alias}`:n}}(e,t.name))).sort(((e,t)=>g(e.sortText,t.sortText))).reduce(((e,t)=>(0,o.addIfUnique)(e,t.text)),[]);a.push(function(e,t,n,i,s,r){let a,o="",l="";const p=(0,c.convertPositionToOffset)(r,s.tokenizerOutput.lines);if(t.orderedImports.length>0&&p>t.orderedImports[0].node.start){let e=!0,r=t.orderedImports[0],p=0;for(const a of t.orderedImports){const l=a.importResult?m(a):p;if(i<l){!e&&p<i&&(o=s.tokenizerOutput.predominantEndOfLineSequence+o);break}if(i===l&&a.moduleName>n)break;if(a.followsNonImportStatement){i>p&&(o=s.tokenizerOutput.predominantEndOfLineSequence+o);break}a===t.orderedImports[t.orderedImports.length-1]&&i>l&&(o=s.tokenizerOutput.predominantEndOfLineSequence+o),e=!e&&i<p&&i===l,p=l,r=a}r?(e?l+=s.tokenizerOutput.predominantEndOfLineSequence:o=s.tokenizerOutput.predominantEndOfLineSequence+o,a=(0,c.convertOffsetToPosition)(e?r.node.start:d.TextRange.getEnd(r.node),s.tokenizerOutput.lines)):a={line:0,character:0}}else{a={line:0,character:0};let e=!1;for(const t of s.parseTree.statements){let n=!0;if(47===t.nodeType&&1===t.statements.length){const e=t.statements[0];(48===e.nodeType||3===e.nodeType&&38===e.leftExpression.nodeType&&y.isDunderName(e.leftExpression.value))&&(n=!1)}if(n){a=(0,c.convertOffsetToPosition)(t.start,s.tokenizerOutput.lines),e=!1;break}a=(0,c.convertOffsetToPosition)(t.start+t.length,s.tokenizerOutput.lines),e=!0}l=l+s.tokenizerOutput.predominantEndOfLineSequence+s.tokenizerOutput.predominantEndOfLineSequence,e?o=s.tokenizerOutput.predominantEndOfLineSequence+o:l+=s.tokenizerOutput.predominantEndOfLineSequence}return{range:{start:a,end:a},preChange:o,importStatement:e,postChange:l,importGroup:i}}(l(p),n,t.name,i,s,r))}}function _(e){let t="";for(let n=0;n<e.leadingDots;n++)t+=".";return t+=e.nameParts.map((e=>e.value)).join("."),t}function b(e){let t=2;return e.isLocalTypingsFile||1===e.importType?t=1:0===e.importType&&(t=0),t}t.getImportGroup=m,t.compareImportStatements=function(e,t){const n=m(e),i=m(t);return n<i?-1:n>i?1:e.moduleName<t.moduleName?-1:1},t.getTopLevelImports=function(e,t=!1){const n={orderedImports:[],mapByFilePath:new Map};let i=!1,s=!1;return e.statements.forEach((e=>{47===e.nodeType?e.statements.forEach((e=>{20===e.nodeType?(s=!0,function(e,t,n){e.list.forEach((i=>{const s=u.getImportInfo(i.module);let r;s&&s.isImportFound&&(r=s.resolvedPaths[s.resolvedPaths.length-1]);const a={node:e,subnode:i,importResult:s,resolvedPath:r,moduleName:_(i.module),followsNonImportStatement:n};t.orderedImports.push(a),r&&(t.mapByFilePath.has(r)||t.mapByFilePath.set(r,a))}))}(e,n,i),i=!1):22===e.nodeType?(s=!0,function(e,t,n,i){var s;const r=u.getImportInfo(e.module);let a;r&&r.isImportFound&&(a=r.resolvedPaths[r.resolvedPaths.length-1]);if(i&&r){t.implicitImports=null!==(s=t.implicitImports)&&void 0!==s?s:new Map;for(const n of r.implicitImports){const i=e.imports.find((e=>e.name.value===n.name));i&&t.implicitImports.set(n.path,i)}}const o={node:e,importResult:r,resolvedPath:a,moduleName:_(e.module),followsNonImportStatement:n};if(t.orderedImports.push(o),a){const e=t.mapByFilePath.get(a);(!e||20===e.node.nodeType||e.moduleName.length>o.moduleName.length)&&t.mapByFilePath.set(a,o)}}(e,n,i,t),i=!1):i=s})):i=s})),n},t.getTextEditsForAutoImportSymbolAddition=function(e,t,n){const i=[];if(!t.node||22!==t.node.nodeType||t.node.isWildcardImport)return i;const s=t.node;if(0===(e=(Array.isArray(e)?e:[e]).filter((e=>!!e.name&&!s.imports.some((t=>t.name.value===e.name&&t.alias===e.alias))))).length)return i;for(const s of e)i.push(f(s.name,s.alias,t.node,n));const r=(0,o.createMapFromItems)(i,(e=>d.Range.print(e.range))),a=[];for(const e of r.values())1===e.length?a.push(e[0]):a.push({range:e[0].range,replacementText:e.sort(((e,t)=>g(e.importName,t.importName))).map((e=>e.replacementText)).join("")});return a},t.getTextEditsForAutoImportInsertions=function(e,t,n,i){const s=[];if(0===(e=Array.isArray(e)?e:[e]).length)return[];const r=(0,o.createMapFromItems)(e,(e=>{var t;return`${e.module.moduleName}-${null!==(t=e.nameForImportFrom)&&void 0!==t?t:""}`}));for(const e of r.values())s.push(...v(e,{name:e[0].module.moduleName,nameForImportFrom:e[0].nameForImportFrom},t,b(e[0].module),n,i));return T(n,s)},t.getTextEditsForAutoImportInsertion=function(e,t,n,i,s,r){return T(s,v(e,t,n,i,s,r))},t.getContainingImportStatement=function(e,t){for(;e&&((0,a.throwIfCancellationRequested)(t),20!==e.nodeType&&22!==e.nodeType);)e=e.parent;return e},t.getAllImportNames=function(e){if(20===e.nodeType){return e.list}return e.imports},t.getImportGroupFromModuleNameAndType=b,t.getTextRangeForImportNameDeletion=function(e,...t){const n=[];for(const i of function(e){if(0===e.length)return[];if(1===e.length)return[{start:e[0],end:e[0]}];const t=[];let n=e[0],i=n;for(const s of e)i!==s&&(i+1!==s?(t.push({start:n,end:i}),n=s,i=s):i=s);return t.push({start:n,end:i}),t}(t)){const t=e[i.start],s=e[i.end];if(0===i.start&&e.length===i.end-i.start+1)n.push(d.TextRange.fromBounds(t.start,d.TextRange.getEnd(s)));else if(i.end===e.length-1){const t=d.TextRange.getEnd(e[i.start-1]),r=d.TextRange.getEnd(s)-t;n.push({start:t,length:r})}else{const s=t.start,r=e[i.end+1].start-s;n.push({start:s,length:r})}}return n},t.getRelativeModuleName=function(e,t,n,i=!1,s){let r,a=t;(s=void 0!==s?s:(0,l.isFile)(e,t))&&(a=(0,l.getDirectoryPath)(t));let o=n;if(s){o=(0,l.getDirectoryPath)(n);const e=(0,l.stripFileExtension)((0,l.getFileName)(n));"__init__"!==e?r=e:i&&(r=(0,l.getFileName)(o),o=(0,l.getDirectoryPath)(o))}const c=(0,l.getRelativePathComponentsFromDirectory)(a,o,(t=>e.realCasePath(t)));let p=".";for(let e=1;e<c.length;e++){const t=c[e];p+=".."===t?".":t,".."!==t&&e!==c.length-1&&(p+=".")}return r&&(p="."===p[p.length-1]?p+r:p+"."+r),p},t.getDirectoryLeadingDotsPointsTo=function(e,t){let n=e;for(let e=1;e<t;e++){if(""===n)return;n=(0,l.getDirectoryPath)(n)}return n},t.getResolvedFilePath=function(e){if(e&&e.isImportFound&&0!==e.resolvedPaths.length)return 1===e.resolvedPaths.length&&""===e.resolvedPaths[0]?e.packageDirectory?e.packageDirectory:e.searchPath?e.searchPath:void 0:e.resolvedPaths[e.resolvedPaths.length-1]},t.haveSameParentModule=function(e,t){if(e.length!==t.length)return!1;let n=0;for(n=0;n<e.length-1&&e[n]===t[n];n++);return n===e.length-1}},46288:function(e,t,n){var i=this&&this.__createBinding||(Object.create?function(e,t,n,i){void 0===i&&(i=n),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,i){void 0===i&&(i=n),e[i]=t[n]}),s=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&i(t,e,n);return s(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.updateNamedTupleBaseClass=t.createNamedTupleType=void 0;const a=n(96541),o=n(6698),l=n(99661),c=n(21),p=r(n(66455)),d=n(16682),u=n(51458),y=n(33029);function m(e,t,n){let i=!1;return e.details.baseClasses=e.details.baseClasses.map((e=>{if(!(0,u.isInstantiableClass)(e)||!u.ClassType.isBuiltIn(e,"NamedTuple"))return e;const s=[];n?t.forEach((e=>{s.push({type:e,isUnbounded:!1})})):s.push({type:t.length>0?(0,u.combineTypes)(t):u.UnknownType.create(),isUnbounded:!0});const r=u.ClassType.cloneForSpecialization(e,[],n);return r.details={...r.details},r.details.baseClasses=r.details.baseClasses.map((e=>(0,u.isInstantiableClass)(e)&&u.ClassType.isBuiltIn(e,"tuple")?(0,y.specializeTupleClass)(e,s,n):e)),(0,y.computeMroLinearization)(r),i=!0,r})),i}t.createNamedTupleType=function(e,t,n,i){var s,r,h;const g=(0,c.getFileInfo)(t);let f="namedtuple";if(0===n.length)e.addError(l.Localizer.Diagnostic.namedTupleFirstArg(),t);else{const i=n[0];0!==i.argumentCategory?e.addError(l.Localizer.Diagnostic.namedTupleFirstArg(),n[0].valueExpression||t):i.valueExpression&&48===i.valueExpression.nodeType&&(f=i.valueExpression.strings.map((e=>e.value)).join(""))}const T=n.find((e=>{var t;return"defaults"===(null===(t=e.name)||void 0===t?void 0:t.value)}));let v=0;if(T&&T.valueExpression){const t=e.getTypeOfExpression(T.valueExpression).type;v=(0,u.isClassInstance)(t)&&(0,y.isTupleClass)(t)&&!(0,y.isUnboundedTupleClass)(t)&&t.tupleTypeArguments?t.tupleTypeArguments.length:void 0}const _=e.getTypingType(t,"NamedTuple")||u.UnknownType.create(),b=u.ClassType.createInstantiable(f,p.getClassFullName(t,g.moduleName,f),g.moduleName,g.filePath,16777216,p.getTypeSourceId(t),void 0,(0,u.isInstantiableClass)(_)?_.details.effectiveMetaclass:u.UnknownType.create());b.details.baseClasses.push(_),b.details.typeVarScopeId=p.getScopeIdForNode(t);const I=b.details.fields;I.set("__class__",d.Symbol.createWithType(68,b));const C=(0,y.synthesizeTypeVarForSelfCls)(b,!0),S=u.FunctionType.createSynthesizedInstance("__new__",1);S.details.declaredReturnType=(0,y.convertToInstance)(C),p.isAssignmentToDefaultsFollowingNamedTuple(t)&&(S.details.flags|=32),u.FunctionType.addParameter(S,{category:0,name:"cls",type:C,hasDeclaredType:!0});const x=[],F={category:0,name:"self",type:(0,y.synthesizeTypeVarForSelfCls)(b,!1),hasDeclaredType:!0};let D=!1;const P=[];if(n.length<2)e.addError(l.Localizer.Diagnostic.namedTupleSecondArg(),t),D=!0;else{const t=n[1];if(0!==t.argumentCategory)D=!0;else if(!i&&t.valueExpression&&48===t.valueExpression.nodeType){const e=t.valueExpression.strings.map((e=>e.value)).join("").split(/[,\s]+/),n=void 0===v?0:Math.max(0,e.length-v);e.forEach(((e,s)=>{if(e=e.trim()){const r=u.UnknownType.create(),l={category:0,name:e,type:r,hasDeclaredType:i,hasDefault:s>=n};u.FunctionType.addParameter(S,l);const c=d.Symbol.createWithType(8,r);x.push(e);const p=t.valueExpression,y={type:1,node:p,isRuntimeTypeExpression:!0,path:g.filePath,range:(0,a.convertOffsetsToRange)(p.start,o.TextRange.getEnd(p),g.lines),moduleName:g.moduleName,isInExceptSuite:!1};c.addDeclaration(y),I.set(e,c),P.push(r)}}))}else if(31===(null===(s=t.valueExpression)||void 0===s?void 0:s.nodeType)||52===(null===(r=t.valueExpression)||void 0===r?void 0:r.nodeType)){const n=t.valueExpression,s=new Map,r=31===(null===(h=t.valueExpression)||void 0===h?void 0:h.nodeType)?t.valueExpression.entries:t.valueExpression.expressions,c=void 0===v?0:Math.max(0,r.length-v);r.forEach(((t,n)=>{let r,p,m,h="";i?52===t.nodeType&&2===t.expressions.length?(m=t.expressions[0],r=t.expressions[1],p=(0,y.convertToInstance)(e.getTypeOfExpressionExpectingType(r).type)):e.addError(l.Localizer.Diagnostic.namedTupleNameType(),t):(m=t,p=u.UnknownType.create()),m&&48===m.nodeType?(h=m.strings.map((e=>e.value)).join(""),h||e.addError(l.Localizer.Diagnostic.namedTupleEmptyName(),m)):D=!0,h||(h=`_${n.toString()}`),s.has(h)&&e.addError(l.Localizer.Diagnostic.namedTupleNameUnique(),m||t),s.set(h,h),p||(p=u.UnknownType.create());const f={category:0,name:h,type:p,hasDeclaredType:i,hasDefault:n>=c};u.FunctionType.addParameter(S,f),P.push(p),x.push(h);const T=d.Symbol.createWithType(2056,p);if(m&&48===m.nodeType){const e={type:1,node:m,path:g.filePath,typeAnnotationNode:r,range:(0,a.convertOffsetsToRange)(m.start,o.TextRange.getEnd(m),g.lines),moduleName:g.moduleName,isInExceptSuite:!1};T.addDeclaration(e)}I.set(h,T)})),e.setTypeForNode(n)}else D=!0}D&&(S.details.parameters=[],u.FunctionType.addDefaultParameters(S),P.push(u.AnyType.create(!1)),P.push(u.AnyType.create(!0)));const E=u.FunctionType.createSynthesizedInstance("__init__",128);u.FunctionType.addParameter(E,F),u.FunctionType.addDefaultParameters(E),E.details.declaredReturnType=u.NoneType.createInstance(),I.set("__new__",d.Symbol.createWithType(4,S)),I.set("__init__",d.Symbol.createWithType(4,E));const A=u.FunctionType.createSynthesizedInstance("keys"),k=u.FunctionType.createSynthesizedInstance("items");A.details.declaredReturnType=e.getBuiltInObject(t,"list",[e.getBuiltInObject(t,"str")]),k.details.declaredReturnType=A.details.declaredReturnType,I.set("keys",d.Symbol.createWithType(8,A)),I.set("items",d.Symbol.createWithType(8,k));const w=u.FunctionType.createSynthesizedInstance("__len__");if(w.details.declaredReturnType=e.getBuiltInObject(t,"int"),u.FunctionType.addParameter(w,F),I.set("__len__",d.Symbol.createWithType(4,w)),D){const n=u.FunctionType.createSynthesizedInstance("__getattribute__");n.details.declaredReturnType=u.AnyType.create(),u.FunctionType.addParameter(n,F),u.FunctionType.addParameter(n,{category:0,name:"name",type:e.getBuiltInObject(t,"str")}),I.set("__getattribute__",d.Symbol.createWithType(4,n))}const N=e.getBuiltInType(t,"tuple"),R=e.getBuiltInType(t,"str");if(!D&&R&&(0,u.isInstantiableClass)(R)&&N&&(0,u.isInstantiableClass)(N)){const e=x.map((e=>({type:u.ClassType.cloneAsInstance(u.ClassType.cloneWithLiteral(R,e)),isUnbounded:!1}))),t=u.ClassType.cloneAsInstance((0,y.specializeTupleClass)(N,e));I.set("__match_args__",d.Symbol.createWithType(4,t))}return m(b,P,!D),(0,y.computeMroLinearization)(b),b},t.updateNamedTupleBaseClass=m},63250:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getTypeOfTernaryOperation=t.getTypeOfUnaryOperation=t.getTypeOfAugmentedAssignment=t.getTypeOfBinaryOperation=t.validateBinaryOperation=void 0;const i=n(83501),s=n(28513),r=n(86513),a=n(99661),o=n(21),l=n(66455),c=n(93890),p=n(33029),d=n(51458),u={0:["__add__","__radd__"],33:["__sub__","__rsub__"],26:["__mul__","__rmul__"],13:["__floordiv__","__rfloordiv__"],10:["__truediv__","__rtruediv__"],24:["__mod__","__rmod__"],29:["__pow__","__rpow__"],22:["__matmul__","__rmatmul__"],3:["__and__","__rand__"],6:["__or__","__ror__"],8:["__xor__","__rxor__"],17:["__lshift__","__rlshift__"],31:["__rshift__","__rrshift__"],12:["__eq__","__eq__"],28:["__ne__","__ne__"],20:["__lt__","__gt__"],21:["__le__","__ge__"],15:["__gt__","__lt__"],16:["__ge__","__le__"]},y={36:!0,37:!0,39:!0,40:!0,41:!0,42:!0},m=64;function h(e,t,n,i,s,r,o,c){const h=n.type,g=i.type;let T,v=e.makeTopLevelTypeVarsConcrete(h);if(void 0!==y[t]){if(36===t){if(!e.canBeTruthy(v))return h;if(!e.canBeFalsy(v))return g;if(v=e.removeTruthinessFromType(v),(0,d.isNever)(g))return v}else if(37===t){if(!e.canBeFalsy(v))return h;if(!e.canBeTruthy(v))return g;if(v=e.removeFalsinessFromType(v),(0,d.isNever)(g))return v}if((0,d.isNever)(h)||(0,d.isNever)(g))return d.NeverType.createNever();41===t||42===t?(T=e.mapSubtypesExpandTypeVars(g,void 0,((r,c)=>e.mapSubtypesExpandTypeVars(v,(0,p.getTypeCondition)(r),(u=>{var y;if((0,d.isAnyOrUnknown)(u)||(0,d.isAnyOrUnknown)(c))return(0,p.preserveUnknown)(u,r);let m=e.getTypeOfMagicMethodReturn(r,[{type:u,isIncomplete:n.isIncomplete}],"__contains__",s,void 0);if(!m){const t=null===(y=e.getTypeOfIterator({type:r,isIncomplete:i.isIncomplete},!1,void 0))||void 0===y?void 0:y.type;t&&e.assignType(t,u)&&(m=e.getBuiltInObject(s,"bool"))}return m||o.addMessage(a.Localizer.Diagnostic.typeNotSupportBinaryOperator().format({operator:(0,l.printOperator)(t),leftType:e.printType(u),rightType:e.printType(r)})),m})))),T&&!(0,d.isNever)(T)&&(T=e.getBuiltInObject(s,"bool"))):T=e.mapSubtypesExpandTypeVars(v,void 0,((n,i)=>e.mapSubtypesExpandTypeVars(g,(0,p.getTypeCondition)(n),((n,r)=>36===t||37===t?(0,d.combineTypes)([i,r]):e.getBuiltInObject(s,"bool")))))}else if(u[t]){if((0,d.isNever)(h)||(0,d.isNever)(g))return d.NeverType.createNever();if(c.isLiteralMathAllowed){const e=(0,p.getLiteralTypeClassName)(h);if(e&&!(0,p.getTypeCondition)(h)){if(e===(0,p.getLiteralTypeClassName)(g)&&!(0,p.getTypeCondition)(g)&&(0,p.getUnionSubtypeCount)(h)*(0,p.getUnionSubtypeCount)(g)<m)if("str"===e||"bytes"===e)0===t&&(T=(0,p.mapSubtypes)(h,(e=>(0,p.mapSubtypes)(g,(t=>{const n=e,i=t;return d.ClassType.cloneWithLiteral(n,n.literalValue+i.literalValue)})))));else if("int"===e&&(0===t||33===t||26===t||13===t||24===t)){let e=!0;T=(0,p.mapSubtypes)(h,(n=>(0,p.mapSubtypes)(g,(i=>{try{const s=n,r=i,a=BigInt(s.literalValue),o=BigInt(r.literalValue);let l;return 0===t?l=a+o:33===t?l=a-o:26===t?l=a*o:13===t?o!==BigInt(0)&&(l=a/o):24===t&&o!==BigInt(0)&&(l=a%o),void 0===l||"number"==typeof l&&isNaN(l)?void(e=!1):(l>=Number.MIN_SAFE_INTEGER&&l<=Number.MAX_SAFE_INTEGER&&(l=Number(l)),d.ClassType.cloneWithLiteral(s,l))}catch{return void(e=!1)}})))),e||(T=void 0)}}}T||(T=e.mapSubtypesExpandTypeVars(h,void 0,((y,m)=>e.mapSubtypesExpandTypeVars(g,(0,p.getTypeCondition)(y),((h,g)=>{if((0,d.isAnyOrUnknown)(m)||(0,d.isAnyOrUnknown)(g))return(0,p.preserveUnknown)(m,g);const T=e.getTupleClassType();if(c.isTupleAddAllowed&&0===t&&(0,d.isClassInstance)(y)&&(0,p.isTupleClass)(y)&&y.tupleTypeArguments&&!(0,p.isUnboundedTupleClass)(y)&&(0,d.isClassInstance)(h)&&(0,p.isTupleClass)(h)&&h.tupleTypeArguments&&!(0,p.isUnboundedTupleClass)(h)&&T&&(0,d.isInstantiableClass)(T))return d.ClassType.cloneAsInstance((0,p.specializeTupleClass)(T,[...y.tupleTypeArguments,...h.tupleTypeArguments]));const v=u[t][0];let _=e.getTypeOfMagicMethodReturn(f(e,m),[{type:g,isIncomplete:i.isIncomplete}],v,s,r);if(_||m===y||(_=e.getTypeOfMagicMethodReturn(f(e,y),[{type:g,isIncomplete:i.isIncomplete}],v,s,r)),_||g===h||(_=e.getTypeOfMagicMethodReturn(f(e,y),[{type:h,isIncomplete:i.isIncomplete}],v,s,r)),!_){const i=u[t][1];_=e.getTypeOfMagicMethodReturn(f(e,g),[{type:m,isIncomplete:n.isIncomplete}],i,s,r),_||g===h||(_=e.getTypeOfMagicMethodReturn(f(e,h),[{type:m,isIncomplete:n.isIncomplete}],i,s,r)),_||m===y||(_=e.getTypeOfMagicMethodReturn(f(e,h),[{type:y,isIncomplete:n.isIncomplete}],i,s,r))}return _||(r?o.addMessage(a.Localizer.Diagnostic.typeNotSupportBinaryOperatorBidirectional().format({operator:(0,l.printOperator)(t),leftType:e.printType(y),rightType:e.printType(h),expectedType:e.printType(r.expectedType)})):o.addMessage(a.Localizer.Diagnostic.typeNotSupportBinaryOperator().format({operator:(0,l.printOperator)(t),leftType:e.printType(y),rightType:e.printType(h)}))),_})))))}return T&&(0,d.isNever)(T)?void 0:T}function g(e,t){if(!(0,d.isInstantiableClass)(e))return!1;const n=e.details.effectiveMetaclass;if(!n||!(0,d.isInstantiableClass)(n))return!1;if(d.ClassType.isBuiltIn(n,"type"))return!1;const i=(0,p.lookUpClassMember)(n,t);return!!i&&(!(0,d.isInstantiableClass)(i.classType)||!d.ClassType.isBuiltIn(i.classType,"type"))}function f(e,t){if((0,d.isFunction)(t)||(0,d.isOverloadedFunction)(t)){const t=e.getObjectType();if(t)return t}return t}t.validateBinaryOperation=h,t.getTypeOfBinaryOperation=function e(t,n,c,u){const m=n.leftExpression;let f=n.rightExpression,T=!1,v=!1;(0,l.operatorSupportsChaining)(n.operator)&&7===f.nodeType&&!f.parenthesized&&(0,l.operatorSupportsChaining)(f.operator)&&(e(t,f,c,u),f=f.leftExpression);let _,b=37===n.operator||36===n.operator?null==c?void 0:c.expectedType:void 0;26===n.operator&&c&&(0,d.isClassInstance)(c.expectedType)&&d.ClassType.isBuiltIn(c.expectedType,"list")&&c.expectedType.typeArguments&&c.expectedType.typeArguments.length>=1&&31===n.leftExpression.nodeType&&(_=c.expectedType);const I=null!=b?b:_,C=t.getTypeOfExpression(m,u,(0,p.makeInferenceContext)(I));let S=C.type;b||(37===n.operator||36===n.operator||0===n.operator&&31===n.rightExpression.nodeType||6===n.operator&&(0,d.isClassInstance)(S)&&d.ClassType.isTypedDictClass(S))&&(b=S);const x=t.getTypeOfExpression(f,u,(0,p.makeInferenceContext)(b));let F=x.type;if((C.isIncomplete||x.isIncomplete)&&(T=!0),6===n.operator&&!g(S,"__or__")&&!g(F,"__ror__")){let e=F,i=S;if(!(0,d.isNoneInstance)(S)&&(0,d.isNoneInstance)(F)?e=d.NoneType.createType():!(0,d.isNoneInstance)(F)&&(0,d.isNoneInstance)(S)&&(i=d.NoneType.createType()),(0,p.isUnionableType)([i,e])){const l=(0,o.getFileInfo)(n);if(l.isStubFile||0!=(4&u)||l.executionEnvironment.pythonVersion>=r.PythonVersion.V3_10||(0,d.isAnyOrUnknown)(i)||t.addError(a.Localizer.Diagnostic.unionSyntaxIllegal(),n,n.operatorToken),!t.validateTypeArg({...C,node:m},{allowVariadicTypeVar:!0,allowUnpackedTuples:!0})||!t.validateTypeArg({...x,node:f},{allowVariadicTypeVar:!0,allowUnpackedTuples:!0}))return{type:d.UnknownType.create()};const c=(0,d.combineTypes)([i,e]);if((0,d.isUnion)(c)&&d.TypeBase.setSpecialForm(c),!l.isStubFile){let e,n,i;if(48===m.nodeType?(e=m,n=f,i=F):48===f.nodeType&&(e=f,n=m,i=S),e&&n&&i){let n=!0;(0,d.isClass)(i)&&(i.isTypeArgumentExplicit&&!(0,d.isClassInstance)(i)||(n=!1)),n||t.addDiagnostic(l.diagnosticRuleSet.reportGeneralTypeIssues,s.DiagnosticRule.reportGeneralTypeIssues,a.Localizer.Diagnostic.unionForwardReferenceNotAllowed(),e)}}return{type:c}}}let D=!1;void 0===y[n.operator]&&(12===n.operator||28===n.operator?S=(0,d.removeNoneFromUnion)(S):D=(0,p.isOptionalType)(S),12!==n.operator&&28!==n.operator||(F=(0,d.removeNoneFromUnion)(F)));const P=new i.DiagnosticAddendum,E=!(0,l.isWithinLoop)(n),A=!(0,d.isUnion)(S);let k=h(t,n.operator,{type:S,isIncomplete:C.isIncomplete},{type:F,isIncomplete:x.isIncomplete},n,c,P,{isLiteralMathAllowed:E,isTupleAddAllowed:A});if(!P.isEmpty()||!k){if(v=!0,!T){const e=(0,o.getFileInfo)(n);if(D&&1===P.getMessages().length)t.addDiagnostic(e.diagnosticRuleSet.reportOptionalOperand,s.DiagnosticRule.reportOptionalOperand,a.Localizer.Diagnostic.noneOperator().format({operator:(0,l.printOperator)(n.operator)}),n.leftExpression);else{let i="";((0,d.isUnion)(t.makeTopLevelTypeVarsConcrete(S))||(0,d.isUnion)(t.makeTopLevelTypeVarsConcrete(F)))&&(i=P.getString()),t.addDiagnostic(e.diagnosticRuleSet.reportGeneralTypeIssues,s.DiagnosticRule.reportGeneralTypeIssues,a.Localizer.Diagnostic.typeNotSupportBinaryOperator().format({operator:(0,l.printOperator)(n.operator),leftType:t.printType(S),rightType:t.printType(F)})+i,n)}}k=d.UnknownType.create()}return{type:k,isIncomplete:T,typeErrors:v}},t.getTypeOfAugmentedAssignment=function(e,t,n){const r={1:["__iadd__",0],34:["__isub__",33],27:["__imul__",26],14:["__ifloordiv__",13],11:["__itruediv__",10],25:["__imod__",24],30:["__ipow__",29],23:["__imatmul__",22],4:["__iand__",3],7:["__ior__",6],9:["__ixor__",8],18:["__ilshift__",17],32:["__irshift__",31]};let c,u;const y=new i.DiagnosticAddendum,g=e.getTypeOfExpression(t.leftExpression),f=g.type;let T;7===t.operator&&(T=f);const v=e.getTypeOfExpression(t.rightExpression,void 0,(0,p.makeInferenceContext)(T)),_=v.type,b=!!v.isIncomplete||!!g.isIncomplete;if((0,d.isNever)(f)||(0,d.isNever)(_))u={type:d.NeverType.createNever(),isIncomplete:b};else{if(c=e.mapSubtypesExpandTypeVars(f,void 0,((i,s)=>e.mapSubtypesExpandTypeVars(_,(0,p.getTypeCondition)(i),((a,o)=>{if((0,d.isAnyOrUnknown)(s)||(0,d.isAnyOrUnknown)(o))return(0,p.preserveUnknown)(s,o);const c=r[t.operator][0];let u=e.getTypeOfMagicMethodReturn(s,[{type:o,isIncomplete:v.isIncomplete}],c,t,n);if(u||s===i||(u=e.getTypeOfMagicMethodReturn(i,[{type:o,isIncomplete:v.isIncomplete}],c,t,n)),u||o===a||(u=e.getTypeOfMagicMethodReturn(i,[{type:a,isIncomplete:v.isIncomplete}],c,t,n)),!u){const i=r[t.operator][1],a=!(0,l.isWithinLoop)(t)&&(0,p.getUnionSubtypeCount)(f)*(0,p.getUnionSubtypeCount)(_)<m,c=!(0,d.isUnion)(f);u=h(e,i,{type:s,isIncomplete:g.isIncomplete},{type:o,isIncomplete:v.isIncomplete},t,n,y,{isLiteralMathAllowed:a,isTupleAddAllowed:c})}return u})))),!y.isEmpty()||!c||(0,d.isNever)(c)){if(!b){const n=(0,o.getFileInfo)(t);e.addDiagnostic(n.diagnosticRuleSet.reportGeneralTypeIssues,s.DiagnosticRule.reportGeneralTypeIssues,a.Localizer.Diagnostic.typeNotSupportBinaryOperator().format({operator:(0,l.printOperator)(t.operator),leftType:e.printType(f),rightType:e.printType(_)})+y.getString(),t)}c=d.UnknownType.create()}u={type:c,isIncomplete:b}}return e.assignTypeToExpression(t.destExpression,u.type,!!u.isIncomplete,t.rightExpression),u},t.getTypeOfUnaryOperation=function(e,t,n){const i=e.getTypeOfExpression(t.expression);let r=e.makeTopLevelTypeVarsConcrete(i.type);const c=i.isIncomplete;if((0,d.isNever)(r))return{type:d.NeverType.createNever(),isIncomplete:c};const u={0:"__pos__",33:"__neg__",5:"__invert__"};let y;if(38!==t.operator&&(0,p.isOptionalType)(r)&&(e.addDiagnostic((0,o.getFileInfo)(t).diagnosticRuleSet.reportOptionalOperand,s.DiagnosticRule.reportOptionalOperand,a.Localizer.Diagnostic.noneOperator().format({operator:(0,l.printOperator)(t.operator)}),t.expression),r=(0,d.removeNoneFromUnion)(r)),!i.isIncomplete){const e=(0,p.getLiteralTypeClassName)(r);"int"===e?0===t.operator?y=r:33===t.operator&&(y=(0,p.mapSubtypes)(r,(e=>{const t=e;return d.ClassType.cloneWithLiteral(t,-t.literalValue)}))):"bool"===e&&38===t.operator&&(y=(0,p.mapSubtypes)(r,(e=>{const t=e;return d.ClassType.cloneWithLiteral(t,!t.literalValue)})))}if(!y)if(38===t.operator)y=e.getBuiltInObject(t,"bool"),y||(y=d.UnknownType.create());else{if((0,d.isAnyOrUnknown)(r))y=r;else{const i=u[t.operator];y=e.getTypeOfMagicMethodReturn(r,[],i,t,n)}if(!y){const i=(0,o.getFileInfo)(t);n?e.addDiagnostic(i.diagnosticRuleSet.reportGeneralTypeIssues,s.DiagnosticRule.reportGeneralTypeIssues,a.Localizer.Diagnostic.typeNotSupportUnaryOperatorBidirectional().format({operator:(0,l.printOperator)(t.operator),type:e.printType(r),expectedType:e.printType(n.expectedType)}),t):e.addDiagnostic(i.diagnosticRuleSet.reportGeneralTypeIssues,s.DiagnosticRule.reportGeneralTypeIssues,a.Localizer.Diagnostic.typeNotSupportUnaryOperator().format({operator:(0,l.printOperator)(t.operator),type:e.printType(r)}),t),y=d.UnknownType.create()}}return{type:y,isIncomplete:c}},t.getTypeOfTernaryOperation=function(e,t,n,i){e.getTypeOfExpression(t.testExpression);const s=[];let r=!1,a=!1;const l=(0,o.getFileInfo)(t),p=(0,c.evaluateStaticBoolExpression)(t.testExpression,l.executionEnvironment,l.definedConstants);if(!1!==p&&e.isNodeReachable(t.ifExpression)){const o=e.getTypeOfExpression(t.ifExpression,n,i);s.push(o.type),o.isIncomplete&&(r=!0),o.typeErrors&&(a=!0)}if(!0!==p&&e.isNodeReachable(t.elseExpression)){const o=e.getTypeOfExpression(t.elseExpression,n,i);s.push(o.type),o.isIncomplete&&(r=!0),o.typeErrors&&(a=!0)}return{type:(0,d.combineTypes)(s),isIncomplete:r,typeErrors:a}}},32966:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getParameterListDetails=t.ParameterSource=t.isTypedKwargs=void 0;const i=n(48466),s=n(51458),r=n(33029);var a;t.isTypedKwargs=function(e){return 2===e.category&&(0,s.isClassInstance)(e.type)&&(0,s.isUnpackedClass)(e.type)&&s.ClassType.isTypedDictClass(e.type)&&!!e.type.details.typedDictEntries},function(e){e[e.PositionOnly=0]="PositionOnly",e[e.PositionOrKeyword=1]="PositionOrKeyword",e[e.KeywordOnly=2]="KeywordOnly"}(a=t.ParameterSource||(t.ParameterSource={})),t.getParameterListDetails=function(e){const t={firstPositionOrKeywordIndex:0,positionParamCount:0,positionOnlyParamCount:0,params:[],hasUnpackedVariadicTypeVar:!1,hasUnpackedTypedDict:!1};let n=e.details.parameters.findIndex((e=>0===e.category&&!e.name));if(n<0)for(let t=0;t<e.details.parameters.length;t++){const s=e.details.parameters[t];if(0!==s.category)break;if(!s.name)break;if((0,i.isDunderName)(s.name)||!s.name.startsWith("__"))break;n=t+1}n>=0&&(t.firstPositionOrKeywordIndex=n);for(let i=0;i<n&&!e.details.parameters[i].hasDefault;i++)t.positionOnlyParamCount++;let o=!1;const l=(i,r,l,c,p)=>{if(i.name){let d;d=void 0!==p?p:1===i.category?a.PositionOnly:o?a.KeywordOnly:n>=0&&r<n?a.PositionOnly:a.PositionOrKeyword,t.params.push({param:i,index:r,type:null!=l?l:s.FunctionType.getEffectiveParameterType(e,r),defaultArgType:c,source:d})}};return e.details.parameters.forEach(((i,c)=>{var p,d;if(1===i.category){const r=s.FunctionType.getEffectiveParameterType(e,c);if(i.name&&(0,s.isUnpackedClass)(r)&&r.tupleTypeArguments){const e=c<t.positionOnlyParamCount;r.tupleTypeArguments.forEach(((n,r)=>{const o=(0,s.isVariadicTypeVar)(n.type)||n.isUnbounded?1:0;1===o&&(t.argsIndex=t.params.length),(0,s.isVariadicTypeVar)(i.type)&&(t.hasUnpackedVariadicTypeVar=!0),l({category:o,name:`${i.name}[${r.toString()}]`,isNameSynthesized:!0,type:n.type,hasDeclaredType:!0},c,n.type,void 0,a.PositionOnly),0===o&&t.positionParamCount++,r>0&&e&&t.positionOnlyParamCount++})),!o&&(n<0||c>=n)&&(t.firstKeywordOnlyIndex=t.params.length,o=!0)}else i.name&&void 0===t.argsIndex&&(t.argsIndex=t.params.length,(0,s.isVariadicTypeVar)(i.type)&&(t.hasUnpackedVariadicTypeVar=!0)),!o&&(n<0||c>=n)&&(t.firstKeywordOnlyIndex=t.params.length,i.name&&t.firstKeywordOnlyIndex++,o=!0),l(i,c)}else if(2===i.category){o=!0;const n=s.FunctionType.getEffectiveParameterType(e,c);if((0,s.isClassInstance)(n)&&(0,s.isUnpackedClass)(n)&&n.details.typedDictEntries){void 0===t.firstKeywordOnlyIndex&&(t.firstKeywordOnlyIndex=t.params.length);const e=n;n.details.typedDictEntries.forEach(((t,n)=>{const i=(0,r.partiallySpecializeType)(t.valueType,e);l({category:0,name:n,type:i,hasDeclaredType:!0,hasDefault:!t.isRequired},c,i)})),t.hasUnpackedTypedDict=!0}else i.name&&(void 0===t.kwargsIndex&&(t.kwargsIndex=t.params.length),void 0===t.firstKeywordOnlyIndex&&(t.firstKeywordOnlyIndex=t.params.length),l(i,c))}else 0===i.category&&(i.name&&!o&&t.positionParamCount++,l(i,c,void 0,(null===(p=e.specializedTypes)||void 0===p?void 0:p.parameterDefaultArgs)?null===(d=e.specializedTypes)||void 0===d?void 0:d.parameterDefaultArgs[c]:void 0))})),t}},20533:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ParentDirectoryCache=void 0;const i=n(5284),s=n(81844);t.ParentDirectoryCache=class{constructor(e){this._importRootGetter=e,this._importChecked=new Map,this._cachedResults=new Map,this._libPathCache=void 0}getImportResult(e,t,n){var i,s,r,a;const o=null===(i=this._cachedResults.get(t))||void 0===i?void 0:i.get(e);if(o)return null!=o?o:n;const l=null===(s=this._importChecked.get(t))||void 0===s?void 0:s.get(e);return l?l.importPath&&null!==(a=null===(r=this._cachedResults.get(t))||void 0===r?void 0:r.get(l.importPath))&&void 0!==a?a:n:void 0}checkValidPath(e,t,n){var i;return!!t.startsWith(n)&&(this._libPathCache=null!==(i=this._libPathCache)&&void 0!==i?i:this._importRootGetter().map((t=>(0,s.ensureTrailingDirectorySeparator)((0,s.normalizePathCase)(e,(0,s.normalizePath)(t))))).filter((e=>e!==n)).filter((e=>e.startsWith(n))),!this._libPathCache.some((e=>t.startsWith(e))))}checked(e,t,n){(0,i.getOrAdd)(this._importChecked,t,(()=>new Map)).set(e,n)}add(e){(0,i.getOrAdd)(this._cachedResults,e.importName,(()=>new Map)).set(e.path,e.importResult)}reset(){this._importChecked.clear(),this._cachedResults.clear(),this._libPathCache=void 0}}},7508:function(e,t,n){var i=this&&this.__createBinding||(Object.create?function(e,t,n,i){void 0===i&&(i=n),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,i){void 0===i&&(i=n),e[i]=t[n]}),s=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&i(t,e,n);return s(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.ParseTreeCleanerWalker=void 0;const a=r(n(21)),o=n(59438);class l extends o.ParseTreeWalker{constructor(e){super(),this._parseTree=e}clean(){this.walk(this._parseTree)}visitNode(e){return a.cleanNodeAnalysisInfo(e),super.visitNode(e)}}t.ParseTreeCleanerWalker=l},66455:function(e,t,n){var i=this&&this.__createBinding||(Object.create?function(e,t,n,i){void 0===i&&(i=n),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,i){void 0===i&&(i=n),e[i]=t[n]}),s=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&i(t,e,n);return s(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.getTokenAtIndex=t.isWhitespace=t.getTokenAtLeft=t.getTokenIndexAtLeft=t.getCallNodeAndActiveParameterIndex=t.getEnclosingParameter=t.CallNodeWalker=t.NameNodeWalker=t.isAssignmentToDefaultsFollowingNamedTuple=t.isDocString=t.getDocString=t.isWithinAssertExpression=t.isWithinTryBlock=t.isWithinLoop=t.isWithinAnnotationComment=t.isWithinTypeAnnotation=t.isWithinDefaultParamInitializer=t.isPartialMatchingExpression=t.isMatchingExpression=t.isSuiteEmpty=t.isNodeContainedWithinNodeType=t.getParentAnnotationNode=t.getParentNodeOfType=t.isNodeContainedWithin=t.isRequiredAllowedForAssignmentTarget=t.isClassVarAllowedForAssignmentTarget=t.isFinalAllowedForAssignmentTarget=t.getTypeAnnotationNode=t.getExecutionScopeNode=t.getTypeVarScopeNode=t.getEvaluationScopeNode=t.getEvaluationNodeForAssignmentExpression=t.getEnclosingSuiteOrModule=t.getEnclosingClassOrFunction=t.getEnclosingLambda=t.getEnclosingFunction=t.getEnclosingClassOrModule=t.getEnclosingModule=t.getEnclosingClass=t.getEnclosingSuite=t.getCallForName=t.printOperator=t.printExpression=t.printArgument=t.getTypeSourceId=t.getClassFullName=t.isCompliantWithNodeRangeRules=t.findNodeByOffset=t.findNodeByPosition=t.getNodeDepth=void 0,t.getTypeVarScopesForNode=t.getScopeIdForNode=t.getVariableDocStringNode=t.operatorSupportsChaining=t.isValidLocationForFutureImport=t.isUnannotatedFunction=t.isBlankLine=t.getFullStatementRange=t.getStringValueRange=t.getStringNodeValueRange=t.isLastNameOfDottedName=t.isFirstNameOfDottedName=t.getFirstNameOfDottedName=t.getDottedName=t.getDecoratorName=t.getDottedNameWithGivenNodeAsLastName=t.getFirstAncestorOrSelf=t.getFirstAncestorOrSelfOfKind=t.isLastNameOfModuleName=t.isFromImportAlias=t.isFromImportName=t.isFromImportModuleName=t.isImportAlias=t.isImportModuleName=t.getTypeAnnotationForParameter=t.isFunctionSuiteEmpty=t.getFileInfoFromNode=t.getModuleNode=t.isWriteAccess=t.printParseNodeType=t.getTokenOverlapping=t.getTokenAt=void 0;const a=r(n(21)),o=n(79251),l=n(30795),c=n(96541),p=n(6698),d=n(10154),u=n(29597),y=r(n(1240)),m=n(21),h=n(59438);function g(e,t){if(t<e.start||t>p.TextRange.getEnd(e))return;let n=(0,h.getChildNodes)(e);if(f(e)&&n.length>20){const e=(0,d.getIndexContaining)(n,t);e>=0&&(n=[n[e]])}for(const i of n){if(!i)continue;const n=g(i,t);if(n)return 5===e.nodeType&&n===e.leftExpression?e.destExpression:n}return e}function f(e){return 3!==e.nodeType&&48!==e.nodeType}function T(e,t){let n="";return 1===e.argumentCategory?n="*":2===e.argumentCategory&&(n="**"),e.name&&(n+=e.name.value+"="),n+=v(e.valueExpression,t),n}function v(e,t=0){switch(e.nodeType){case 38:return e.value;case 35:return v(e.leftExpression,t)+"."+e.memberName.value;case 9:{let n=v(e.leftExpression,t);return 35!==e.leftExpression.nodeType&&38!==e.leftExpression.nodeType&&24!==e.leftExpression.nodeType&&9!==e.leftExpression.nodeType&&(n=`(${n})`),n+"("+e.arguments.map((e=>T(e,t))).join(", ")+")"}case 24:return v(e.baseExpression,t)+"["+e.items.map((e=>T(e,t))).join(", ")+(e.trailingComma?",":"")+"]";case 55:return _(e.operator)+v(e.expression,t);case 7:{const n=v(e.leftExpression,t)+" "+_(e.operator)+" "+v(e.rightExpression,t);return e.parenthesized?`(${n})`:n}case 40:{let t=e.value.toString();return t.endsWith("n")&&(t=t.substring(0,t.length-1)),e.isImaginary&&(t+="j"),t}case 48:return 1&t&&e.typeAnnotation?v(e.typeAnnotation,t):e.strings.map((e=>v(e,t))).join(" ");case 49:{let n="";8&e.token.flags&&(n+="r"),16&e.token.flags&&(n+="u"),32&e.token.flags&&(n+="b"),64&e.token.flags&&(n+="f");let i=e.token.escapedValue;if(0==(2&t)){const e=32;i=i.substring(0,e)}return 4&e.token.flags?1&e.token.flags?n+=`'''${i}'''`:n+=`"""${i}"""`:1&e.token.flags?n+=`'${i}'`:n+=`"${i}"`,n}case 3:return v(e.leftExpression,t)+" = "+v(e.rightExpression,t);case 4:return v(e.name,t)+" := "+v(e.rightExpression,t);case 54:return v(e.valueExpression,t)+": "+v(e.typeAnnotation,t);case 5:return v(e.leftExpression,t)+" "+_(e.operator)+" "+v(e.rightExpression,t);case 6:return"await "+v(e.expression,t);case 51:return v(e.ifExpression,t)+" if "+v(e.testExpression,t)+" else "+v(e.elseExpression,t);case 31:return`[${e.entries.map((e=>v(e,t))).join(", ")}]`;case 56:return"*"+v(e.expression,t);case 52:{const n=e.expressions.map((e=>v(e,t)));return 1===n.length?`(${n[0]}, )`:`(${n.join(", ")})`}case 60:return e.expression?"yield "+v(e.expression,t):"yield";case 61:return"yield from "+v(e.expression,t);case 18:return"...";case 32:{let n="<ListExpression>";if((0,u.isExpressionNode)(e.expression))n=v(e.expression,t);else if(17===e.expression.nodeType){n=`${v(e.expression.keyExpression,t)}: ${v(e.expression.valueExpression,t)}`}return n=n+" "+e.forIfNodes.map((e=>33===e.nodeType?(e.isAsync?"async ":"")+"for "+v(e.targetExpression,t)+` in ${v(e.iterableExpression,t)}`:`if ${v(e.testExpression,t)}`)).join(" "),e.isParenthesized?`(${n}})`:n}case 46:{let n="";return e.startValue||e.endValue||e.stepValue?(e.startValue&&(n+=v(e.startValue,t)),e.endValue&&(n+=": "+v(e.endValue,t)),e.stepValue&&(n+=": "+v(e.stepValue,t))):n+=":",n}case 30:return"lambda "+e.parameters.map((e=>{let n="";return 1===e.category?n+="*":2===e.category&&(n+="**"),e.name?n+=e.name.value:0===e.category&&(n+="/"),e.defaultValue&&(n+=" = "+v(e.defaultValue,t)),n})).join(", ")+": "+v(e.expression,t);case 11:if(33===e.constType)return"True";if(15===e.constType)return"False";if(9===e.constType)return"__debug__";if(26===e.constType)return"None";break;case 15:{const n=`${e.entries.map((e=>17===e.nodeType?`${v(e.keyExpression,t)}: ${v(e.valueExpression,t)}`:16===e.nodeType?`**${v(e.expandExpression,t)}`:v(e,t)))}`;return n?`{ ${n} }`:"{}"}case 45:return e.entries.map((e=>v(e,t))).join(", ")}return"<Expression>"}function _(e){const t={0:"+",1:"+=",2:"=",3:"&",4:"&=",5:"~",6:"|",7:"|=",8:"^",9:"^=",10:"/",11:"/=",12:"==",13:"//",14:"//=",15:">",16:">=",17:"<<",18:"<<=",19:"<>",20:"<",21:"<=",22:"@",23:"@=",24:"%",25:"%=",26:"*",27:"*=",28:"!=",29:"**",30:"**=",31:">>",32:">>=",33:"-",34:"-=",36:"and",37:"or",38:"not",39:"is",40:"is not",41:"in",42:"not in"};return t[e]?t[e]:"unknown"}function b(e,t=!1){let n=e.parent;for(;n;){if(10===n.nodeType)return n;if(36===n.nodeType)return;if(28===n.nodeType&&t)return;n=n.parent}}function I(e){let t,n=e.parent;for(;n;){if(28===n.nodeType&&!n.decorators.some((e=>e===t)))return n;if(10===n.nodeType)return;t=n,n=n.parent}}function C(e){let t,n,i=e,s=!1;for(;i;){switch(41===i.nodeType&&t===i.name&&(s=!0),i.nodeType){case 28:if(i.parameters.some((e=>e===t))){if(s&&void 0!==(0,m.getScope)(i))return i}else if(t===i.suite&&void 0!==(0,m.getScope)(i))return i;break;case 30:if(i.parameters.some((e=>e===t))){if(s&&void 0!==(0,m.getScope)(i))return i}else if((!t||t===i.expression)&&void 0!==(0,m.getScope)(i))return i;break;case 10:if(t===i.suite&&void 0!==(0,m.getScope)(i))return i;break;case 32:if(void 0!==(0,m.getScope)(i)){if(!(t===i.forIfNodes[0]&&33===i.forIfNodes[0].nodeType&&i.forIfNodes[0].iterableExpression===n))return i}break;case 36:if(void 0!==(0,m.getScope)(i))return i}n=t,t=i,i=i.parent}(0,l.fail)("Did not find evaluation scope")}function S(e){let t,n=e;for(;n;){switch(n.nodeType){case 28:case 10:if(!n.decorators.some((e=>e===t)))return n;break;case 77:return n}t=n,n=n.parent}}function x(e,t){let n=e;for(;n;){if(n.nodeType===t)return n;n=n.parent}}function F(e,t){if(38===e.nodeType)return 38===t.nodeType?e.value===t.value:4===t.nodeType&&e.value===t.name.value;if(35===e.nodeType&&35===t.nodeType)return F(e.leftExpression,t.leftExpression)&&e.memberName.value===t.memberName.value;if(24===e.nodeType&&24===t.nodeType){if(!F(e.baseExpression,t.baseExpression))return!1;if(1!==t.items.length||t.trailingComma||t.items[0].name||0!==t.items[0].argumentCategory)return!1;const n=e.items[0].valueExpression;if(40===n.nodeType){const e=t.items[0].valueExpression;return!(40!==e.nodeType||e.isImaginary||!e.isInteger)&&n.value===e.value}if(55===n.nodeType&&33===n.operator&&40===n.expression.nodeType){const e=t.items[0].valueExpression;return!(55!==e.nodeType||33!==e.operator||40!==e.expression.nodeType||e.expression.isImaginary||!e.expression.isInteger)&&n.expression.value===e.expression.value}if(48===n.nodeType){const e=n,i=t.items[0].valueExpression;if(1===e.strings.length&&49===e.strings[0].nodeType&&48===i.nodeType&&1===i.strings.length&&49===i.strings[0].nodeType)return e.strings[0].value===i.strings[0].value}return!1}return!1}function D(e){if(0===e.statements.length||48!==e.statements[0].nodeType)return!1;const t=e.statements[0].strings;return 0!==t.length&&!t.some((e=>0!=(64&e.token.flags)))}t.getNodeDepth=function(e){let t=0,n=e;for(;n;)t++,n=n.parent;return t},t.findNodeByPosition=function(e,t,n){const i=(0,c.convertPositionToOffset)(t,n);if(void 0!==i)return g(e,i)},t.findNodeByOffset=g,t.isCompliantWithNodeRangeRules=f,t.getClassFullName=function(e,t,n){const i=[n];let s=e;for(;s;)s=b(s),s&&i.push(s.name.value);return i.push(t),i.reverse().join(".")},t.getTypeSourceId=function(e){return e.start},t.printArgument=T,t.printExpression=v,t.printOperator=_,t.getCallForName=function(e){var t,n,i;return 9===(null===(t=e.parent)||void 0===t?void 0:t.nodeType)&&e.parent.leftExpression===e?e.parent:35===(null===(n=e.parent)||void 0===n?void 0:n.nodeType)&&e.parent.memberName===e&&9===(null===(i=e.parent.parent)||void 0===i?void 0:i.nodeType)&&e.parent.parent.leftExpression===e.parent?e.parent.parent:void 0},t.getEnclosingSuite=function(e){let t=e.parent;for(;t;){if(50===t.nodeType)return t;t=t.parent}},t.getEnclosingClass=b,t.getEnclosingModule=function(e){let t=e.parent;for(;t;){if(36===t.nodeType)return t;t=t.parent}(0,l.fail)("Module node not found")},t.getEnclosingClassOrModule=function(e,t=!1){let n=e.parent;for(;n;){if(10===n.nodeType)return n;if(36===n.nodeType)return n;if(28===n.nodeType&&t)return;n=n.parent}},t.getEnclosingFunction=I,t.getEnclosingLambda=function(e){let t=e.parent;for(;t;){if(30===t.nodeType)return t;if(50===t.nodeType)return;t=t.parent}},t.getEnclosingClassOrFunction=function(e){let t=e.parent;for(;t;){if(28===t.nodeType)return t;if(10===t.nodeType)return t;t=t.parent}},t.getEnclosingSuiteOrModule=function(e,t=!1,n=!0){let i=e.parent;for(;i;){if(50===i.nodeType)return i;if(36===i.nodeType)return i;if(30===i.nodeType&&n)return;if(28===i.nodeType&&t)return;i=i.parent}},t.getEvaluationNodeForAssignmentExpression=function(e){let t=!1,n=C(e);for(;void 0!==n;)switch(n.nodeType){case 28:case 30:case 36:return n;case 10:return t?void 0:n;case 32:t=!0,n=C(n.parent);break;default:return}},t.getEvaluationScopeNode=C,t.getTypeVarScopeNode=S,t.getExecutionScopeNode=function(e){let t=C(e);for(;10===t.nodeType||32===t.nodeType;)t=C(t.parent);return t},t.getTypeAnnotationNode=function(e){let t=e,n=e.parent;for(;n;){if(54===n.nodeType){if(n.typeAnnotation===t)return n;break}t=n,n=n.parent}},t.isFinalAllowedForAssignmentTarget=function(e){if(38===e.nodeType)return!0;if(35===e.nodeType){if(38!==e.leftExpression.nodeType)return!1;if(!b(e))return!1;const t=I(e);return!!t&&"__init__"===t.name.value}return!1},t.isClassVarAllowedForAssignmentTarget=function(e){return!!b(e,!0)},t.isRequiredAllowedForAssignmentTarget=function(e){return!!b(e,!0)},t.isNodeContainedWithin=function(e,t){let n=e;for(;n;){if(n===t)return!0;n=n.parent}return!1},t.getParentNodeOfType=x,t.getParentAnnotationNode=function(e){let t,n=e;for(;n;){if(28===n.nodeType)return t===n.returnTypeAnnotation?t:void 0;if(41===n.nodeType)return t===n.typeAnnotation||t===n.typeAnnotationComment?t:void 0;if(3===n.nodeType)return t===n.typeAnnotationComment?t:void 0;if(54===n.nodeType)return t===n.typeAnnotation?t:void 0;if(62===n.nodeType)return t===n.returnTypeAnnotation||n.paramTypeAnnotations.some((e=>e===t))?((0,l.assert)(!t||(0,u.isExpressionNode)(t)),t):void 0;t=n,n=n.parent}},t.isNodeContainedWithinNodeType=function(e,t){return void 0!==x(e,t)},t.isSuiteEmpty=function(e){let t=!1;for(const n of e.statements){if(47!==n.nodeType)return!1;for(const e of n.statements)if(18===e.nodeType)t=!0;else if(48!==e.nodeType)return!1}return t},t.isMatchingExpression=F,t.isPartialMatchingExpression=function e(t,n){return 35===t.nodeType?F(t.leftExpression,n)||e(t.leftExpression,n):24===t.nodeType&&(F(t.baseExpression,n)||e(t.baseExpression,n))},t.isWithinDefaultParamInitializer=function(e){let t,n=e;for(;n;){if(41===n.nodeType&&t===n.defaultValue)return!0;if(30===n.nodeType||28===n.nodeType||10===n.nodeType||36===n.nodeType)return!1;t=n,n=n.parent}return!1},t.isWithinTypeAnnotation=function(e,t){let n,i=e,s=!1;for(;i;){if(41===i.nodeType&&(n===i.typeAnnotation||n===i.typeAnnotationComment))return s||!t;if(28===i.nodeType&&n===i.returnTypeAnnotation)return s||!t;if(28===i.nodeType&&n===i.functionAnnotationComment)return!0;if(54===i.nodeType&&n===i.typeAnnotation)return s||!t;if(3===i.nodeType&&n===i.typeAnnotationComment)return!0;if(48===i.nodeType&&n===i.typeAnnotation&&(s=!0),30===i.nodeType||28===i.nodeType||10===i.nodeType||36===i.nodeType)return!1;n=i,i=i.parent}return!1},t.isWithinAnnotationComment=function(e){let t,n=e;for(;n;){if(28===n.nodeType&&t===n.functionAnnotationComment)return!0;if(3===n.nodeType&&t===n.typeAnnotationComment)return!0;if(30===n.nodeType||28===n.nodeType||10===n.nodeType||36===n.nodeType)return!1;t=n,n=n.parent}return!1},t.isWithinLoop=function(e){let t=e;for(;t;){switch(t.nodeType){case 26:case 57:return!0}t=t.parent}return!1},t.isWithinTryBlock=function(e,t=!1){let n,i=e;for(;i;){switch(i.nodeType){case 53:return i.trySuite===n;case 58:if(t&&i.suite===n)return!0;break;case 28:case 36:case 10:return!1}n=i,i=i.parent}return!1},t.isWithinAssertExpression=function(e){let t,n=e;for(;n;){if(2===n.nodeType)return n.testExpression===t;t=n,n=n.parent}return!1},t.getDocString=function(e){if(0===e.length)return;if(47!==e[0].nodeType)return;if(!D(e[0]))return;const t=e[0].statements[0].strings;return 1===t.length?t[0].value:t.map((e=>e.value)).join("")},t.isDocString=D,t.isAssignmentToDefaultsFollowingNamedTuple=function(e){var t,n;if(9!==e.nodeType||!e.parent||3!==e.parent.nodeType||38!==e.parent.leftExpression.nodeType||!e.parent.parent||47!==e.parent.parent.nodeType)return!1;const i=e.parent.leftExpression.value,s=e.parent.parent;if(s.statements[0]!==e.parent||!s.parent||36!==s.parent.nodeType&&50!==s.parent.nodeType)return!1;const r=s.parent;let a=r.statements.findIndex((e=>e===s));if(a<0)return!1;for(a++;a<r.statements.length;){const e=r.statements[a];if(47!==e.nodeType)break;if(48!==(null===(t=e.statements[0])||void 0===t?void 0:t.nodeType)){if(3===(null===(n=e.statements[0])||void 0===n?void 0:n.nodeType)){const t=e.statements[0];if(35===t.leftExpression.nodeType&&"__defaults__"===t.leftExpression.memberName.value){const e=t.leftExpression.leftExpression;if(35===e.nodeType&&"__new__"===e.memberName.value&&38===e.leftExpression.nodeType&&e.leftExpression.value===i)return!0}}break}a++}return!1};class P extends h.ParseTreeWalker{constructor(e){super(),this._callback=e}visitName(e){return this._callback(e,this._subscriptIndex,this._baseExpression),!0}visitIndex(e){this.walk(e.baseExpression);const t=this._subscriptIndex,n=this._baseExpression;return this._baseExpression=e.baseExpression,e.items.forEach(((e,t)=>{this._subscriptIndex=t,this.walk(e)})),this._subscriptIndex=t,this._baseExpression=n,!1}}t.NameNodeWalker=P;class E extends h.ParseTreeWalker{constructor(e){super(),this._callback=e}visitCall(e){return this._callback(e),!0}}function A(e,t,n=!1,i=!1){const s=e.getItemAtPosition(t);if(s<0)return-1;for(let r=s;r>=0;r--){const s=e.getItemAt(r);if((i||0!==s.length)&&((n||!k(s))&&p.TextRange.getEnd(s)<=t))return r}return-1}function k(e){return 2===e.type||3===e.type||4===e.type}function w(e,t){if(!(t<0))return e.getItemAt(t)}function N(e,t){return w(e,e.getItemAtPosition(t))}function R(e){let t=e;for(;t&&36!==t.nodeType;)t=t.parent;return t}function O(e,t){return M(e,(e=>e.nodeType===t))}function M(e,t){for(const n of function*(e){for(;void 0!==e;)yield e,e=e.parent}(e))if(t(n))return n}function L(e){if(38===e.nodeType)return[e];const t=[];return function e(t,n){if(38===t.nodeType)return n.push(t),!0;if(n.push(t.memberName),38===t.leftExpression.nodeType||35===t.leftExpression.nodeType)return e(t.leftExpression,n);return!1}(e,t)?t.reverse():void 0}function V(e){const t=e.quoteMarkLength,n=!(65536&e.flags);return p.TextRange.create(e.start+t,e.length-t-(n?t:0))}function U(e,t){const n=e.tokenizerOutput.lines.getItemAt(t);return(0,o.containsOnlyWhitespace)(e.text,n)}function z(e){let t="";(10===e.nodeType||28===e.nodeType)&&(t=e.name.value);return`${a.getFileInfo(e).filePath}.${e.start.toString()}-${t}`}t.CallNodeWalker=E,t.getEnclosingParameter=function(e){let t=e;for(;t;){if(41===t.nodeType)return t;t=t.parent}},t.getCallNodeAndActiveParameterIndex=function(e,t,n){let i,s=e;for(;void 0!==s;){if(9===s.nodeType&&d(n,s,t)){i=s;break}s=s.parent}if(!i||!i.arguments)return;const r=p.TextRange.getEnd(i);if(t>r)return;const a=N(n,r-1);if(t===r&&14===(null==a?void 0:a.type))return;let o=!1,l=-1,c=!1;return i.arguments.forEach(((e,i)=>{if(o)return;let s=e.start;const r=n.getItemAtPosition(s);r>=0&&(s=p.TextRange.getEnd(n.getItemAt(r-1)));let a=p.TextRange.getEnd(e);const d=n.getItemAtPosition(a);if(d>=0)for(let e=d;e<n.count;e++){const t=n.getItemAt(e);switch(t.type){case 12:case 14:break;default:continue}a=p.TextRange.getEnd(t);break}t<a&&(l=i,c=t>=s,o=!0)})),o||(l=i.arguments.length+1),{callNode:i,activeIndex:l,activeOrFake:c};function d(e,t,n){const i=t.leftExpression.length>0?p.TextRange.getEnd(t.leftExpression)-1:t.leftExpression.start,s=p.TextRange.getEnd(t);if(n<i||s<n)return!1;if(t.arguments.length>0){const e=t.arguments[0].start,i=p.TextRange.getEnd(t.arguments[t.arguments.length-1]);if(e<=n&&n<i)return!0}const r=e.getItemAtPosition(i);if(r<0||e.count<=r)return!0;const a=e.getItemAt(r);if(5===a.type&&64&a.flags&&p.TextRange.contains(a,n)){const e=a,t=y.getUnescapedString(e),i=n-e.start-e.prefixLength-e.quoteMarkLength,r=t.formatStringSegments.find((e=>e.offset<=i&&i<e.offset+e.length));if(!r||!r.isExpression)return!0;const o=Math.min(r.length,s-e.start-e.prefixLength-e.quoteMarkLength-r.offset);for(let e=i-r.offset;e<o;e++){if("("===r.value[e])return!1}return!0}const o=e.getItemAt(r+1);return!(13===o.type&&n<p.TextRange.getEnd(o))}},t.getTokenIndexAtLeft=A,t.getTokenAtLeft=function(e,t,n=!1,i=!1){const s=A(e,t,n,i);if(!(s<0))return e.getItemAt(s)},t.isWhitespace=k,t.getTokenAtIndex=w,t.getTokenAt=N,t.getTokenOverlapping=function(e,t){const n=e.getItemAtPosition(t);if(n<0)return;const i=e.getItemAt(n);return p.TextRange.overlaps(i,t)?i:void 0},t.printParseNodeType=function(e){switch(e){case 0:return"Error";case 1:return"Argument";case 2:return"Assert";case 3:return"Assignment";case 4:return"AssignmentExpression";case 5:return"AugmentedAssignment";case 6:return"Await";case 7:return"BinaryOperation";case 8:return"Break";case 9:return"Call";case 10:return"Class";case 11:return"Constant";case 12:return"Continue";case 13:return"Decorator";case 14:return"Del";case 15:return"Dictionary";case 16:return"DictionaryExpandEntry";case 17:return"DictionaryKeyEntry";case 18:return"Ellipsis";case 19:return"If";case 20:return"Import";case 21:return"ImportAs";case 22:return"ImportFrom";case 23:return"ImportFromAs";case 24:return"Index";case 25:return"Except";case 26:return"For";case 27:return"FormatString";case 28:return"Function";case 29:return"Global";case 30:return"Lambda";case 31:return"List";case 32:return"ListComprehension";case 33:return"ListComprehensionFor";case 34:return"ListComprehensionIf";case 35:return"MemberAccess";case 36:return"Module";case 37:return"ModuleName";case 38:return"Name";case 39:return"Nonlocal";case 40:return"Number";case 41:return"Parameter";case 42:return"Pass";case 43:return"Raise";case 44:return"Return";case 45:return"Set";case 46:return"Slice";case 47:return"StatementList";case 48:return"StringList";case 49:return"String";case 50:return"Suite";case 51:return"Ternary";case 52:return"Tuple";case 53:return"Try";case 54:return"TypeAnnotation";case 55:return"UnaryOperation";case 56:return"Unpack";case 57:return"While";case 58:return"With";case 59:return"WithItem";case 60:return"Yield";case 61:return"YieldFrom";case 62:return"FunctionAnnotation";case 63:return"Match";case 64:return"Case";case 65:return"PatternSequence";case 66:return"PatternAs";case 67:return"PatternLiteral";case 68:return"PatternClass";case 69:return"PatternCapture";case 70:return"PatternMapping";case 71:return"PatternMappingKeyEntry";case 72:return"PatternMappingExpandEntry";case 73:return"PatternValue";case 74:return"PatternClassArgument";case 75:return"TypeParameter";case 76:return"TypeParameterList";case 77:return"TypeAlias"}(0,l.assertNever)(e)},t.isWriteAccess=function(e){let t=e,n=t.parent;for(;n;){switch(n.nodeType){case 3:case 5:return t===n.leftExpression;case 4:case 25:return t===n.name;case 14:return!0;case 26:case 33:return t===n.targetExpression;case 21:return t===n.alias||n.module.nameParts.length>0&&t===n.module.nameParts[0];case 23:return t===n.alias||!n.alias&&t===n.name;case 35:if(t!==n.memberName)return!1;break;case 58:return n.withItems.some((e=>e===t));case 54:if(t===n.typeAnnotation)return!1;break;case 28:case 10:case 36:return!1}t=n,n=n.parent}return!1},t.getModuleNode=R,t.getFileInfoFromNode=function(e){const t=R(e);return t?a.getFileInfo(t):void 0},t.isFunctionSuiteEmpty=function(e){let t=!0;return e.suite.statements.forEach((e=>{0!==e.nodeType&&(47===e.nodeType?e.statements.forEach((e=>{18!==e.nodeType&&48!==e.nodeType&&42!==e.nodeType&&(t=!1)})):t=!1)})),t},t.getTypeAnnotationForParameter=function(e,t){if(t>=e.parameters.length)return;const n=e.parameters[t];if(n.typeAnnotation)return n.typeAnnotation;if(n.typeAnnotationComment)return n.typeAnnotationComment;if(!e.functionAnnotationComment||e.functionAnnotationComment.isParamListEllipsis)return;let i=0;const s=e.functionAnnotationComment.paramTypeAnnotations;s.length<e.parameters.length&&(i=1);const r=t-i;return r<0||r>=s.length?void 0:s[r]},t.isImportModuleName=function(e){var t,n;return 21===(null===(n=null===(t=O(e,37))||void 0===t?void 0:t.parent)||void 0===n?void 0:n.nodeType)},t.isImportAlias=function(e){var t;return 21===(null===(t=e.parent)||void 0===t?void 0:t.nodeType)&&e.parent.alias===e},t.isFromImportModuleName=function(e){var t,n;return 22===(null===(n=null===(t=O(e,37))||void 0===t?void 0:t.parent)||void 0===n?void 0:n.nodeType)},t.isFromImportName=function(e){var t;return 23===(null===(t=e.parent)||void 0===t?void 0:t.nodeType)&&e.parent.name===e},t.isFromImportAlias=function(e){var t;return 23===(null===(t=e.parent)||void 0===t?void 0:t.nodeType)&&e.parent.alias===e},t.isLastNameOfModuleName=function(e){var t;if(37!==(null===(t=e.parent)||void 0===t?void 0:t.nodeType))return!1;const n=e.parent;return 0!==n.nameParts.length&&n.nameParts[n.nameParts.length-1]===e},t.getFirstAncestorOrSelfOfKind=O,t.getFirstAncestorOrSelf=M,t.getDottedNameWithGivenNodeAsLastName=function(e){var t;return 35!==(null===(t=e.parent)||void 0===t?void 0:t.nodeType)||e.parent.leftExpression===e?e:e.parent},t.getDecoratorName=function(e){return function e(t){var n;return 38===t.nodeType||35===t.nodeType?null===(n=L(t))||void 0===n?void 0:n.map((e=>e.value)).join("."):9===t.nodeType?e(t.leftExpression):void 0}(e.expression)},t.getDottedName=L,t.getFirstNameOfDottedName=function e(t){return 38===t.nodeType?t:38===t.leftExpression.nodeType||35===t.leftExpression.nodeType?e(t.leftExpression):void 0},t.isFirstNameOfDottedName=function(e){var t;return 35!==(null===(t=e.parent)||void 0===t?void 0:t.nodeType)||e.parent.leftExpression===e},t.isLastNameOfDottedName=function(e){var t,n;return 35!==(null===(t=e.parent)||void 0===t?void 0:t.nodeType)||(38===e.parent.leftExpression.nodeType||35===e.parent.leftExpression.nodeType)&&(e.parent.leftExpression!==e&&35!==(null===(n=e.parent.parent)||void 0===n?void 0:n.nodeType))},t.getStringNodeValueRange=function(e){return V(e.token)},t.getStringValueRange=V,t.getFullStatementRange=function(e,t,n){var i;const s=t.tokenizerOutput,r=(0,c.convertTextRangeToRange)(e,s.lines),a=null!==(i=function(e,t,n){const i=n.tokens.getItemAtPosition(t);if(i<0)return;let s=i;for(;s>0;s--){const t=n.tokens.getItemAt(s);if((0,c.convertTextRangeToRange)(t,n.lines).end.line!==e.start.line)break}for(let t=i-1;t>s;t--){const i=n.tokens.getItemAt(t);if(3!==i.type&&4!==i.type){if(2===i.type)return;return e.start}}return}(r,e.start,s))&&void 0!==i?i:{line:r.start.line,character:0},o=function(e,t,n){const i=n.tokens.getItemAtPosition(t);if(i<0)return;let s=i;for(;s<n.tokens.count;s++){const t=n.tokens.getItemAt(s),i=(0,c.convertTextRangeToRange)(t,n.lines);if(e.end.line!==i.start.line)break}let r=!1;for(let e=i;e<s;e++){const t=n.tokens.getItemAt(e);if(11===t.type||2===t.type){r=!0;continue}if(!r)continue;return(0,c.convertTextRangeToRange)(t,n.lines).start}return}(r,p.TextRange.getEnd(e),s);if(o)return{start:a,end:o};if(r.end.line===s.lines.count-1)return{start:a,end:r.end};let l=1;if(n&&n.includeTrailingBlankLines)for(let e=l;r.end.line+e<s.lines.count;e++)if(!U(t,r.end.line+e)){l=e;break}return{start:a,end:{line:r.end.line+l,character:0}}},t.isBlankLine=U,t.isUnannotatedFunction=function(e){return void 0===e.returnTypeAnnotation&&e.parameters.every((e=>void 0===e.typeAnnotation&&void 0===e.typeAnnotationComment))},t.isValidLocationForFutureImport=function(e){const t=R(e);(0,l.assert)(t);let n=!1;for(const i of t.statements){if(47!==i.nodeType)return!1;for(const t of i.statements){if(t===e)return!0;if(48===t.nodeType){if(n)return!1;n=!0}else{if(22!==t.nodeType)return!1;if(0!==t.module.leadingDots||1!==t.module.nameParts.length||"__future__"!==t.module.nameParts[0].value)return!1}}}return!1},t.operatorSupportsChaining=function(e){switch(e){case 12:case 28:case 20:case 21:case 15:case 16:case 39:case 40:case 41:case 42:return!0}return!1},t.getVariableDocStringNode=function(e){var t,n,i,s;let r,a=e;for(;a&&3!==a.nodeType;)54!==a.nodeType||r||(r=a),a=a.parent;if(3!==(null==a?void 0:a.nodeType)){if(!r)return;a=r}const o=a.parent;if(47!==(null==o?void 0:o.nodeType))return;const l=o.parent;if(!l||36!==l.nodeType&&50!==l.nodeType)return;const c=l.statements.findIndex((e=>e===o));if(c<0||c===l.statements.length-1)return;const p=l.statements[c+1];if(47!==p.nodeType||!D(p))return;let d=!1;if(36===(null===(t=null==o?void 0:o.parent)||void 0===t?void 0:t.nodeType))d=!0;else if(50===(null===(n=null==o?void 0:o.parent)||void 0===n?void 0:n.nodeType)&&10===(null===(s=null===(i=null==o?void 0:o.parent)||void 0===i?void 0:i.parent)||void 0===s?void 0:s.nodeType))d=!0;else{const e=I(o);e&&"__init__"===e.name.value&&b(e,!0)&&(d=!0)}return d?p.statements[0]:void 0},t.getScopeIdForNode=z,t.getTypeVarScopesForNode=function(e){const t=[];let n=e;for(;n&&(n=S(n),n);)t.push(z(n)),n=n.parent;return t}},59438:function(e,t,n){var i=this&&this.__createBinding||(Object.create?function(e,t,n,i){void 0===i&&(i=n),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,i){void 0===i&&(i=n),e[i]=t[n]}),s=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&i(t,e,n);return s(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.ParseTreeWalker=t.ParseTreeVisitor=t.getChildNodes=void 0;const a=r(n(30795));function o(e){var t;switch(e.nodeType){case 0:return[e.child,...null!==(t=e.decorators)&&void 0!==t?t:[]];case 1:return[e.name,e.valueExpression];case 2:return[e.testExpression,e.exceptionExpression];case 4:return[e.name,e.rightExpression];case 3:return[e.leftExpression,e.rightExpression,e.typeAnnotationComment];case 5:case 7:return[e.leftExpression,e.rightExpression];case 6:case 13:case 67:case 73:case 55:case 56:case 60:case 61:return[e.expression];case 8:case 11:case 12:case 18:case 38:case 40:case 42:case 49:return[];case 9:return[e.leftExpression,...e.arguments];case 64:return[e.pattern,e.guardExpression,e.suite];case 10:return[...e.decorators,e.name,e.typeParameters,...e.arguments,e.suite];case 14:case 27:case 52:return e.expressions;case 15:case 31:case 45:return e.entries;case 16:return[e.expandExpression];case 17:return[e.keyExpression,e.valueExpression];case 19:return[e.testExpression,e.ifSuite,e.elseSuite];case 20:return e.list;case 21:return[e.module,e.alias];case 22:return[e.module,...e.imports];case 23:return[e.name,e.alias];case 24:return[e.baseExpression,...e.items];case 25:return[e.typeExpression,e.name,e.exceptSuite];case 26:return[e.targetExpression,e.iterableExpression,e.forSuite,e.elseSuite];case 28:return[...e.decorators,e.name,e.typeParameters,...e.parameters,e.returnTypeAnnotation,e.functionAnnotationComment,e.suite];case 62:return[...e.paramTypeAnnotations,e.returnTypeAnnotation];case 29:case 39:return e.nameList;case 30:return[...e.parameters,e.expression];case 32:return[e.expression,...e.forIfNodes];case 33:return[e.targetExpression,e.iterableExpression];case 34:return[e.testExpression];case 63:return[e.subjectExpression,...e.cases];case 35:return[e.leftExpression,e.memberName];case 37:return e.nameParts;case 36:case 50:return[...e.statements];case 41:return[e.name,e.typeAnnotation,e.typeAnnotationComment,e.defaultValue];case 66:return[...e.orPatterns,e.target];case 68:return[e.className,...e.arguments];case 74:return[e.name,e.pattern];case 69:case 72:return[e.target];case 71:return[e.keyPattern,e.valuePattern];case 70:case 65:return[...e.entries];case 43:return[e.typeExpression,e.valueExpression,e.tracebackExpression];case 44:return[e.returnExpression];case 46:return[e.startValue,e.endValue,e.stepValue];case 47:return e.statements;case 48:return[e.typeAnnotation,...e.strings];case 51:return[e.ifExpression,e.testExpression,e.elseExpression];case 53:return[e.trySuite,...e.exceptClauses,e.elseSuite,e.finallySuite];case 77:return[e.name,e.typeParameters,e.expression];case 54:return[e.valueExpression,e.typeAnnotation];case 75:return[e.name,e.boundExpression,e.defaultExpression];case 76:return[...e.parameters];case 57:return[e.testExpression,e.whileSuite,e.elseSuite];case 58:return[...e.withItems,e.suite];case 59:return[e.expression,e.target];default:a.assertNever(e,`Unknown node type ${e}`)}}t.getChildNodes=o;class l{constructor(e){this._default=e}visit(e){switch(e.nodeType){case 0:return this.visitError(e);case 1:return this.visitArgument(e);case 2:return this.visitAssert(e);case 4:return this.visitAssignmentExpression(e);case 3:return this.visitAssignment(e);case 5:return this.visitAugmentedAssignment(e);case 6:return this.visitAwait(e);case 7:return this.visitBinaryOperation(e);case 8:return this.visitBreak(e);case 9:return this.visitCall(e);case 64:return this.visitCase(e);case 10:return this.visitClass(e);case 11:return this.visitConstant(e);case 12:return this.visitContinue(e);case 13:return this.visitDecorator(e);case 14:return this.visitDel(e);case 15:return this.visitDictionary(e);case 16:return this.visitDictionaryExpandEntry(e);case 17:return this.visitDictionaryKeyEntry(e);case 18:return this.visitEllipsis(e);case 19:return this.visitIf(e);case 20:return this.visitImport(e);case 21:return this.visitImportAs(e);case 22:return this.visitImportFrom(e);case 23:return this.visitImportFromAs(e);case 24:return this.visitIndex(e);case 25:return this.visitExcept(e);case 26:return this.visitFor(e);case 27:return this.visitFormatString(e);case 28:return this.visitFunction(e);case 62:return this.visitFunctionAnnotation(e);case 29:return this.visitGlobal(e);case 30:return this.visitLambda(e);case 31:return this.visitList(e);case 32:return this.visitListComprehension(e);case 33:return this.visitListComprehensionFor(e);case 34:return this.visitListComprehensionIf(e);case 63:return this.visitMatch(e);case 35:return this.visitMemberAccess(e);case 37:return this.visitModuleName(e);case 36:return this.visitModule(e);case 38:return this.visitName(e);case 39:return this.visitNonlocal(e);case 40:return this.visitNumber(e);case 41:return this.visitParameter(e);case 42:return this.visitPass(e);case 66:return this.visitPatternAs(e);case 68:return this.visitPatternClass(e);case 74:return this.visitPatternClassArgument(e);case 69:return this.visitPatternCapture(e);case 67:return this.visitPatternLiteral(e);case 72:return this.visitPatternMappingExpandEntry(e);case 71:return this.visitPatternMappingKeyEntry(e);case 70:return this.visitPatternMapping(e);case 65:return this.visitPatternSequence(e);case 73:return this.visitPatternValue(e);case 43:return this.visitRaise(e);case 44:return this.visitReturn(e);case 45:return this.visitSet(e);case 46:return this.visitSlice(e);case 47:return this.visitStatementList(e);case 48:return this.visitStringList(e);case 49:return this.visitString(e);case 50:return this.visitSuite(e);case 51:return this.visitTernary(e);case 52:return this.visitTuple(e);case 53:return this.visitTry(e);case 77:return this.visitTypeAlias(e);case 54:return this.visitTypeAnnotation(e);case 75:return this.visitTypeParameter(e);case 76:return this.visitTypeParameterList(e);case 55:return this.visitUnaryOperation(e);case 56:return this.visitUnpack(e);case 57:return this.visitWhile(e);case 58:return this.visitWith(e);case 59:return this.visitWithItem(e);case 60:return this.visitYield(e);case 61:return this.visitYieldFrom(e);default:a.assertNever(e,`Unknown node type ${e}`)}}visitArgument(e){return this._default}visitAssert(e){return this._default}visitAssignment(e){return this._default}visitAssignmentExpression(e){return this._default}visitAugmentedAssignment(e){return this._default}visitAwait(e){return this._default}visitBinaryOperation(e){return this._default}visitBreak(e){return this._default}visitCall(e){return this._default}visitCase(e){return this._default}visitClass(e){return this._default}visitTernary(e){return this._default}visitContinue(e){return this._default}visitConstant(e){return this._default}visitDecorator(e){return this._default}visitDel(e){return this._default}visitDictionary(e){return this._default}visitDictionaryKeyEntry(e){return this._default}visitDictionaryExpandEntry(e){return this._default}visitError(e){return this._default}visitEllipsis(e){return this._default}visitIf(e){return this._default}visitImport(e){return this._default}visitImportAs(e){return this._default}visitImportFrom(e){return this._default}visitImportFromAs(e){return this._default}visitIndex(e){return this._default}visitExcept(e){return this._default}visitFor(e){return this._default}visitFormatString(e){return this._default}visitFunction(e){return this._default}visitFunctionAnnotation(e){return this._default}visitGlobal(e){return this._default}visitLambda(e){return this._default}visitList(e){return this._default}visitListComprehension(e){return this._default}visitListComprehensionFor(e){return this._default}visitListComprehensionIf(e){return this._default}visitMatch(e){return this._default}visitMemberAccess(e){return this._default}visitModule(e){return this._default}visitModuleName(e){return this._default}visitName(e){return this._default}visitNonlocal(e){return this._default}visitNumber(e){return this._default}visitParameter(e){return this._default}visitPass(e){return this._default}visitPatternCapture(e){return this._default}visitPatternClass(e){return this._default}visitPatternClassArgument(e){return this._default}visitPatternAs(e){return this._default}visitPatternLiteral(e){return this._default}visitPatternMappingExpandEntry(e){return this._default}visitPatternSequence(e){return this._default}visitPatternValue(e){return this._default}visitPatternMappingKeyEntry(e){return this._default}visitPatternMapping(e){return this._default}visitRaise(e){return this._default}visitReturn(e){return this._default}visitSet(e){return this._default}visitSlice(e){return this._default}visitStatementList(e){return this._default}visitString(e){return this._default}visitStringList(e){return this._default}visitSuite(e){return this._default}visitTuple(e){return this._default}visitTry(e){return this._default}visitTypeAlias(e){return this._default}visitTypeAnnotation(e){return this._default}visitTypeParameter(e){return this._default}visitTypeParameterList(e){return this._default}visitUnaryOperation(e){return this._default}visitUnpack(e){return this._default}visitWhile(e){return this._default}visitWith(e){return this._default}visitWithItem(e){return this._default}visitYield(e){return this._default}visitYieldFrom(e){return this._default}}t.ParseTreeVisitor=l;t.ParseTreeWalker=class extends l{constructor(){super(!0)}walk(e){const t=this.visitNode(e);t.length>0&&this.walkMultiple(t)}walkMultiple(e){e.forEach((e=>{e&&this.walk(e)}))}visitNode(e){return this.visit(e)?o(e):[]}}},78140:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getPatternSubtypeNarrowingCallback=t.validateClassPattern=t.assignTypeToPatternTargets=t.checkForUnusedPattern=t.narrowTypeBasedOnPattern=void 0;const i=n(5284),s=n(30795),r=n(83501),a=n(28513),o=n(99661),l=n(21),c=n(54750),p=n(66455),d=n(2026),u=n(36906),y=n(51458),m=n(33029),h=n(43024),g=["builtins.bool","builtins.bytearray","builtins.bytes","builtins.dict","builtins.float","builtins.frozenset","builtins.int","builtins.list","builtins.set","builtins.str","builtins.tuple"];function f(e,t,n,s){switch(n.nodeType){case 65:return function(e,t,n,s){t=(0,m.transformPossibleRecursiveTypeAlias)(t);let r=I(e,t,n.entries.length,n.starEntryIndex);return r=r.filter((t=>{if(t.definiteNoMatch)return!s;let r=!0,a=!0;const o=[];let l=t.isTuple;!s&&t.isIndeterminateLength&&(l=!1),t.isIndeterminateLength&&(1===n.entries.length&&0===n.starEntryIndex||(a=!1));let c=0;if(n.entries.forEach(((p,d)=>{const u=C(e,n,t,d,n.entries.length,n.starEntryIndex,!0,!1),h=f(e,u,p,s);s?d===n.starEntryIndex?(0,y.isClassInstance)(h)&&h.tupleTypeArguments&&!(0,m.isUnboundedTupleClass)(h)&&h.tupleTypeArguments?(0,i.appendArray)(o,h.tupleTypeArguments.map((e=>e.type))):(o.push(h),l=!1):(o.push(h),(0,y.isNever)(h)&&(r=!1)):((0,y.isNever)(h)?o.push(u):(a=!1,c++,o.push(h)),d===n.starEntryIndex&&(l=!1))})),!s){if(a)return!1;if(l&&1===c){const i=e.getBuiltInType(n,"tuple");i&&(0,y.isInstantiableClass)(i)&&(t.subtype=y.ClassType.cloneAsInstance((0,m.specializeTupleClass)(i,o.map((e=>({type:e,isUnbounded:!1}))))))}return!0}if(r){if(l){const i=e.getBuiltInType(n,"tuple");i&&(0,y.isInstantiableClass)(i)&&(t.subtype=y.ClassType.cloneAsInstance((0,m.specializeTupleClass)(i,o.map((e=>({type:e,isUnbounded:!1}))))))}if(t.isObject){const i=e.getTypingType(n,"Sequence");i&&(0,y.isInstantiableClass)(i)&&(t.subtype=y.ClassType.cloneAsInstance(y.ClassType.cloneForSpecialization(i,[e.stripLiteralValue((0,y.combineTypes)(o))],!0)))}}return r})),(0,y.combineTypes)(r.map((e=>e.subtype)))}(e,t,n,s);case 67:return function(e,t,n,i){const s=e.getTypeOfExpression(n.expression).type;if(!i)return(0,m.mapSubtypes)(t,(t=>{if(!((0,y.isClassInstance)(s)&&(0,m.isLiteralType)(s)&&(0,y.isClassInstance)(t)&&(0,m.isLiteralType)(t)&&e.assignType(s,t)||(0,y.isNoneInstance)(t)&&(0,y.isNoneInstance)(s)))return(0,y.isClassInstance)(t)&&y.ClassType.isBuiltIn(t,"bool")&&void 0===t.literalValue&&(0,y.isClassInstance)(s)&&y.ClassType.isBuiltIn(s,"bool")&&void 0!==s.literalValue?y.ClassType.cloneWithLiteral(s,!s.literalValue):t}));return(0,m.mapSubtypes)(t,(t=>e.assignType(t,s)?s:(0,y.isClassInstance)(s)&&(0,m.isLiteralType)(s)&&(0,y.isClassInstance)(t)&&!(0,m.isLiteralType)(t)&&e.assignType(y.ClassType.cloneWithLiteral(s,void 0),t)?t:void 0))}(e,t,n,s);case 68:return function(e,t,n,i){let s=e.getTypeOfExpression(n.className,2).type;(0,y.isClass)(s)&&!s.typeAliasInfo&&(s=(0,m.specializeClassType)(s));if(!i){if(!(0,y.isInstantiableClass)(s))return t;let r=s;r.details.typeParameters.length>0&&(r=y.ClassType.cloneForSpecialization(r,void 0,!1));const a=(0,m.convertToInstance)(r);return e.mapSubtypesExpandTypeVars(t,void 0,((t,s)=>{if(!(0,y.isNoneInstance)(t)&&!(0,y.isClassInstance)(t))return s;if((0,y.isNoneInstance)(t)&&(0,y.isInstantiableClass)(r)&&y.ClassType.isBuiltIn(r,"NoneType"))return;if(!e.assignType(a,t))return t;if(0===n.arguments.length){if((0,y.isClass)(a)&&(0,y.isClass)(t)&&y.ClassType.isSameGenericClass(a,t))return;return t}if(!e.assignType(t,a)&&(0,y.isClass)(t)&&!y.ClassType.isFinal(t))return t;let o=[];n.arguments.some((e=>!e.name))&&(0,y.isClass)(t)&&(o=T(e,t));for(let r=0;r<n.arguments.length;r++){const a=_(e,n.arguments[r],r,o,t,i);if(!(0,y.isNever)(a))return s}}))}if(!y.TypeBase.isInstantiable(s)&&!(0,y.isNever)(s))return e.addDiagnostic((0,l.getFileInfo)(n).diagnosticRuleSet.reportGeneralTypeIssues,a.DiagnosticRule.reportGeneralTypeIssues,o.Localizer.DiagnosticAddendum.typeNotClass().format({type:e.printType(s)}),n.className),y.NeverType.createNever();return e.mapSubtypesExpandTypeVars(s,void 0,((s,r)=>(0,y.isAnyOrUnknown)(s)?r:(0,y.isInstantiableClass)(s)?e.mapSubtypesExpandTypeVars(t,void 0,(t=>{if((0,y.isAnyOrUnknown)(t))return(0,m.convertToInstance)(r);if((0,y.isNoneInstance)(t)&&(0,y.isInstantiableClass)(s)&&y.ClassType.isBuiltIn(s,"NoneType"))return t;if((0,y.isClassInstance)(t)){let a;if(e.assignType(s,y.ClassType.cloneAsInstantiable(t)))a=t;else{if(!e.assignType(y.ClassType.cloneAsInstantiable(t),s))return;if(a=(0,m.addConditionToType)((0,m.convertToInstance)(r),(0,m.getTypeCondition)(t)),(0,y.isInstantiableClass)(r)&&(0,y.isClassInstance)(t)&&(y.ClassType.isSpecialBuiltIn(r)||r.details.typeParameters.length>0)){const n=new h.TypeVarContext((0,m.getTypeVarScopeId)(r)),i=y.ClassType.cloneForSpecialization(r,void 0,!1),s=y.ClassType.cloneAsInstance(i);(0,c.populateTypeVarContextBasedOnExpectedType)(e,s,t,n,void 0)&&(a=(0,m.applySolvedTypeVars)(s,n,{unknownIfNotFound:!0}))}}let o=[];n.arguments.some((e=>!e.name))&&(o=T(e,s));let l=!0;if(n.arguments.forEach(((t,n)=>{const s=_(e,t,n,o,a,i);(0,y.isNever)(s)&&(l=!1)})),l)return a}})):void 0))}(e,t,n,s);case 66:return function(e,t,n,i){let s=t;if(!i)return n.orPatterns.forEach((t=>{s=f(e,s,t,!1)})),s;const r=n.orPatterns.map((t=>{const n=f(e,s,t,!0);return s=f(e,s,t,!1),n}));return(0,y.combineTypes)(r)}(e,t,n,s);case 70:return function(e,t,n,i){if(t=(0,m.transformPossibleRecursiveTypeAlias)(t),!i){if(1!==n.entries.length||71!==n.entries[0].nodeType)return t;const i=n.entries[0].keyPattern,s=n.entries[0].valuePattern;if(67!==i.nodeType||66!==s.nodeType||!s.orPatterns.every((e=>67===e.nodeType)))return t;const r=e.getTypeOfExpression(i.expression).type;if(!(0,y.isClassInstance)(r)||!y.ClassType.isBuiltIn(r,"str")||void 0===r.literalValue)return t;const a=r.literalValue,o=s.orPatterns.map((t=>e.getTypeOfExpression(t.expression).type));return(0,m.mapSubtypes)(t,(t=>{if((0,y.isClassInstance)(t)&&y.ClassType.isTypedDictClass(t)){const n=(0,d.getTypedDictMembersForClass)(e,t,!0).get(a);if(n&&(n.isRequired||n.isProvided)&&(0,y.isClassInstance)(n.valueType)){const e=n.valueType;if(o.some((t=>(0,y.isClassInstance)(t)&&y.ClassType.isSameGenericClass(t,e)&&t.literalValue===e.literalValue)))return}}return t}))}let s=b(e,t);return s=s.filter((t=>{let s=!0;return n.entries.forEach((r=>{if(t.typedDict){if(71===r.nodeType){const a=f(e,e.getBuiltInObject(n,"str"),r.keyPattern,i);(0,y.isNever)(a)&&(s=!1);const o=(0,m.mapSubtypes)(a,(n=>{var i;if((0,y.isAnyOrUnknown)(n))return n;if((0,y.isClassInstance)(n)&&y.ClassType.isBuiltIn(n,"str")){if(!(0,m.isLiteralType)(n))return y.UnknownType.create();const s=(0,d.getTypedDictMembersForClass)(e,t.typedDict).get(n.literalValue);if(s){const a=f(e,s.valueType,r.valuePattern,!0);if(!(0,y.isNever)(a)){if(!s.isRequired&&!s.isProvided&&(0,y.isTypeSame)(t.subtype,t.typedDict)){const e=new Map(null!==(i=t.typedDict.typedDictNarrowedEntries)&&void 0!==i?i:[]);e.set(n.literalValue,{valueType:s.valueType,isRequired:!1,isProvided:!0}),t.subtype=y.ClassType.cloneAsInstance(y.ClassType.cloneForNarrowedTypedDictEntries(y.ClassType.cloneAsInstantiable(t.typedDict),e)),t.typedDict=t.subtype}return a}}}}));(0,y.isNever)(o)&&(s=!1)}}else if(t.dictTypeArgs&&71===r.nodeType){const n=f(e,t.dictTypeArgs.key,r.keyPattern,i),a=f(e,t.dictTypeArgs.value,r.valuePattern,i);((0,y.isNever)(n)||(0,y.isNever)(a))&&(s=!1)}})),s})),(0,y.combineTypes)(s.map((e=>e.subtype)))}(e,t,n,s);case 73:return function(e,t,n,i){const s=e.getTypeOfExpression(n.expression).type,r=[];return e.mapSubtypesExpandTypeVars(s,void 0,((s,a)=>{r.push(e.mapSubtypesExpandTypeVars(t,(0,m.getTypeCondition)(s),(t=>{if(!i){if((0,y.isClassInstance)(t)&&y.ClassType.isEnumClass(t)&&!(0,m.isLiteralType)(t)&&(0,y.isClassInstance)(s)&&(0,y.isSameWithoutLiteralValue)(t,s)&&(0,m.isLiteralType)(s)){const n=(0,u.enumerateLiteralsForType)(e,t);if(n)return(0,y.combineTypes)(n.filter((e=>!y.ClassType.isLiteralValueSame(s,e))))}else if((0,y.isClassInstance)(t)&&(0,y.isClassInstance)(s)&&(0,m.isLiteralType)(t)&&y.ClassType.isLiteralValueSame(s,t))return;return t}if((0,y.isNever)(s)||(0,y.isNever)(t))return y.NeverType.createNever();if((0,y.isAnyOrUnknown)(s)||(0,y.isAnyOrUnknown)(t))return(0,y.isUnknown)(s)||(0,y.isUnknown)(t)?(0,m.preserveUnknown)(s,t):y.AnyType.create();return e.useSpeculativeMode(n.expression,(()=>e.getTypeOfMagicMethodReturn(s,[{type:t}],"__eq__",n.expression,void 0)))?a:void 0})))})),(0,y.combineTypes)(r)}(e,t,n,s);case 69:return s?t:y.NeverType.createNever();case 0:return t}}function T(e,t){const n=(0,m.lookUpClassMember)(t,"__match_args__");if(n){const t=e.getTypeOfMember(n);if((0,y.isClassInstance)(t)&&(0,m.isTupleClass)(t)&&!(0,m.isUnboundedTupleClass)(t)&&t.tupleTypeArguments){const e=t.tupleTypeArguments;if(e.every((e=>(0,y.isClassInstance)(e.type)&&y.ClassType.isBuiltIn(e.type,"str")&&(0,m.isLiteralType)(e.type))))return e.map((e=>e.type.literalValue))}}return[]}function v(e){return g.some((t=>e.details.fullName===t))}function _(e,t,n,i,s,r){var a;let o;if(t.name?o=t.name.value:n<i.length&&(o=i[n]),(0,y.isAnyOrUnknown)(s))return s;if(!(0,y.isClass)(s))return y.UnknownType.create();let l,c=!1,p=s;if(!t.name&&(0,y.isClass)(s)&&0===n&&(v(s)?c=!0:0===i.length&&s.details.mro.forEach((e=>{(0,y.isClass)(e)&&v(e)&&(p=e,c=!0)}))),c)l=y.ClassType.cloneAsInstance(p);else if(o&&(l=null===(a=e.useSpeculativeMode(t,(()=>e.getTypeOfObjectMember(t,y.ClassType.cloneAsInstance(s),o))))||void 0===a?void 0:a.type),!l){if(!r)return s;if(y.ClassType.isFinal(s))return y.NeverType.createNever();l=y.UnknownType.create()}return f(e,l,t.pattern,r)}function b(e,t){const n=[];return(0,m.doForEachSubtype)(t,(t=>{const i=e.makeTopLevelTypeVarsConcrete(t);if((0,y.isAnyOrUnknown)(i))n.push({subtype:t,dictTypeArgs:{key:i,value:i}});else if((0,y.isClassInstance)(i))if(y.ClassType.isTypedDictClass(i))n.push({subtype:t,typedDict:i});else{let e;for(const t of i.details.mro)if((0,y.isInstantiableClass)(t)&&y.ClassType.isBuiltIn(t,"Mapping")){e=t;break}if(e){const s=(0,m.partiallySpecializeType)(e,i);s.typeArguments&&s.typeArguments.length>=2&&n.push({subtype:t,dictTypeArgs:{key:s.typeArguments[0],value:s.typeArguments[1]}})}}})),n}function I(e,t,n,i){const s=[],r=void 0===i?n:n-1;return(0,m.doForEachSubtype)(t,(t=>{const n=e.makeTopLevelTypeVarsConcrete(t);let a,o=!1;if((0,y.isAnyOrUnknown)(n))s.push({subtype:t,entryTypes:[n],isIndeterminateLength:!0,definiteNoMatch:!1});else{if((0,y.isClassInstance)(n)){if(y.ClassType.isBuiltIn(n,"object"))return void s.push({subtype:t,entryTypes:[(0,m.convertToInstance)(n)],isIndeterminateLength:!0,isObject:!0,definiteNoMatch:!1});for(const e of n.details.mro){if(!(0,y.isInstantiableClass)(e))break;if(y.ClassType.isBuiltIn(e,"str")||y.ClassType.isBuiltIn(e,"bytes")||y.ClassType.isBuiltIn(e,"bytearray"))break;if(y.ClassType.isBuiltIn(e,"Sequence")){a=e;break}if((0,m.isTupleClass)(e)){a=e;break}}if(a){const e=(0,m.partiallySpecializeType)(a,n);(0,m.isTupleClass)(e)?e.tupleTypeArguments&&((0,m.isUnboundedTupleClass)(e)?(s.push({subtype:t,entryTypes:[(0,y.combineTypes)(e.tupleTypeArguments.map((e=>e.type)))],isIndeterminateLength:!0,isTuple:!0,definiteNoMatch:!1}),o=!0):e.tupleTypeArguments.length>=r&&(void 0!==i||e.tupleTypeArguments.length===r)&&(s.push({subtype:t,entryTypes:e.tupleTypeArguments.map((e=>e.type)),isIndeterminateLength:!1,isTuple:!0,definiteNoMatch:!1}),o=!0)):(s.push({subtype:t,entryTypes:[e.typeArguments&&e.typeArguments.length>0?e.typeArguments[0]:y.UnknownType.create()],isIndeterminateLength:!0,definiteNoMatch:!1}),o=!0)}}o||s.push({subtype:t,entryTypes:[],isIndeterminateLength:!0,definiteNoMatch:!0})}})),s}function C(e,t,n,i,r,a,o,l){if(n.isIndeterminateLength){let s=n.entryTypes[0];if(l){const n=e.getBuiltInObject(t,"object");n&&(0,y.isClassInstance)(n)&&(s=n)}return o||i!==a||(0,y.isNever)(s)||(s=S(e,t,s)),s}if(void 0===a||i<a)return n.entryTypes[i];if(i===a){const i=n.entryTypes.slice(a,a+n.entryTypes.length-r+1).map((t=>e.stripLiteralValue(t)));let s=(0,y.combineTypes)(i);return o||(s=S(e,t,s)),s}const c=n.entryTypes.length-(r-i);return(0,s.assert)(c>=0&&c<n.entryTypes.length),n.entryTypes[c]}function S(e,t,n){if((0,y.isNever)(n))return n;const i=(0,m.convertToInstance)(e.getBuiltInObject(t,"list"));return i&&(0,y.isClassInstance)(i)?y.ClassType.cloneForSpecialization(i,[n],!0):y.UnknownType.create()}function x(e,t,n){e.addDiagnostic((0,l.getFileInfo)(t).diagnosticRuleSet.reportUnnecessaryComparison,a.DiagnosticRule.reportUnnecessaryComparison,o.Localizer.Diagnostic.patternNeverMatches().format({type:e.printType(n)}),t)}t.narrowTypeBasedOnPattern=f,t.checkForUnusedPattern=function(e,t,n){if((0,y.isNever)(n))x(e,t,n);else if(66===t.nodeType&&t.orPatterns.length>1)t.orPatterns.forEach((t=>{const i=f(e,n,t,!0);(0,y.isNever)(i)&&x(e,t,n),n=f(e,n,t,!1)}));else{const i=f(e,n,t,!0);(0,y.isNever)(i)&&x(e,t,n)}},t.assignTypeToPatternTargets=function e(t,n,i,s,c){switch(n=f(t,n,c,!0),c.nodeType){case 65:{const r=I(t,n,c.entries.length,c.starEntryIndex).filter((e=>!e.definiteNoMatch));c.entries.forEach(((n,a)=>{const o=(0,y.combineTypes)(r.map((e=>C(t,c,e,a,c.entries.length,c.starEntryIndex,!1,s))));e(t,o,i,!1,n)}));break}case 66:c.target&&t.assignTypeToExpression(c.target,n,i,c.target),c.orPatterns.forEach((r=>{e(t,n,i,s,r),n=f(t,n,r,!1)}));break;case 69:if(c.isWildcard){if(!i){const e=(0,l.getFileInfo)(c);if((0,y.isUnknown)(n))t.addDiagnostic(e.diagnosticRuleSet.reportUnknownVariableType,a.DiagnosticRule.reportUnknownVariableType,o.Localizer.Diagnostic.wildcardPatternTypeUnknown(),c.target);else if((0,m.isPartlyUnknown)(n)){const i=new r.DiagnosticAddendum;i.addMessage(o.Localizer.DiagnosticAddendum.typeOfSymbol().format({name:"_",type:t.printType(n,{expandTypeAlias:!0})})),t.addDiagnostic(e.diagnosticRuleSet.reportUnknownVariableType,a.DiagnosticRule.reportUnknownVariableType,o.Localizer.Diagnostic.wildcardPatternTypePartiallyUnknown()+i.getString(),c.target)}}}else t.assignTypeToExpression(c.target,n,i,c.target);break;case 70:{const s=b(t,n);c.entries.forEach((n=>{const r=[],a=[];s.forEach((e=>{if(e.typedDict)if(71===n.nodeType){const i=f(t,t.getBuiltInObject(c,"str"),n.keyPattern,!0);r.push(i),(0,m.doForEachSubtype)(i,(n=>{if((0,y.isClassInstance)(n)&&y.ClassType.isBuiltIn(n,"str")&&(0,m.isLiteralType)(n)){const i=(0,d.getTypedDictMembersForClass)(t,e.typedDict).get(n.literalValue);a.push(i?i.valueType:y.UnknownType.create())}else a.push(y.UnknownType.create())}))}else 72===n.nodeType&&(r.push(t.getBuiltInObject(c,"str")),a.push(y.UnknownType.create()));else if(e.dictTypeArgs)if(71===n.nodeType){const i=f(t,e.dictTypeArgs.key,n.keyPattern,!0);r.push(i),a.push(f(t,e.dictTypeArgs.value,n.valuePattern,!0))}else 72===n.nodeType&&(r.push(e.dictTypeArgs.key),a.push(e.dictTypeArgs.value))}));const o=(0,y.combineTypes)(r),l=(0,y.combineTypes)(a);if(71===n.nodeType)e(t,o,i,!1,n.keyPattern),e(t,l,i,!1,n.valuePattern);else if(72===n.nodeType){const e=t.getBuiltInType(c,"dict"),s=t.getBuiltInObject(c,"str"),r=e&&(0,y.isInstantiableClass)(e)&&(0,y.isClassInstance)(s)?y.ClassType.cloneAsInstance(y.ClassType.cloneForSpecialization(e,[o,l],!0)):y.UnknownType.create();t.assignTypeToExpression(n.target,r,i,n.target)}}));break}case 68:{const s=c.arguments.map((e=>[]));t.mapSubtypesExpandTypeVars(n,void 0,(e=>{(0,y.isClassInstance)(e)?(0,m.doForEachSubtype)(n,(n=>{const i=t.makeTopLevelTypeVarsConcrete(n);if((0,y.isAnyOrUnknown)(i))c.arguments.forEach(((e,t)=>{s[t].push(i)}));else if((0,y.isClassInstance)(i)){let n=[];c.arguments.some((e=>!e.name))&&(n=T(t,y.ClassType.cloneAsInstantiable(e))),c.arguments.forEach(((i,r)=>{const a=_(t,i,r,n,y.ClassType.cloneAsInstantiable(e),!0);s[r].push(a)}))}})):c.arguments.forEach(((e,t)=>{s[t].push(y.UnknownType.create())}))})),c.arguments.forEach(((n,r)=>{e(t,(0,y.combineTypes)(s[r]),i,!1,n.pattern)}));break}}},t.validateClassPattern=function(e,t){const n=e.getTypeOfExpression(t.className,2).type;if(!(0,y.isAnyOrUnknown)(n))if(n.typeAliasInfo&&(0,y.isInstantiableClass)(n)&&n.typeArguments&&n.isTypeArgumentExplicit)e.addDiagnostic((0,l.getFileInfo)(t).diagnosticRuleSet.reportGeneralTypeIssues,a.DiagnosticRule.reportGeneralTypeIssues,o.Localizer.Diagnostic.classPatternTypeAlias().format({type:e.printType(n)}),t.className);else if((0,y.isInstantiableClass)(n)){g.some((e=>n.details.fullName===e))&&(t.arguments.length>1?e.addDiagnostic((0,l.getFileInfo)(t).diagnosticRuleSet.reportGeneralTypeIssues,a.DiagnosticRule.reportGeneralTypeIssues,o.Localizer.Diagnostic.classPatternBuiltInArgCount(),t.arguments[1]):1===t.arguments.length&&t.arguments[0].name&&e.addDiagnostic((0,l.getFileInfo)(t).diagnosticRuleSet.reportGeneralTypeIssues,a.DiagnosticRule.reportGeneralTypeIssues,o.Localizer.Diagnostic.classPatternBuiltInArgPositional(),t.arguments[0].name))}else(0,y.isNever)(n)||e.addDiagnostic((0,l.getFileInfo)(t).diagnosticRuleSet.reportGeneralTypeIssues,a.DiagnosticRule.reportGeneralTypeIssues,o.Localizer.DiagnosticAddendum.typeNotClass().format({type:e.printType(n)}),t.className)},t.getPatternSubtypeNarrowingCallback=function(e,t,n){if(24===n.nodeType&&1===n.items.length&&!n.trailingComma&&0===n.items[0].argumentCategory&&(0,p.isMatchingExpression)(t,n.baseExpression)){const t=e.getTypeOfExpression(n.items[0].valueExpression),i=t.type;if((0,y.isClassInstance)(i)&&(0,m.isLiteralType)(i)&&y.ClassType.isBuiltIn(i,["int","str"])){const s=e.getTypeOfExpression(n.baseExpression,2),r=s.type;return n=>{let a;if((0,y.isNever)(n)?a=y.NeverType.createNever():(0,y.isClassInstance)(n)&&void 0!==n.literalValue&&(a=y.ClassType.isBuiltIn(i,"str")?(0,u.narrowTypeForDiscriminatedDictEntryComparison)(e,r,i,n,!0):(0,u.narrowTypeForDiscriminatedTupleComparison)(e,r,i,n,!0)),a)return{type:a,isIncomplete:t.isIncomplete||s.isIncomplete}}}}if(52===n.nodeType){const i=n.expressions.findIndex((e=>(0,p.isMatchingExpression)(t,e)));if(i>=0){const t=e.getTypeOfExpression(n.expressions[i]);return e=>{let n=!0;const s=[];return(0,m.doForEachSubtype)(e,(e=>{(0,y.isClassInstance)(e)&&y.ClassType.isBuiltIn(e,"tuple")&&e.tupleTypeArguments&&i<e.tupleTypeArguments.length&&e.tupleTypeArguments.every((e=>!e.isUnbounded))?s.push(e.tupleTypeArguments[i].type):n=!1})),n?{type:(0,y.combineTypes)(s),isIncomplete:t.isIncomplete}:void 0}}}}},12394:function(e,t,n){var i=this&&this.__createBinding||(Object.create?function(e,t,n,i){void 0===i&&(i=n),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,i){void 0===i&&(i=n),e[i]=t[n]}),s=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&i(t,e,n);return s(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.Program=t.MaxWorkspaceIndexFileCount=void 0;const a=n(29335),o=n(80327),l=n(88711),c=n(59750),p=n(1395),d=r(n(30795)),u=n(30795),y=n(13490),m=n(41209),h=n(81844),g=n(96541),f=n(6698),T=n(59273),v=r(n(21)),_=n(5084),b=n(33866),I=n(66455),C=n(17741),S=n(37648),x=n(9584),F=n(51021),D=n(43271),P=n(10823);t.MaxWorkspaceIndexFileCount=2e3;class E{constructor(e,t,n,i,s,r){this._disableChecker=s,this._sourceFileList=[],this._sourceFileMap=new Map,this._parsedFileCount=0,this._isEditMode=!1,this._lookUpImport=(e,t)=>{var n;let i;if("string"==typeof e)i=this.getSourceFileInfo(e);else{const t=this._importResolver.resolveImport(e.importingFilePath,this._configOptions.findExecEnvironment(e.importingFilePath),{leadingDots:0,nameParts:e.nameParts,importedSymbols:void 0});if(t.isImportFound&&!t.isNativeLib&&t.resolvedPaths.length>0){let e=t.resolvedPaths[t.resolvedPaths.length-1];e&&(i=this.getSourceFileInfo(e),i||(e=(0,h.normalizePathCase)(this.fileSystem,e),this.addTrackedFile(e),i=this.getSourceFileInfo(e)))}}if(!i)return;i.sourceFile.isBindingRequired()&&T.timingStats.typeCheckerTime.subtractFromTime((()=>{this._bindFile(i,void 0,null==t?void 0:t.skipFileNeededCheck)}));const s=i.sourceFile.getModuleSymbolTable();if(!s)return;const r=i.sourceFile.getParseResults(),a=r.parseTree,o=v.getFileInfo(a),l=v.getDunderAllInfo(r.parseTree);return{symbolTable:s,dunderAllNames:null==l?void 0:l.names,usesUnsupportedDunderAllForm:null!==(n=null==l?void 0:l.usesUnsupportedDunderAllForm)&&void 0!==n&&n,get docString(){return(0,I.getDocString)(a.statements)},isInPyTypedPackage:o.isInPyTypedPackage}},this._console=n||new p.StandardConsole,this._logTracker=null!=i?i:new m.LogTracker(n,"FG"),this._importResolver=e,this._configOptions=t,this._cacheManager=null!=r?r:new _.CacheManager,this._cacheManager.registerCacheOwner(this),this._createNewEvaluator(),this._id=E._nextId,E._nextId+=1}get id(){return this._id}get console(){return this._console}get rootPath(){return this._configOptions.projectRoot}get evaluator(){return this._evaluator}get configOptions(){return this._configOptions}get importResolver(){return this._importResolver}get fileSystem(){return this._importResolver.fileSystem}dispose(){this._cacheManager.unregisterCacheOwner(this)}enterEditMode(){this._isEditMode=!0,this._sourceFileList.forEach((e=>{e.sourceFile.enterEditMode()}))}exitEditMode(){const e=[];return this._sourceFileList.forEach((t=>{const n=t.sourceFile.exitEditMode();if(n){this._updateSourceFileImports(t,this.configOptions);const i=o.TextDocument.create(t.sourceFile.getFilePath(),"python",1,t.sourceFile.getFileContent()||"");e.push({filePath:t.sourceFile.getFilePath(),range:{start:{line:0,character:0},end:{line:i.lineCount,character:0}},replacementText:n})}})),this._isEditMode=!1,e}setConfigOptions(e){this._configOptions=e,this._importResolver.setConfigOptions(e),this._createNewEvaluator()}setImportResolver(e){this._importResolver=e,this._createNewEvaluator()}setTrackedFiles(e){if(this._sourceFileList.length>0){const t=new Map;e.forEach((e=>{t.set((0,h.normalizePathCase)(this.fileSystem,e),e)})),this._sourceFileList.forEach((e=>{const n=(0,h.normalizePathCase)(this.fileSystem,e.sourceFile.getFilePath());t.has(n)||(e.isTracked=!1)}))}return this.addTrackedFiles(e),this._removeUnneededFiles()}setPreCheckCallback(e){this._preCheckCallback=e}setAllowedThirdPartyImports(e){this._allowedThirdPartyImports=e}addTrackedFiles(e,t=!1,n=!1){e.forEach((e=>{this.addTrackedFile(e,t,n)}))}addInterimFile(e){let t=this.getSourceFileInfo(e);return t||(t=this._createInterimFileInfo(e),this._addToSourceFileListAndMap(t)),t}addTrackedFile(e,t=!1,n=!1){let i=this.getSourceFileInfo(e);const s=this._getImportNameForFile(e);if(i)return i.sourceFile.setModuleName(s),i.isTracked=!0,i.sourceFile;const r=new C.SourceFile(this.fileSystem,e,s,t,n,this._isEditMode,this._console,this._logTracker);return i={sourceFile:r,isTracked:!0,isOpenByClient:!1,isTypeshedFile:!1,isThirdPartyImport:t,isThirdPartyPyTypedPresent:n,diagnosticsVersion:void 0,imports:[],importedBy:[],shadows:[],shadowedBy:[]},this._addToSourceFileListAndMap(i),r}setFileOpened(e,t,n,i){var s,r;let a=this.getSourceFileInfo(e);if(a)a.isOpenByClient=!0,a.diagnosticsVersion=0;else{const t=this._getImportNameForFile(e),n=new C.SourceFile(this.fileSystem,e,t,!1,!1,this._isEditMode,this._console,this._logTracker,null==i?void 0:i.realFilePath,null!==(s=null==i?void 0:i.ipythonMode)&&void 0!==s?s:C.IPythonMode.None),o=null==i?void 0:i.chainedFilePath;a={sourceFile:n,isTracked:null!==(r=null==i?void 0:i.isTracked)&&void 0!==r&&r,chainedSourceFile:o?this.getSourceFileInfo(o):void 0,isOpenByClient:!0,isTypeshedFile:!1,isThirdPartyImport:!1,isThirdPartyPyTypedPresent:!1,diagnosticsVersion:void 0,imports:[],importedBy:[],shadows:[],shadowedBy:[]},this._addToSourceFileListAndMap(a)}a.sourceFile.setClientVersion(t,n)}getChainedFilePath(e){var t;const n=this.getSourceFileInfo(e);return null===(t=null==n?void 0:n.chainedSourceFile)||void 0===t?void 0:t.sourceFile.getFilePath()}updateChainedFilePath(e,t){const n=this.getSourceFileInfo(e);n&&(n.chainedSourceFile=t?this.getSourceFileInfo(t):void 0,n.sourceFile.markDirty(),this._markFileDirtyRecursive(n,new Set))}setFileClosed(e,t){const n=this.getSourceFileInfo(e);return n&&(n.isOpenByClient=!1,n.isTracked=null!=t?t:n.isTracked,n.sourceFile.setClientVersion(null,""),n.sourceFile.didContentsChangeOnDisk()&&(n.sourceFile.markDirty(),this._markFileDirtyRecursive(n,new Set))),this._removeUnneededFiles()}markAllFilesDirty(e,t=!0){const n=new Set;this._sourceFileList.forEach((i=>{e?i.sourceFile.markDirty(t):i.sourceFile.didContentsChangeOnDisk()&&(i.sourceFile.markDirty(t),this._markFileDirtyRecursive(i,n))})),n.size>0&&this._createNewEvaluator()}markFilesDirty(e,t,n=!0){const i=new Set;e.forEach((e=>{const s=this.getSourceFileInfo(e);if(s){const r=(0,h.getFileName)(e);if("builtins.pyi"===r||"__builtins__.pyi"===r)return void this.markAllFilesDirty(t,n);(t||!s.isOpenByClient&&s.sourceFile.didContentsChangeOnDisk())&&(s.sourceFile.markDirty(n),this._markFileDirtyRecursive(s,i))}})),i.size>0&&this._createNewEvaluator()}getFileCount(e=!0){return e?this._sourceFileList.filter((e=>(0,S.isUserCode)(e))).length:this._sourceFileList.length}getUserFileCount(){return this._sourceFileList.filter((e=>(0,S.isUserCode)(e))).length}getUserFiles(){return this._sourceFileList.filter((e=>(0,S.isUserCode)(e)))}getOpened(){return this._sourceFileList.filter((e=>e.isOpenByClient))}getFilesToAnalyzeCount(){let e=0;return this._disableChecker||this._sourceFileList.forEach((t=>{t.sourceFile.isCheckingRequired()&&this._shouldCheckFile(t)&&e++})),e}isCheckingOnlyOpenFiles(){return this._configOptions.checkOnlyOpenFiles||!1}functionSignatureDisplay(){return this._configOptions.functionSignatureDisplay}containsSourceFileIn(e){const t=(0,h.normalizePathCase)(this.fileSystem,e);return this._sourceFileList.some((e=>e.sourceFile.getFilePath().startsWith(t)))}owns(e){const t=this.getSourceFileInfo(e);return t?t.isTracked:(0,c.matchFileSpecs)(this._configOptions,e)}getSourceFile(e){const t=this.getSourceFileInfo(e);if(t)return t.sourceFile}getBoundSourceFile(e){var t;return null===(t=this.getBoundSourceFileInfo(e))||void 0===t?void 0:t.sourceFile}getSourceFileInfoList(){return this._sourceFileList}getSourceFileInfo(e){return this._sourceFileMap.get((0,h.normalizePathCase)(this.fileSystem,e))}getBoundSourceFileInfo(e,t,n){const i=this.getSourceFileInfo(e);if(i)return this._bindFile(i,t,n),i}analyze(e,t=a.CancellationToken.None){return this._runEvaluatorWithCancellationToken(t,(()=>{const n=new T.Duration,i=this._sourceFileList.filter((e=>e.isOpenByClient&&e.sourceFile.isCheckingRequired()));if(i.length>0){const s=e?e.openFilesTimeInMs:Number.MAX_VALUE;for(const e of i)if(this._checkTypes(e,t)&&n.getDurationInMilliseconds()>s)return!0;if(void 0!==e)return!0}if(!this._configOptions.checkOnlyOpenFiles){const i=e?e.noOpenFilesTimeInMs:Number.MAX_VALUE;for(const e of this._sourceFileList)if((0,S.isUserCode)(e)&&this._checkTypes(e,t)&&n.getDurationInMilliseconds()>i)return!0}return!1}))}analyzeFile(e,t=a.CancellationToken.None){return this._runEvaluatorWithCancellationToken(t,(()=>{const n=this.getSourceFileInfo(e);return!(!n||!this._checkTypes(n,t))}))}run(e,t){var n;return(null!==(n=this._evaluator)&&void 0!==n?n:this._createNewEvaluator()).runWithCancellationToken(t,(()=>e(this)))}runWithMutation(e,t){var n;if(this._isEditMode){const i={addInterimFile:e=>this.addInterimFile(e),setFileOpened:(e,t,n,i,s,r)=>{this.setFileOpened(e,t,n,{isTracked:this.owns(e),ipythonMode:i,chainedFilePath:s,realFilePath:r})},updateOpenFileContents:(e,t,n,i,s)=>{this.setFileOpened(e,t,n,{isTracked:this.owns(e),ipythonMode:i,chainedFilePath:void 0,realFilePath:s})}};(null!==(n=this._evaluator)&&void 0!==n?n:this._createNewEvaluator()).runWithCancellationToken(t,(()=>e(this,i)))}}getSourceMapper(e,t,n,i){const s=this.getSourceFileInfo(e),r=this._configOptions.findExecEnvironment(e);return this._createSourceMapper(r,t,s,n,i)}getParseResults(e){var t;return null===(t=this.getBoundSourceFile(e))||void 0===t?void 0:t.getParseResults()}handleMemoryHighUsage(){this._handleMemoryHighUsage()}printDetailedAnalysisTimes(){const e=this._sourceFileList.filter((e=>void 0!==e.sourceFile.getCheckTime())).sort(((e,t)=>t.sourceFile.getCheckTime()-e.sourceFile.getCheckTime()));this._console.info(""),this._console.info("Analysis time by file"),e.forEach((e=>{const t=e.sourceFile.getCheckTime();this._console.info(`${t}ms: ${e.sourceFile.getFilePath()}`)}))}printDependencies(e,t){const n=this._importResolver.fileSystem,i=this._sourceFileList.filter((e=>!e.isTypeshedFile)).sort(((e,t)=>n.getOriginalFilePath(e.sourceFile.getFilePath())<n.getOriginalFilePath(t.sourceFile.getFilePath())?1:-1)),s=[];i.forEach((i=>{this._console.info("");let r=n.getOriginalFilePath(i.sourceFile.getFilePath());const a=(0,h.getRelativePath)(r,e);a&&(r=a),this._console.info(`${r}`),this._console.info(` Imports     ${i.imports.length} file`+(1===i.imports.length?"":"s")),t&&i.imports.forEach((e=>{this._console.info(`    ${n.getOriginalFilePath(e.sourceFile.getFilePath())}`)})),this._console.info(` Imported by ${i.importedBy.length} file`+(1===i.importedBy.length?"":"s")),t&&i.importedBy.forEach((e=>{this._console.info(`    ${n.getOriginalFilePath(e.sourceFile.getFilePath())}`)})),0===i.importedBy.length&&s.push(i.sourceFile)})),s.length>0&&(this._console.info(""),this._console.info(`${s.length} file${1===s.length?"":"s"} not explicitly imported`),s.forEach((e=>{this._console.info(`    ${n.getOriginalFilePath(e.getFilePath())}`)})))}writeTypeStub(e,t,n,i){for(const s of this._sourceFileList){(0,l.throwIfCancellationRequested)(i);const r=s.sourceFile.getFilePath(),a=(0,h.getRelativePath)(r,e);if(void 0!==a){let e=(0,h.normalizePath)((0,h.combinePaths)(n,a));e=t?(0,h.combinePaths)((0,h.getDirectoryPath)(e),"__init__.pyi"):(0,h.stripFileExtension)(e)+".pyi";const r=(0,h.getDirectoryPath)(e);try{(0,h.makeDirectories)(this.fileSystem,r,n)}catch(e){throw new Error(`Could not create directory for '${r}'`)}this._bindFile(s),this._runEvaluatorWithCancellationToken(i,(()=>{new P.TypeStubWriter(e,s.sourceFile,this._evaluator).write()})),this._handleMemoryHighUsage()}}}getTypeOfSymbol(e){this._handleMemoryHighUsage();return(this._evaluator||this._createNewEvaluator()).getEffectiveTypeOfSymbol(e)}printType(e,t){this._handleMemoryHighUsage();return(this._evaluator||this._createNewEvaluator()).printType(e,t)}getTextOnRange(e,t,n){const i=this.getSourceFileInfo(e);if(!i)return;const s=i.sourceFile,r=s.getOpenFileContents();return void 0!==r?this._runEvaluatorWithCancellationToken(n,(()=>{this._parseFile(i);const e=s.getParseResults(),n=(0,g.convertRangeToTextRange)(t,e.tokenizerOutput.lines);if(n)return r.substr(n.start,n.length)})):void 0}getDiagnostics(e){const t=this._removeUnneededFiles();return this._sourceFileList.forEach((n=>{if(this._shouldCheckFile(n)){const i=n.sourceFile.getDiagnostics(e,n.diagnosticsVersion);void 0!==i&&(t.push({filePath:n.sourceFile.getFilePath(),version:n.sourceFile.getClientVersion(),diagnostics:i}),n.diagnosticsVersion=n.sourceFile.getDiagnosticVersion())}else!n.isOpenByClient&&e.checkOnlyOpenFiles&&void 0!==n.diagnosticsVersion&&(t.push({filePath:n.sourceFile.getFilePath(),version:n.sourceFile.getClientVersion(),diagnostics:[]}),n.diagnosticsVersion=void 0)})),t}getDiagnosticsForRange(e,t){const n=this.getSourceFile(e);if(!n)return[];const i=n.getDiagnostics(this._configOptions);return i?i.filter((e=>(0,f.doRangesIntersect)(e.range,t))):[]}clone(){var e,t;const n=new E(this._importResolver,this._configOptions,this._console,new m.LogTracker(this._console,"Cloned")),i=this.getUserFiles();n.setTrackedFiles(i.map((e=>e.sourceFile.getFilePath()))),n.markAllFilesDirty(!0);for(const i of this.getOpened()){const s=i.sourceFile.getClientVersion();void 0!==s&&n.setFileOpened(i.sourceFile.getFilePath(),s,null!==(e=i.sourceFile.getOpenFileContents())&&void 0!==e?e:"",{chainedFilePath:null===(t=i.chainedSourceFile)||void 0===t?void 0:t.sourceFile.getFilePath(),ipythonMode:i.sourceFile.getIPythonMode(),isTracked:i.isTracked,realFilePath:i.sourceFile.getRealFilePath()})}return n}getCacheUsage(){const e=this._evaluator.getTypeCacheEntryCount()/75e4,t=this._parsedFileCount/1e3;return Math.max(e,t)}emptyCache(){this._createNewEvaluator(),this._discardCachedParseResults(),this._parsedFileCount=0,y.Extensions.getProgramExtensions(this.rootPath).forEach((e=>e.clearCache?e.clearCache():null))}_handleMemoryHighUsage(){if(this._cacheManager.getCacheUsage()>.75){const e=this._cacheManager.getUsedHeapRatio(this._configOptions.verboseOutput?this._console:void 0),t=15099494.4;(this._evaluator.getTypeCacheEntryCount()>t||e>.9)&&this._cacheManager.emptyCache(this._console)}}_discardCachedParseResults(){for(const e of this._sourceFileList)e.sourceFile.dropParseAndBindInfo()}_runEvaluatorWithCancellationToken(e,t){try{return e?this._evaluator.runWithCancellationToken(e,t):t()}catch(e){throw l.OperationCanceledException.is(e)||this._createNewEvaluator(),e}}_removeUnneededFiles(){const e=[];for(let t=0;t<this._sourceFileList.length;){const n=this._sourceFileList[t];this._isFileNeeded(n)?(this._shouldCheckFile(n)||void 0===n.diagnosticsVersion||(e.push({filePath:n.sourceFile.getFilePath(),version:n.sourceFile.getClientVersion(),diagnostics:[]}),n.diagnosticsVersion=void 0),t++):(e.push({filePath:n.sourceFile.getFilePath(),version:n.sourceFile.getClientVersion(),diagnostics:[]}),n.sourceFile.prepareForClose(),this._removeSourceFileFromListAndMap(n.sourceFile.getFilePath(),t),n.imports.forEach((i=>{const s=i.importedBy.findIndex((e=>e===n));if(!(s<0||(i.importedBy.splice(s,1),this._isFileNeeded(i)))){const n=this._sourceFileList.findIndex((e=>e===i));n>=0&&n<t&&(e.push({filePath:i.sourceFile.getFilePath(),version:i.sourceFile.getClientVersion(),diagnostics:[]}),i.sourceFile.prepareForClose(),this._removeSourceFileFromListAndMap(i.sourceFile.getFilePath(),n),t--)}})),n.shadowedBy.forEach((e=>{e.shadows=e.shadows.filter((e=>e!==n))})),n.shadowedBy=[])}return e}_isFileNeeded(e,t){return!e.sourceFile.isFileDeleted()&&(!!(t||e.isTracked||e.isOpenByClient)||(e.shadows.length>0||0!==e.importedBy.length&&this._isImportNeededRecursive(e,new Set)))}_isImportNeededRecursive(e,t){if(e.isTracked||e.isOpenByClient||e.shadows.length>0)return!0;const n=(0,h.normalizePathCase)(this.fileSystem,e.sourceFile.getFilePath());if(t.has(n))return!1;t.add(n);for(const n of e.importedBy)if(this._isImportNeededRecursive(n,t))return!0;return!1}_createSourceMapper(e,t,n,i,s){return new x.SourceMapper(this._importResolver,e,this._evaluator,((e,t)=>{let n=this.getSourceFileInfo(e);return n||(n=this.addInterimFile(e)),this._addShadowedFile(n,t),this.getBoundSourceFile(t)}),(e=>{let t=this.getBoundSourceFileInfo(e);return t||(t=this.addInterimFile(e),this._parseFile(t,void 0,!0)),t}),null!=i&&i,null!=s&&s,n,t)}_isImportAllowed(e,t,n){if(t.isNativeLib)return!1;let i=this._configOptions.useLibraryCodeForTypes||1===t.importType&&!!t.pyTypedInfo||2===t.importType&&e.isThirdPartyPyTypedPresent;return!((1===t.importType||e.isThirdPartyImport&&2===t.importType)&&(this._allowedThirdPartyImports?(t.isRelative||this._allowedThirdPartyImports.some((e=>t.importName===e||!!t.importName.startsWith(e+"."))))&&(i=!0):(e.isThirdPartyImport&&this._configOptions.useLibraryCodeForTypes||t.isNamespacePackage&&t.filteredImplicitImports.some((e=>!!e.pyTypedInfo)))&&(i=!0),!n))||i}_updateSourceFileImports(e,t){const n=[],i=e.sourceFile.getImports(),s=t=>{let n=!1,i=!1;return 1===t.importType?(n=!0,t.pyTypedInfo&&(i=!0)):e.isThirdPartyImport&&2===t.importType&&(n=!0,e.isThirdPartyPyTypedPresent&&(i=!0)),{isThirdPartyImport:n,isPyTypedPresent:i}},r=new Map;if(e.chainedSourceFile)if(e.chainedSourceFile.sourceFile.isFileDeleted())e.chainedSourceFile=void 0;else{const t=e.chainedSourceFile.sourceFile.getFilePath();r.set((0,h.normalizePathCase)(this.fileSystem,t),{path:t,isTypeshedFile:!1,isThirdPartyImport:!1,isPyTypedPresent:!1})}i.forEach((n=>{if(n.isImportFound){if(this._isImportAllowed(e,n,n.isStubFile)&&n.resolvedPaths.length>0){const e=n.resolvedPaths[n.resolvedPaths.length-1];if(e){const t=s(n);r.set((0,h.normalizePathCase)(this.fileSystem,e),{path:e,isTypeshedFile:!!n.isStdlibTypeshedFile||!!n.isThirdPartyTypeshedFile,isThirdPartyImport:t.isThirdPartyImport,isPyTypedPresent:t.isPyTypedPresent})}}n.filteredImplicitImports.forEach((t=>{if(this._isImportAllowed(e,n,t.isStubFile)&&!t.isNativeLib){const e=s(n);r.set((0,h.normalizePathCase)(this.fileSystem,t.path),{path:t.path,isTypeshedFile:!!n.isStdlibTypeshedFile||!!n.isThirdPartyTypeshedFile,isThirdPartyImport:e.isThirdPartyImport,isPyTypedPresent:e.isPyTypedPresent})}})),n.nonStubImportResult&&!n.nonStubImportResult.isImportFound&&(e.sourceFile.isStubFile()||n.isStdlibTypeshedFile||t.verboseOutput&&(this._console.info(`Could not resolve source for '${n.importName}' in file '${e.sourceFile.getFilePath()}'`),n.nonStubImportResult.importFailureInfo&&n.nonStubImportResult.importFailureInfo.forEach((e=>{this._console.info(`  ${e}`)}))))}else t.verboseOutput&&(this._console.info(`Could not import '${n.importName}' in file '${e.sourceFile.getFilePath()}'`),n.importFailureInfo&&n.importFailureInfo.forEach((e=>{this._console.info(`  ${e}`)})))}));const a=new Map;e.imports.forEach((t=>{const n=(0,h.normalizePathCase)(this.fileSystem,t.sourceFile.getFilePath());r.has(n)?a.set(n,t):t.importedBy=t.importedBy.filter((t=>(0,h.normalizePathCase)(this.fileSystem,t.sourceFile.getFilePath())!==(0,h.normalizePathCase)(this.fileSystem,e.sourceFile.getFilePath())))})),r.forEach(((t,i)=>{if(!a.has(i)){let s=this.getSourceFileInfo(t.path);if(!s){const e=this._getImportNameForFile(t.path);s={sourceFile:new C.SourceFile(this.fileSystem,t.path,e,t.isThirdPartyImport,t.isPyTypedPresent,this._isEditMode,this._console,this._logTracker),isTracked:!1,isOpenByClient:!1,isTypeshedFile:t.isTypeshedFile,isThirdPartyImport:t.isThirdPartyImport,isThirdPartyPyTypedPresent:t.isPyTypedPresent,diagnosticsVersion:void 0,imports:[],importedBy:[],shadows:[],shadowedBy:[]},this._addToSourceFileListAndMap(s),n.push(s)}s.importedBy.push(e),a.set(i,s)}})),e.imports=[],r.forEach(((t,n)=>{this.getSourceFileInfo(n)&&e.imports.push(this.getSourceFileInfo(n))})),e.builtinsImport=void 0;const o=e.sourceFile.getBuiltinsImport();if(o&&o.isImportFound){const t=o.resolvedPaths[o.resolvedPaths.length-1];e.builtinsImport=this.getSourceFileInfo(t)}e.ipythonDisplayImport=void 0;const l=e.sourceFile.getIPythonDisplayImport();if(l&&l.isImportFound){const t=l.resolvedPaths[l.resolvedPaths.length-1];e.ipythonDisplayImport=this.getSourceFileInfo(t)}return n}_removeSourceFileFromListAndMap(e,t){this._sourceFileMap.delete((0,h.normalizePathCase)(this.fileSystem,e)),this._sourceFileList.splice(t,1)}_addToSourceFileListAndMap(e){const t=(0,h.normalizePathCase)(this.fileSystem,e.sourceFile.getFilePath());(0,u.assert)(!this._sourceFileMap.has(t)),this._sourceFileList.push(e),this._sourceFileMap.set(t,e)}static _getPrintTypeFlags(e){let t=0;return e.diagnosticRuleSet.printUnknownAsAny&&(t|=1),e.diagnosticRuleSet.omitConditionalConstraint&&(t|=64),e.diagnosticRuleSet.omitTypeArgsIfUnknown&&(t|=2),e.diagnosticRuleSet.omitUnannotatedParamType&&(t|=4),e.diagnosticRuleSet.pep604Printing&&(t|=8),t}_getImportNameForFile(e){return this._importResolver.getModuleNameForImport(e,this._configOptions.getDefaultExecEnvironment(),!0).moduleName}_addShadowedFile(e,t){let n=this.getSourceFileInfo(t);return n||(n=this.addInterimFile(t)),n.shadows.includes(e)||n.shadows.push(e),e.shadowedBy.includes(n)||e.shadowedBy.push(n),n.sourceFile}_createInterimFileInfo(e){const t=this._getImportNameForFile(e);return{sourceFile:new C.SourceFile(this.fileSystem,e,t,!1,!1,this._isEditMode,this._console,this._logTracker),isTracked:!1,isOpenByClient:!1,isTypeshedFile:!1,isThirdPartyImport:!1,isThirdPartyPyTypedPresent:!1,diagnosticsVersion:void 0,imports:[],importedBy:[],shadows:[],shadowedBy:[]}}_createNewEvaluator(){return this._evaluator&&this._evaluator.disposeEvaluator(),this._evaluator=(0,D.createTypeEvaluatorWithTracker)(this._lookUpImport,{printTypeFlags:E._getPrintTypeFlags(this._configOptions),logCalls:this._configOptions.logTypeEvaluationTime,minimumLoggingThreshold:this._configOptions.typeEvaluationTimeThreshold,evaluateUnknownImportsAsAny:!!this._configOptions.evaluateUnknownImportsAsAny,verifyTypeCacheEvaluatorFlags:!!this._configOptions.internalTestMode},this._logTracker,this._configOptions.logTypeEvaluationTime?(0,F.createTracePrinter)(this._importResolver.getImportRoots(this._configOptions.findExecEnvironment(this._configOptions.projectRoot))):void 0),this._evaluator}_parseFile(e,t,n){if(this._isFileNeeded(e,n)&&e.sourceFile.isParseRequired()&&(e.sourceFile.parse(this._configOptions,this._importResolver,t)&&(this._parsedFileCount++,this._updateSourceFileImports(e,this._configOptions)),e.sourceFile.isFileDeleted())){e.isTracked=!1;const t=new Set;this._markFileDirtyRecursive(e,t),this._importResolver.invalidateCache()}}_getImplicitImports(e){var t,n;if(e.builtinsImport===e)return;const i=e=>{if(e&&!e.sourceFile.isFileDeleted())return e};return null!==(n=null!==(t=i(e.chainedSourceFile))&&void 0!==t?t:i(e.ipythonDisplayImport))&&void 0!==n?n:e.builtinsImport}_bindImplicitImports(e,t){const n=[],i=new Set;let s=this._getImplicitImports(e);for(;s;){const e=s.sourceFile.getFilePath();i.has(e)&&d.fail(`Found a cycle in implicit imports files for ${e}`),i.add(e),n.push(s),this._parseFile(s,void 0,t),s=this._getImplicitImports(s)}if(0===n.length)return;let r=n.pop();for(;r;)this._bindFile(r,void 0,t,!0),r=n.pop()}_bindFile(e,t,n,i){var s,r;if(!this._isFileNeeded(e,n)||!e.sourceFile.isBindingRequired())return;this._parseFile(e,t,n);const a=t=>{if(!t||t===e)return;if(t.sourceFile.isFileDeleted())return;const n=t.sourceFile.getParseResults();if(!n)return;return v.getScope(n.parseTree)};let o;e.builtinsImport&&e.builtinsImport!==e&&(i||this._bindImplicitImports(e),o=null!==(r=null!==(s=a(e.chainedSourceFile))&&void 0!==s?s:a(e.ipythonDisplayImport))&&void 0!==r?r:a(e.builtinsImport));let l=e.sourceFile.getParseResults().futureImports;e.chainedSourceFile&&(l=this._getEffectiveFutureImports(l,e.chainedSourceFile)),e.effectiveFutureImports=l.size>0?l:void 0,e.sourceFile.bind(this._configOptions,this._lookUpImport,o,l)}_getEffectiveFutureImports(e,t){var n;const i=new Set(e);return null===(n=t.effectiveFutureImports)||void 0===n||n.forEach((e=>{i.add(e)})),i}_shouldCheckFile(e){return!!e.isOpenByClient||!(this._configOptions.checkOnlyOpenFiles||!e.isTracked)}_checkTypes(e,t){return this._logTracker.log(`analyzing: ${e.sourceFile.getFilePath()}`,(n=>{if(!this._isFileNeeded(e))return n.suppress(),!1;if(!e.sourceFile.isCheckingRequired())return n.suppress(),!1;if(!this._shouldCheckFile(e))return n.suppress(),!1;if(this._bindFile(e),this._preCheckCallback){const t=e.sourceFile.getParseResults();t&&this._preCheckCallback(t,this._evaluator)}if(!this._disableChecker){let n;if(e.sourceFile.getIPythonMode()===C.IPythonMode.CellDocs){n=[];const i=(0,S.collectImportedByFiles)(e);for(const e of i){if(!(0,S.isUserCode)(e))continue;const i=this._cacheManager.pauseTracking();try{this._checkTypes(e,t)}finally{i.dispose()}const s=e.sourceFile.getParseResults();s&&n.push(s)}}const i=this._configOptions.findExecEnvironment(e.sourceFile.getFilePath());e.sourceFile.check(this._importResolver,this._evaluator,this._createSourceMapper(i,t,e),n)}if(this._handleMemoryHighUsage(),"none"!==this._configOptions.diagnosticRuleSet.reportImportCycles&&!this._allowedThirdPartyImports){const t=new Map;this._getImportsRecursive(e,t,0),t.forEach((e=>{T.timingStats.cycleDetectionTime.timeOperation((()=>{const t=new Map;this._detectAndReportImportCycles(e,t)||t.forEach((e=>{e.sourceFile.setNoCircularDependencyConfirmed()}))}))}))}return!0}))}_getImportsRecursive(e,t,n){const i=(0,h.normalizePathCase)(this.fileSystem,e.sourceFile.getFilePath());if(!t.has(i))if(n>256)e.sourceFile.setHitMaxImportDepth(256);else{t.set(i,e),(0,S.isUserCode)(e)&&this._parseFile(e);for(const i of e.imports)this._getImportsRecursive(i,t,n+1)}}_detectAndReportImportCycles(e,t,n=[],i=new Map){if(e.sourceFile.isStubFile()||e.isThirdPartyImport)return!1;if(e.sourceFile.isNoCircularDependencyConfirmed())return!1;const s=(0,h.normalizePathCase)(this.fileSystem,e.sourceFile.getFilePath());t.set(s,e);let r=!1;if(i.has(s))r=!0,n.length>1&&e===n[0]&&this._logImportCycle(n);else{if(i.has(s))return!1;i.set(s,!0),n.push(e);for(const s of e.imports)this._detectAndReportImportCycles(s,t,n,i)&&(r=!0);i.set(s,!1),n.pop()}return r}_logImportCycle(e){const t=new b.CircularDependency;e.forEach((e=>{t.appendPath(e.sourceFile.getFilePath())})),t.normalizeOrder();const n=t.getPaths()[0],i=this.getSourceFileInfo(n);(0,u.assert)(void 0!==i),i.sourceFile.addCircularDependency(t)}_markFileDirtyRecursive(e,t,n=!1){const i=(0,h.normalizePathCase)(this.fileSystem,e.sourceFile.getFilePath());if(t.has(i))return;e.sourceFile.markReanalysisRequired(n),t.add(i),e.importedBy.forEach((n=>{const i=n.chainedSourceFile===e;this._markFileDirtyRecursive(n,t,i)}));let s=e.chainedSourceFile;for(;s;){if(s.sourceFile.isCheckingRequired())return;s.sourceFile.markReanalysisRequired(!1),s=s.chainedSourceFile}}}t.Program=E,E._nextId=0},79282:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.assignProperty=t.clonePropertyWithDeleter=t.clonePropertyWithSetter=t.createProperty=t.validatePropertyMethod=void 0;const i=n(83501),s=n(28513),r=n(99661),a=n(21),o=n(66455),l=n(16682),c=n(51458),p=n(33029);function d(e,t,n){const i=t.details.fields,s=c.FunctionType.createSynthesizedInstance("__get__",256);c.FunctionType.addParameter(s,{category:0,name:"self",type:c.AnyType.create(),hasDeclaredType:!0}),c.FunctionType.addParameter(s,{category:0,name:"obj",type:c.NoneType.createInstance(),hasDeclaredType:!0}),c.FunctionType.addParameter(s,{category:0,name:"objtype",type:c.AnyType.create(),hasDeclaredType:!0,hasDefault:!0,defaultType:c.AnyType.create()}),s.details.declaredReturnType=c.FunctionType.isClassMethod(n)?c.FunctionType.getSpecializedReturnType(n):t,s.details.declaration=n.details.declaration,s.details.typeVarScopeId=(0,p.getTypeVarScopeId)(n);const r=c.FunctionType.createSynthesizedInstance("__get__",256);c.FunctionType.addParameter(r,{category:0,name:"self",type:c.AnyType.create(),hasDeclaredType:!0});const a=n.details.parameters.length>0?n.details.parameters[0].type:c.AnyType.create();c.FunctionType.addParameter(r,{category:0,name:"obj",type:a,hasDeclaredType:!0}),c.FunctionType.addParameter(r,{category:0,name:"objtype",type:c.AnyType.create(),hasDeclaredType:!0,hasDefault:!0,defaultType:c.AnyType.create()}),r.details.declaredReturnType=c.FunctionType.getSpecializedReturnType(n),r.details.declaration=n.details.declaration,r.details.typeVarScopeId=(0,p.getTypeVarScopeId)(n);const o=c.OverloadedFunctionType.create([r,s]),d=l.Symbol.createWithType(4,o);i.set("__get__",d)}function u(e,t,n){const i=t.details.fields,s=c.FunctionType.createSynthesizedInstance("__set__");c.FunctionType.addParameter(s,{category:0,name:"self",type:c.AnyType.create(),hasDeclaredType:!0});let r=n.details.parameters.length>0?n.details.parameters[0].type:c.AnyType.create();(0,c.isTypeVar)(r)&&r.details.isSynthesizedSelf&&(r=e.makeTopLevelTypeVarsConcrete(r)),c.FunctionType.addParameter(s,{category:0,name:"obj",type:(0,c.combineTypes)([r,c.NoneType.createInstance()]),hasDeclaredType:!0}),s.details.declaredReturnType=c.NoneType.createInstance(),s.details.typeVarScopeId=(0,p.getTypeVarScopeId)(n);let a=c.UnknownType.create();n.details.parameters.length>=2&&0===n.details.parameters[1].category&&n.details.parameters[1].name&&(a=n.details.parameters[1].type),c.FunctionType.addParameter(s,{category:0,name:"value",type:a,hasDeclaredType:!0});const o=l.Symbol.createWithType(4,s);i.set("__set__",o)}function y(e,t,n){const i=t.details.fields,s=c.FunctionType.createSynthesizedInstance("__delete__");c.FunctionType.addParameter(s,{category:0,name:"self",type:c.AnyType.create(),hasDeclaredType:!0}),s.details.typeVarScopeId=(0,p.getTypeVarScopeId)(n);let r=n.details.parameters.length>0?n.details.parameters[0].type:c.AnyType.create();(0,c.isTypeVar)(r)&&r.details.isSynthesizedSelf&&(r=e.makeTopLevelTypeVarsConcrete(r)),c.FunctionType.addParameter(s,{category:0,name:"obj",type:(0,c.combineTypes)([r,c.NoneType.createInstance()]),hasDeclaredType:!0}),s.details.declaredReturnType=c.NoneType.createInstance();const a=l.Symbol.createWithType(4,s);i.set("__delete__",a)}function m(e,t){const n=t.details.fields,i=n.get("fget"),s=null==i?void 0:i.getSynthesizedType();s&&(0,c.isFunction)(s)&&d(0,t,s);const r=n.get("fset"),a=null==r?void 0:r.getSynthesizedType();a&&(0,c.isFunction)(a)&&u(e,t,a);const o=n.get("fdel"),l=null==o?void 0:o.getSynthesizedType();l&&(0,c.isFunction)(l)&&y(e,t,l)}function h(e){const t=e.details.fields;["getter","setter","deleter"].forEach((n=>{const i=c.FunctionType.createSynthesizedInstance(n);c.FunctionType.addParameter(i,{category:0,name:"self",type:c.AnyType.create(),hasDeclaredType:!0}),c.FunctionType.addParameter(i,{category:0,name:"accessor",type:c.AnyType.create(),hasDeclaredType:!0}),i.details.declaredReturnType=e;const s=l.Symbol.createWithType(4,i);t.set(n,s)}))}t.validatePropertyMethod=function(e,t,n){c.FunctionType.isStaticMethod(t)&&e.addDiagnostic((0,a.getFileInfo)(n).diagnosticRuleSet.reportGeneralTypeIssues,s.DiagnosticRule.reportGeneralTypeIssues,r.Localizer.Diagnostic.propertyStaticMethod(),n)},t.createProperty=function(e,t,n,i){const s=(0,a.getFileInfo)(t),r=e.getBuiltInType(t,"type"),u=c.ClassType.isBuiltIn(n,"property")?(0,o.getTypeSourceId)(t):n.details.typeSourceId,y=c.ClassType.createInstantiable(n.details.name,(0,o.getClassFullName)(t,s.moduleName,`__property_${i.details.name}`),s.moduleName,s.filePath,2049,u,void 0,(0,c.isInstantiableClass)(r)?r:c.UnknownType.create());y.details.typeVarScopeId=n.details.typeVarScopeId;const g=e.getBuiltInType(t,"object");y.details.baseClasses.push((0,c.isInstantiableClass)(g)?g:c.UnknownType.create()),(0,p.computeMroLinearization)(y);const f=y.details.fields;n.details.fields.forEach(((e,t)=>{const n=["__get__","__set__","__delete__","fget","fset","fdel"];e.isIgnoredForProtocolMatch()||n.some((e=>e===t))||f.set(t,e)}));const T=c.ClassType.cloneAsInstance(y);y.isAsymmetricDescriptor=!1,m(e,T);const v=l.Symbol.createWithType(4,c.FunctionType.cloneWithNewFlags(i,4|i.details.flags));return f.set("fget",v),c.FunctionType.isClassMethod(i)&&(y.details.flags|=4194304),d(e,T,i),h(T),T},t.clonePropertyWithSetter=function(e,t,n,d){if(!(0,p.isProperty)(t))return t;const y=t,g=y.details.flags;let f=!!y.isAsymmetricDescriptor;const T=(0,a.getFileInfo)(d);if(d.parameters.length>=2){const t=(0,o.getTypeAnnotationForParameter)(d,1);if(t){const n=e.getGetterTypeFromProperty(y,!1);if(n&&!(0,c.isAnyOrUnknown)(n)){const a=e.getTypeOfAnnotation(t,{associateTypeVarsWithScope:!0});if("none"!==T.diagnosticRuleSet.reportPropertyTypeMismatch){const o=new i.DiagnosticAddendum;e.assignType(n,a,o)||e.addDiagnostic(T.diagnosticRuleSet.reportPropertyTypeMismatch,s.DiagnosticRule.reportPropertyTypeMismatch,r.Localizer.Diagnostic.setterGetterTypeMismatch()+o.getString(),t)}(0,c.isTypeSame)(n,a)||(f=!0)}}}const v=c.ClassType.createInstantiable(y.details.name,y.details.fullName,y.details.moduleName,(0,a.getFileInfo)(d).filePath,g,y.details.typeSourceId,y.details.declaredMetaclass,y.details.effectiveMetaclass);v.details.typeVarScopeId=y.details.typeVarScopeId;const _=e.getBuiltInType(d,"object");v.details.baseClasses.push((0,c.isInstantiableClass)(_)?_:c.UnknownType.create()),(0,p.computeMroLinearization)(v),v.isAsymmetricDescriptor=f;const b=c.ClassType.cloneAsInstance(v),I=v.details.fields;y.details.fields.forEach(((e,t)=>{e.isIgnoredForProtocolMatch()||I.set(t,e)})),m(e,b);const C=l.Symbol.createWithType(4,c.FunctionType.cloneWithNewFlags(n,4|n.details.flags));return I.set("fset",C),u(e,b,n),h(b),b},t.clonePropertyWithDeleter=function(e,t,n,i){var s;if(!(0,p.isProperty)(t))return t;const r=t,o=c.ClassType.createInstantiable(r.details.name,r.details.fullName,r.details.moduleName,(0,a.getFileInfo)(i).filePath,r.details.flags,r.details.typeSourceId,r.details.declaredMetaclass,r.details.effectiveMetaclass);o.details.typeVarScopeId=r.details.typeVarScopeId;const d=e.getBuiltInType(i,"object");o.details.baseClasses.push((0,c.isInstantiableClass)(d)?d:c.UnknownType.create()),(0,p.computeMroLinearization)(o);const u=c.ClassType.cloneAsInstance(o);o.isAsymmetricDescriptor=null!==(s=r.isAsymmetricDescriptor)&&void 0!==s&&s;const g=o.details.fields;r.details.fields.forEach(((e,t)=>{e.isIgnoredForProtocolMatch()||g.set(t,e)})),m(e,u);const f=l.Symbol.createWithType(4,c.FunctionType.cloneWithNewFlags(n,4|n.details.flags));return g.set("fdel",f),y(e,u,n),h(u),u},t.assignProperty=function(e,t,n,i,s,a,o,l,d=0){const u=c.ClassType.cloneAsInstance(s),y=c.ClassType.cloneAsInstance(i);let m=!0;return[{name:"fget",missingDiagMsg:r.Localizer.DiagnosticAddendum.missingGetter,incompatibleDiagMsg:r.Localizer.DiagnosticAddendum.incompatibleGetter},{name:"fset",missingDiagMsg:r.Localizer.DiagnosticAddendum.missingSetter,incompatibleDiagMsg:r.Localizer.DiagnosticAddendum.incompatibleSetter},{name:"fdel",missingDiagMsg:r.Localizer.DiagnosticAddendum.missingDeleter,incompatibleDiagMsg:r.Localizer.DiagnosticAddendum.incompatibleDeleter}].forEach((r=>{var h,g;const f=t.details.fields.get(r.name);let T=f?null===(h=e.getDeclaredTypeOfSymbol(f))||void 0===h?void 0:h.type:void 0;if(T&&(0,c.isFunction)(T)){const t=n.details.fields.get(r.name);let h=t?null===(g=e.getDeclaredTypeOfSymbol(t))||void 0===g?void 0:g.type:void 0;if(!h||!(0,c.isFunction)(h))return null==a||a.addMessage(r.missingDiagMsg()),void(m=!1);e.inferReturnTypeIfNecessary(h),h=(0,p.partiallySpecializeType)(h,s),e.inferReturnTypeIfNecessary(T),T=(0,p.partiallySpecializeType)(T,i),l&&(T=(0,p.applySolvedTypeVars)(T,l)),T=c.FunctionType.cloneWithNewFlags(T,-5&T.details.flags),h=c.FunctionType.cloneWithNewFlags(h,-5&h.details.flags);const f=e.bindFunctionToClassOrObject(y,T,void 0,void 0,d),v=e.bindFunctionToClassOrObject(u,h,void 0,void 0,d);f&&v&&e.assignType(f,v,a,o,void 0,0,d)||(m=!1)}})),m}},56370:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.assignModuleToProtocol=t.assignClassToProtocol=void 0;const i=n(99661),s=n(79282),r=n(51458),a=n(33029),o=n(43024),l=[];t.assignClassToProtocol=function(e,t,n,c,p,d,u,y,m){var h;const g=0!=(1&u);if(m>r.maxTypeRecursionCount)return!0;if(m++,l.some((e=>(0,r.isTypeSame)(e.srcType,n)&&(0,r.isTypeSame)(e.destType,t))))return!g;if(!g&&!y&&0===t.details.typeParameters.length&&0===n.details.typeParameters.length&&(null===(h=n.details.compatibleProtocols)||void 0===h?void 0:h.has(t.details.fullName)))return!0;l.push({srcType:n,destType:t});let f=!0;try{f=function(e,t,n,l,c,p,d,u,y){if(0!=(1&d))return(0,r.isTypeSame)(t,n);const m=r.ClassType.cloneForSpecialization(t,void 0,!1),h=new o.TypeVarContext((0,a.getTypeVarScopeId)(t)),g=new o.TypeVarContext((0,a.getTypeVarScopeId)(t)),f=e.stripLiteralValue(n);if((0,a.populateTypeVarContextForSelfType)(g,t,f),r.ClassType.isTypedDictClass(n)){const t=e.getTypedDictClassType();t&&(0,r.isInstantiableClass)(t)&&(n=t)}let T=!0;const v=new Set,_=(0,a.buildTypeVarContextFromSpecializedClass)(n);let b=16&d;if(b|=(0,a.containsLiteralType)(n,!0)?128:0,t.details.mro.forEach((o=>{(0,r.isInstantiableClass)(o)&&r.ClassType.isProtocolClass(o)&&(T||l)&&o.details.fields.forEach(((c,p)=>{var d;if((T||l)&&c.isClassMember()&&!c.isIgnoredForProtocolMatch()&&!v.has(p)){let m,I=!1;if(!u&&"__class_getitem__"===p)return;if("__slots__"===p)return;if(v.add(p),u&&n.details.effectiveMetaclass&&(0,r.isInstantiableClass)(n.details.effectiveMetaclass)&&(m=(0,a.lookUpClassMember)(n.details.effectiveMetaclass,p),m&&(_.addSolveForScope((0,a.getTypeVarScopeId)(n.details.effectiveMetaclass)),I=!0)),m||(m=(0,a.lookUpClassMember)(n,p)),m){let v=null===(d=e.getDeclaredTypeOfSymbol(c))||void 0===d?void 0:d.type;if(v){let d;if(r.ClassType.isSameGenericClass(o,t)||(v=(0,a.partiallySpecializeType)(v,o,t)),(0,r.isInstantiableClass)(m.classType)){const t=e.getEffectiveTypeOfSymbol(m.symbol);(0,r.isFunction)(t)&&e.inferReturnTypeIfNecessary(t),d=(0,a.partiallySpecializeType)(t,m.classType,f)}else d=r.UnknownType.create();if((0,r.isFunction)(d)||(0,r.isOverloadedFunction)(d)){if(I){const t=e.bindFunctionToClassOrObject(r.ClassType.cloneAsInstance(n),d,void 0,void 0,y,!1,n);if(t&&(d=(0,a.removeParamSpecVariadicsFromSignature)(t)),(0,r.isFunction)(v)||(0,r.isOverloadedFunction)(v)){const t=e.bindFunctionToClassOrObject(r.ClassType.cloneAsInstance(n),v,void 0,void 0,y,!1,n);t&&(v=(0,a.removeParamSpecVariadicsFromSignature)(t))}}else if((0,r.isInstantiableClass)(m.classType)){v=(0,a.applySolvedTypeVars)(v,g);const t=e.bindFunctionToClassOrObject(u?n:r.ClassType.cloneAsInstance(n),d,m.classType,void 0,y);if(t&&(d=(0,a.removeParamSpecVariadicsFromSignature)(t)),(0,r.isFunction)(v)||(0,r.isOverloadedFunction)(v)){const t=e.bindFunctionToClassOrObject(r.ClassType.cloneAsInstance(n),v,m.classType,void 0,y);t&&(v=(0,a.removeParamSpecVariadicsFromSignature)(t))}}}else v=(0,a.applySolvedTypeVars)(v,g);const _=null==l?void 0:l.createAddendum();if((0,r.isClassInstance)(v)&&r.ClassType.isPropertyClass(v))if((0,r.isClassInstance)(d)&&r.ClassType.isPropertyClass(d)&&!u)(0,s.assignProperty)(e,r.ClassType.cloneAsInstantiable(v),r.ClassType.cloneAsInstantiable(d),o,n,null==_?void 0:_.createAddendum(),h,g,y)||(_&&_.addMessage(i.Localizer.DiagnosticAddendum.memberTypeMismatch().format({name:p})),T=!1);else{const t=e.getGetterTypeFromProperty(v,!0);t&&e.assignType(t,d,null==_?void 0:_.createAddendum(),h,void 0,b,y)||(_&&_.addMessage(i.Localizer.DiagnosticAddendum.memberTypeMismatch().format({name:p})),T=!1)}else{const t=c.getDeclarations()[0],n=1===(null==t?void 0:t.type)&&!t.isFinal;e.assignType(v,d,null==_?void 0:_.createAddendum(),h,void 0,n?1|b:b,y)||(_&&(n&&_.addMessage(i.Localizer.DiagnosticAddendum.memberIsInvariant().format({name:p})),_.addMessage(i.Localizer.DiagnosticAddendum.memberTypeMismatch().format({name:p}))),T=!1)}const C=c.getTypedDeclarations().some((e=>1===e.type&&!!e.isFinal));C!==m.symbol.getTypedDeclarations().some((e=>1===e.type&&!!e.isFinal))&&(C?_&&_.addMessage(i.Localizer.DiagnosticAddendum.memberIsFinalInProtocol().format({name:p})):_&&_.addMessage(i.Localizer.DiagnosticAddendum.memberIsNotFinalInProtocol().format({name:p})),T=!1)}c.isClassVar()&&!m.symbol.isClassVar()&&(null==l||l.addMessage(i.Localizer.DiagnosticAddendum.protocolMemberClassVar().format({name:p})),T=!1)}else null==l||l.addMessage(i.Localizer.DiagnosticAddendum.protocolMemberMissing().format({name:p})),T=!1}}))})),T&&t.details.typeParameters.length>0){const n=(0,a.applySolvedTypeVars)(m,h);if(t.typeArguments)e.verifyTypeArgumentsAssignable(t,n,l,c,p,d,y)||(T=!1);else if(c&&t.details.typeParameters.length>0&&n.typeArguments&&!c.isLocked()){const e=n.typeArguments;for(let n=0;n<t.details.typeParameters.length;n++){const i=n<e.length?e[n]:r.UnknownType.create();c.setTypeVarType(t.details.typeParameters[n],void 0,void 0,i)}}}return T}(e,t,n,c,p,d,u,y,m)}catch(e){throw l.pop(),e}return l.pop(),f&&!y&&0===t.details.typeParameters.length&&0===n.details.typeParameters.length&&(n.details.compatibleProtocols||(n.details.compatibleProtocols=new Set),n.details.compatibleProtocols.add(t.details.fullName)),f},t.assignModuleToProtocol=function(e,t,n,s,l,c,p){if(p>r.maxTypeRecursionCount)return!0;p++;let d=!0;const u=new Set,y=r.ClassType.cloneForSpecialization(t,void 0,!1),m=new o.TypeVarContext((0,a.getTypeVarScopeId)(t));if(t.details.mro.forEach((o=>{(0,r.isInstantiableClass)(o)&&r.ClassType.isProtocolClass(o)&&o.details.fields.forEach(((o,l)=>{var c;if(o.isClassMember()&&!o.isIgnoredForProtocolMatch()&&!u.has(l)){u.add(l);const y=n.fields.get(l);if(y){let n=null===(c=e.getDeclaredTypeOfSymbol(o))||void 0===c?void 0:c.type;if(n){n=(0,a.partiallySpecializeType)(n,t);const o=e.getEffectiveTypeOfSymbol(y);if(((0,r.isFunction)(o)||(0,r.isOverloadedFunction)(o))&&((0,r.isFunction)(n)||(0,r.isOverloadedFunction)(n))){const i=e.bindFunctionToClassOrObject(r.ClassType.cloneAsInstance(t),n,t,void 0,p);i&&(n=i)}const c=null==s?void 0:s.createAddendum();e.assignType(n,o,null==c?void 0:c.createAddendum(),m,void 0,0,p)||(c&&c.addMessage(i.Localizer.DiagnosticAddendum.memberTypeMismatch().format({name:l})),d=!1)}}else null==s||s.addMessage(i.Localizer.DiagnosticAddendum.protocolMemberMissing().format({name:l})),d=!1}}))})),d&&t.details.typeParameters.length>0&&t.typeArguments){const n=(0,a.applySolvedTypeVars)(y,m);e.verifyTypeArgumentsAssignable(t,n,s,l,void 0,c,p)||(d=!1)}return d}},41097:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getPyTypedInfo=void 0;const i=n(81844);t.getPyTypedInfo=function(e,t){if(!e.existsSync(t)||!(0,i.isDirectory)(e,t))return;let n=!1;const s=(0,i.combinePaths)(t,"py.typed");if(!e.existsSync(t)||!(0,i.isFile)(e,s))return;const r=e.statSync(s);if(r.size>0&&r.size<65536){const t=e.readFileSync(s,"utf8");(t.match(/partial\n/)||t.match(/partial\r\n/))&&(n=!0)}return{pyTypedPath:s,isPartiallyTyped:n}}},24873:function(e,t,n){var i=this&&this.__createBinding||(Object.create?function(e,t,n,i){void 0===i&&(i=n),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,i){void 0===i&&(i=n),e[i]=t[n]}),s=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&i(t,e,n);return s(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.getPathsFromPthFiles=t.isPythonBinary=t.findPythonSearchPaths=t.getTypeshedSubdirectory=t.getTypeShedFallbackPath=t.thirdPartyFolderName=t.stdLibFolderName=void 0;const a=n(79251),o=r(n(15813)),l=n(81844),c=n(86513);function p(e,t){const n=[];return e.readdirEntriesSync(t).filter((e=>(e.isFile()||e.isSymbolicLink())&&e.name.endsWith(".pth"))).sort(((e,t)=>(0,a.compareComparableValues)(e.name,t.name))).forEach((i=>{const s=(0,l.combinePaths)(t,i.name),r=(0,l.tryStat)(e,s);if((null==r?void 0:r.isFile())&&r.size>0&&r.size<65536){e.readFileSync(s,"utf8").split(/\r?\n/).forEach((i=>{const s=i.trim();if(s.length>0&&!s.startsWith("#")&&!s.match(/^import\s/)){const i=(0,l.combinePaths)(t,s);e.existsSync(i)&&(0,l.isDirectory)(e,i)&&n.push(i)}}))}})),n}function d(e,t){return!e.some((e=>e===t))&&(e.push(t),!0)}t.stdLibFolderName="stdlib",t.thirdPartyFolderName="stubs",t.getTypeShedFallbackPath=function(e){let t=e.getModulePath();if(!t)return;t=(0,l.getDirectoryPath)((0,l.ensureTrailingDirectorySeparator)((0,l.normalizePath)(t)));const n=(0,l.combinePaths)(t,o.typeshedFallback);if(e.existsSync(n))return n;const i=(0,l.combinePaths)((0,l.getDirectoryPath)(t),o.typeshedFallback);return e.existsSync(i)?i:void 0},t.getTypeshedSubdirectory=function(e,n){return(0,l.combinePaths)(e,n?t.stdLibFolderName:t.thirdPartyFolderName)},t.findPythonSearchPaths=function(e,t,n,i,s,r){if(i.push("Finding python search paths"),void 0!==t.venvPath&&t.venv){const n=t.venv,s=(0,l.combinePaths)(t.venvPath,n),r=[],a=[];if([o.lib,o.lib64,o.libAlternate].forEach((n=>{const p=function(e,t,n,i){if(!e.existsSync(t))return void i.push(`Did not find '${t}'`);i.push(`Found path '${t}'; looking for ${o.sitePackages}`);const s=(0,l.combinePaths)(t,o.sitePackages);if(e.existsSync(s))return i.push(`Found path '${s}'`),s;i.push(`Did not find '${s}', so looking for python subdirectory`);const r=(0,l.getFileSystemEntries)(e,t),a=r.directories.filter((n=>{if(n.startsWith("python3.")){const i=(0,l.combinePaths)(t,n,o.sitePackages);return e.existsSync(i)}return!1}));if(n){const e=a.find((e=>e===`python${(0,c.versionToString)(n)}`));if(e){const n=(0,l.combinePaths)(t,e,o.sitePackages);return i.push(`Found path '${n}'`),n}}if(a.length>0){const e=(0,l.combinePaths)(t,a[0],o.sitePackages);return i.push(`Found path '${e}'`),e}return}(e,(0,l.combinePaths)(s,n),t.defaultPythonVersion,i);p&&(d(r,p),a.push(p))})),a.forEach((t=>{p(e,t).forEach((e=>{d(r,e)}))})),r.length>0)return i.push(`Found the following '${o.sitePackages}' dirs`),r.forEach((e=>{i.push(`  ${e}`)})),r;i.push(`Did not find any '${o.sitePackages}' dirs. Falling back on python interpreter.`)}const a=n.getPythonSearchPaths(t.pythonPath,i);if(s&&r){return a.paths.filter((e=>!(0,l.containsPath)(r,e,!0)||(0,l.containsPath)(a.prefix,e,!0)))}return a.paths},t.isPythonBinary=function(e){return"python"===(e=e.trim())||"python3"===e},t.getPathsFromPthFiles=p},59083:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getRegionComments=void 0;const i=n(96541);t.getRegionComments=function(e){const t=[];for(let n=0;n<e.tokenizerOutput.tokens.count;n++){const i=e.tokenizerOutput.tokens.getItemAt(n);if(i.comments)for(const n of i.comments){const i=a(n,e);void 0!==i&&t.push({type:i,comment:n})}}return t};const s=/^\s*region\b/,r=/^\s*endregion\b/;function a(e,t){const n=e.start-1,a=(0,i.convertOffsetToPosition)(n,t.tokenizerOutput.lines);if(0!==a.character){const e=n-a.character;if(t.text.slice(e,n).trimStart().length>0)return}const o=s.exec(e.value),l=r.exec(e.value);return o?0:l?1:void 0}},89126:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Scope=void 0;const i=n(30795),s=n(16682);t.Scope=class{constructor(e,t){this.symbolTable=new Map,this.notLocalBindings=new Map,this.type=e,this.parent=t}getGlobalScope(){let e=this,t=!1;for(;e;){if(3===e.type||4===e.type)return{scope:e,isBeyondExecutionScope:t};1===e.type&&(t=!0),e=e.parent}return(0,i.fail)("failed to find scope"),{scope:this,isBeyondExecutionScope:t}}isIndependentlyExecutable(){return 3===this.type||1===this.type}lookUpSymbol(e){return this.symbolTable.get(e)}lookUpSymbolRecursive(e,t=!1,n=!1){const i=this.symbolTable.get(e);if(i){if(t&&i.isExternallyHidden())return;const e=i.getDeclarations();if(0===e.length||e.some((e=>1!==e.type||!e.isDefinedByMemberAccess)))return{symbol:i,isOutsideCallerModule:t,isBeyondExecutionScope:n,scope:this}}let s,r=n||this.isIndependentlyExecutable();if(1===this.notLocalBindings.get(e)){const e=this.getGlobalScope();e.scope!==this&&(s=e.scope,e.isBeyondExecutionScope&&(r=!0))}else s=this.parent;if(s)return s.lookUpSymbolRecursive(e,t||3===this.type,r)}addSymbol(e,t){const n=new s.Symbol(t);return this.symbolTable.set(e,n),n}getBindingType(e){return this.notLocalBindings.get(e)}setBindingType(e,t){return this.notLocalBindings.set(e,t)}setSlotsNames(e){this.slotsNames=e}getSlotsNames(){return this.slotsNames}}},60177:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.findTopNodeInScope=t.getScopeHierarchy=t.getScopeForNode=t.getBuiltInScope=void 0;const i=n(21),s=n(66455);function r(e){const t=(0,s.getEvaluationScopeNode)(e);return(0,i.getScope)(t)}t.getBuiltInScope=function(e){let t=e;for(;4!==t.type;)t=t.parent;return t},t.getScopeForNode=r,t.getScopeHierarchy=function(e,t){const n=[];let i=e;for(;i;){const e=r(i);if(!e)return;if(0!==n.length&&n[n.length-1]===e||n.push(e),e===t)return n;i=i.parent}return t?void 0:n},t.findTopNodeInScope=function(e,t){let n,s=e,r=!1;for(;s;){if((0,i.getScope)(s)===t)r=!0;else if(r)return n;n=s,s=s.parent}}},85576:function(e,t,n){var i=this&&this.__createBinding||(Object.create?function(e,t,n,i){void 0===i&&(i=n),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,i){void 0===i&&(i=n),e[i]=t[n]}),s=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&i(t,e,n);return s(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.AnalyzerService=t.getNextServiceId=t.pyprojectTomlName=t.configFileNames=void 0;const a=r(n(11128)),o=r(n(53233)),l=n(88711),c=n(59750),p=n(1395),d=n(13490),u=n(705),y=n(340),m=n(15813),h=n(81844),g=n(59273),f=n(24618),T=n(24161),v=n(24873),_=n(17741);t.configFileNames=["pyrightconfig.json"],t.pyprojectTomlName="pyproject.toml";const b=(0,h.normalizeSlashes)("/.git/");let I=1;function C(e){return`${e}_${I++}`}t.getNextServiceId=C;class S{constructor(e,t,n){var i,s,r,a,o;this._typeStubTargetIsSingleFile=!1,this._requireTrackedFileUpdate=!0,this._lastUserInteractionTime=Date.now(),this._disposed=!1,this._pendingLibraryChanges={changesOnly:!0},this._instanceName=e,this._executionRootPath="",this._options=n,this._options.serviceId=null!==(i=this._options.serviceId)&&void 0!==i?i:C(e),this._options.console=n.console||new p.StandardConsole,this._options.importResolverFactory=null!==(s=n.importResolverFactory)&&void 0!==s?s:S.createImportResolver,this._options.cancellationProvider=null!==(r=n.cancellationProvider)&&void 0!==r?r:new l.DefaultCancellationProvider,this._options.hostFactory=null!==(a=n.hostFactory)&&void 0!==a?a:()=>new y.NoAccessHost,this._options.configOptions=null!==(o=n.configOptions)&&void 0!==o?o:new c.ConfigOptions(process.cwd());const u=this._options.importResolverFactory(t,this._options.configOptions,this._options.hostFactory());this._backgroundAnalysisProgram=void 0!==this._options.backgroundAnalysisProgramFactory?this._options.backgroundAnalysisProgramFactory(this._options.serviceId,this._options.console,this._options.configOptions,u,this._options.backgroundAnalysis,this._options.maxAnalysisTime,this._options.cacheManager):new f.BackgroundAnalysisProgram(this._options.console,this._options.configOptions,u,this._options.backgroundAnalysis,this._options.maxAnalysisTime,void 0,this._options.cacheManager);const m={addInterimFile:this.addInterimFile.bind(this),updateOpenFileContents:this.updateOpenFileContents.bind(this),setFileOpened:this.setFileOpened.bind(this)};d.Extensions.createProgramExtensions(this._program,m)}get fs(){return this._backgroundAnalysisProgram.importResolver.fileSystem}get cancellationProvider(){return this._options.cancellationProvider}get librarySearchPathsToWatch(){return this._librarySearchPathsToWatch}get backgroundAnalysisProgram(){return this._backgroundAnalysisProgram}get test_program(){return this._program}clone(e,t,n,i){var s;const r=new S(e,null!=i?i:this.fs,{...this._options,serviceId:t,backgroundAnalysis:n,skipScanningUserFiles:!0}),a=this.getUserFiles();r.backgroundAnalysisProgram.setTrackedFiles(a),r.backgroundAnalysisProgram.markAllFilesDirty(!0);for(const e of this.backgroundAnalysisProgram.program.getOpened()){const t=e.sourceFile.getClientVersion();void 0!==t&&r.setFileOpened(e.sourceFile.getFilePath(),t,e.sourceFile.getOpenFileContents(),e.sourceFile.getIPythonMode(),null===(s=e.chainedSourceFile)||void 0===s?void 0:s.sourceFile.getFilePath(),e.sourceFile.getRealFilePath())}return r}runEditMode(e,t){let n=[];const i=t.onCancellationRequested((()=>{n=[],this._backgroundAnalysisProgram.exitEditMode()}));this._backgroundAnalysisProgram.enterEditMode();try{this._program.runWithMutation(e,t)}finally{i.dispose(),n=this._backgroundAnalysisProgram.exitEditMode()}return n}dispose(){this._disposed||(this._backgroundAnalysisProgram.dispose(),d.Extensions.destroyProgramExtensions(this._program.id)),this._disposed=!0,this._removeSourceFileWatchers(),this._removeConfigFileWatcher(),this._removeLibraryFileWatcher(),this._clearReloadConfigTimer(),this._clearReanalysisTimer(),this._clearLibraryReanalysisTimer()}static createImportResolver(e,t,n){return new T.ImportResolver(e,t,n)}setCompletionCallback(e){this._onCompletionCallback=e,this._backgroundAnalysisProgram.setCompletionCallback(e)}setOptions(e){this._commandLineOptions=e;const t=this._hostFactory(),n=this._getConfigOptions(t,e);n.pythonPath&&n.ensureDefaultPythonVersion(t,this._console),n.ensureDefaultPythonPlatform(t,this._console),this._backgroundAnalysisProgram.setConfigOptions(n),this._executionRootPath=(0,h.normalizePath)((0,h.combinePaths)(e.executionRoot,n.projectRoot)),this._applyConfigOptions(t)}hasSourceFile(e){return this.backgroundAnalysisProgram.hasSourceFile(e)}isTracked(e){return this._program.owns(e)}getUserFiles(){return this._program.getUserFiles().map((e=>e.sourceFile.getFilePath()))}getOpenFiles(){return this._program.getOpened().map((e=>e.sourceFile.getFilePath()))}setFileOpened(e,t,n,i=_.IPythonMode.None,s,r){this._backgroundAnalysisProgram.setFileOpened(e,t,n,{isTracked:this.isTracked(e)||i!==_.IPythonMode.None,ipythonMode:i,chainedFilePath:s,realFilePath:r}),this._scheduleReanalysis(!1)}getChainedFilePath(e){return this._backgroundAnalysisProgram.getChainedFilePath(e)}updateChainedFilePath(e,t){this._backgroundAnalysisProgram.updateChainedFilePath(e,t),this._scheduleReanalysis(!1)}updateOpenFileContents(e,t,n,i=_.IPythonMode.None,s){this._backgroundAnalysisProgram.updateOpenFileContents(e,t,n,{isTracked:this.isTracked(e),ipythonMode:i,chainedFilePath:void 0,realFilePath:s}),this._scheduleReanalysis(!1)}startIndexing(e){this._backgroundAnalysisProgram.startIndexing(e)}setFileClosed(e,t){this._backgroundAnalysisProgram.setFileClosed(e,t),this._scheduleReanalysis(!1)}addInterimFile(e){this._backgroundAnalysisProgram.addInterimFile(e)}getParseResult(e){var t;return null===(t=this._program.getBoundSourceFile(e))||void 0===t?void 0:t.getParseResults()}getSourceFile(e){return this._program.getBoundSourceFile(e)}getTextOnRange(e,t,n){return this._program.getTextOnRange(e,t,n)}getEvaluator(){return this._program.evaluator}run(e,t){return this._program.run(e,t)}printStats(){this._console.info(""),this._console.info("Analysis stats");const e=this._program.getFileCount(!1);this._console.info("Total files parsed and bound: "+e.toString());const t=this._program.getUserFileCount();this._console.info("Total files checked: "+t.toString())}printDetailedAnalysisTimes(){this._program.printDetailedAnalysisTimes()}printDependencies(e){this._program.printDependencies(this._executionRootPath,e)}getDiagnosticsForRange(e,t,n){return this._backgroundAnalysisProgram.getDiagnosticsForRange(e,t,n)}getConfigOptions(){return this._configOptions}getImportResolver(){return this._backgroundAnalysisProgram.importResolver}recordUserInteractionTime(){this._lastUserInteractionTime=Date.now(),this._analyzeTimer&&this._scheduleReanalysis(!1)}test_getConfigOptions(e){return this._getConfigOptions(this._backgroundAnalysisProgram.host,e)}test_getFileNamesFromFileSpecs(){return this._getFileNamesFromFileSpecs()}test_shouldHandleSourceFileWatchChanges(e,t){return this._shouldHandleSourceFileWatchChanges(e,t)}writeTypeStub(e){var t;const n=this._getTypeStubFolder();this._program.writeTypeStub(null!==(t=this._typeStubTargetPath)&&void 0!==t?t:"",this._typeStubTargetIsSingleFile,n,e)}writeTypeStubInBackground(e){var t;const n=this._getTypeStubFolder();return this._backgroundAnalysisProgram.writeTypeStub(null!==(t=this._typeStubTargetPath)&&void 0!==t?t:"",this._typeStubTargetIsSingleFile,n,e)}invalidateAndForceReanalysis(e=!0,t=!0,n){this._backgroundAnalysisProgram.invalidateAndForceReanalysis(e,t,n)}restart(){this._applyConfigOptions(this._hostFactory()),this._backgroundAnalysisProgram.restart()}get _console(){return this._options.console}get _hostFactory(){return this._options.hostFactory}get _importResolverFactory(){return this._options.importResolverFactory}get _program(){return this._backgroundAnalysisProgram.program}get _configOptions(){return this._backgroundAnalysisProgram.configOptions}get _watchForSourceChanges(){var e;return!!(null===(e=this._commandLineOptions)||void 0===e?void 0:e.watchForSourceChanges)}get _watchForLibraryChanges(){var e;return!!(null===(e=this._commandLineOptions)||void 0===e?void 0:e.watchForLibraryChanges)&&!!this._options.libraryReanalysisTimeProvider}get _watchForConfigChanges(){var e;return!!(null===(e=this._commandLineOptions)||void 0===e?void 0:e.watchForConfigChanges)}get _typeCheckingMode(){var e;return null===(e=this._commandLineOptions)||void 0===e?void 0:e.typeCheckingMode}get _verboseOutput(){return!!this._configOptions.verboseOutput}get _typeStubTargetImportName(){var e;return null===(e=this._commandLineOptions)||void 0===e?void 0:e.typeStubTargetImportName}_getConfigOptions(e,t){var n,i;let s,r,a=t.executionRoot;t.configFilePath?(s=(0,h.combinePaths)(t.executionRoot,(0,h.normalizePath)(t.configFilePath)),this.fs.existsSync(s)?s.toLowerCase().endsWith(".json")?a=(0,h.getDirectoryPath)(s):(a=s,s=this._findConfigFile(s),s||this._console.info(`Configuration file not found at ${a}.`)):(this._console.info(`Configuration file not found at ${s}.`),s=t.executionRoot)):a&&(s=this._findConfigFile(a),s||t.fromVsCodeExtension||(s=this._findConfigFileHereOrUp(a)),s?a=(0,h.getDirectoryPath)(s):(this._console.log("No configuration file found."),s=void 0)),s||(r=this._findPyprojectTomlFile(a),r||t.fromVsCodeExtension||(r=this._findPyprojectTomlFileHereOrUp(a)),r?(a=(0,h.getDirectoryPath)(r),this._console.log(`pyproject.toml file found at ${a}.`)):this._console.log("No pyproject.toml file found."));const o=new c.ConfigOptions(a,this._typeCheckingMode),l=["**/node_modules","**/__pycache__","**/.*"];let p;if(t.pythonPath&&(this._console.info(`Setting pythonPath for service "${this._instanceName}": "${t.pythonPath}"`),o.pythonPath=t.pythonPath),o.defaultPythonPlatform=t.pythonPlatform,o.defaultPythonVersion=t.pythonVersion,o.ensureDefaultExtraPaths(this.fs,t.autoSearchPaths||!1,t.extraPaths),t.fileSpecs.length>0&&t.fileSpecs.forEach((e=>{o.include.push((0,h.getFileSpec)(this.fs,a,e))})),t.excludeFileSpecs.length>0&&t.excludeFileSpecs.forEach((e=>{o.exclude.push((0,h.getFileSpec)(this.fs,a,e))})),t.ignoreFileSpecs.length>0&&t.ignoreFileSpecs.forEach((e=>{o.ignore.push((0,h.getFileSpec)(this.fs,a,e))})),!s&&t.executionRoot&&(0===t.fileSpecs.length&&o.include.push((0,h.getFileSpec)(this.fs,t.executionRoot,".")),0===t.excludeFileSpecs.length&&l.forEach((e=>{o.exclude.push((0,h.getFileSpec)(this.fs,t.executionRoot,e))}))),this._configFilePath=s||r,s?(this._console.info(`Loading configuration file at ${s}`),p=this._parseJsonConfigFile(s)):r&&(this._console.info(`Loading pyproject.toml file at ${r}`),p=this._parsePyprojectTomlFile(r)),p){o.initializeFromJson(p,this._typeCheckingMode,this._console,this.fs,e,t.diagnosticSeverityOverrides,t.fileSpecs.length>0);const n=(0,h.getDirectoryPath)(this._configFilePath);0===o.include.length&&(this._console.info(`No include entries specified; assuming ${n}`),o.include.push((0,h.getFileSpec)(this.fs,n,"."))),0===o.exclude.length&&(l.forEach((e=>{this._console.info(`Auto-excluding ${e}`),o.exclude.push((0,h.getFileSpec)(this.fs,n,e))})),void 0===o.autoExcludeVenv&&(o.autoExcludeVenv=!0))}else o.autoExcludeVenv=!0,o.applyDiagnosticOverrides(t.diagnosticSeverityOverrides);void 0!==t.analyzeUnannotatedFunctions&&(o.diagnosticRuleSet.analyzeUnannotatedFunctions=t.analyzeUnannotatedFunctions);const d=(e,n)=>{const i=t.fromVsCodeExtension?"the client settings":"a command-line option";this._console.warn(`The ${e} has been specified in both the config file and ${i}. The value in the config file (${n}) will take precedence`)};if(t.venvPath&&(o.venvPath?d("venvPath",o.venvPath):o.venvPath=t.venvPath),t.typeshedPath&&(o.typeshedPath?d("typeshedPath",o.typeshedPath):o.typeshedPath=t.typeshedPath),o.verboseOutput=null!==(n=t.verboseOutput)&&void 0!==n?n:o.verboseOutput,o.checkOnlyOpenFiles=!!t.checkOnlyOpenFiles,o.autoImportCompletions=!!t.autoImportCompletions,o.indexing=!!t.indexing,o.taskListTokens=t.taskListTokens,o.logTypeEvaluationTime=!!t.logTypeEvaluationTime,o.typeEvaluationTimeThreshold=t.typeEvaluationTimeThreshold,void 0===o.useLibraryCodeForTypes&&(o.useLibraryCodeForTypes=!0),t.stubPath&&(o.stubPath?d("stubPath",o.stubPath):o.stubPath=t.stubPath),o.stubPath?this.fs.existsSync(o.stubPath)&&(0,h.isDirectory)(this.fs,o.stubPath)||this._console.warn(`stubPath ${o.stubPath} is not a valid directory.`):o.stubPath=(0,h.normalizePath)((0,h.combinePaths)(o.projectRoot,m.defaultStubsDirectory)),o.venvPath&&(this.fs.existsSync(o.venvPath)&&(0,h.isDirectory)(this.fs,o.venvPath)||this._console.error(`venvPath ${o.venvPath} is not a valid directory.`),o.venv=null!==(i=o.venv)&&void 0!==i?i:this._configOptions.venv,o.venv)){const t=(0,h.combinePaths)(o.venvPath,o.venv);if(this.fs.existsSync(t)&&(0,h.isDirectory)(this.fs,t)){const t=[];void 0===(0,v.findPythonSearchPaths)(this.fs,o,e,t)&&(this._console.error(`site-packages directory cannot be located for venvPath ${o.venvPath} and venv ${o.venv}.`),o.verboseOutput&&t.forEach((e=>{this._console.error(`  ${e}`)})))}else this._console.error(`venv ${o.venv} subdirectory not found in venv path ${o.venvPath}.`)}return o.venv&&(o.venvPath||this._console.warn("venvPath not specified, so venv settings will be ignored.")),o.typeshedPath&&(this.fs.existsSync(o.typeshedPath)&&(0,h.isDirectory)(this.fs,o.typeshedPath)||this._console.error(`typeshedPath ${o.typeshedPath} is not a valid directory.`)),o}_getTypeStubFolder(){var e;const t=null!==(e=this._configOptions.stubPath)&&void 0!==e?e:(0,h.normalizePath)((0,h.combinePaths)(this._configOptions.projectRoot,m.defaultStubsDirectory));if(!this._typeStubTargetPath||!this._typeStubTargetImportName){const e=`Import '${this._typeStubTargetImportName}' could not be resolved`;throw this._console.error(e),new Error(e)}const n=this._typeStubTargetImportName.split(".");if(0===n[0].length){const e=`Import '${this._typeStubTargetImportName}' could not be resolved`;throw this._console.error(e),new Error(e)}try{this.fs.existsSync(t)||this.fs.mkdirSync(t)}catch(e){const n=`Could not create typings directory '${t}'`;throw this._console.error(n),new Error(n)}const i=(0,h.combinePaths)(t,n[0]),s=(0,h.combinePaths)(t,...n);try{this.fs.existsSync(s)||(0,h.makeDirectories)(this.fs,s,t)}catch(e){const t=`Could not create typings subdirectory '${s}'`;throw this._console.error(t),new Error(t)}return i}_findConfigFileHereOrUp(e){return(0,h.forEachAncestorDirectory)(e,(e=>this._findConfigFile(e)))}_findConfigFile(e){for(const n of t.configFileNames){const t=(0,h.combinePaths)(e,n);if(this.fs.existsSync(t))return t}}_findPyprojectTomlFileHereOrUp(e){return(0,h.forEachAncestorDirectory)(e,(e=>this._findPyprojectTomlFile(e)))}_findPyprojectTomlFile(e){const n=(0,h.combinePaths)(e,t.pyprojectTomlName);if(this.fs.existsSync(n))return n}_parseJsonConfigFile(e){return this._attemptParseFile(e,(e=>{const t=[],n=o.parse(e,t,{allowTrailingComma:!0});if(t.length>0)throw new Error("Errors parsing JSON file");return n}))}_parsePyprojectTomlFile(e){return this._attemptParseFile(e,((t,n)=>{try{const e=a.parse(t);if(e&&e.tool&&e.tool.pyright)return e.tool.pyright}catch(e){throw this._console.error(`Pyproject file parse attempt ${n} error: ${JSON.stringify(e)}`),e}this._console.info(`Pyproject file "${e}" has no "[tool.pyright]" section.`)}))}_attemptParseFile(e,t){let n="",i=0;for(;;){try{n=this.fs.readFileSync(e,"utf8")}catch{return this._console.error(`Config file "${e}" could not be read.`),void this._reportConfigParseError()}let s=!1;try{return t(n,i+1)}catch(e){s=!0}if(!s)break;if(i++>=5)return this._console.error(`Config file "${e}" could not be parsed. Verify that format is correct.`),void this._reportConfigParseError()}}_getFileNamesFromFileSpecs(){const e=new Map;return g.timingStats.findFilesTime.timeOperation((()=>{const t=this._matchFiles(this._configOptions.include,this._configOptions.exclude);for(const n of t)e.set(n,n)})),this._backgroundAnalysisProgram.program.getOpened().map((e=>e.sourceFile.getFilePath())).filter((e=>(0,c.matchFileSpecs)(this._program.configOptions,e))).forEach((t=>e.set(t,t))),[...e.values()]}_updateTrackedFileList(e){if(this._typeStubTargetImportName){const e=this._configOptions.findExecEnvironment(this._executionRootPath),t=(0,T.createImportedModuleDescriptor)(this._typeStubTargetImportName),n=this._backgroundAnalysisProgram.importResolver.resolveImport("",e,t);if(n.isImportFound){const e=[],t=n.resolvedPaths[n.resolvedPaths.length-1],i=(0,h.isFile)(this.fs,t),s=i&&"__init__"===(0,h.stripFileExtension)((0,h.getFileName)(t));let r=t;i&&(r=(0,h.getDirectoryPath)(r));for(let e=n.resolvedPaths.length-2;e>=0;e--)r=n.resolvedPaths[e]?n.resolvedPaths[e]:(0,h.getDirectoryPath)(r);(0,h.isDirectory)(this.fs,r)?this._typeStubTargetPath=r:(0,h.isFile)(this.fs,r)&&(this._typeStubTargetPath=(0,h.getDirectoryPath)(r)),t?(e.push(t),this._typeStubTargetIsSingleFile=1===n.resolvedPaths.length&&!s):this._typeStubTargetIsSingleFile=!1,n.filteredImplicitImports.forEach((t=>{const n=(0,h.getFileExtension)(t.path).toLowerCase();T.supportedSourceFileExtensions.some((e=>n===e))&&e.push(t.path)})),this._backgroundAnalysisProgram.setAllowedThirdPartyImports([this._typeStubTargetImportName]),this._backgroundAnalysisProgram.setTrackedFiles(e)}else this._console.error(`Import '${this._typeStubTargetImportName}' not found`)}else if(!this._options.skipScanningUserFiles){let t=[];this._console.log("Searching for source files"),t=this._getFileNamesFromFileSpecs(),this._backgroundAnalysisProgram.setConfigOptions(this._configOptions),this._backgroundAnalysisProgram.setTrackedFiles(t),this._backgroundAnalysisProgram.markAllFilesDirty(e),0===t.length?this._console.info("No source files found."):this._console.info(`Found ${t.length} source `+(1===t.length?"file":"files"))}this._requireTrackedFileUpdate=!1}_matchFiles(e,t){const n=[["bin","activate"],["Scripts","activate"],["pyvenv.cfg"]],i=[],s=Date.now();let r=!1;const a=(e,a,o)=>{if(!r){.001*(Date.now()-s)>=10&&(this._console.error('Enumeration of workspace source files is taking longer than 10 seconds.\nThis may be because:\n* You have opened your home directory or entire hard drive as a workspace\n* Your workspace contains a very large number of directories and files\n* Your workspace contains a symlink to a directory with many files\n* Your workspace is remote, and file enumeration is slow\nTo reduce this time, open a workspace directory with fewer files or add a pyrightconfig.json configuration file with an "exclude" section to exclude subdirectories from your workspace. For more details, refer to https://github.com/microsoft/pyright/blob/main/docs/configuration.md.'),r=!0)}if(this._configOptions.autoExcludeVenv&&n.some((t=>this.fs.existsSync((0,h.combinePaths)(e,...t)))))return h.FileSpec.isInPath(e,t)||t.push((0,h.getFileSpec)(this.fs,this._configOptions.projectRoot,`${e}/**`)),void this._console.info(`Auto-excluding ${e}`);const{files:c,directories:p}=(0,h.getFileSystemEntries)(this.fs,e);for(const n of c){const s=(0,h.combinePaths)(e,n);h.FileSpec.matchIncludeFileSpec(a,t,s)&&i.push(s)}for(const n of p){const i=(0,h.combinePaths)(e,n);(a.test(i)||o)&&(h.FileSpec.isInPath(i,t)||l(i,a,o))}},o=new Set,l=(e,t,n)=>{const i=(0,h.tryRealpath)(this.fs,e);if(i)if(o.has(i))this._console.warn(`Skipping recursive symlink "${e}" -> "${i}"`);else{o.add(i);try{a(e,t,n)}finally{o.delete(i)}}else this._console.warn(`Skipping broken link "${e}"`)};return e.forEach((e=>{if(!h.FileSpec.isInPath(e.wildcardRoot,t)){let t=!1,n=!0;const s=(0,h.tryStat)(this.fs,e.wildcardRoot);(null==s?void 0:s.isFile())?(h.FileSpec.matchesIncludeFileRegex(e.wildcardRoot)?i.push(e.wildcardRoot):n=!1,t=!0):(null==s?void 0:s.isDirectory())&&(l(e.wildcardRoot,e.regExp,e.hasDirectoryWildcard),t=!0),t?n||this._console.error(`File "${e.wildcardRoot}" is not a Python source file.`):this._console.error(`File or directory "${e.wildcardRoot}" does not exist.`)}})),i}_removeSourceFileWatchers(){this._sourceFileWatcher&&(this._sourceFileWatcher.close(),this._sourceFileWatcher=void 0)}_updateSourceFileWatchers(){if(this._removeSourceFileWatchers(),this._watchForSourceChanges&&this._configOptions.include.length>0){const e=this._configOptions.include.map((e=>(0,h.combinePaths)(this._executionRootPath,e.wildcardRoot)));try{this._verboseOutput&&this._console.info(`Adding fs watcher for directories:\n ${e.join("\n")}`);const t=(0,u.ignoredWatchEventFunction)(e);this._sourceFileWatcher=this.fs.createFileSystemWatcher(e,((e,n)=>{if(!n)return;if(this._verboseOutput&&this._console.info(`SourceFile: Received fs event '${e}' for path '${n}'`),t(n))return;if(n.endsWith(".tmp")||n.endsWith(".git")||n.includes(b))return;const i=function(e,t,n,i,s){const r=(0,h.tryStat)(e,s);if("add"===i){if(!r)return;return{event:i,isFile:r.isFile()}}if("change"===i){if(!r){const e=!!n.getSourceFile(s);if(!e&&!n.containsSourceFileIn(s))return;return{event:"unlink",isFile:e}}return{event:i,isFile:r.isFile()}}return void t.warn(`Received unknown file change event: '${i}' for '${s}'`)}(this.fs,this._console,this._program,e,n);if(i&&this._shouldHandleSourceFileWatchChanges(n,i.isFile)){if(i.isFile&&"change"===i.event)return this._backgroundAnalysisProgram.markFilesDirty([n],!1),void this._scheduleReanalysis(!1);this.invalidateAndForceReanalysis(!1,!1),this._scheduleReanalysis(!0)}}))}catch{this._console.error(`Exception caught when installing fs watcher for:\n ${e.join("\n")}`)}}}_shouldHandleSourceFileWatchChanges(e,t){if(t)return!(!(0,h.hasPythonExtension)(e)||function(e){const t=(0,h.getFileName)(e),n=t.split(".");if(4===n.length&&n[3]===n[1]&&32===n[2].length)return!0;return!1}(e))&&!(!this.isTracked(e)&&!this._program.getSourceFileInfo(e));if(!(0,c.matchFileSpecs)(this._program.configOptions,e,!1))return!1;const n=(0,h.getDirectoryPath)(e);return!!(n.startsWith(this._configOptions.projectRoot)&&(this.fs.existsSync((0,h.combinePaths)(n,"__init__.py"))||this.fs.existsSync((0,h.combinePaths)(n,"__init__.pyi")))||this._program.containsSourceFileIn(e))}_removeLibraryFileWatcher(){this._libraryFileWatcher&&(this._libraryFileWatcher.close(),this._libraryFileWatcher=void 0)}_updateLibraryFileWatcher(){if(this._removeLibraryFileWatcher(),!this._watchForLibraryChanges)return void(this._librarySearchPathsToWatch=void 0);this._librarySearchPathsToWatch=(0,v.findPythonSearchPaths)(this.fs,this._backgroundAnalysisProgram.configOptions,this._backgroundAnalysisProgram.host,[],!0,this._executionRootPath);const e=this._librarySearchPathsToWatch;if(e&&e.length>0)try{this._verboseOutput&&this._console.info(`Adding fs watcher for library directories:\n ${e.join("\n")}`);const t=(0,u.ignoredWatchEventFunction)(e);this._libraryFileWatcher=this.fs.createFileSystemWatcher(e,((e,n)=>{if(!n)return;if(this._verboseOutput&&this._console.info(`LibraryFile: Received fs event '${e}' for path '${n}'`),t(n))return;const i="change"===e&&this.fs.existsSync(n);this._scheduleLibraryAnalysis(i)}))}catch{this._console.error(`Exception caught when installing fs watcher for:\n ${e.join("\n")}`)}}_clearLibraryReanalysisTimer(){var e;this._libraryReanalysisTimer&&(clearTimeout(this._libraryReanalysisTimer),this._libraryReanalysisTimer=void 0,null===(e=this._backgroundAnalysisProgram)||void 0===e||e.cancelIndexing())}_scheduleLibraryAnalysis(e){var t,n;if(this._disposed)return;this._clearLibraryReanalysisTimer();const i=null===(n=(t=this._options).libraryReanalysisTimeProvider)||void 0===n?void 0:n.call(t);i&&(this._pendingLibraryChanges.changesOnly=this._pendingLibraryChanges.changesOnly&&e,this._libraryReanalysisTimer=setTimeout((()=>{this._clearLibraryReanalysisTimer(),this.invalidateAndForceReanalysis(!1,!0,{changesOnly:this._pendingLibraryChanges.changesOnly}),this._scheduleReanalysis(!1),this._pendingLibraryChanges.changesOnly=!0}),i))}_removeConfigFileWatcher(){this._configFileWatcher&&(this._configFileWatcher.close(),this._configFileWatcher=void 0)}_updateConfigFileWatcher(){this._removeConfigFileWatcher(),this._watchForConfigChanges&&(this._configFilePath?this._configFileWatcher=this.fs.createFileSystemWatcher([this._configFilePath],(e=>{this._verboseOutput&&this._console.info(`Received fs event '${e}' for config file`),this._scheduleReloadConfigFile()})):this._executionRootPath&&(this._configFileWatcher=this.fs.createFileSystemWatcher([this._executionRootPath],((e,n)=>{if(n&&("add"===e||"change"===e)){const i=(0,h.getFileName)(n);i&&t.configFileNames.some((e=>e===i))&&(this._verboseOutput&&this._console.info(`Received fs event '${e}' for config file`),this._commandLineOptions&&this.setOptions(this._commandLineOptions))}}))))}_clearReloadConfigTimer(){this._reloadConfigTimer&&(clearTimeout(this._reloadConfigTimer),this._reloadConfigTimer=void 0)}_scheduleReloadConfigFile(){this._clearReloadConfigTimer(),this._reloadConfigTimer=setTimeout((()=>{this._clearReloadConfigTimer(),this._reloadConfigFile()}),100)}_reloadConfigFile(){if(this._updateConfigFileWatcher(),this._configFilePath){this._console.info(`Reloading configuration file at ${this._configFilePath}`);const e=this._backgroundAnalysisProgram.host,t=this._getConfigOptions(e,this._commandLineOptions);this._backgroundAnalysisProgram.setConfigOptions(t),this._applyConfigOptions(e)}}_applyConfigOptions(e){var t;const n=this._importResolverFactory(this.fs,this._backgroundAnalysisProgram.configOptions,e);if(this._backgroundAnalysisProgram.setImportResolver(n),(null===(t=this._commandLineOptions)||void 0===t?void 0:t.fromVsCodeExtension)||this._configOptions.verboseOutput){const e=this._configOptions.verboseOutput?p.LogLevel.Info:p.LogLevel.Log;for(const t of this._configOptions.getExecutionEnvironments()){(0,p.log)(this._console,e,`Search paths for ${t.root||"<default>"}`);n.getImportRoots(t,!0).forEach((t=>{(0,p.log)(this._console,e,`  ${t}`)}))}}this._updateLibraryFileWatcher(),this._updateConfigFileWatcher(),this._updateSourceFileWatchers(),this._updateTrackedFileList(!0),this._scheduleReanalysis(!1)}_clearReanalysisTimer(){this._analyzeTimer&&(clearTimeout(this._analyzeTimer),this._analyzeTimer=void 0)}_scheduleReanalysis(e){var t,n;if(this._disposed||!(null===(t=this._commandLineOptions)||void 0===t?void 0:t.enableAmbientAnalysis))return;e&&(this._requireTrackedFileUpdate=!0),null===(n=this._backgroundAnalysisCancellationSource)||void 0===n||n.cancel(),this._clearReanalysisTimer();const i=Date.now()-this._lastUserInteractionTime,s=Math.max(250-i,20);this._analyzeTimer=setTimeout((()=>{this._analyzeTimer=void 0,this._requireTrackedFileUpdate&&this._updateTrackedFileList(!1),this._backgroundAnalysisCancellationSource=this.cancellationProvider.createCancellationTokenSource();this._backgroundAnalysisProgram.startAnalysis(this._backgroundAnalysisCancellationSource.token)&&this._scheduleReanalysis(!1)}),s)}_reportConfigParseError(){this._onCompletionCallback&&this._onCompletionCallback({diagnostics:[],filesInProgram:0,filesRequiringAnalysis:0,checkingOnlyOpenFiles:!0,fatalErrorOccurred:!1,configParseErrorOccurred:!0,elapsedTime:0})}}t.AnalyzerService=S},17741:function(e,t,n){var i=this&&this.__createBinding||(Object.create?function(e,t,n,i){void 0===i&&(i=n),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,i){void 0===i&&(i=n),e[i]=t[n]}),s=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&i(t,e,n);return s(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.parseFile=t.SourceFile=t.IPythonMode=void 0;const a=n(71267),o=n(88711),l=n(59750),c=n(1395),p=n(30795),d=n(83501),u=n(28513),y=n(58601),m=n(13490),h=n(41209),g=n(81844),f=n(96541),T=r(n(92828)),v=n(6698),_=n(10154),b=n(59273),I=n(99661),C=n(29597),S=n(92365),x=r(n(21)),F=n(43324),D=n(46892),P=r(n(67030)),E=n(7508),A=n(52007),k=52428800;var w;!function(e){e[e.None=0]="None",e[e.CellDocs=1]="CellDocs"}(w=t.IPythonMode||(t.IPythonMode={}));class N{constructor(){this.diagnosticVersion=0,this.fileContentsVersion=0,this.lastFileContentLength=void 0,this.lastFileContentHash=void 0,this.analyzedFileContentsVersion=-1,this.parseTreeNeedsCleaning=!1,this.isBindingInProgress=!1,this.parseDiagnostics=[],this.commentDiagnostics=[],this.bindDiagnostics=[],this.checkerDiagnostics=[],this.typeIgnoreLines=new Map,this.pyrightIgnoreLines=new Map,this.circularDependencies=[],this.noCircularDependencyConfirmed=!1,this.isBindingNeeded=!0,this.isCheckingNeeded=!0,this.indexingNeeded=!0,this.isFileDeleted=!1}}function R(e,t,n,i,s){var r;const a=e.findExecEnvironment(t),o=new S.ParseOptions;o.ipythonMode=i,t.endsWith("pyi")&&(o.isStubFile=!0),o.pythonVersion=a.pythonVersion,o.skipFunctionAndClassBody=null!==(r=e.indexGenerationMode)&&void 0!==r&&r;return(new S.Parser).parseSourceFile(n,o,s)}t.SourceFile=class{constructor(e,t,n,i,s,r,o,p,d,u=w.None){this._writableData=new N,this._diagnosticRuleSet=(0,l.getBasicDiagnosticRuleSet)(),this._ipythonMode=w.None,this._isEditMode=!1,this.fileSystem=e,this._console=o||new c.StandardConsole,this._isEditMode=r,this._filePath=t,this._realFilePath=null!=d?d:t,this._moduleName=n,this._isStubFile=t.endsWith(".pyi"),this._isThirdPartyImport=i,this._isThirdPartyPyTypedPresent=s;const y=(0,g.getFileName)(t);this._isTypingStubFile=this._isStubFile&&(this._filePath.endsWith((0,g.normalizeSlashes)("stdlib/typing.pyi"))||"typing_extensions.pyi"===y),this._isTypingExtensionsStubFile=this._isStubFile&&"typing_extensions.pyi"===y,this._isBuiltInStubFile=!1,this._isStubFile&&(this._filePath.endsWith((0,g.normalizeSlashes)("stdlib/collections/__init__.pyi"))||this._filePath.endsWith((0,g.normalizeSlashes)("stdlib/asyncio/futures.pyi"))||this._filePath.endsWith((0,g.normalizeSlashes)("stdlib/asyncio/tasks.pyi"))||this._filePath.endsWith((0,g.normalizeSlashes)("stdlib/builtins.pyi"))||this._filePath.endsWith((0,g.normalizeSlashes)("stdlib/_importlib_modulespec.pyi"))||this._filePath.endsWith((0,g.normalizeSlashes)("stdlib/dataclasses.pyi"))||this._filePath.endsWith((0,g.normalizeSlashes)("stdlib/abc.pyi"))||this._filePath.endsWith((0,g.normalizeSlashes)("stdlib/enum.pyi"))||this._filePath.endsWith((0,g.normalizeSlashes)("stdlib/queue.pyi"))||this._filePath.endsWith((0,g.normalizeSlashes)("stdlib/types.pyi")))&&(this._isBuiltInStubFile=!0),this._logTracker=null!=p?p:new h.LogTracker(o,a.isMainThread?"FG":"BG"),this._ipythonMode=u}getRealFilePath(){return this._realFilePath}getIPythonMode(){return this._ipythonMode}getFilePath(){return this._filePath}getModuleName(){return this._moduleName}setModuleName(e){this._moduleName=e}getDiagnosticVersion(){return this._writableData.diagnosticVersion}isStubFile(){return this._isStubFile}isThirdPartyPyTypedPresent(){return this._isThirdPartyPyTypedPresent}getDiagnostics(e,t){if(this._writableData.diagnosticVersion===t)return;let n=!0;this._isThirdPartyImport&&(n=!1);let i=[...this._writableData.parseDiagnostics,...this._writableData.commentDiagnostics,...this._writableData.bindDiagnostics,...this._writableData.checkerDiagnostics];const s=i,r=new Map(this._writableData.typeIgnoreLines),a=new Map(this._writableData.pyrightIgnoreLines);this._diagnosticRuleSet.enableTypeIgnoreComments&&this._writableData.typeIgnoreLines.size>0&&(i=i.filter((e=>{if(3!==e.category&&4!==e.category&&5!==e.category)for(let t=e.range.start.line;t<=e.range.end.line;t++)if(this._writableData.typeIgnoreLines.has(t))return r.delete(t),!1;return!0}))),this._writableData.pyrightIgnoreLines.size>0&&(i=i.filter((e=>{if(4!==e.category&&5!==e.category)for(let t=e.range.start.line;t<=e.range.end.line;t++){const n=this._writableData.pyrightIgnoreLines.get(t);if(n){if(!n.rulesList)return a.delete(t),!1;const i=e.getRule();if(!i)return!0;if(n.rulesList.find((e=>e.text===i))){const e=a.get(t);if(null==e?void 0:e.rulesList){const n=e.rulesList.filter((e=>e.text!==i));0===n.length?a.delete(t):a.set(t,{range:e.range,rulesList:n})}return!1}return!0}}return!0})));const o=[];if("none"!==this._diagnosticRuleSet.reportUnnecessaryTypeIgnoreComment){const e=(0,d.convertLevelToCategory)(this._diagnosticRuleSet.reportUnnecessaryTypeIgnoreComment),t=s.filter((e=>0===e.category||1===e.category||2===e.category)),n=e=>s.find((t=>4===t.category&&t.range.start.line<=e.start.line&&t.range.end.line>=e.end.line));if(0===t.length&&void 0!==this._writableData.typeIgnoreAll){const t=this._writableData.typeIgnoreAll.range.start,i=t+this._writableData.typeIgnoreAll.range.length,s=(0,f.convertOffsetsToRange)(t,i,this._writableData.parseResults.tokenizerOutput.lines);!n(s)&&this._diagnosticRuleSet.enableTypeIgnoreComments&&o.push(new d.Diagnostic(e,I.Localizer.Diagnostic.unnecessaryTypeIgnore(),s))}r.forEach((t=>{var i;if(null===(i=this._writableData.parseResults)||void 0===i?void 0:i.tokenizerOutput.lines){const i=t.range.start,s=i+t.range.length,r=(0,f.convertOffsetsToRange)(i,s,this._writableData.parseResults.tokenizerOutput.lines);!n(r)&&this._diagnosticRuleSet.enableTypeIgnoreComments&&o.push(new d.Diagnostic(e,I.Localizer.Diagnostic.unnecessaryTypeIgnore(),r))}})),a.forEach((t=>{var i;if(null===(i=this._writableData.parseResults)||void 0===i?void 0:i.tokenizerOutput.lines)if(t.rulesList)t.rulesList.forEach((t=>{const i=t.range.start,s=i+t.range.length,r=(0,f.convertOffsetsToRange)(i,s,this._writableData.parseResults.tokenizerOutput.lines);n(r)||o.push(new d.Diagnostic(e,I.Localizer.Diagnostic.unnecessaryPyrightIgnoreRule().format({name:t.text}),r))}));else{const i=t.range.start,s=i+t.range.length,r=(0,f.convertOffsetsToRange)(i,s,this._writableData.parseResults.tokenizerOutput.lines);n(r)||o.push(new d.Diagnostic(e,I.Localizer.Diagnostic.unnecessaryPyrightIgnore(),r))}}))}if("none"!==this._diagnosticRuleSet.reportImportCycles&&this._writableData.circularDependencies.length>0){const e=(0,d.convertLevelToCategory)(this._diagnosticRuleSet.reportImportCycles);this._writableData.circularDependencies.forEach((t=>{const n=new d.Diagnostic(e,I.Localizer.Diagnostic.importCycleDetected()+"\n"+t.getPaths().map((e=>"  "+e)).join("\n"),(0,v.getEmptyRange)());n.setRule(u.DiagnosticRule.reportImportCycles),i.push(n)}))}return void 0!==this._writableData.hitMaxImportDepth&&i.push(new d.Diagnostic(0,I.Localizer.Diagnostic.importDepthExceeded().format({depth:this._writableData.hitMaxImportDepth}),(0,v.getEmptyRange)())),this._addTaskListDiagnostics(e.taskListTokens,i),e.ignore.find((e=>e.regExp.test(this._realFilePath)))&&(i=[]),this._diagnosticRuleSet.enableTypeIgnoreComments&&void 0!==this._writableData.typeIgnoreAll&&(i=i.filter((e=>0!==e.category&&1!==e.category&&2!==e.category))),i=i.concat(o),n||(i=i.filter((e=>3===e.category||4===e.category||5===e.category))),i}getImports(){return this._writableData.imports||[]}getBuiltinsImport(){return this._writableData.builtinsImport}getIPythonDisplayImport(){return this._writableData.ipythonDisplayImport}getModuleSymbolTable(){return this._writableData.moduleSymbolTable}getCheckTime(){return this._writableData.checkTime}enterEditMode(){this._isEditMode=!0}exitEditMode(){if(this._isEditMode=!1,this._preEditData){const e=this._writableData.clientDocumentContents;return this._writableData=this._preEditData,this._preEditData=void 0,e}}didContentsChangeOnDisk(){if(this._writableData.clientDocumentContents)return!1;if(void 0===this._writableData.lastFileContentLength)return!1;try{const e=this.fileSystem.readFileSync(this._filePath,"utf8");if(e.length!==this._writableData.lastFileContentLength)return!0;if(T.hashString(e)!==this._writableData.lastFileContentHash)return!0}catch(e){return!0}return!1}dropParseAndBindInfo(){this._writableData.parseResults=void 0,this._writableData.moduleSymbolTable=void 0,this._writableData.isBindingNeeded=!0}markDirty(e=!0){this._writableData.fileContentsVersion++,this._writableData.noCircularDependencyConfirmed=!1,this._writableData.isCheckingNeeded=!0,this._writableData.isBindingNeeded=!0,this._writableData.indexingNeeded=e,this._writableData.moduleSymbolTable=void 0,this._writableData.cachedIndexResults=void 0;const t=this.getFilePath();m.Extensions.getProgramExtensions(t).forEach((e=>e.fileDirty?e.fileDirty(t):null))}markReanalysisRequired(e){this._writableData.isCheckingNeeded=!0,this._writableData.noCircularDependencyConfirmed=!1,this._writableData.parseResults&&(this._writableData.parseResults.containsWildcardImport||void 0!==x.getDunderAllInfo(this._writableData.parseResults.parseTree)||e)&&(this._writableData.parseTreeNeedsCleaning=!0,this._writableData.isBindingNeeded=!0,this._writableData.moduleSymbolTable=void 0)}getClientVersion(){return this._writableData.clientDocumentVersion}getOpenFileContents(){return this._writableData.clientDocumentContents}getFileContent(){const e=this.getOpenFileContents();if(void 0!==e)return e;try{const e=this.fileSystem.statSync(this._filePath);if(e.size>k)throw this._console.error(`File length of "${this._filePath}" is ${e.size} which exceeds the maximum supported file size of 52428800`),new Error("File larger than max");return this.fileSystem.readFileSync(this._filePath,"utf8")}catch(e){return}}setClientVersion(e,t){if(this._cachePreEditState(),null===e)this._writableData.clientDocumentVersion=void 0,this._writableData.clientDocumentContents=void 0;else{this._writableData.clientDocumentVersion=e,this._writableData.clientDocumentContents=t;const n=T.hashString(t);t.length===this._writableData.lastFileContentLength&&n===this._writableData.lastFileContentHash||this.markDirty(),this._writableData.lastFileContentLength=t.length,this._writableData.lastFileContentHash=n,this._writableData.isFileDeleted=!1}}prepareForClose(){}isFileDeleted(){return this._writableData.isFileDeleted}isParseRequired(){return!this._writableData.parseResults||this._writableData.analyzedFileContentsVersion!==this._writableData.fileContentsVersion}isBindingRequired(){return!this._writableData.isBindingInProgress&&(!!this.isParseRequired()||this._writableData.isBindingNeeded)}isIndexingRequired(){return this._writableData.indexingNeeded}markIndexDone(){this._writableData.indexingNeeded=!1}isCheckingRequired(){return this._writableData.isCheckingNeeded}getParseResults(){if(!this.isParseRequired())return this._writableData.parseResults}getCachedIndexResults(){return this._writableData.cachedIndexResults}cacheIndexResults(e){this._writableData.cachedIndexResults=e}addCircularDependency(e){let t=!1;this._writableData.circularDependencies.length<4&&(this._writableData.circularDependencies.some((t=>t.isEqual(e)))||(this._writableData.circularDependencies.push(e),t=!0)),t&&this._writableData.diagnosticVersion++}setNoCircularDependencyConfirmed(){this._writableData.noCircularDependencyConfirmed=!0}isNoCircularDependencyConfirmed(){return!this.isParseRequired()&&this._writableData.noCircularDependencyConfirmed}setHitMaxImportDepth(e){this._writableData.hitMaxImportDepth=e}parse(e,t,n){return this._logTracker.log(`parsing: ${this._getPathForLogging(this._filePath)}`,(i=>{if(!this.isParseRequired())return i.suppress(),!1;const s=new y.DiagnosticSink;let r=this.getOpenFileContents();if(void 0===r)try{const e=b.timingStats.readFileTime.totalTime;b.timingStats.readFileTime.timeOperation((()=>{if(r=null!=n?n:this.getFileContent(),void 0===r)throw new Error("Can't get file content");this._writableData.lastFileContentLength=r.length,this._writableData.lastFileContentHash=T.hashString(r)})),i.add(`fs read ${b.timingStats.readFileTime.totalTime-e}ms`)}catch(e){s.addError("Source file could not be read",(0,v.getEmptyRange)()),r="",this.fileSystem.existsSync(this._realFilePath)||(this._writableData.isFileDeleted=!0)}try{const n=R(e,this._filePath,r,this._ipythonMode,s);(0,p.assert)(void 0!==n&&void 0!==n.tokenizerOutput),this._writableData.parseResults=n,this._writableData.typeIgnoreLines=this._writableData.parseResults.tokenizerOutput.typeIgnoreLines,this._writableData.typeIgnoreAll=this._writableData.parseResults.tokenizerOutput.typeIgnoreAll,this._writableData.pyrightIgnoreLines=this._writableData.parseResults.tokenizerOutput.pyrightIgnoreLines;const i=e.findExecEnvironment(this._filePath);b.timingStats.resolveImportsTime.timeOperation((()=>{const e=this._resolveImports(t,n.importedModules,i);this._writableData.imports=e.imports,this._writableData.builtinsImport=e.builtinsImportResult,this._writableData.ipythonDisplayImport=e.ipythonDisplayImportResult,this._writableData.parseDiagnostics=s.fetchAndClear()}));const a=void 0!==e.strict.find((e=>e.regExp.test(this._realFilePath))),o=[];this._diagnosticRuleSet=P.getFileLevelDirectives(this._writableData.parseResults.tokenizerOutput.tokens,this._writableData.parseResults.tokenizerOutput.lines,e.diagnosticRuleSet,a,o),this._writableData.commentDiagnostics=[],o.forEach((e=>{this._writableData.commentDiagnostics.push(new d.Diagnostic(0,e.message,(0,f.convertTextRangeToRange)(e.range,this._writableData.parseResults.tokenizerOutput.lines)))}))}catch(e){const t=(e.stack?e.stack.toString():void 0)||("string"==typeof e.message?e.message:void 0)||JSON.stringify(e);this._console.error(I.Localizer.Diagnostic.internalParseError().format({file:this.getFilePath(),message:t})),this._writableData.parseResults={text:"",parseTree:C.ModuleNode.create({start:0,length:0}),importedModules:[],futureImports:new Set,tokenizerOutput:{tokens:new _.TextRangeCollection([]),lines:new _.TextRangeCollection([]),typeIgnoreAll:void 0,typeIgnoreLines:new Map,pyrightIgnoreLines:new Map,predominantEndOfLineSequence:"\n",predominantTabSequence:"    ",predominantSingleQuoteCharacter:"'"},containsWildcardImport:!1,typingSymbolAliases:new Map},this._writableData.imports=void 0,this._writableData.builtinsImport=void 0,this._writableData.ipythonDisplayImport=void 0;const n=new y.DiagnosticSink;n.addError(I.Localizer.Diagnostic.internalParseError().format({file:this.getFilePath(),message:t}),(0,v.getEmptyRange)()),this._writableData.parseDiagnostics=n.fetchAndClear()}return this._writableData.analyzedFileContentsVersion=this._writableData.fileContentsVersion,this._writableData.indexingNeeded=!0,this._writableData.isBindingNeeded=!0,this._writableData.isCheckingNeeded=!0,this._writableData.parseTreeNeedsCleaning=!1,this._writableData.hitMaxImportDepth=void 0,this._writableData.diagnosticVersion++,!0}))}bind(e,t,n,i){return(0,p.assert)(!this.isParseRequired(),"Bind called before parsing"),(0,p.assert)(this.isBindingRequired(),"Bind called unnecessarily"),(0,p.assert)(!this._writableData.isBindingInProgress,"Bind called while binding in progress"),(0,p.assert)(void 0!==this._writableData.parseResults,"Parse results not available"),this._logTracker.log(`binding: ${this._getPathForLogging(this._filePath)}`,(()=>{try{b.timingStats.bindTime.timeOperation((()=>{this._cleanParseTreeIfRequired();const s=this._buildFileInfo(e,this._writableData.parseResults.text,t,n,i);x.setFileInfo(this._writableData.parseResults.parseTree,s);const r=new F.Binder(s,e.indexGenerationMode);if(this._writableData.isBindingInProgress=!0,r.bindModule(this._writableData.parseResults.parseTree),e.internalTestMode){(new A.TestWalker).walk(this._writableData.parseResults.parseTree)}this._writableData.bindDiagnostics=s.diagnosticSink.fetchAndClear();const a=x.getScope(this._writableData.parseResults.parseTree);(0,p.assert)(void 0!==a,"Module scope not returned by binder"),this._writableData.moduleSymbolTable=a.symbolTable}))}catch(e){const t=(e.stack?e.stack.toString():void 0)||("string"==typeof e.message?e.message:void 0)||JSON.stringify(e);this._console.error(I.Localizer.Diagnostic.internalBindError().format({file:this.getFilePath(),message:t}));const n=new y.DiagnosticSink;n.addError(I.Localizer.Diagnostic.internalBindError().format({file:this.getFilePath(),message:t}),(0,v.getEmptyRange)()),this._writableData.bindDiagnostics=n.fetchAndClear()}finally{this._writableData.isBindingInProgress=!1}this._writableData.diagnosticVersion++,this._writableData.isCheckingNeeded=!0,this._writableData.indexingNeeded=!0,this._writableData.isBindingNeeded=!1}))}check(e,t,n,i){return(0,p.assert)(!this.isParseRequired(),"Check called before parsing"),(0,p.assert)(!this.isBindingRequired(),"Check called before binding"),(0,p.assert)(!this._writableData.isBindingInProgress,"Check called while binding in progress"),(0,p.assert)(this.isCheckingRequired(),"Check called unnecessarily"),(0,p.assert)(void 0!==this._writableData.parseResults,"Parse results not available"),this._logTracker.log(`checking: ${this._getPathForLogging(this._filePath)}`,(()=>{try{b.timingStats.typeCheckerTime.timeOperation((()=>{const s=new b.Duration;new D.Checker(e,t,this._writableData.parseResults,n,i).check(),this._writableData.isCheckingNeeded=!1;const r=x.getFileInfo(this._writableData.parseResults.parseTree);this._writableData.checkerDiagnostics=r.diagnosticSink.fetchAndClear(),this._writableData.checkTime=s.getDurationInMilliseconds()}))}catch(e){if(!o.OperationCanceledException.is(e)){const t=(e.stack?e.stack.toString():void 0)||("string"==typeof e.message?e.message:void 0)||JSON.stringify(e);this._console.error(I.Localizer.Diagnostic.internalTypeCheckingError().format({file:this.getFilePath(),message:t}));const n=new y.DiagnosticSink;n.addError(I.Localizer.Diagnostic.internalTypeCheckingError().format({file:this.getFilePath(),message:t}),(0,v.getEmptyRange)()),this._writableData.checkerDiagnostics=n.fetchAndClear(),this._writableData.isCheckingNeeded=!1}throw e}finally{this._writableData.circularDependencies=[],this._writableData.diagnosticVersion++}}))}test_enableIPythonMode(e){this._ipythonMode=e?w.CellDocs:w.None}_cachePreEditState(){void 0!==this._writableData.clientDocumentContents&&this._isEditMode&&!this._preEditData&&(this._preEditData=this._writableData,this._writableData=new N)}_addTaskListDiagnostics(e,t){var n,i;if(!e||0===e.length||!t)return;if(!(null===(i=null===(n=this._writableData.parseResults)||void 0===n?void 0:n.tokenizerOutput)||void 0===i?void 0:i.tokens))return;const s=this._writableData.parseResults.tokenizerOutput;for(let n=0;n<s.tokens.count;n++){const i=s.tokens.getItemAt(n);if(i.comments&&0!==i.comments.length)for(const n of i.comments)for(const i of e){const e="^[\\s]*"+i.text+"([\\s]*$|[\\W]+)";if(!RegExp(e,"i").test(n.value))continue;let r=n.start;r+=n.value.toLowerCase().indexOf(i.text.toLowerCase());const a=v.TextRange.getEnd(n),o=(0,f.convertOffsetsToRange)(r,a,s.lines);t.push(new d.Diagnostic(6,n.value.trim(),o,i.priority))}}}_buildFileInfo(e,t,n,i,s){(0,p.assert)(void 0!==this._writableData.parseResults,"Parse results not available");return{importLookup:n,futureImports:s,builtinsScope:i,diagnosticSink:new y.TextRangeDiagnosticSink(this._writableData.parseResults.tokenizerOutput.lines),executionEnvironment:e.findExecEnvironment(this._filePath),diagnosticRuleSet:this._diagnosticRuleSet,fileContents:t,lines:this._writableData.parseResults.tokenizerOutput.lines,typingSymbolAliases:this._writableData.parseResults.typingSymbolAliases,definedConstants:e.defineConstant,filePath:this._filePath,moduleName:this._moduleName,isStubFile:this._isStubFile,isTypingStubFile:this._isTypingStubFile,isTypingExtensionsStubFile:this._isTypingExtensionsStubFile,isBuiltInStubFile:this._isBuiltInStubFile,isInPyTypedPackage:this._isThirdPartyPyTypedPresent,ipythonMode:this._ipythonMode,accessedSymbolSet:new Set}}_cleanParseTreeIfRequired(){if(this._writableData.parseResults&&this._writableData.parseTreeNeedsCleaning){new E.ParseTreeCleanerWalker(this._writableData.parseResults.parseTree).clean(),this._writableData.parseTreeNeedsCleaning=!1}}_resolveImports(e,t,n){const i=[],s=(t,s=!1)=>{const r=e.resolveImport(this._filePath,n,{leadingDots:0,nameParts:t,importedSymbols:void 0});if(!s||r.isImportFound)return 0===r.resolvedPaths.length||r.resolvedPaths[0]!==this._filePath?(i.push(r),r):void 0};let r;this._isThirdPartyImport||this._isStubFile||(r=s(["__builtins__"],!0)),r||(r=s(["builtins"]));const a=this._ipythonMode?s(["IPython","display"]):void 0;for(const s of t){const t=e.resolveImport(this._filePath,n,{leadingDots:s.leadingDots,nameParts:s.nameParts,importedSymbols:s.importedSymbols});i.push(t),s.nameParts.length===s.nameNode.nameParts.length?x.setImportInfo(s.nameNode,t):((0,p.assert)(s.nameParts.length>0),(0,p.assert)(s.nameParts.length-1<s.nameNode.nameParts.length),x.setImportInfo(s.nameNode.nameParts[s.nameParts.length-1],t))}return{imports:i,builtinsImportResult:r,ipythonDisplayImportResult:a}}_getPathForLogging(e){return(0,h.getPathForLogging)(this.fileSystem,e)}},t.parseFile=R},37648:(e,t)=>{function n(e,t){e.importedBy.forEach((e=>{t.has(e)||(t.add(e),n(e,t))}))}Object.defineProperty(t,"__esModule",{value:!0}),t.collectImportedByFiles=t.isUserCode=void 0,t.isUserCode=function(e){return!!e&&e.isTracked&&!e.isThirdPartyImport&&!e.isTypeshedFile},t.collectImportedByFiles=function(e){const t=new Set;return n(e,t),t}},9584:function(e,t,n){var i=this&&this.__createBinding||(Object.create?function(e,t,n,i){void 0===i&&(i=n),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,i){void 0===i&&(i=n),e[i]=t[n]}),s=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&i(t,e,n);return s(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.isStubFile=t.SourceMapper=void 0;const a=r(n(21)),o=r(n(66455)),l=n(5284),c=n(79251),p=n(30795),d=n(81844),u=n(44660),y=n(37648),m=n(60259),h=n(51458),g=n(33029);function f(e){return".pyi"===(0,d.getAnyExtensionFromPath)(e,[".pyi"],!1)}t.SourceMapper=class{constructor(e,t,n,i,s,r,a,o,l){this._importResolver=e,this._execEnv=t,this._evaluator=n,this._fileBinder=i,this._boundSourceGetter=s,this._mapCompiled=r,this._preferStubs=a,this._fromFile=o,this._cancelToken=l}findModules(e){var t;return(this._isStubThatShouldBeMappedToImplementation(e)?this._getBoundSourceFilesFromStubFile(e):[null===(t=this._boundSourceGetter(e))||void 0===t?void 0:t.sourceFile]).filter(c.isDefined).map((e=>{var t;return null===(t=e.getParseResults())||void 0===t?void 0:t.parseTree})).filter(c.isDefined)}getModuleNode(e){var t,n;return null===(n=null===(t=this._boundSourceGetter(e))||void 0===t?void 0:t.sourceFile.getParseResults())||void 0===n?void 0:n.parseTree}findDeclarations(e){return(0,u.isClassDeclaration)(e)?this._findClassOrTypeAliasDeclarations(e):(0,u.isFunctionDeclaration)(e)?this._findFunctionOrTypeAliasDeclarations(e):(0,u.isVariableDeclaration)(e)?this._findVariableDeclarations(e):(0,u.isParameterDeclaration)(e)?this._findParameterDeclarations(e):(0,u.isSpecialBuiltInClassDeclaration)(e)?this._findSpecialBuiltInClassDeclarations(e):[]}findClassDeclarationsByType(e,t){const n=[];return this._addClassTypeDeclarations(e,t,n,new Set),n.filter((e=>(0,u.isClassDeclaration)(e))).map((e=>e))}findFunctionDeclarations(e){return this._findFunctionOrTypeAliasDeclarations(e).filter((e=>(0,u.isFunctionDeclaration)(e))).map((e=>e))}isUserCode(e){return(0,y.isUserCode)(this._boundSourceGetter(e))}getNextFileName(e){const t=(0,d.stripFileExtension)(e);let n=1,i=`${t}_${n}.py`;for(;this.isUserCode(i)&&n<1e3;)n+=1,i=`${t}_${n}.py`;return i}_findSpecialBuiltInClassDeclarations(e,t=new Set){if(38===e.node.valueExpression.nodeType){const n=e.node.valueExpression.value;return this._getBoundSourceFilesFromStubFile(e.path).flatMap((e=>this._findClassDeclarationsByName(e,n,t)))}return[]}_findClassOrTypeAliasDeclarations(e,t=new Set){const n=this._getFullClassName(e.node);return this._getBoundSourceFilesFromStubFile(e.path).flatMap((e=>this._findClassDeclarationsByName(e,n,t)))}_findFunctionOrTypeAliasDeclarations(e,t=new Set){const n=e.node.name.value,i=this._getBoundSourceFilesFromStubFile(e.path);if(e.isMethod){const s=o.getEnclosingClass(e.node);if(void 0===s)return[];const r=this._getFullClassName(s);return i.flatMap((e=>this._findMethodDeclarationsByName(e,r,n,t)))}return i.flatMap((e=>this._findFunctionDeclarationsByName(e,n,t)))}_findVariableDeclarations(e,t=new Set){if(38!==e.node.nodeType)return[];const n=e.node.value,i=this._getBoundSourceFilesFromStubFile(e.path),s=o.getEnclosingClass(e.node);if(s){const e=this._getFullClassName(s);return i.flatMap((i=>this._findFieldDeclarationsByName(i,e,n,t)))}return i.flatMap((e=>this._findVariableDeclarationsByName(e,n,t)))}_findParameterDeclarations(e){const t=[];if(!e.node.name)return t;const n=o.getEnclosingFunction(e.node);if(!n)return t;const i=this._evaluator.getDeclarationsForNameNode(n.name);if(!i)return t;const s=new Set;for(const n of i)for(const i of this._findFunctionOrTypeAliasDeclarations(n,s))t.push(...this._lookUpSymbolDeclarations(i.node,e.node.name.value).filter((e=>(0,u.isParameterDeclaration)(e))).map((e=>e)));return t}_findMemberDeclarationsByName(e,t,n,i,s){const r=[],a=this._findClassDeclarationsByName(e,t,s);for(const e of a.filter((e=>(0,u.isClassDeclaration)(e))).map((e=>e))){const t=this._evaluator.getTypeOfClass(e.node);if(!t)continue;const a=(0,g.lookUpClassMember)(t.classType,n);if(a)for(const e of a.symbol.getDeclarations())i(e,s,r)}return r}_findFieldDeclarationsByName(e,t,n,i){let s=[];const r=`@${e.getFilePath()}/c/${t}/v/${n}`;return i.has(r)||(i.add(r),s=this._findMemberDeclarationsByName(e,t,n,((e,t,n)=>{if((0,u.isVariableDeclaration)(e))if(this._isStubThatShouldBeMappedToImplementation(e.path))for(const i of this._findVariableDeclarations(e,t))(0,u.isVariableDeclaration)(i)&&n.push(i);else n.push(e)}),i),i.delete(r)),s}_findMethodDeclarationsByName(e,t,n,i){let s=[];const r=`@${e.getFilePath()}/c/${t}/f/${n}`;return i.has(r)||(i.add(r),s=this._findMemberDeclarationsByName(e,t,n,((e,t,n)=>{(0,u.isFunctionDeclaration)(e)&&(this._isStubThatShouldBeMappedToImplementation(e.path)?(0,l.appendArray)(n,this._findFunctionOrTypeAliasDeclarations(e,t)):n.push(e))}),i),i.delete(r)),s}_findVariableDeclarationsByName(e,t,n){var i;const s=[],r=`@${e.getFilePath()}/v/${t}`;if(n.has(r))return s;n.add(r);const a=null===(i=e.getParseResults())||void 0===i?void 0:i.parseTree;if(!a)return s;const o=this._lookUpSymbolDeclarations(a,t);if(0===o.length)this._addDeclarationsFollowingWildcardImports(a,t,s,n);else for(const e of o)this._addVariableDeclarations(e,s,n);return n.delete(r),s}_findFunctionDeclarationsByName(e,t,n){var i;const s=[],r=`@${e.getFilePath()}/f/${t}`;if(n.has(r))return s;n.add(r);const a=null===(i=e.getParseResults())||void 0===i?void 0:i.parseTree;if(!a)return s;const o=this._lookUpSymbolDeclarations(a,t);if(0===o.length)this._addDeclarationsFollowingWildcardImports(a,t,s,n);else for(const e of o)this._addClassOrFunctionDeclarations(e,s,n);return n.delete(r),s}_findClassDeclarationsByName(e,t,n){var i;let s=[];const r=null===(i=e.getParseResults())||void 0===i?void 0:i.parseTree;if(r){let i=t.split(".");i.length>0&&(s=this._findClassDeclarations(e,i[0],r,n),i=i.slice(1));for(const t of i)s=s.flatMap((i=>this._findClassDeclarations(e,t,i.node,n)))}return s}_findClassDeclarations(e,t,n,i){const s=[],r=`@${e.getFilePath()}[${n.start}]${t}`;if(i.has(r))return s;i.add(r);const a=this._lookUpSymbolDeclarations(n,t);if(0===a.length&&36===n.nodeType)this._addDeclarationsFollowingWildcardImports(n,t,s,i);else for(const e of a)this._addClassOrFunctionDeclarations(e,s,i);return i.delete(r),s}_addVariableDeclarations(e,t,n){if((0,u.isVariableDeclaration)(e))this._isStubThatShouldBeMappedToImplementation(e.path)?(0,l.appendArray)(t,this._findVariableDeclarations(e,n)):t.push(e);else if((0,u.isAliasDeclaration)(e)){const i=this._evaluator.resolveAliasDeclaration(e,!0);i&&((0,u.isVariableDeclaration)(i)?this._addVariableDeclarations(i,t,n):((0,u.isClassDeclaration)(i)||(0,u.isFunctionDeclaration)(i))&&this._addClassOrFunctionDeclarations(i,t,n))}}_addClassOrFunctionDeclarations(e,t,n){var i;if((0,u.isClassDeclaration)(e))this._isStubThatShouldBeMappedToImplementation(e.path)?(0,l.appendArray)(t,this._findClassOrTypeAliasDeclarations(e,n)):t.push(e);else if((0,u.isFunctionDeclaration)(e))this._isStubThatShouldBeMappedToImplementation(e.path)?(0,l.appendArray)(t,this._findFunctionOrTypeAliasDeclarations(e,n)):t.push(e);else if((0,u.isAliasDeclaration)(e)){const i=this._handleSpecialBuiltInModule(e),s=this._evaluator.resolveAliasDeclaration(i,!0);s&&!(0,u.isAliasDeclaration)(s)&&this._addClassOrFunctionDeclarations(s,t,n)}else if((0,u.isVariableDeclaration)(e)){this._addVariableDeclarations(e,t,n);const s=null!==(i=e.typeAliasName)&&void 0!==i?i:e.node,r=this._evaluator.getType(s);if(!r)return;if((0,h.isFunction)(r)&&r.details.declaration)this._addClassOrFunctionDeclarations(r.details.declaration,t,n);else if((0,h.isOverloadedFunction)(r))for(const e of r.overloads.map((e=>e.details.declaration)).filter(c.isDefined))this._addClassOrFunctionDeclarations(e,t,n);else(0,h.isInstantiableClass)(r)&&this._addClassTypeDeclarations(e.path,r,t,n)}}_handleSpecialBuiltInModule(e){if(e.path||!e.node)return e;if("io"!==e.moduleName&&"collections"!==e.moduleName)return e;const t=this._importResolver.getTypeshedStdLibPath(this._execEnv);if(!t)return e;const n=o.getFileInfoFromNode(e.node);if(!n)return e;const i=(0,d.combinePaths)(t,function(){switch(e.node.nodeType){case 21:case 22:return e.node.module;case 23:return e.node.parent.module;default:return(0,p.assertNever)(e.node)}}().nameParts.map((e=>e.value)).join(".")+".pyi"),s=this._getSourceFiles(i,n.filePath);if(0===s.length)return e;const r={...e};return r.path=s[0].getFilePath(),r}_addClassTypeDeclarations(e,t,n,i){const s=t.details.filePath,r=this._getSourceFiles(s,void 0,e),a=t.details.fullName.substring(t.details.moduleName.length+1);for(const e of r)(0,l.appendArray)(n,this._findClassDeclarationsByName(e,a,i))}_getSourceFiles(e,t,n){const i=[];if(this._isStubThatShouldBeMappedToImplementation(e))(0,l.appendArray)(i,this._getBoundSourceFilesFromStubFile(e,t,n));else{const t=this._boundSourceGetter(e);t&&i.push(t.sourceFile)}return i}_addDeclarationsFollowingWildcardImports(e,t,n,i){var s,r;const o=null===(s=a.getScope(e))||void 0===s?void 0:s.symbolTable;if(o)for(const e of o.values())for(const s of e.getDeclarations()){if(!(0,u.isAliasDeclaration)(s)||!s.path||22!==s.node.nodeType||!s.node.isWildcardImport)continue;const e=`@${s.path}/l/${t}`;if(i.has(e))continue;i.add(e);const a=this._getSourceFiles(s.path);for(const e of a){const s=null===(r=e.getParseResults())||void 0===r?void 0:r.parseTree;if(!s)continue;const a=this._lookUpSymbolDeclarations(s,t);if(0===a.length)this._addDeclarationsFollowingWildcardImports(s,t,n,i);else for(const e of a){const t=this._evaluator.resolveAliasDeclaration(e,!0);t&&((0,u.isFunctionDeclaration)(t)||(0,u.isClassDeclaration)(t)?this._addClassOrFunctionDeclarations(t,n,i):(0,u.isVariableDeclaration)(t)&&this._addVariableDeclarations(t,n,i))}}}}_lookUpSymbolDeclarations(e,t){if(void 0===e)return[];const n=a.getScope(e),i=null==n?void 0:n.lookUpSymbol(t),s=null==i?void 0:i.getDeclarations();return null!=s?s:[]}_getFullClassName(e){const t=[];let n=e;for(;void 0!==n;)t.push(n.name.value),n=o.getEnclosingClass(n);return t.reverse().join(".")}_getBoundSourceFilesFromStubFile(e,t,n){var i;return this._getSourcePathsFromStub(e,null!=n?n:null===(i=this._fromFile)||void 0===i?void 0:i.sourceFile.getFilePath()).map((n=>this._fileBinder(null!=t?t:e,n))).filter(c.isDefined)}_getSourcePathsFromStub(e,t){let n=this._importResolver.getSourceFilesFromStub(e,this._execEnv,this._mapCompiled);if(n.length>0)return n;const i=this._getStubFileImportTree(e,t);for(let e=0;e<i.length;e++)if(n=this._importResolver.getSourceFilesFromStub(i[e],this._execEnv,this._mapCompiled),n.length>0)return n;return[]}_getStubFileImportTree(e,t){return t&&this._isStubThatShouldBeMappedToImplementation(e)?(0,m.buildImportTree)(t,e,(e=>{const t=this._boundSourceGetter(e);return t?t.importedBy.map((e=>e.sourceFile.getFilePath())):[]}),this._cancelToken).filter((e=>this._isStubThatShouldBeMappedToImplementation(e))):[e]}_isStubThatShouldBeMappedToImplementation(e){if(this._preferStubs)return!1;return!!f(e)&&this._importResolver.getSourceFilesFromStub(e,this._execEnv,this._mapCompiled).every((t=>t!==e))}},t.isStubFile=f},60259:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.buildImportTree=void 0;const n=1e3;class i{constructor(){this.value=0}}function s(e,t,i,r,a,o){if(a.value>n||o.isCancellationRequested)return[];if(a.value+=1,t===e)return r.length?r:[t];if(r.length>1&&r.find((e=>e===t)))return[];const l=i(t);for(let n=0;n<l.length&&!o.isCancellationRequested;n++){const c=s(e,l[n],i,[...r,t],a,o);if(c.length>0)return c}return[]}t.buildImportTree=function(e,t,n,r){const a=s(e,t,n,[],new i,r);return a.length>0?a:[t]}},93890:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.evaluateStaticBoolLikeExpression=t.evaluateStaticBoolExpression=void 0;const i=n(59750);function s(e,t,n,c,p){if(4===e.nodeType)return s(e.rightExpression,t,n,c,p);if(55===e.nodeType){if(38===e.operator){const i=r(e.expression,t,n,c,p);if(void 0!==i)return!i}}else if(7===e.nodeType){if(37===e.operator||36===e.operator){const i=s(e.leftExpression,t,n,c,p),r=s(e.rightExpression,t,n,c,p);if(void 0===i||void 0===r)return;return 37===e.operator?i||r:i&&r}if(l(e.leftExpression,p)&&52===e.rightExpression.nodeType){const n=function(e){let t;if(e.expressions.length>=2){if(40===e.expressions[0].nodeType&&!e.expressions[0].isImaginary&&40===e.expressions[1].nodeType&&!e.expressions[1].isImaginary){const n=e.expressions[0],i=e.expressions[1];"number"==typeof n.value&&"number"==typeof i.value&&(t=256*n.value+i.value)}}else if(1===e.expressions.length){const n=e.expressions[0];"number"==typeof n.value&&(t=256*n.value)}return t}(e.rightExpression);return a(e.operator,t.pythonVersion,n)}if(24===e.leftExpression.nodeType&&l(e.leftExpression.baseExpression,p)&&1===e.leftExpression.items.length&&!e.leftExpression.trailingComma&&!e.leftExpression.items[0].name&&0===e.leftExpression.items[0].argumentCategory&&40===e.leftExpression.items[0].valueExpression.nodeType&&!e.leftExpression.items[0].valueExpression.isImaginary&&0===e.leftExpression.items[0].valueExpression.value&&40===e.rightExpression.nodeType)return a(e.operator,Math.floor(t.pythonVersion/256),e.rightExpression.value);if(function(e,t=["sys"]){if(35===e.nodeType&&38===e.leftExpression.nodeType&&"platform"===e.memberName.value&&t.some((t=>t===e.leftExpression.value)))return!0;return!1}(e.leftExpression,p)&&48===e.rightExpression.nodeType){const n=e.rightExpression.strings.map((e=>e.value)).join(""),s=function(e){if(e.pythonPlatform===i.PythonPlatform.Darwin)return"darwin";if(e.pythonPlatform===i.PythonPlatform.Windows)return"win32";if(e.pythonPlatform===i.PythonPlatform.Linux)return"linux";return}(t);return o(e.operator,s,n)}if(function(e){if(35===e.nodeType&&38===e.leftExpression.nodeType&&"os"===e.leftExpression.value&&"name"===e.memberName.value)return!0;return!1}(e.leftExpression)&&48===e.rightExpression.nodeType){const n=e.rightExpression.strings.map((e=>e.value)).join(""),s=function(e){if(e.pythonPlatform===i.PythonPlatform.Darwin)return"posix";if(e.pythonPlatform===i.PythonPlatform.Windows)return"nt";if(e.pythonPlatform===i.PythonPlatform.Linux)return"posix";return}(t);if(void 0!==s)return o(e.operator,s,n)}else if(48===e.rightExpression.nodeType){let t;if(38===e.leftExpression.nodeType?t=n.get(e.leftExpression.value):35===e.leftExpression.nodeType&&(t=n.get(e.leftExpression.memberName.value)),void 0!==t&&"string"==typeof t){const n=e.rightExpression.strings.map((e=>e.value)).join("");return o(e.operator,t,n)}}}else if(11===e.nodeType){if(33===e.constType)return!0;if(15===e.constType)return!1}else if(38===e.nodeType){if("TYPE_CHECKING"===e.value)return!0;const t=n.get(e.value);if(void 0!==t)return!!t}else if(35===e.nodeType){if(c&&"TYPE_CHECKING"===e.memberName.value&&38===e.leftExpression.nodeType&&c.some((t=>t===e.leftExpression.value)))return!0;const t=n.get(e.memberName.value);if(void 0!==t)return!!t}}function r(e,t,n,i,r){return(11!==e.nodeType||26!==e.constType)&&s(e,t,n,i,r)}function a(e,t,n){if(void 0!==t&&void 0!==n){if(t=BigInt(t),n=BigInt(n),20===e)return t<n;if(21===e)return t<=n;if(15===e)return t>n;if(16===e)return t>=n;if(12===e)return t===n;if(28===e)return t!==n}}function o(e,t,n){if(void 0!==t&&void 0!==n){if(12===e)return t===n;if(28===e)return t!==n}}function l(e,t=["sys"]){return!(35!==e.nodeType||38!==e.leftExpression.nodeType||"version_info"!==e.memberName.value||!t.some((t=>t===e.leftExpression.value)))}t.evaluateStaticBoolExpression=s,t.evaluateStaticBoolLikeExpression=r},16682:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Symbol=t.indeterminateSymbolId=void 0;const i=n(2848);let s=1;t.indeterminateSymbolId=0;class r{constructor(e){this.id=s++,this._flags=e}static createWithType(e,t){const n=new r(e);return n._synthesizedType=t,n}isInitiallyUnbound(){return!!(1&this._flags)}setIsExternallyHidden(){this._flags|=2}isExternallyHidden(){return!!(2&this._flags)}setIsIgnoredForProtocolMatch(){this._flags|=64}isIgnoredForProtocolMatch(){return!!(64&this._flags)}setIsClassMember(){this._flags|=4}isClassMember(){return!!(4&this._flags)}setIsInstanceMember(){this._flags|=8}isInstanceMember(){return!!(8&this._flags)}setIsClassVar(){this._flags|=128}isClassVar(){return!!(128&this._flags)}setIsInitVar(){this._flags|=1024}isInitVar(){return!!(1024&this._flags)}setIsInDunderAll(){this._flags|=256}isInDunderAll(){return!!(256&this._flags)}setIsPrivateMember(){this._flags|=32}isPrivateMember(){return!!(32&this._flags)}setPrivatePyTypedImport(){this._flags|=512}isPrivatePyTypedImport(){return!!(512&this._flags)}isNamedTupleMemberMember(){return!!(2048&this._flags)}addDeclaration(e){if(this._declarations){const t=this._declarations.findIndex((t=>(0,i.areDeclarationsSame)(t,e)));if(t<0)this._declarations.push(e),this._declarations.forEach((e=>{1===e.type&&e.typeAliasName&&delete e.typeAliasName}));else{const n=this._declarations[t];(0,i.hasTypeForDeclaration)(e)?(this._declarations[t]=e,1===n.type&&1===e.type&&!e.inferredTypeSource&&n.inferredTypeSource&&(e.inferredTypeSource=n.inferredTypeSource)):1===e.type&&1===n.type&&(e.isFinal&&(n.isFinal=!0),n.typeAliasName=e.typeAliasName,!n.inferredTypeSource&&e.inferredTypeSource&&(n.inferredTypeSource=e.inferredTypeSource))}}else this._declarations=[e]}hasDeclarations(){return!!this._declarations&&this._declarations.length>0}getDeclarations(){return this._declarations?this._declarations:[]}hasTypedDeclarations(){return!!this._synthesizedType||this.getDeclarations().some((e=>(0,i.hasTypeForDeclaration)(e)))}getTypedDeclarations(){return this.getDeclarations().filter((e=>(0,i.hasTypeForDeclaration)(e)))}getSynthesizedType(){return this._synthesizedType}}t.Symbol=r},48466:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.isPublicConstantOrTypeAlias=t.isTypeAliasName=t.isConstantName=t.isSingleDunderName=t.isDunderName=t.isPrivateOrProtectedName=t.isProtectedName=t.isPrivateName=void 0;const n=/^[A-Z0-9_]+$/,i=/^[_]+$/,s=/^_{0,2}[A-Z][A-Za-z0-9_]+$/;function r(e){return e.length>2&&e.startsWith("__")&&!e.endsWith("__")}function a(e){return e.length>1&&e.startsWith("_")&&!e.startsWith("__")}function o(e){return r(e)||a(e)}function l(e){return!!e.match(n)&&!e.match(i)}function c(e){return!!e.match(s)}t.isPrivateName=r,t.isProtectedName=a,t.isPrivateOrProtectedName=o,t.isDunderName=function(e){return e.length>4&&e.startsWith("__")&&e.endsWith("__")},t.isSingleDunderName=function(e){return e.length>2&&e.startsWith("_")&&e.endsWith("_")},t.isConstantName=l,t.isTypeAliasName=c,t.isPublicConstantOrTypeAlias=function(e){return!o(e)&&(l(e)||c(e))}},60721:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.isVisibleExternally=t.isTypedDictMemberAccessedThroughIndex=t.getLastTypedDeclaredForSymbol=void 0,t.getLastTypedDeclaredForSymbol=function(e){const t=e.getTypedDeclarations();if(t.length>0)return t[t.length-1]},t.isTypedDictMemberAccessedThroughIndex=function(e){const t=e.getTypedDeclarations();if(t.length>0){if(1===t[t.length-1].type)return!0}return!1},t.isVisibleExternally=function(e){return!e.isExternallyHidden()&&!e.isPrivatePyTypedImport()}},52007:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.NameTypeWalker=t.TestWalker=void 0;const i=n(59438),s=n(30795),r=n(6698),a=n(66455);class o extends i.ParseTreeWalker{constructor(){super()}visitNode(e){const t=super.visitNode(e);return this._verifyParentChildLinks(e,t),this._verifyChildRanges(e,t),t}_verifyParentChildLinks(e,t){t.forEach((t=>{t&&t.parent!==e&&(0,s.fail)(`Child node ${t.nodeType} does not contain a reference to its parent ${e.nodeType}`)}))}_verifyChildRanges(e,t){let n;const i=(0,a.isCompliantWithNodeRangeRules)(e);t.forEach((t=>{if(t){let a=!1;if(!i)switch(e.nodeType){case 3:t===e.typeAnnotationComment&&(a=!0),3===t.nodeType&&(a=!0);break;case 48:t===e.typeAnnotation&&(a=!0);break;default:(0,s.fail)(`node ${e.nodeType} is not marked as not following range rules.`)}a||((t.start<e.start||r.TextRange.getEnd(t)>r.TextRange.getEnd(e))&&(0,s.fail)(`Child node ${t.nodeType} is not contained within its parent ${e.nodeType}`),n&&t.start<r.TextRange.getEnd(n)&&62!==n.nodeType&&(0,s.fail)("Child node is not after previous child node"),n=t)}}))}}t.TestWalker=o;class l extends i.ParseTreeWalker{constructor(e){super(),this._evaluator=e}visitName(e){var t,n;return 23!==(null===(t=e.parent)||void 0===t?void 0:t.nodeType)&&21!==(null===(n=e.parent)||void 0===n?void 0:n.nodeType)&&this._evaluator.isNodeReachable(e,void 0)&&this._evaluator.getType(e),!0}}t.NameTypeWalker=l},51021:function(e,t,n){var i=this&&this.__createBinding||(Object.create?function(e,t,n,i){void 0===i&&(i=n),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,i){void 0===i&&(i=n),e[i]=t[n]}),s=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&i(t,e,n);return s(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.createTracePrinter=void 0;const a=n(79251),o=n(30795),l=n(81844),c=n(96541),p=n(29597),d=r(n(21)),u=r(n(66455)),y=n(16682),m=n(51458);t.createTracePrinter=function(e){function t(e,t="'"){return e?`${t}${e}${t}`:""}e=e.map((e=>(0,l.ensureTrailingDirectorySeparator)(e))).sort(((e,t)=>e.localeCompare(t))).reverse();const n=/[\\/]/g;function i(t){if(t){if("string"==typeof t){for(const i of e)if(t.startsWith(i)){const e=t.substring(i.length);return(0,l.stripFileExtension)(e).replace(n,".")}return t}if(t.nameParts)return t.nameParts.join(".")}return""}function s(e){var n,i,r,a,l,c;if(e)switch(e.category){case 2:return`Any ${t(null===(n=e.typeAliasInfo)||void 0===n?void 0:n.fullName)}`;case 7:return m.TypeBase.isInstantiable(e)?`Class '${e.details.name}' (${e.details.moduleName})`:`Object '${e.details.name}' (${e.details.moduleName})`;case 5:return`Function '${e.details.name}' (${e.details.moduleName})`;case 8:return`Module '${e.moduleName}' (${e.moduleName})`;case 4:return`Never ${t(null===(i=e.typeAliasInfo)||void 0===i?void 0:i.fullName)}`;case 3:return`None ${t(null===(r=e.typeAliasInfo)||void 0===r?void 0:r.fullName)}`;case 6:return`OverloadedFunction [${e.overloads.map((e=>t(s(e),'"'))).join(",")}]`;case 10:return`TypeVar '${e.details.name}' ${t(null===(a=e.typeAliasInfo)||void 0===a?void 0:a.fullName)}`;case 0:return`Unbound ${t(null===(l=e.typeAliasInfo)||void 0===l?void 0:l.fullName)}`;case 9:return`Union [${e.subtypes.map((e=>t(s(e),'"'))).join(",")}]`;case 1:return`Unknown ${t(null===(c=e.typeAliasInfo)||void 0===c?void 0:c.fullName)}`;default:(0,o.assertNever)(e)}return""}function r(e){if(e)switch(e.type){case 8:return`Alias, ${g(e.node)} (${i(e.path)})`;case 6:return`Class, ${g(e.node)} (${i(e.path)})`;case 5:return`Function, ${g(e.node)} (${i(e.path)})`;case 0:return`Intrinsic, ${g(e.node)} ${e.intrinsicType} (${i(e.path)})`;case 2:return`Parameter, ${g(e.node)} (${i(e.path)})`;case 3:return`TypeParameter, ${g(e.node)} (${i(e.path)})`;case 7:return`SpecialBuiltInClass, ${g(e.node)} (${i(e.path)})`;case 1:return`Variable, ${g(e.node)} (${i(e.path)})`;case 4:return`TypeAlias, ${g(e.node)} (${i(e.path)})`;default:(0,o.assertNever)(e)}return""}function h(e){for(;36!==e.nodeType&&e.parent;)e=e.parent;return 36===e.nodeType?d.getFileInfo(e):void 0}function g(e,n=!1){var s;if(!e)return"";let r=n?`(${i(null===(s=h(e))||void 0===s?void 0:s.filePath)})`:"";const a=h(e);if(null==a?void 0:a.lines){const t=(0,c.convertOffsetToPosition)(e.start,a.lines);r+=` [${t.line+1}:${t.character+1}]`}if((0,p.isExpressionNode)(e))return t(function(e,t=30){return e.length<t?e:e.substring(0,t)+" <shortened> "}(u.printExpression(e)),'"')+` ${r}`;switch(e.nodeType){case 21:return`importAs '${g(e.module)}' ${t(e.alias?g(e.alias):"")} ${r}`;case 22:return`importFrom [${e.imports.map((e=>t(g(e),'"'))).join(",")}]`;case 23:return`ImportFromAs '${g(e.name)}' ${t(e.alias?g(e.alias):"")} ${r}`;case 36:return`module ${r}`;case 10:return`class '${g(e.name)}' ${r}`;case 28:return`function '${g(e.name)}' ${r}`;case 37:return`moduleName '${e.nameParts.map((e=>g(e))).join(".")}' ${r}`;case 1:return`argument '${e.name?g(e.name):"N/A"}' ${r}`;case 41:return`parameter '${e.name?g(e.name):"N/A"}' ${r}`;default:return`${u.printParseNodeType(e.nodeType)} ${r}`}}return{print:function(e){return e?function(e){const t=e;return t&&(0,a.isNumber)(t.nodeType)}(e)?g(e,!0):function(e){const t=e;return t&&(0,a.isNumber)(t.type)&&(0,a.isString)(t.path)&&(0,a.isString)(t.moduleName)}(e)?r(e):e instanceof y.Symbol?(t=e)?t.hasDeclarations()?`symbol ${r(t.getDeclarations()[0])}`:"<symbol>":"":function(e){const t=e;return t&&(0,a.isNumber)(t.category)&&(0,a.isNumber)(t.flags)}(e)?s(e):"":"";var t},printFileOrModuleName:i}}},34478:function(e,t,n){var i=this&&this.__createBinding||(Object.create?function(e,t,n,i){void 0===i&&(i=n),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,i){void 0===i&&(i=n),e[i]=t[n]}),s=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&i(t,e,n);return s(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.SpeculativeTypeTracker=void 0;const a=n(30795),o=r(n(66455)),l=n(51458);t.SpeculativeTypeTracker=class{constructor(){this._speculativeContextStack=[],this._speculativeTypeCache=new Map}enterSpeculativeContext(e,t){this._speculativeContextStack.push({speculativeRootNode:e,entriesToUndo:[],allowCacheRetention:t})}leaveSpeculativeContext(){(0,a.assert)(this._speculativeContextStack.length>0);this._speculativeContextStack.pop().entriesToUndo.forEach((e=>{e.cache.delete(e.id)}))}isSpeculative(e){if(0===this._speculativeContextStack.length)return!1;if(!e)return!0;for(let t=this._speculativeContextStack.length-1;t>=0;t--)if(o.isNodeContainedWithin(e,this._speculativeContextStack[t].speculativeRootNode))return!0;return!1}trackEntry(e,t){const n=this._speculativeContextStack.length;n>0&&this._speculativeContextStack[n-1].entriesToUndo.push({cache:e,id:t})}disableSpeculativeMode(){const e=this._speculativeContextStack;return this._speculativeContextStack=[],e}enableSpeculativeMode(e){(0,a.assert)(0===this._speculativeContextStack.length),this._speculativeContextStack=e}addSpeculativeType(e,t,n,i){if((0,a.assert)(this._speculativeContextStack.length>0),this._speculativeContextStack.some((e=>!e.allowCacheRetention)))return;let s=this._speculativeTypeCache.get(e.id);s?(s=s.filter((e=>(!e.typeResult.isIncomplete||e.incompleteGenerationCount===n)&&(i?!e.expectedType||!(0,l.isTypeSame)(e.expectedType,i):!!e.expectedType))),s.length>=8&&s.slice(1)):s=[],s.push({typeResult:t,expectedType:i,incompleteGenerationCount:n}),this._speculativeTypeCache.set(e.id,s)}getSpeculativeType(e,t){if(this._speculativeContextStack.some((t=>o.isNodeContainedWithin(e,t.speculativeRootNode)))){const n=this._speculativeTypeCache.get(e.id);if(n)for(const e of n)if(t){if(e.expectedType&&(0,l.isTypeSame)(t,e.expectedType))return e}else if(!e.expectedType)return e}}}},69719:function(e,t,n){var i=this&&this.__createBinding||(Object.create?function(e,t,n,i){void 0===i&&(i=n),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,i){void 0===i&&(i=n),e[i]=t[n]}),s=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&i(t,e,n);return s(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.getVariableDocString=t.getFunctionOrClassDeclDocString=t.getClassDocString=t.getModuleDocString=t.getModuleDocStringFromPaths=t.getModuleDocStringFromModuleNodes=t.getVariableInStubFileDocStrings=t.getPropertyDocStringInherited=t.getOverloadedFunctionDocStringsInherited=t.getFunctionDocStringInherited=void 0;const a=n(44660),o=r(n(66455)),l=n(9584),c=n(51458),p=n(5284),d=n(33029);function u(e,t){if(6===e.category){if(0===e.overloads.length)return!1;e=e.overloads[0]}return"builtins"===e.details.moduleName&&!!t&&!!e.boundToType&&!c.ClassType.isSameGenericClass(t,e.boundToType)}function y(e,t){const n=[];if(!(0,l.isStubFile)(e.path))return n;for(const i of t.findDeclarations(e))if((0,a.isVariableDeclaration)(i)&&i.docString)n.push(i.docString);else if((0,a.isClassDeclaration)(i)||(0,a.isFunctionDeclaration)(i)){const e=g(i);e&&n.push(e)}return n}function m(e){for(const t of e)if(t.statements){const e=o.getDocString(t.statements);if(e)return e}}function h(e,t){const n=[];for(const i of e)(0,l.isStubFile)(i)&&(0,p.addIfNotNull)(n,t.getModuleNode(i)),n.push(...t.findModules(i));return m(n)}function g(e){var t,n,i;return o.getDocString(null!==(i=null===(n=null===(t=e.node)||void 0===t?void 0:t.suite)||void 0===n?void 0:n.statements)&&void 0!==i?i:[])}function f(e,t,n){if(!(0,c.isOverloadedFunction)(e))return;const i=[];if(e.overloads.some((e=>e.details.docString)))e.overloads.forEach((e=>{e.details.docString&&i.push(e.details.docString)}));else if(t&&(0,l.isStubFile)(t.path)&&(0,a.isFunctionDeclaration)(t)){const e=v(n.findFunctionDeclarations(t));e&&i.push(e)}return i}function T(e,t){let n=v([e]);if(!n&&(0,l.isStubFile)(e.path)){n=v(t.findFunctionDeclarations(e))}return n}function v(e){for(const t of e){const e=g(t);if(e)return e}}t.getFunctionDocStringInherited=function(e,t,n,i){let s;if(!u(e,i)&&t&&(0,a.isFunctionDeclaration)(t)&&(s=function(e,t,n){if(!(0,c.isFunction)(e))return;let i=e.details.docString;!i&&t&&(i=T(t,n));!i&&e.details.declaration&&(i=T(e.details.declaration,n));return i}(e,t,n)),!s&&i){const t=e.details.name,r=(0,d.getClassMemberIterator)(i,t,29);for(const e of r){if(e.symbol.getDeclarations().length>0){const t=e.symbol.getDeclarations().slice(-1)[0];if((0,a.isFunctionDeclaration)(t)&&(s=T(t,n),s))break}}}return s||e.details.docString},t.getOverloadedFunctionDocStringsInherited=function(e,t,n,i,s){var r;let a;if(!u(e,s))for(const i of t)if(a=f(e,i,n),a&&a.length>0)return a;if(s&&e.overloads.length>0){const t=e.overloads[0].details.name,o=(0,d.getClassMemberIterator)(s,t,29);for(const e of o){const t=e.symbol.getDeclarations().slice(-1)[0],s=null===(r=i.getTypeForDeclaration(t))||void 0===r?void 0:r.type;if(s&&(a=f(s,t,n),a&&a.length>0))break}}return null!=a?a:[]},t.getPropertyDocStringInherited=function(e,t,n){const i=o.getEnclosingClass(e.node.name,!1),s=i?n.getTypeOfClass(i):void 0;if(s)return function(e,t,n,i){var s,r;if(!e||!(0,a.isFunctionDeclaration)(e))return;const o=null===(s=n.getTypeForDeclaration(e))||void 0===s?void 0:s.type;if(!o||!(0,d.isMaybeDescriptorInstance)(o))return;const l=28===e.node.nodeType?e.node.name.value:void 0;if(!l)return;const p=(0,d.getClassIterator)(i,0);for(const[e]of p){if(!(0,c.isInstantiableClass)(e))continue;const i=e.details.fields.get(l),s=null==i?void 0:i.getDeclarations();if(s)for(const e of s)if((0,a.isFunctionDeclaration)(e)){const i=null===(r=n.getTypeForDeclaration(e))||void 0===r?void 0:r.type;if(i&&(0,d.isMaybeDescriptorInstance)(i)){const n=T(e,t);if(n)return n}}}return}(e,t,n,s.classType)},t.getVariableInStubFileDocStrings=y,t.getModuleDocStringFromModuleNodes=m,t.getModuleDocStringFromPaths=h,t.getModuleDocString=function(e,t,n){var i;let s=e.docString;if(!s){s=h([null!==(i=null==t?void 0:t.path)&&void 0!==i?i:e.filePath],n)}return s},t.getClassDocString=function(e,t,n){let i=e.details.docString;if(!i&&t&&(0,a.isClassDeclaration)(t)&&(i=v([t]),!i&&t&&(0,l.isStubFile)(t.path)&&6===t.type))for(const e of n.findDeclarations(t)){if((0,a.isVariableDeclaration)(e)&&e.docString){i=e.docString;break}if((0,a.isClassDeclaration)(e)||(0,a.isFunctionDeclaration)(e)){i=g(e);break}}if(!i&&t){const s=n.findClassDeclarationsByType(t.path,e);if(s){i=v(s.filter((e=>(0,a.isClassDeclaration)(e))).map((e=>e)))}}return i},t.getFunctionOrClassDeclDocString=g,t.getVariableDocString=function(e,t){if(e)return void 0!==e.docString?e.docString:y(e,t).find((e=>e))}},11528:function(e,t,n){var i=this&&this.__createBinding||(Object.create?function(e,t,n,i){void 0===i&&(i=n),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,i){void 0===i&&(i=n),e[i]=t[n]}),s=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&i(t,e,n);return s(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.createTypeEvaluator=t.maxCodeComplexity=void 0;const a=n(88711),o=n(5284),l=n(30795),c=n(83501),p=n(28513),d=n(96541),u=n(86513),y=n(6698),m=n(99661),h=n(29597),g=n(92365),f=n(21403),T=r(n(21)),v=n(54318),_=n(80563),b=n(54750),I=n(45341),C=n(5838),S=n(2848),x=n(92814),F=n(19948),D=n(46288),P=n(63250),E=n(32966),A=r(n(66455)),k=n(78140),w=n(79282),N=n(56370),R=r(n(60177)),O=n(93890),M=n(16682),L=n(48466),V=n(60721),U=n(34478),z=n(7461),B=r(n(73800)),W=n(33029),$=n(43024),G=n(2026),j=n(51458),q=new Map([["asyncio.futures.Future",u.PythonVersion.V3_9],["asyncio.tasks.Task",u.PythonVersion.V3_9],["builtins.dict",u.PythonVersion.V3_9],["builtins.frozenset",u.PythonVersion.V3_9],["builtins.list",u.PythonVersion.V3_9],["builtins._PathLike",u.PythonVersion.V3_9],["builtins.set",u.PythonVersion.V3_9],["builtins.tuple",u.PythonVersion.V3_9],["collections.ChainMap",u.PythonVersion.V3_9],["collections.Counter",u.PythonVersion.V3_9],["collections.defaultdict",u.PythonVersion.V3_9],["collections.DefaultDict",u.PythonVersion.V3_9],["collections.deque",u.PythonVersion.V3_9],["collections.OrderedDict",u.PythonVersion.V3_9],["queue.Queue",u.PythonVersion.V3_9]]),K=new Map([["builtins.float",["builtins.int"]],["builtins.complex",["builtins.float","builtins.int"]],["builtins.bytes",["builtins.bytearray","builtins.memoryview"]]]),H=64;t.maxCodeComplexity=768,t.createTypeEvaluator=function(e,n){const i=[],s=new Set,r=new U.SpeculativeTypeTracker,Y=[];let Q,Z,J,X,ee,te,ne,ie,se,re,ae,oe,le,ce=new Set,pe=new Map,de=new Map,ue=new Map,ye=new Map,me=[],he=!1,ge=0;const fe=[];let Te;function ve(){Q&&(0,a.throwIfCancellationRequested)(Q)}function _e(e){return Te&&xe(e)?Te.get(e.id):de.get(e.id)}function be(e){const t=_e(e);return!!t&&(!t.typeResult.isIncomplete||t.incompleteGenerationCount===ge)}function Ie(e,t){var i,s;const r=_e(e);if(r&&!r.typeResult.isIncomplete){if(n.verifyTypeCacheEvaluatorFlags&&void 0!==t){const a=r.flags;if(void 0!==a&&t!==a){const r=T.getFileInfo(e),o=(0,d.convertOffsetToPosition)(e.start,r.lines),c=`Type cache flag mismatch for node type ${e.nodeType} (parent ${null!==(s=null===(i=e.parent)||void 0===i?void 0:i.nodeType)&&void 0!==s?s:"none"}): cached flags = ${a}, access flags = ${t}, file = {${r.filePath} [${o.line+1}:${o.character+1}]}`;n.verifyTypeCacheEvaluatorFlags?(0,l.fail)(c):console.log(c)}}return r.typeResult.type}}function Ce(e,t,n,i,s=!1){const a=Te&&xe(e)?Te:de;if(t.isIncomplete){const n=a.get(e.id);void 0===n||(0,j.isTypeSame)(t.type,n.typeResult.type)||ge++}else ge++;a.set(e.id,{typeResult:t,flags:n,incompleteGenerationCount:ge}),gi(e)&&(r.trackEntry(a,e.id),s&&r.addSpeculativeType(e,t,ge,null==i?void 0:i.expectedType))}function Se(e,t=j.UnknownType.create(),n=0){Ce(e,{type:t},n)}function xe(e){const t=fe.length;if(0===t)return!1;const n=fe[t-1];let i=e;for(;i;){if(i===n.functionNode)return!0;i=i.parent}return!1}function Fe(e,t){return i.findIndex((n=>n.symbolId===e.id&&n.declaration===t))}function De(e,t){const n=Fe(e,t);if(n>=0){for(let e=n+1;e<i.length;e++)i[e].isResultValid=!1;return!1}return i.push({symbolId:e.id,declaration:t,isResultValid:!0}),!0}function Pe(e){const t=i.pop();return(0,l.assert)(t.symbolId===e.id),t.isResultValid}function Ee(e,t,n){const s=Fe(e,t);s>=0&&(i[s].partialType=n)}function Ae(e,t){const n=Fe(e,t);if(n>=0)return i[n].partialType}function ke(e){var t;return null===(t=si(e,(()=>{ti(e)})))||void 0===t?void 0:t.type}function we(e){let t=e,n=e;for(;n;)(0,h.isExpressionNode)(n)&&(t=n),n=n.parent;for(ti(t),n=e;n;){const e=ye.get(n.id);if(e)return{type:e,node:n};if(n===t)break;n=n.parent}}function Ne(e){he||(he=!0,J=ui(e,"object"),X=di(e,"type"),ee=ui(e,"function"),Qe(e,"Collection"),Z=Ze(e,"NoneType")||j.AnyType.create(),te=di(e,"tuple"),ne=di(e,"bool"),ie=di(e,"int"),se=di(e,"str"),re=di(e,"dict"),ae=Qe(e,"TypedDict"),oe=Qe(e,"_TypedDict"),le=Ze(e,"SupportsKeysAndGetItem"),le||(le=Qe(e,"Mapping")))}function Re(e,t=0,n){var i,s;const a=_e(e);if(a&&(!a.typeResult.isIncomplete||a.incompleteGenerationCount===ge))return a.typeResult;{const t=r.getSpeculativeType(e,null==n?void 0:n.expectedType);if(t&&(!t.typeResult.isIncomplete||t.incompleteGenerationCount===ge))return t.typeResult}let o;ve(),n&&(n.expectedType=(0,W.transformPossibleRecursiveTypeAlias)(n.expectedType)),Ne(e);let d=0!=(128&t);switch(e.nodeType){case 38:o=function(e,t){var n;const i=T.getFileInfo(e),s=e.value;let r,a,o=!1;const c=0!=(4&t)||i.isStubFile,d=T.getTypeParameterSymbol(e);if(d){r=d,(0,l.assert)(1===r.getDeclarations().length);const t=(0,V.getLastTypedDeclaredForSymbol)(r);(0,l.assert)(3===(null==t?void 0:t.type)),a=_i(t.node),ft(i,r,e)}else{let n=yi(e,s,!c,c&&0!=(256&t));if(!n){const i=Ti(e);i&&(n=yi(i,i.value,!c,c&&0!=(256&t)))}if(n){let d=!c;if(4===n.scope.type&&(d=!1),r=n.symbol,ft(i,r,e),!i.diagnosticRuleSet.analyzeUnannotatedFunctions){const t=A.getEnclosingFunction(e);if(t&&A.isUnannotatedFunction(t))return{type:j.AnyType.create(),isIncomplete:!1}}const u=xi(r,d?e:void 0);let y=(0,W.transformPossibleRecursiveTypeAlias)(u.type);u.isIncomplete&&((0,j.isUnbound)(y)&&(y=j.UnknownType.create(!0)),o=!0),u.isRecursiveDefinition&&et(e)&&ot(T.getFileInfo(e).diagnosticRuleSet.reportGeneralTypeIssues,p.DiagnosticRule.reportGeneralTypeIssues,m.Localizer.Diagnostic.recursiveDefinition().format({name:s}),e);const h=!!y&&(0,j.isInstantiableClass)(y)&&j.ClassType.isSpecialBuiltIn(y);if(a=y,d&&!h){let i=y;if(!n.isBeyondExecutionScope&&r.isInitiallyUnbound()&&(i=j.UnboundType.create(),3===n.scope.type)){(0,l.assert)(n.scope.parent);const e=n.scope.parent.lookUpSymbol(s);if(e){i=xi(e).type}}const c=ai(e,r.id,i,void 0,{skipConditionalNarrowing:0!=(256&t)});if(c.type&&(a=c.type),c.isIncomplete&&(o=!0),!c.type&&n.isBeyondExecutionScope){const t=function(e,t,n){if(!t.symbol.getDeclarations().every((e=>1===e.type||2===e.type||8===e.type)))return;const i=R.getScopeHierarchy(e,t.scope);if(i&&i.length>=2&&i.every((e=>1===e.type||3===e.type))){const s=R.findTopNodeInScope(e,i[i.length-2]);if(s&&(28===s.nodeType||30===s.nodeType)){const i=T.getFlowNode(s);if(i&&t.symbol.getDeclarations().every((e=>{if(2===e.type)return!0;if(8===e.type)return!0;const t=T.getFlowNode(e.node);return!!t&&!ns.isFlowNodeReachable(t,i,!0)})))return ai(e,t.symbol.id,n,s)}}return}(e,n,y);(null==t?void 0:t.type)&&(a=t.type),(null==t?void 0:t.isIncomplete)&&(o=!0)}}if(a=_t(e,a,t),0!=(256&t)&&u.includesVariableDecl&&!a.typeAliasInfo){let n=(0,j.isTypeVar)(a)||(0,W.isTypeAliasPlaceholder)(a);(0,j.isClass)(a)&&!a.includeSubclasses&&(n=!0),n||i.isTypingStubFile||!u.includesIllegalTypeAliasDecl&&j.TypeBase.isInstantiable(a)&&0==(2&t)||(ot(i.diagnosticRuleSet.reportGeneralTypeIssues,p.DiagnosticRule.reportGeneralTypeIssues,m.Localizer.Diagnostic.typeAnnotationVariable(),e),a=j.UnknownType.create())}}else"reveal_type"===s||"reveal_locals"===s?a=j.AnyType.create():(ot(i.diagnosticRuleSet.reportUndefinedVariable,p.DiagnosticRule.reportUndefinedVariable,m.Localizer.Diagnostic.symbolIsUndefined().format({name:s}),e),a=j.UnknownType.create())}(0,j.isParamSpec)(a)&&32&t&&(st(m.Localizer.Diagnostic.paramSpecContext(),e),a=j.UnknownType.create());if((0,j.isTypeVar)(a)&&!a.details.isParamSpec&&!a.isVariadicInUnion&&0==(128&t)&&a.details.name===s){if(!(7===(null===(n=e.parent)||void 0===n?void 0:n.nodeType)&&6===e.parent.operator)){const t=a.details.isVariadic?Qe(e,"TypeVarTuple"):Qe(e,"TypeVar");a=t&&(0,j.isInstantiableClass)(t)?j.ClassType.cloneAsInstance(t):j.UnknownType.create()}}0!=(128&t)&&0==(1024&t)&&(0,j.isInstantiableClass)(a)&&j.ClassType.isBuiltIn(a,"Generic")&&ot(T.getFileInfo(e).diagnosticRuleSet.reportGeneralTypeIssues,p.DiagnosticRule.reportGeneralTypeIssues,m.Localizer.Diagnostic.genericNotAllowed(),e);(0,j.isTypeVar)(a)&&!a.details.isSynthesized&&(a=vt(e,a,t));return{type:a,isIncomplete:o}}(e,t);break;case 35:o=function(e,t){const n=2|571652&t,i=Re(e.leftExpression,n);if((0,W.isTypeAliasPlaceholder)(i.type))return{type:j.UnknownType.create(!0),isIncomplete:!0};const s=bt(e,i,{method:"get"},2|t);if((0,_.isCodeFlowSupportedForReference)(e)){Ce(e,{...s,isIncomplete:!0},t),Ce(e.memberName,{...s,isIncomplete:!0},t);let n=s.type,r=!!s.isIncomplete;if((0,j.isUnbound)(n)){const t=yt(i.type);let s;(0,j.isInstantiableClass)(t)?s=(0,W.lookUpClassMember)(t,e.memberName.value,1):(0,j.isClassInstance)(t)&&(s=(0,W.lookUpObjectMember)(t,e.memberName.value,1)),s&&(n=ki(s),r=!1)}const a=ai(e,M.indeterminateSymbolId,n,void 0,{isTypeAtStartIncomplete:r,skipConditionalNarrowing:0!=(256&t)});a.type&&(s.type=a.type),a.isIncomplete&&(s.isIncomplete=!0),s.type=_t(e,s.type,t)}i.isIncomplete&&(s.isIncomplete=!0);return Ce(e.memberName,s,t),s}(e,t);break;case 24:o=function(e,t=0){const n=Re(e.baseExpression,2|t);if(128&t&&48===e.baseExpression.nodeType){const t=T.getFileInfo(e);!t.isStubFile&&t.executionEnvironment.pythonVersion<u.PythonVersion.V3_10&&st(m.Localizer.Diagnostic.stringNotSubscriptable(),e.baseExpression)}if(0==(4&t)){let i=0!=(32768&t);if(i){const t=A.getExecutionScopeNode(e);36===(null==t?void 0:t.nodeType)&&(i=!1)}if(!i){const t=T.getFileInfo(e);if((0,j.isInstantiableClass)(n.type)&&j.ClassType.isBuiltIn(n.type)&&!n.type.aliasName){const i=q.get(n.type.details.fullName);void 0!==i&&t.executionEnvironment.pythonVersion<i&&!t.isStubFile&&st(m.Localizer.Diagnostic.classNotRuntimeSubscriptable().format({name:n.type.aliasName||n.type.details.name}),e.baseExpression)}}}const i=Ft(e,n,{method:"get"},t);if((0,_.isCodeFlowSupportedForReference)(e)){let s=!0;if(mt(n.type,void 0,(e=>{(0,j.isClassInstance)(e)&&(j.ClassType.isBuiltIn(e)||j.ClassType.isTypedDictClass(e))||(s=!1)})),s){Ce(e,i,t);const s=ai(e,M.indeterminateSymbolId,i.type,void 0,{isTypeAtStartIncomplete:!!n.isIncomplete||!!i.isIncomplete,skipConditionalNarrowing:0!=(256&t)});s.type&&(i.type=s.type),s.isIncomplete&&(i.isIncomplete=!0)}}n.isIncomplete&&(i.isIncomplete=!0);return i}(e,t);break;case 9:o=function(e,t,n){var i;let s;s=30===e.leftExpression.nodeType?function(e,t){(0,l.assert)(30===e.leftExpression.nodeType);const n=j.FunctionType.createSynthesizedInstance("");n.details.declaredReturnType=t?t.expectedType:j.UnknownType.create();let i=!1;e.arguments.forEach(((e,t)=>{const s=Re(e.valueExpression);s.isIncomplete&&(i=!0),j.FunctionType.addParameter(n,{category:0,name:`p${t.toString()}`,type:s.type,hasDeclaredType:!0})}));const s=e.leftExpression.parameters;if(s.length>0){const e=s[s.length-1];0!==e.category||e.name||j.FunctionType.addParameter(n,{category:0,name:"",type:j.UnknownType.create()})}function r(){return Re(e.leftExpression,2,(0,W.makeInferenceContext)(n))}let a=i||gi(e)||(null==t?void 0:t.isTypeIncomplete)?hi(e.leftExpression,r):r();a.typeErrors&&(a=Re(e.leftExpression,2));return a}(e,t):Re(e.leftExpression,2);const r=e.arguments.map((e=>({valueExpression:e.valueExpression,argumentCategory:e.argumentCategory,node:e,name:e.name})));let a={type:j.UnknownType.create()};if((0,W.isTypeAliasPlaceholder)(s.type))a.isIncomplete=!0;else{if(38===e.leftExpression.nodeType&&"super"===e.leftExpression.value)a=function(e){e.arguments.length>2&&st(m.Localizer.Diagnostic.superCallArgCount(),e.arguments[2]);let t,n;if(e.arguments.length>0){t=Re(e.arguments[0].valueExpression).type;const n=yt(t);(0,j.isAnyOrUnknown)(n)||(0,j.isInstantiableClass)(n)||ot(T.getFileInfo(e).diagnosticRuleSet.reportGeneralTypeIssues,p.DiagnosticRule.reportGeneralTypeIssues,m.Localizer.Diagnostic.superCallFirstArg().format({type:es(t)}),e.arguments[0].valueExpression)}else{const n=A.getEnclosingClass(e);if(n){const e=An(n);t=e?e.classType:j.UnknownType.create()}else st(m.Localizer.Diagnostic.superCallZeroArgForm(),e.leftExpression),t=j.UnknownType.create()}if(e.arguments.length>1){const i=yt(Re(e.arguments[1].valueExpression).type);let s=!1;if((0,j.isAnyOrUnknown)(i)||((0,j.isClassInstance)(i)?((0,j.isInstantiableClass)(t)&&((0,W.derivesFromClassRecursive)(j.ClassType.cloneAsInstantiable(i),t,!0)||(s=!0)),n=i):(0,j.isInstantiableClass)(i)?((0,j.isInstantiableClass)(t)&&((0,W.derivesFromClassRecursive)(i,t,!0)||(s=!0)),n=i):s=!0),s){ot(T.getFileInfo(e).diagnosticRuleSet.reportGeneralTypeIssues,p.DiagnosticRule.reportGeneralTypeIssues,m.Localizer.Diagnostic.superCallSecondArg().format({type:es(t)}),e.arguments[1].valueExpression)}}else{const i=A.getEnclosingFunction(e);let s;if(i){const e=Vn(i);if(e){const t=e.functionType;j.FunctionType.isClassMethod(t)?t.details.parameters.length>0&&t.details.parameters[0].hasDeclaredType&&(s=yt(t.details.parameters[0].type)):j.FunctionType.isInstanceMethod(t)&&t.details.parameters.length>0&&t.details.parameters[0].hasDeclaredType&&(s=yt((0,W.convertToInstantiable)(t.details.parameters[0].type)))}}s&&(0,j.isInstantiableClass)(s)?n=s:(0,j.isInstantiableClass)